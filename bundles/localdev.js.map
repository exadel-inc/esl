{"version":3,"file":"localdev.js","mappings":"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","sources":["webpack:///./src/anchor/anchor-link.ts","webpack:///./src/back-link/back-link.ts","webpack:///./src/common/breakpoints.ts","webpack:///./src/esl-media-demo/test-media-source.ts","webpack:///./src/esl-media-demo/test-media.ts","webpack:///./src/landing/marquee/marquee.ts","webpack:///./src/navigation/header/header-search.ts","webpack:///./src/navigation/sidebar/sidebar.ts","webpack:///./src/search/search-script.ts","webpack:///./src/search/search.ts","webpack:///../src/modules/draft/esl-carousel/all.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel-slide.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-multi-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-single-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-autoplay.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-dots.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-link.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-touch.plugin.ts","webpack:///../src/modules/esl-a11y-group/core/esl-a11y-group.ts","webpack:///../src/modules/esl-alert/core/esl-alert.ts","webpack:///../src/modules/esl-animate/core/esl-animate-service.ts","webpack:///../src/modules/esl-animate/core/esl-animate.ts","webpack:///../src/modules/esl-base-element/core/esl-base-element.ts","webpack:///../src/modules/esl-event-listener/core/api.ts","webpack:///../src/modules/esl-event-listener/core/listener.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes-data.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes.ts","webpack:///../src/modules/esl-footnotes/core/esl-note.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-item.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-list.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-wrapper.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-dropdown.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-renderer.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select.ts","webpack:///../src/modules/esl-image/core/esl-image-iobserver.ts","webpack:///../src/modules/esl-image/core/esl-image-strategies.ts","webpack:///../src/modules/esl-image/core/esl-image.ts","webpack:///../src/modules/esl-media-query/core/common/env-shortcuts.ts","webpack:///../src/modules/esl-media-query/core/common/screen-breakpoint.ts","webpack:///../src/modules/esl-media-query/core/common/screen-dpr.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-base.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-condition.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-const.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-containers.ts","webpack:///../src/modules/esl-media-query/core/esl-media-query.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule-list.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule.ts","webpack:///../src/modules/esl-media/core/esl-media-iobserver.ts","webpack:///../src/modules/esl-media/core/esl-media-manager.ts","webpack:///../src/modules/esl-media/core/esl-media-provider.ts","webpack:///../src/modules/esl-media/core/esl-media-registry.ts","webpack:///../src/modules/esl-media/core/esl-media.ts","webpack:///../src/modules/esl-media/providers/brightcove-provider.ts","webpack:///../src/modules/esl-media/providers/html5/audio-provider.ts","webpack:///../src/modules/esl-media/providers/html5/media-provider.ts","webpack:///../src/modules/esl-media/providers/html5/video-provider.ts","webpack:///../src/modules/esl-media/providers/iframe-provider.ts","webpack:///../src/modules/esl-media/providers/youtube-provider.ts","webpack:///../src/modules/esl-mixin-element/ui/esl-mixin-element.ts","webpack:///../src/modules/esl-mixin-element/ui/esl-mixin-registry.ts","webpack:///../src/modules/esl-panel-group/core/esl-panel-group.ts","webpack:///../src/modules/esl-panel/core/esl-panel.ts","webpack:///../src/modules/esl-popup/core/esl-popup-placeholder.ts","webpack:///../src/modules/esl-popup/core/esl-popup-position.ts","webpack:///../src/modules/esl-popup/core/esl-popup.ts","webpack:///../src/modules/esl-related-target/core/esl-related-target.ts","webpack:///../src/modules/esl-scrollbar/core/esl-scrollbar.ts","webpack:///../src/modules/esl-tab/core/esl-tab.ts","webpack:///../src/modules/esl-tab/core/esl-tabs.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-dispatcher.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-placeholder.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable.ts","webpack:///../src/modules/esl-tooltip/core/esl-tooltip.ts","webpack:///../src/modules/esl-traversing-query/core/esl-traversing-query.ts","webpack:///../src/modules/esl-trigger/core/esl-trigger.ts","webpack:///../src/modules/esl-utils/abstract/observable.ts","webpack:///../src/modules/esl-utils/async/debounce.ts","webpack:///../src/modules/esl-utils/async/delayed-task.ts","webpack:///../src/modules/esl-utils/async/promise.ts","webpack:///../src/modules/esl-utils/async/raf.ts","webpack:///../src/modules/esl-utils/decorators/attr.ts","webpack:///../src/modules/esl-utils/decorators/bind.ts","webpack:///../src/modules/esl-utils/decorators/bool-attr.ts","webpack:///../src/modules/esl-utils/decorators/decorate.ts","webpack:///../src/modules/esl-utils/decorators/json-attr.ts","webpack:///../src/modules/esl-utils/decorators/listen.ts","webpack:///../src/modules/esl-utils/decorators/memoize.ts","webpack:///../src/modules/esl-utils/decorators/prop.ts","webpack:///../src/modules/esl-utils/decorators/ready.ts","webpack:///../src/modules/esl-utils/dom/api.ts","webpack:///../src/modules/esl-utils/dom/attr.ts","webpack:///../src/modules/esl-utils/dom/class.ts","webpack:///../src/modules/esl-utils/dom/events/misc.ts","webpack:///../src/modules/esl-utils/dom/events/target.ts","webpack:///../src/modules/esl-utils/dom/focus.ts","webpack:///../src/modules/esl-utils/dom/keys.ts","webpack:///../src/modules/esl-utils/dom/ready.ts","webpack:///../src/modules/esl-utils/dom/rect.ts","webpack:///../src/modules/esl-utils/dom/rtl.ts","webpack:///../src/modules/esl-utils/dom/sanitize.ts","webpack:///../src/modules/esl-utils/dom/script.ts","webpack:///../src/modules/esl-utils/dom/scroll/parent.ts","webpack:///../src/modules/esl-utils/dom/scroll/scroll-into-view.ts","webpack:///../src/modules/esl-utils/dom/traversing.ts","webpack:///../src/modules/esl-utils/dom/visible.ts","webpack:///../src/modules/esl-utils/dom/window.ts","webpack:///../src/modules/esl-utils/environment/device-detector.ts","webpack:///../src/modules/esl-utils/environment/export-ns.ts","webpack:///../src/modules/esl-utils/fixes/ie-fixes.ts","webpack:///../src/modules/esl-utils/fixes/viewport.ts","webpack:///../src/modules/esl-utils/misc/array.ts","webpack:///../src/modules/esl-utils/misc/format.ts","webpack:///../src/modules/esl-utils/misc/functions.ts","webpack:///../src/modules/esl-utils/misc/memoize.ts","webpack:///../src/modules/esl-utils/misc/object/compare.ts","webpack:///../src/modules/esl-utils/misc/object/copy.ts","webpack:///../src/modules/esl-utils/misc/object/merge.ts","webpack:///../src/modules/esl-utils/misc/object/path.ts","webpack:///../src/modules/esl-utils/misc/object/types.ts","webpack:///../src/modules/esl-utils/misc/object/utils.ts","webpack:///../src/modules/esl-utils/misc/uid.ts","webpack:///../src/modules/lib.ts","webpack:///../src/polyfills/es5-target-shim.ts","webpack:///../src/polyfills/list/dom.element.toggleAttribute.ts","webpack:///../src/polyfills/list/dom.keyboard.key.ts","webpack:///../src/polyfills/list/dom.node.isConnected.ts","webpack:///../src/polyfills/polyfills.validate.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///./src/localdev.ts"],"sourcesContent":["import {ESLMixinElement} from '../../../src/modules/esl-mixin-element/ui/esl-mixin-element';\nimport {listen, memoize} from '../../../src/modules/esl-utils/decorators';\nimport {afterNextRender} from '../../../src/modules/esl-utils/async/raf';\nimport {ESLEventUtils} from '../../../src/modules/esl-utils/dom/events';\n\n/**\n * Demo sample of anchor mixin\n */\nexport class ESLDemoAnchorLink extends ESLMixinElement {\n  static is = 'esl-d-anchor';\n\n  @memoize()\n  public get anchorHref(): string | null {\n    if (this.$host instanceof HTMLAnchorElement) {\n      const url = new URL(this.$host.href);\n      return url.hash ? url.hash.substring(1) : null;\n    }\n    return null;\n  }\n  @memoize()\n  public get anchorTarget(): Element | null {\n    return this.anchorHref ? document.getElementById(this.anchorHref) : null;\n  }\n\n  public moveToTarget(): void {\n    const $target = this.anchorTarget;\n    if (!$target) return console.warn('No anchor target found');\n\n    ESLEventUtils.dispatch($target, 'esl:show:request');\n    afterNextRender(() => {\n      // TODO: replace with scroll ext version\n      // scrollIntoView($target, {behavior: 'smooth'})\n      //   .then(() => console.log('Scroll to successful: ', $target));\n      $target.scrollIntoView({behavior: 'smooth'});\n    });\n  }\n\n  @listen('click')\n  protected onClick(e: PointerEvent): void {\n    e.preventDefault();\n    if (this.anchorHref) {\n      history.pushState(null, '', '#' + this.anchorHref);\n    }\n    this.moveToTarget();\n  }\n}\n","import {ESLMixinElement} from '../../../src/modules/esl-mixin-element/core';\n\nexport class ESLDemoBackLink extends ESLMixinElement {\n  static is = 'esl-d-back-link';\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (!document.referrer) return;\n    const refUrl = new URL(document.referrer);\n    if (refUrl.host !== window.location.host) return;\n    this.$$attr('href', document.referrer);\n    this.$$attr(ESLDemoBackLink.is, false);\n  }\n}\n","// Config\nimport {ESLScreenBreakpoints} from '../../../src/modules/esl-media-query/core/common/screen-breakpoint';\n\nESLScreenBreakpoints.add('xs', 1, 599);\nESLScreenBreakpoints.add('sm', 600, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n","import {attr, listen, decorate} from '../../../src/modules/esl-utils/decorators';\nimport {debounce} from '../../../src/modules/esl-utils/async/debounce';\nimport {ESLBaseElement} from '../../../src/modules/esl-base-element/core/esl-base-element';\nimport {ESLTraversingQuery} from '../../../src/modules/esl-traversing-query/core/esl-traversing-query';\n\nclass ESLDemoMediaSource extends ESLBaseElement {\n  static is = 'esl-d-media-source';\n\n  @attr() public target: string;\n\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n    this.onChange();\n  }\n\n  protected render(): void {\n    const form = document.createElement('form');\n    form.innerHTML = `\n      <fieldset>\n        <legend>Video Settings:</legend>\n          <div class=\"input-group mb-2\">\n          <select class=\"form-control\" name=\"media-type\">\n            <option value=\"auto\">- Auto -</option>\n            <option value=\"audio\">HTML Audio</option>\n            <option value=\"video\">HTML Video</option>\n            <option value=\"youtube\">Youtube</option>\n            <option value=\"brightcove\">Brightcove</option>\n            <option value=\"iframe\">Iframe</option>\n          </select>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media src\" name=\"media-src\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media id\" name=\"media-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player id\" name=\"player-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player account\" name=\"player-account\" autocomplete=\"on\"/>\n        </div>\n\n        <div class=\"form-group\">\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"muted\" class=\"form-check-input\"/> Muted</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"autoplay\" class=\"form-check-input\"/> Autoplay</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"disabled\" class=\"form-check-input\"/> Disabled</label>\n          </div>\n        </div>\n      </fieldset>\n    `;\n    form.action = 'javascript: void 0;';\n\n    this.innerHTML = '';\n    this.appendChild(form);\n  }\n\n  @listen('change')\n  @decorate(debounce, 750)\n  protected onChange(): void {\n    const inputs = this.querySelectorAll('input[name], select[name]');\n    Array.from(inputs).forEach((input: HTMLInputElement | HTMLSelectElement) => {\n      this.$targets.forEach((target: HTMLElement) => {\n        if (input instanceof HTMLInputElement && input.type === 'checkbox') {\n          target.toggleAttribute(input.name, input.checked);\n        } else {\n          target.setAttribute(input.name, input.value);\n        }\n      });\n    });\n  }\n}\n\nESLDemoMediaSource.register();\n","import {ESLTraversingQuery} from '../../../src/modules/esl-traversing-query/core';\nimport {ESLBaseElement} from '../../../src/modules/esl-base-element/core';\nimport {attr, listen} from '../../../src/modules/esl-utils/decorators';\n\ninterface MediaTarget {\n  play(): any;\n  pause(): any;\n  stop(): any;\n}\n\ninterface TestMediaAction {\n  title: string;\n  action: (target: MediaTarget, actionName: string, action: TestMediaAction) => void;\n  render: (actionName: string, action: TestMediaAction) => HTMLElement;\n}\n\nclass ESLDemoMediaControls extends ESLBaseElement {\n  public static is = 'esl-d-media-controls';\n\n  public static ACTIONS: Record<string, TestMediaAction> = {\n    play: {\n      title: 'Play',\n      action: (target: any) => target.play(),\n      render: renderButton\n    },\n    pause: {\n      title: 'Pause',\n      action: (target: any) => target.pause(),\n      render: renderButton\n    },\n    stop: {\n      title: 'Stop',\n      action: (target: any) => target.stop(),\n      render: renderButton\n    }\n  };\n  public static ACTIONS_ALL = Object.keys(ESLDemoMediaControls.ACTIONS).join(',');\n\n  @attr() public target: string;\n  @attr({defaultValue: ESLDemoMediaControls.ACTIONS_ALL}) public actions: string;\n\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n  }\n\n  private render(): void {\n    const actionList = this.actions.split(',');\n\n    this.innerHTML = '';\n    for (const actionName of actionList) {\n      const action: TestMediaAction = ESLDemoMediaControls.ACTIONS[actionName];\n      if (!action) return;\n      this.appendChild(action.render(actionName, action));\n    }\n  }\n\n  @listen('click')\n  private onClick(e: MouseEvent): void {\n    const target = e.target as HTMLElement;\n    const actionName = target.dataset.action;\n    if (actionName && ESLDemoMediaControls.ACTIONS[actionName]) {\n      const actionDesc = ESLDemoMediaControls.ACTIONS[actionName];\n      const actionFn = actionDesc.action;\n      this.$targets.forEach(($el) => actionFn.call($el, $el, actionName, actionDesc));\n    }\n  }\n}\n\nfunction renderButton(actionName: string, action: TestMediaAction): HTMLButtonElement {\n  const btn = document.createElement('button');\n  btn.className = 'btn btn-sec-blue';\n  btn.dataset.action = actionName;\n  btn.textContent = action.title;\n  return btn;\n}\n\nESLDemoMediaControls.register();\n","import {ESLBaseElement} from '../../../../src/modules/esl-base-element/core';\nimport {bind, ready, memoize, attr} from '../../../../src/modules/esl-utils/decorators';\nimport {range} from '../../../../src/modules/esl-utils/misc/array';\nimport {isIE} from '../../../../src/modules/esl-utils/environment/device-detector';\n\nexport class ESLDemoMarquee extends ESLBaseElement {\n  static is = 'esl-d-marquee';\n  static STARS_SEL = 'use';\n\n  @attr({defaultValue: '4'}) public targetsNumber: string;\n  @attr({defaultValue: '3000'}) public iterationTime: string;\n\n  private _$active: HTMLElement[] = [];\n  private _animateTimer: number = 0;\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (isIE) return;\n    this.startAnimation();\n  }\n  protected disconnectedCallback(): void {\n    this.stopAnimation();\n    super.disconnectedCallback();\n  }\n\n  @memoize()\n  public get $stars(): HTMLElement[] {\n    return Array.from(document.querySelectorAll((this.constructor as typeof ESLDemoMarquee).STARS_SEL));\n  }\n  public get $randomStar(): HTMLElement {\n    const index = Math.floor(Math.random() * this.$stars.length);\n    return this.$stars[index];\n  }\n\n  public startAnimation(): void {\n    memoize.clear(this, '$stars');\n    this.stopAnimation();\n    if (this.$stars.length < 2) return;\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n  public stopAnimation(): void {\n    this._animateTimer && window.clearTimeout(this._animateTimer);\n  }\n\n  @bind\n  protected _onIteration(): void {\n    const $candidates = range(+this.targetsNumber, () => this.$randomStar);\n    this._$active.forEach((star) => star.classList.remove('animate'));\n    $candidates.forEach((star) => star.classList.add('animate'));\n    this._$active = $candidates;\n\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n}\n","import {prop, attr, boolAttr} from '../../../../src/modules/esl-utils/decorators';\nimport {CSSClassUtils} from '../../../../src/modules/esl-utils/dom/class';\nimport {afterNextRender} from '../../../../src/modules/esl-utils/async/raf';\nimport {parseNumber} from '../../../../src/modules/esl-utils/misc/format';\nimport {ESLTraversingQuery} from '../../../../src/modules/esl-traversing-query/core';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core';\nimport {requestGss} from '../../search/search-script';\n\nimport type {ESLToggleableActionParams} from '../../../../src/modules/esl-toggleable/core';\n\nexport class ESLDemoSearchBox extends ESLToggleable {\n  static is = 'esl-d-search-box';\n\n  @attr() public postCls: string;\n  @attr() public postClsDelay: string;\n  @attr({defaultValue: '::find(input)'}) public firstFocusable: string;\n\n  @boolAttr() public autofocus: boolean;\n\n  @prop() public closeOnOutsideAction = true;\n\n  public onShow(params: ESLToggleableActionParams): void {\n    CSSClassUtils.add(this, this.postCls);\n    requestGss().then(() => this.showSearchElements(params));\n  }\n\n  private showSearchElements(params: ESLToggleableActionParams): void {\n    afterNextRender(() => super.onShow(params));\n    if (this.autofocus) {\n      const $focusEl = ESLTraversingQuery.first(this.firstFocusable, this) as HTMLElement;\n      $focusEl && window.setTimeout(() => $focusEl.focus(), parseNumber(this.postClsDelay));\n    }\n\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n\n  public onHide(params: ESLToggleableActionParams): void {\n    super.onHide(params);\n    window.setTimeout(() => {\n      CSSClassUtils.remove(this, this.postCls);\n      this.activator?.focus({preventScroll: true});\n    }, parseNumber(this.postClsDelay));\n  }\n}\n","import {boolAttr, listen, prop, ready} from '../../../../src/modules/esl-utils/decorators';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\nimport {ESLMediaQuery} from '../../../../src/modules/esl-media-query/core/esl-media-query';\n\nimport type {ESLToggleableActionParams} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\n\ninterface SidebarActionParams extends ESLToggleableActionParams {\n  /** Change state without animation */\n  immediate: boolean;\n}\n\nexport class ESLDemoSidebar extends ESLToggleable {\n  static is = 'esl-d-sidebar';\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  @prop() public submenus: string = '.sidebar-nav-secondary';\n  @prop() public activeMenuAttr: string = 'data-open';\n\n  @boolAttr({name: 'animation'}) protected _animation: boolean;\n\n  public get $submenus(): ESLToggleable[] {\n    return Array.from(this.querySelectorAll(this.submenus));\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n  }\n\n  protected storeState(): void {\n    this.open ? localStorage.removeItem('sidebar-collapsed') : localStorage.setItem('sidebar-collapsed', 'true');\n  }\n\n  protected setInitialState(): void {\n    const isDesktop = ESLMediaQuery.for('@+MD').matches;\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'init', immediate: true});\n  }\n\n  public collapseAll(): void {\n    this.$submenus.forEach((menu) => menu.hide({activator: this}));\n  }\n\n  public expandActive(noAnimate: boolean = false): void {\n    this.$submenus\n      .filter((menu) => menu.hasAttribute('data-open'))\n      .forEach((menu) => menu.show({noAnimate, activator: this}));\n  }\n\n  protected updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-expanded', String(this.open));\n  }\n\n  protected onShow(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onShow(params);\n    this.expandActive(params.initiator === 'init');\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n  protected onHide(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onHide(params);\n    this.collapseAll();\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n\n  @listen({\n    event: 'change',\n    target: ESLMediaQuery.for('@+MD')\n  })\n  protected onBreakpointChange({matches: isDesktop}: MediaQueryListEvent): void {\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'bpchange', immediate: !isDesktop});\n  }\n\n  @listen({inherit: true})\n  protected _onOutsideAction(e: Event): void {\n    if (ESLMediaQuery.for('@+MD').matches) return;\n    super._onOutsideAction(e);\n  }\n}\n","import {loadScript} from '../../../src/modules/esl-utils/dom/script';\nimport {memoizeFn} from '../../../src/modules/esl-utils/misc/memoize';\n\nfunction loadSearchScript(): Promise<Event> {\n  return loadScript('gss', 'https://cse.google.com/cse.js?cx=3171f866738b34f02');\n}\n\nconst onGSSReady = (): Promise<void> => {\n  return new Promise((resolve) => {\n    (window as any).__gcse = {\n      parsetags: 'onload',\n      initializationCallback: (): void => resolve()\n    };\n  });\n};\n\nexport const requestGss = memoizeFn(() => loadSearchScript().then(onGSSReady));\n","import {ESLBaseElement} from '../../../src/modules/esl-base-element/core';\nimport {CSSClassUtils} from '../../../src/modules/esl-utils/dom/class';\nimport {ready} from '../../../src/modules/esl-utils/decorators';\nimport {requestGss} from './search-script';\n\nexport class ESLDemoSearchPageWrapper extends ESLBaseElement {\n  static is = 'esl-d-search-page-wrapper';\n\n  @ready\n  protected connectedCallback(): void {\n    requestGss().then(() => this.afterSearchScriptLoad());\n  }\n\n  private afterSearchScriptLoad(): void {\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n}\n","// Views\nimport './core/view/esl-single-carousel-view';\nimport './core/view/esl-multi-carousel-view';\n\nexport * from './core/esl-carousel';\n\n// Plugins\nimport {ESLCarouselDotsPlugin} from './plugin/esl-carousel-dots.plugin';\nimport {ESLCarouselLinkPlugin} from './plugin/esl-carousel-link.plugin';\nimport {ESLCarouselTouchPlugin} from './plugin/esl-carousel-touch.plugin';\nimport {ESLCarouselAutoplayPlugin} from './plugin/esl-carousel-autoplay.plugin';\n\n// TODO: ??\nexport const ESLCarouselPlugins = {\n  Dots: ESLCarouselDotsPlugin,\n  Link: ESLCarouselLinkPlugin,\n  Touch: ESLCarouselTouchPlugin,\n  Autoplay: ESLCarouselAutoplayPlugin\n};\n","/**\n * Slide controller\n * @author Julia Murashko\n */\nimport {ESLBaseElement} from '../../../esl-base-element/core';\n\nexport class ESLCarouselSlide extends ESLBaseElement {\n  // TODO: refactor (check type of Element)\n  public get index(): number {\n    if (!this.parentNode) return -1;\n    return Array.prototype.indexOf.call(this.parentNode.children, this);\n  }\n\n  public get active(): boolean {\n    return this.hasAttribute('active');\n  }\n  public _setActive(active: boolean) {\n    this.toggleAttribute('active', active);\n  }\n\n  public get first(): boolean {\n    return this.hasAttribute('first');\n  }\n  public _setFirst(first: boolean) {\n    this.toggleAttribute('first', first);\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-slide': ESLCarouselSlide;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../../esl-base-element/core';\nimport {attr} from '../../../esl-utils/decorators';\nimport {isEqual} from '../../../esl-utils/misc/object';\nimport {ESLMediaRuleList} from '../../../esl-media-query/core';\nimport {ESLCarouselSlide} from './esl-carousel-slide';\nimport {ESLCarouselViewRegistry} from './view/esl-carousel-view';\n\nimport type {ESLCarouselView} from './view/esl-carousel-view';\nimport type {ESLCarouselPlugin} from '../plugin/esl-carousel-plugin';\n\ninterface CarouselConfig { // Registry\n  view?: string;\n  count?: number;\n  className?: string;\n}\n\n// TODO: add ability to choose the number of an active slide\n@ExportNs('Carousel')\nexport class ESLCarousel extends ESLBaseElement {\n  public static Slide = ESLCarouselSlide;\n\n  public static is = 'esl-carousel';\n\n  static get observedAttributes() {\n    return ['config'];\n  }\n\n  @attr() public config: string;\n\n  private _configRules: ESLMediaRuleList<CarouselConfig | null>;\n  private _currentConfig: CarouselConfig = {};\n  private _view: ESLCarouselView | null;\n  private readonly _plugins = new Map<string, ESLCarouselPlugin>();\n\n  private readonly _onMatchChange: () => void;\n\n  constructor() {\n    super();\n    this._onMatchChange = this.update.bind(this, false);\n    this._onRegistryChange = this._onRegistryChange.bind(this);\n  }\n\n  get $slidesArea(): HTMLElement | null {\n    return this.querySelector('[data-slides-area]');\n  }\n\n  get $slides(): ESLCarouselSlide[] {\n    // TODO cache\n    const els = this.$slidesArea && this.$slidesArea.querySelectorAll(ESLCarouselSlide.is);\n    return els ? Array.from(els) as ESLCarouselSlide[] : [];\n  }\n\n  get count(): number {\n    return this.$slides.length || 0;\n  }\n\n  get activeIndexes(): number[] {\n    return this.$slides.reduce((activeIndexes: number[], el, index) => {\n      if (el.active) {\n        activeIndexes.push(index);\n      }\n      return activeIndexes;\n    }, []);\n  }\n\n  get activeCount(): number {\n    return this.activeConfig.count || 0;\n  }\n\n  /**\n   * @returns number first active index\n   */\n  get firstIndex(): number {\n    const index = this.$slides.findIndex((slide) => {\n      return slide.first;\n    });\n    return Math.max(index, 0);\n  }\n\n  get activeConfig(): CarouselConfig {\n    return this._currentConfig;\n  }\n\n  set activeConfig(config) {\n    this._currentConfig = Object.assign({}, config);\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction?: string, force: boolean = false) {\n    if (this.dataset.isAnimated) {\n      return;\n    }\n\n    if (nextIndex < 0) {\n      nextIndex = 0;\n    }\n\n    if (this.firstIndex === nextIndex && !force) {\n      return;\n    }\n\n    if (!direction) {\n      // calculate and compare how much slides we have to go due to direction (left or right)\n      // choose less\n      // TODO: optimize\n      if (nextIndex > this.firstIndex) {\n        direction = nextIndex - this.firstIndex > (this.firstIndex - nextIndex + this.count) % this.count ? 'left' : 'right';\n      } else {\n        direction = this.firstIndex - nextIndex >= (nextIndex - this.firstIndex - nextIndex + this.count) % this.count ? 'right' : 'left';\n      }\n    }\n\n    const eventDetails = { // Todo change info\n      bubbles: true,\n      detail: {\n        direction\n      }\n    };\n\n    const approved = this.$$fire('esl:slide:change', eventDetails);\n\n    if (this._view && approved && this.firstIndex !== nextIndex) {\n      this._view.goTo(nextIndex, direction);\n    }\n    if (this._view && approved) {\n      let i = 0;\n      this.$slides.forEach((el, index) => {\n        el._setActive(((nextIndex + this.count) % this.count <= index) && (index < (nextIndex + this.activeCount + this.count) % this.count));\n      });\n\n      while (i < this.activeCount) {\n        const computedIndex = (nextIndex + i + this.count) % this.count;\n        this.$slides[computedIndex]._setActive(true);\n        ++i;\n      }\n\n      if (this.activeConfig.view === 'multiple') {\n        this.$slides[this.firstIndex]._setFirst(false);\n        this.$slides[nextIndex]._setFirst(true);\n      }\n    }\n\n    this.$$fire('esl:slide:changed', eventDetails);\n  }\n\n  public prev() {\n    // const nextGroup = this.getNextGroup(-1);\n    this.goTo((this.firstIndex - this.activeCount + this.count) % this.count, 'left');\n  }\n\n  public next() {\n    // const nextGroup = this.getNextGroup(1);\n    this.goTo((this.firstIndex + this.activeCount + this.count) % this.count, 'right');\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.update(true);\n    this.goTo(this.firstIndex, '', true);\n    this._bindEvents();\n\n    ESLCarouselViewRegistry.instance.addListener(this._onRegistryChange);\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this._unbindEvents();\n\n    ESLCarouselViewRegistry.instance.removeListener(this._onRegistryChange);\n  }\n\n  private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    // TODO: change observed attributes\n    if (attrName === 'config') {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n      this.update(true);\n    }\n  }\n\n  protected _bindEvents() {\n    this.addEventListener('click', this._onClick, false);\n  }\n\n  protected _unbindEvents() {\n    this.removeEventListener('click', this._onClick, false);\n  }\n\n  get configRules() {\n    if (!this._configRules) {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n    }\n    return this._configRules;\n  }\n\n  set configRules(rules: ESLMediaRuleList<CarouselConfig | null>) {\n    if (this._configRules) {\n      this._configRules.removeListener(this._onMatchChange);\n    }\n    this._configRules = rules;\n    this._configRules.addListener(this._onMatchChange);\n  }\n\n  private update(force: boolean = false) {\n    const config: CarouselConfig = Object.assign(\n      {view: 'multiple', count: 1},\n      this.configRules.activeValue\n    );\n\n    if (!force && isEqual(this.activeConfig, config)) {\n      return;\n    }\n    this.activeConfig = config;\n\n    const viewType = this.activeConfig.view;\n    if (!viewType) return;\n\n    // TODO: somehow compare active view & selected view\n    // this._view && this._view.unbind();\n    this._view = ESLCarouselViewRegistry.instance.createViewInstance(viewType, this);\n    // this._view && this._view.bind();\n\n    if (force || this.activeIndexes.length !== this.activeConfig.count) {\n      this._view && this._view.draw();\n      // this.goTo(this.firstIndex, '', true);\n    }\n  }\n\n  private getNextGroup(shiftGroupsCount: number) {\n    // get number of group of current active slides by last index of this group\n    const lastIndex = this.activeIndexes.length - 1;\n    const currentGroup = Math.floor(this.activeIndexes[lastIndex] / this.activeCount);\n    // get count of groups of slides\n    const countGroups = Math.ceil(this.count / this.activeCount);\n    // get number of group of next active slides\n    return (currentGroup + shiftGroupsCount + countGroups) % countGroups;\n  }\n\n  // move to core plugin\n  protected _onClick(event: MouseEvent) {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const markedTarget: HTMLElement | null = eventTarget.closest('[data-slide-target]');\n    if (markedTarget && markedTarget.dataset.slideTarget) {\n      const target = markedTarget.dataset.slideTarget;\n      if ('prev' === target) {\n        this.prev();\n      } else if ('next' === target) {\n        this.next();\n      } else if ('g' === target[0]) {\n        const group = +(target.substr(1)) - 1;\n        const lastGroup = Math.floor(this.count / this.activeCount);\n        this.goTo(group === lastGroup ? this.count - this.activeCount : this.activeCount * group);\n      } else {\n        this.goTo(+target - 1);\n      }\n    }\n  }\n\n  protected _onRegistryChange() {\n    if (!this._view) this.update(true);\n  }\n\n  // Plugin management\n  public addPlugin(plugin: ESLCarouselPlugin) {\n    if (plugin.carousel) return;\n    this.appendChild(plugin);\n  }\n\n  public removePlugin(plugin: ESLCarouselPlugin | string | undefined) {\n    if (typeof plugin === 'string') plugin = this._plugins.get(plugin);\n    if (!plugin || plugin.carousel !== this) return;\n    plugin.parentNode && plugin.parentNode.removeChild(plugin);\n  }\n\n  public _addPlugin(plugin: ESLCarouselPlugin) {\n    if (this._plugins.has(plugin.key)) return;\n    this._plugins.set(plugin.key, plugin);\n    if (this.isConnected) plugin.bind();\n  }\n\n  public _removePlugin(plugin: ESLCarouselPlugin) {\n    if (!this._plugins.has(plugin.key)) return;\n    plugin.unbind();\n    this._plugins.delete(plugin.key);\n  }\n\n  public static register(tagName?: string) {\n    ESLCarouselSlide.register((tagName || ESLCarousel.is) + '-slide');\n    customElements.whenDefined(ESLCarouselSlide.is).then(() => super.register.call(this, tagName));\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {}\n  export interface ESLLibrary {\n    Carousel: typeof ESLCarousel;\n    CarouselPlugin: typeof ESLCarouselPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel': ESLCarousel;\n  }\n}\n","import {Observable} from '../../../../esl-utils/abstract/observable';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nexport abstract class ESLCarouselView {\n  protected readonly carousel: ESLCarousel;\n\n  protected constructor(carousel: ESLCarousel) {\n    this.carousel = carousel; // TODO: unsafe while lifecycle is not clear\n  }\n\n  public abstract bind(): void;\n\n  public abstract draw(): void;\n\n  public abstract goTo(nextIndex: number, direction: string): void;\n\n  public abstract unbind(): void;\n}\n\nexport type ESLCarouselViewConstructor = new(carousel: ESLCarousel) => ESLCarouselView;\n\nlet eslRegistryInstance: ESLCarouselViewRegistry | null = null;\nexport class ESLCarouselViewRegistry extends Observable<(name: string, view: ESLCarouselViewConstructor) => void> {\n  private registry = new Map<string, ESLCarouselViewConstructor>();\n\n  public static get instance() {\n    if (eslRegistryInstance === null) {\n      eslRegistryInstance = new ESLCarouselViewRegistry();\n    }\n    return eslRegistryInstance;\n  }\n\n  public createViewInstance(name: string, carousel: ESLCarousel): ESLCarouselView | null {\n    const View = this.registry.get(name);\n    return View ? new View(carousel) : null;\n  }\n\n  public registerView(name: string, view: ESLCarouselViewConstructor) {\n    if (this.registry.has(name)) {\n      throw new Error(`View with name ${name} already defined`);\n    }\n    this.registry.set(name, view);\n    this.fire(name, view);\n  }\n}\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLMultiCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  // tslint:disable-next-line:no-empty\n  public bind() {\n  }\n\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const currentTrans = slideStyles.transform !== 'none' ? parseFloat(slideStyles.transform.split(',')[4]) : 0;\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) / this.carousel.activeCount\n      - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = this.carousel.firstIndex === 0 ?\n      -currentTrans :\n      -(parseFloat(slidesAreaStyles.width) / this.carousel.activeCount * this.carousel.firstIndex) - currentTrans;\n\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction: string) {\n    const slideIndex = direction === 'right' ? this.carousel.activeIndexes[0] : this.carousel.firstIndex;\n    const slideStyles = getComputedStyle(this.carousel.$slides[slideIndex]);\n    const slideWidth = parseFloat(slideStyles.width) +\n      parseFloat(slideStyles.marginLeft) +\n      parseFloat(slideStyles.marginRight);\n    const areaWidth = slideWidth * this.carousel.$slides.length;\n\n    const transitionDuration = parseFloat(slideStyles.transitionDuration) * 1000; // ms\n    const currentLeft = parseFloat(slideStyles.left);\n    const currentTrans = parseFloat(slideStyles.transform.split(',')[4]) || 0;\n\n    if (this.carousel.firstIndex === nextIndex) {\n      return 0;\n    }\n\n    let shiftCount = 0;\n    if (direction === 'left') {\n      shiftCount = (this.carousel.firstIndex - nextIndex + this.carousel.count) % this.carousel.count;\n    } else if (direction === 'right') {\n      shiftCount = (this.carousel.count - this.carousel.firstIndex + nextIndex) % this.carousel.count;\n    }\n    const direct = direction === 'left' ? -1 : 1;\n    const trans = currentTrans - (shiftCount * slideWidth) * direct;\n\n    const nextActiveIndexes: number[] = [];\n    for (let i = 0; i < this.carousel.activeCount; ++i) {\n      nextActiveIndexes.push((nextIndex + i + this.carousel.count) % this.carousel.count);\n    }\n\n    const intersectionIndexes = nextActiveIndexes.filter(\n      (index: number) => this.carousel.activeIndexes.includes(index)\n    );\n\n    let left = 0;\n    const animatedCount = shiftCount < this.carousel.activeCount ? this.carousel.activeCount : shiftCount;\n    for (let i = 0; i < animatedCount; ++i) {\n      const computedIndex = (nextIndex + i + this.carousel.count) % this.carousel.count;\n      const minActive = Math.min(...this.carousel.activeIndexes);\n      // make next active slides be in one line\n      if (computedIndex >= this.carousel.firstIndex && direction === 'left') {\n        left = currentLeft - areaWidth;\n      } else if (computedIndex <= minActive && direction === 'right') {\n        left = currentLeft + areaWidth;\n      } else {\n        left = currentLeft;\n      }\n\n      // exclude slides that are active now and have to be active then\n      if (!intersectionIndexes.includes(computedIndex)) {\n        this.carousel.$slides[computedIndex].style.left = left + 'px';\n      }\n\n      // handle slides that are active now and have to be active then\n      if (intersectionIndexes.includes(computedIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(computedIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        const copyLeft = left;\n        setTimeout(() => {\n          this.carousel.$slides[computedIndex].style.left = copyLeft + 'px';\n        }, time);\n      }\n\n    }\n\n    this.carousel.$slides.forEach((slide) => {\n      // exclude slides that are active now and have to be active then\n\n      slide.style.transform = `translateX(${trans}px)`;\n\n      // handle slides that are active now and have to be active then\n      const sIndex = slide.index;\n      if (intersectionIndexes.includes(sIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(sIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        setTimeout(() => {\n          this.carousel.$slides[sIndex].style.transform = `translateX(${trans}px)`;\n        }, time);\n      }\n    });\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n\n    setTimeout(() => {\n      this.carousel.removeAttribute('data-is-animated');\n    }, transitionDuration);\n\n  }\n\n  public unbind() {\n    this.carousel.$slides.forEach((el) => {\n      el.style.transform = 'none';\n      el.style.left = 'none';\n    });\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('multiple', ESLMultiCarouselView);\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLSingleCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  public bind() {}\n\n  // TODO: check\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = -(parseFloat(slidesAreaStyles.width) / this.carousel.firstIndex);\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  public goTo(nextIndex: number, direction: string) {\n    if (this.carousel.firstIndex === nextIndex) {\n      return;\n    }\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n    this.carousel.setAttribute('direction', direction);\n\n    const activeSlide = this.carousel.$slides[this.carousel.firstIndex];\n    const nextSlide = this.carousel.$slides[nextIndex];\n\n    activeSlide.classList.add(direction);\n    nextSlide.classList.add(direction);\n\n    activeSlide.classList.add('prev');\n\n    activeSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n    nextSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n  }\n\n  private _cleanAnimation(event: Event) {\n    const target = event.target as HTMLElement;\n    const direction = this.carousel.getAttribute('direction');\n\n    direction && target.classList.remove(direction);\n    target.classList.remove('prev');\n\n    this.carousel.removeAttribute('data-is-animated');\n  }\n\n  // tslint:disable-next-line:no-empty\n  public unbind() {\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('single', ESLSingleCarouselView);\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-utils/decorators';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Autoplay (Auto-Advance) plugin\n * Automatically switch slides by timeout\n *\n * @author Alexey Stsefanovich (ala'n)\n */\n@ExportNs('CarouselPlugins.Autoplay')\nexport class ESLCarouselAutoplayPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-autoplay-plugin';\n\n  @attr({defaultValue: 'next'}) public direction: string;\n  @attr({defaultValue: '5000'}) public timeout: number;\n\n  private _active: boolean;\n  private _timeout: number | null = null;\n\n  constructor() {\n    super();\n    this._onInterval = this._onInterval.bind(this);\n    this._onInteract = this._onInteract.bind(this);\n  }\n\n  public get active() {\n    return this._active;\n  }\n\n  public bind(): void {\n    this.carousel.addEventListener('mouseover', this._onInteract);\n    this.carousel.addEventListener('mouseout', this._onInteract);\n    this.carousel.addEventListener('focusin', this._onInteract);\n    this.carousel.addEventListener('focusout', this._onInteract);\n    this.carousel.addEventListener('esl:slide:changed', this._onInteract);\n    this.start();\n    // console.log('Auto-advance plugin attached successfully to ', this.carousel);\n  }\n  public unbind(): void {\n    this.carousel.removeEventListener('mouseover', this._onInteract);\n    this.carousel.removeEventListener('mouseout', this._onInteract);\n    this.carousel.removeEventListener('focusin', this._onInteract);\n    this.carousel.removeEventListener('focusout', this._onInteract);\n    this.carousel.removeEventListener('esl:slide:changed', this._onInteract);\n    this.stop();\n    // console.log('Auto-advance plugin detached successfully from ', this.carousel);\n  }\n\n  public start() {\n    this._active = true;\n    this.reset();\n  }\n  public stop() {\n    this._active = false;\n    this.reset();\n  }\n\n  public reset() {\n    if (typeof this._timeout === 'number') clearTimeout(this._timeout);\n    this._timeout = this._active ? window.setTimeout(this._onInterval, this.timeout) : null;\n  }\n\n  protected _onInterval() {\n    if (!this._active) return;\n    switch (this.direction) {\n      case 'next':\n        this.carousel.next();\n        return;\n      case 'prev':\n        this.carousel.prev();\n        return;\n    }\n    this.reset();\n  }\n\n  protected _onInteract(e: Event) {\n    switch (e.type) {\n      case 'mouseover':\n      case 'focusin':\n        this.stop();\n        return;\n      case 'mouseout':\n      case 'focusout':\n        this.start();\n        return;\n      case 'esl:slide:changed':\n        this.reset();\n        return;\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Autoplay: typeof ESLCarouselAutoplayPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-autoplay-plugin': ESLCarouselAutoplayPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Dots plugin\n * Dots plugin renders carousel dots navigation\n *\n * @author Julia Murashko\n */\n@ExportNs('CarouselPlugins.Dots')\nexport class ESLCarouselDotsPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-dots';\n  public static freePlacement = true;\n\n  private _onUpdate = () => this.rerender();\n\n  public bind() {\n    this.rerender();\n    this.carousel.addEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public unbind() {\n    this.innerHTML = '';\n    this.carousel.removeEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public rerender() {\n    let html = '';\n    const activeDot = Math.floor(this.carousel.activeIndexes[this.carousel.activeCount - 1] / this.carousel.activeCount);\n    for (let i = 0; i < Math.ceil(this.carousel.count / this.carousel.activeCount); ++i) {\n      html += this.buildDot(i, i === activeDot);\n    }\n    this.innerHTML = html;\n  }\n\n  public buildDot(index: number, isActive: boolean) {\n    return `<button role=\"button\" class=\"carousel-dot ${isActive ? 'active-dot' : ''}\" data-slide-target=\"g${index + 1}\"></button>`;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Dots: typeof ESLCarouselDotsPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-dots': ESLCarouselDotsPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-utils/decorators';\nimport {ESLCarousel} from '../core/esl-carousel';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Link plugin. Allows to bind carousel positions.\n */\n@ExportNs('CarouselPlugins.Link')\nexport class ESLCarouselLinkPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-link-plugin';\n\n  public static get observedAttributes() {\n    return ['to', 'direction'];\n  }\n\n  @attr() public to: string;\n  @attr({defaultValue: 'both'}) public direction: string;\n\n  private _target: ESLCarousel | null;\n\n  constructor() {\n    super();\n    this._onSlideChange = this._onSlideChange.bind(this);\n  }\n\n  public bind() {\n    if (!this.target) {\n      this.target = document.querySelector(this.to);\n    }\n    if (!(this.target instanceof ESLCarousel)) return;\n\n    if (this.direction === 'both' || this.direction === 'reverse') {\n      this.target.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n    if (this.direction === 'both' || this.direction === 'target') {\n      this.carousel.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n  }\n\n  public unbind() {\n    this.target && this.target.removeEventListener('esl:slide:changed', this._onSlideChange);\n    this.carousel && this.carousel.removeEventListener('esl:slide:changed', this._onSlideChange);\n  }\n\n  protected _onSlideChange(e: CustomEvent) {\n    if (!this.target || !this.carousel) return;\n    const $target = e.target === this.carousel ? this.target : this.carousel;\n    const $source = e.target === this.carousel ? this.carousel : this.target;\n    $target.goTo($source.firstIndex, e.detail.direction);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (this.carousel && oldVal !== newVal) {\n      this.unbind();\n      if (attrName === 'to') {\n        this._target = null;\n      }\n      this.bind();\n    }\n  }\n\n  get target() {\n    return this._target;\n  }\n  set target(target) {\n    this._target = target;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Link: typeof ESLCarouselLinkPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-link-plugin': ESLCarouselLinkPlugin;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {ESLCarousel} from '../core/esl-carousel';\n\n/**\n * {@link ESLCarousel} Plugin base class.\n * The ESL Carousel Plugin should have the dom representation so it's extends {@link ESLBaseElement}\n * Use the attributes to path the plugin options, the same as with any custom elements.\n */\nexport abstract class ESLCarouselPlugin extends ESLBaseElement {\n  /**\n   * Marker to define the restriction for the plugin placement.\n   * If freePlacement is false - plugin element should be child of ESLCarousel element.\n   * If freePlacement is true - plugin can be placed anywhere inside of carousel.\n   */\n  public static freePlacement = false;\n\n  /**\n   * @returns carousel owner of the plugin\n   */\n  protected findCarouselOwner(): ESLCarousel | null {\n    if ((this.constructor as typeof ESLCarouselPlugin).freePlacement) {\n      return this.closest(ESLCarousel.is);\n    } else {\n      return this.parentNode as ESLCarousel;\n    }\n  }\n\n  private _carousel?: ESLCarousel;\n\n  /**\n   * @returns plugin unique key, ESLCarousel can not own more then one plugin with the same key\n   */\n  public get key() {\n    return this.nodeName.toLowerCase();\n  }\n  /**\n   * @returns owner of plugin\n   */\n  public get carousel(): ESLCarousel {\n    return this._carousel!;\n  }\n\n  protected connectedCallback() {\n    const carousel = this.findCarouselOwner();\n    if (carousel instanceof ESLCarousel) {\n      this._carousel = carousel;\n      this._carousel._addPlugin(this);\n    } else {\n      throw new Error('Invalid esl-carousel-plugin placement: plugin element should be placed under the esl-carousel node');\n    }\n  }\n  protected disconnectedCallback() {\n    if (this.carousel) {\n      this.carousel._removePlugin(this);\n      delete this._carousel;\n    }\n  }\n\n  /**\n   * Define the plugin bind lifecycle hook.\n   * Unlike {@link connectedCallback}, bind is called by owner ESL Carousel when the plugin can be attached.\n   */\n  public abstract bind(): void;\n\n  /**\n   * Define the plugin unbind lifecycle hook.\n   * Unlike {@link disconnectedCallback}, unbind is called by owner ESL Carousel when the plugin should be detached.\n   */\n  public abstract unbind(): void;\n\n  public static register(tagName?: string) {\n    customElements.whenDefined(ESLCarousel.is).then(() => super.register.call(this, tagName));\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {getTouchPoint} from '../../../esl-utils/dom/events';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\nimport type {Point} from '../../../esl-utils/dom/events';\n\n/**\n * Slide Carousel Touch plugin\n */\n@ExportNs('CarouselPlugins.Touch')\nexport class ESLCarouselTouchPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-touch-plugin';\n\n  private isTouchStarted = false;\n  private startPoint: Point = {x: 0, y: 0};\n\n  public bind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.addEventListener(events.START, this.onTouchStart);\n    this.carousel.addEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.addEventListener(events.END, this.onTouchEnd);\n  }\n\n  public unbind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.removeEventListener(events.START, this.onTouchStart);\n    this.carousel.removeEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.removeEventListener(events.END, this.onTouchEnd);\n  }\n\n  onTouchStart = (event: TouchEvent | PointerEvent) => {\n    // TODO: precondition for focused element ?\n    if ((event instanceof TouchEvent && event.touches.length !== 1) ||\n      (event instanceof PointerEvent && event.pointerType !== 'touch')) {\n      this.isTouchStarted = false;\n      return;\n    }\n    this.isTouchStarted = true;\n    this.startPoint = getTouchPoint(event);\n  };\n\n  onTouchMove = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    // const point = EventUtils.normalizeTouchPoint(event);\n    // const offset = {\n    // \tx: point.x - this.startPoint.x,\n    // \ty: point.y - this.startPoint.y\n    // };\n  };\n\n  onTouchEnd = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    const point = getTouchPoint(event);\n    const offset = {\n      x: point.x - this.startPoint.x,\n      y: point.y - this.startPoint.y\n    };\n    this.isTouchStarted = false;\n\n    // TODO: temporary, update according final implementation\n    if (Math.abs(offset.x) < Math.abs(offset.y)) return; // Direction\n    if (Math.abs(offset.x) < 100) return; // Tolerance\n\n    // Swipe gesture example\n    if (offset.x < 0) {\n      this.carousel.next();\n    } else {\n      this.carousel.prev();\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  };\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Touch: typeof ESLCarouselTouchPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-touch-plugin': ESLCarouselTouchPlugin;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ARROW_DOWN, ARROW_LEFT, ARROW_RIGHT, ARROW_UP} from '../../esl-utils/dom/keys';\n\n/** Relative targeting type definition */\nexport type GroupTarget = 'next' | 'prev' | 'current';\n\n/**\n * ESLA11yGroup component\n * @author Julia Murashko\n *\n * ESLA11yGroup - helper custom element that adds a11y group behavior to targets.\n */\n@ExportNs('A11yGroup')\nexport class ESLA11yGroup extends ESLBaseElement {\n  public static is = 'esl-a11y-group';\n\n  /** Mapping of the keyboard keys to {@link GroupTarget} */\n  public static KEY_MAP: Record<string, GroupTarget> = {\n    [ARROW_UP]: 'prev',\n    [ARROW_LEFT]: 'prev',\n    [ARROW_DOWN]: 'next',\n    [ARROW_RIGHT]: 'next'\n  };\n\n  /** Target elements multiple selector ({@link ESLTraversingQuery} syntax) */\n  @attr({defaultValue: '::child'}) public targets: string;\n\n  /** Activates target (via click event) on selection */\n  @boolAttr({}) public activateSelected: boolean;\n  /** Prevents scroll when target receives focus */\n  @boolAttr({}) public preventScroll: boolean;\n\n  /** @returns HTMLElement root element of the group */\n  public get $root(): HTMLElement | null {\n    return this.parentElement;\n  }\n  /** @returns HTMLElement[] targets of the group */\n  public get $targets(): HTMLElement[] {\n    if (!this.$root) return [];\n    return ESLTraversingQuery.all(this.targets, this.$root) as HTMLElement[];\n  }\n\n  @listen({\n    event: 'keydown',\n    target: (target: ESLA11yGroup) => target.$root\n  })\n  protected _onKeydown(e: KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n    if (!this.$targets.includes(target)) return;\n\n    const groupTarget = (this.constructor as typeof ESLA11yGroup).KEY_MAP[e.key];\n    if (!groupTarget) return;\n\n    this.goTo(groupTarget, target);\n    e.preventDefault();\n  }\n\n  /** Go to the target from the passed element or currently focused target by default */\n  public goTo(target: GroupTarget, from: HTMLElement | null = this.current()): void {\n    if (!from) return;\n    const targetEl = this[target](from);\n    if (!targetEl) return;\n    targetEl.focus({preventScroll: this.preventScroll});\n    this.activateSelected && targetEl.click();\n  }\n\n  /** @returns HTMLElement next target fot trigger */\n  public next(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index + 1) % triggers.length];\n  }\n\n  /** @returns HTMLElement previous target fot trigger */\n  public prev(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index - 1 + triggers.length) % triggers.length];\n  }\n\n  /** @returns HTMLElement currently focused element from targets */\n  public current(): HTMLElement | null {\n    const $active = document.activeElement as HTMLElement;\n    return this.$targets.includes($active) ? $active : null;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    A11yGroup: typeof ESLA11yGroup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-a11y-group': ESLA11yGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, jsonAttr, prop, listen} from '../../esl-utils/decorators';\nimport {isMatches} from '../../esl-utils/dom/traversing';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {createZIndexIframe} from '../../esl-utils/fixes/ie-fixes';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ESLToggleableActionParams, ESLToggleableRequestDetails} from '../../esl-toggleable/core';\n\nexport interface AlertActionParams extends ESLToggleableRequestDetails {\n  /** text to be shown; passes empty string or null to hide */\n  text?: string;\n  /** html content */\n  html?: string;\n  /** classes to add to alert element */\n  cls?: string;\n  /** timeout to clear classes */\n  hideTime?: number;\n}\n\n/**\n * ESLAlert component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLAlert is a component to show small notifications on your pages. ESLAlert can have multiple instances on the page.\n */\n@ExportNs('Alert')\nexport class ESLAlert extends ESLToggleable {\n  public static is = 'esl-alert';\n  public static observedAttributes = ['target'];\n\n  /** Default show/hide params for all ESLAlert instances */\n  public static defaultConfig: AlertActionParams = {\n    hideTime: 300,\n    hideDelay: 2500\n  };\n\n  /** Event to show alert component */\n  @prop('esl:alert:show') public override SHOW_REQUEST_EVENT: string;\n  /** Event to hide alert component */\n  @prop('esl:alert:hide') public override HIDE_REQUEST_EVENT: string;\n\n  /**\n   * Defines the scope (using {@link ESLTraversingQuery} syntax) element to listen for an activation event.\n   * Parent element by default\n   */\n  @attr({defaultValue: '::parent'}) public target: string;\n\n  /** Default show/hide params for current ESLAlert instance */\n  @jsonAttr<AlertActionParams>()\n  public override defaultParams: AlertActionParams;\n\n  protected $content: HTMLElement;\n  protected activeCls?: string;\n\n  private _$target: EventTarget;\n  private _clearTimeout: number;\n\n  /** Creates global alert instance (using body element as a base) */\n  public static init(options?: Partial<ESLAlert>): ESLAlert {\n    let alert: ESLAlert = document.querySelector(`body > ${ESLAlert.is}`)!;\n    if (!alert) {\n      alert = document.createElement(ESLAlert.is) as ESLAlert;\n      options && Object.assign(alert, options);\n      document.body.appendChild(alert);\n    }\n    return alert;\n  }\n\n  protected override mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    const type = this.constructor as typeof ESLAlert;\n    return Object.assign({}, type.defaultConfig, this.defaultParams || {}, params || {});\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') {\n      this.$target = ESLTraversingQuery.first(this.target) as EventTarget;\n    }\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.setAttribute('role', this.getAttribute('role') || 'alert');\n    this.$content = document.createElement('div');\n    this.$content.className = 'esl-alert-content';\n    this.innerHTML = '';\n    this.appendChild(this.$content);\n    if (DeviceDetector.isIE) this.appendChild(createZIndexIframe());\n    if (this.target) {\n      this.$target = ESLTraversingQuery.first(this.target, this) as EventTarget;\n    }\n  }\n\n  /** Target element to listen to activation events */\n  public get $target(): EventTarget {\n    return this._$target;\n  }\n  public set $target($el: EventTarget) {\n    this._$target = $el;\n    this.$$on(this._onShowRequest);\n    this.$$on(this._onHideRequest);\n  }\n\n  protected override onShow(params: AlertActionParams): void {\n    if (this._clearTimeout) window.clearTimeout(this._clearTimeout);\n    if (params.html || params.text) {\n      this.render(params);\n      super.onShow(params);\n    }\n    this.hide(params);\n  }\n  protected override onHide(params: AlertActionParams): void {\n    super.onHide(params);\n    this._clearTimeout = window.setTimeout(() => this.clear(), params.hideTime);\n  }\n\n  protected render({text, html, cls}: AlertActionParams): void {\n    CSSClassUtils.remove(this, this.activeCls);\n    CSSClassUtils.add(this, this.activeCls = cls);\n    if (html) this.$content.innerHTML = html;\n    if (text) this.$content.textContent = text;\n  }\n  protected clear(): void {\n    this.$content.innerHTML = '';\n    CSSClassUtils.remove(this, this.activeCls);\n  }\n\n  protected override buildRequestParams(e: CustomEvent<ESLToggleableRequestDetails>): AlertActionParams | null {\n    const detail = e.detail || {};\n    if (!isMatches(this, detail.match)) return null;\n    if (e.type === this.SHOW_REQUEST_EVENT) return Object.assign({}, detail, {force: true});\n    if (e.type === this.HIDE_REQUEST_EVENT) return Object.assign({hideDelay: 0}, detail, {force: true});\n    return null;\n  }\n\n  @listen({inherit: true, target: (el: ESLAlert) => el.$target})\n  protected override _onHideRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    super._onHideRequest(e);\n    e.stopPropagation();\n  }\n\n  @listen({inherit: true, target: (el: ESLAlert) => el.$target})\n  protected override _onShowRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    super._onShowRequest(e);\n    e.stopPropagation();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Alert: typeof ESLAlert;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-alert': ESLAlert;\n  }\n}\n","import {wrap} from '../../esl-utils/misc/array';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {memoize, bind} from '../../esl-utils/decorators';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\n/** ESLAnimateService animation options */\nexport interface ESLAnimateConfig {\n  /** Class(es) to mark element animated */\n  cls?: string;\n\n  /** Animate if class already presented */\n  force?: boolean;\n\n  /** Animate items in group one by one, using groupDelay */\n  group?: boolean;\n\n  /** Delay to display element(s) after previous one. Used when group animation is enabled. Default: 100ms */\n  groupDelay?: number;\n\n  /** Do not unsubscribe after animate and repeat animation on each viewport intersection */\n  repeat?: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   * Default: 0.4 (40%)\n   */\n  ratio?: number;\n}\n\n/** ESLAnimateService animation inner options. Contains system animation properties */\ninterface ESLAnimateConfigInner extends Required<ESLAnimateConfig> {\n  /** (private) animation requested */\n  _timeout?: number;\n  /** (private) marker to unobserve */\n  _unsubscribe?: boolean;\n}\n\n/** Service to animate elements on viewport intersection */\n@ExportNs('AnimateService')\nexport class ESLAnimateService {\n\n  /** ESLAnimateService default animation configuration */\n  protected static DEFAULT_CONFIG: ESLAnimateConfig = {cls: 'in', groupDelay: 100, ratio: 0.4};\n  /** ESLAnimationService IntersectionObserver properties */\n  protected static OPTIONS_OBSERVER: IntersectionObserverInit = {threshold: [0.001, 0.2, 0.4, 0.6, 0.8]};\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param target - element(s) or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public static observe(target: Element | Element[], config: ESLAnimateConfig = {}): void {\n    wrap(target).forEach((item: Element) => this.instance.observe(item, config));\n  }\n\n  /** Unobserve element or elements */\n  public static unobserve(target: Element | Element[]): void {\n    wrap(target).forEach((item: Element) => this.instance.unobserve(item));\n  }\n\n  /** @returns if service observing target */\n  public static isObserved(target: Element): boolean {\n    return !!this.instance.getConfigFor(target);\n  }\n\n  @memoize()\n  private static get instance(): ESLAnimateService {\n    return new ESLAnimateService();\n  }\n\n  protected _io = new IntersectionObserver(this.onIntersect, ESLAnimateService.OPTIONS_OBSERVER);\n  protected _entries: Set<Element> = new Set();\n  protected _configMap = new WeakMap<Element, ESLAnimateConfigInner>();\n\n  protected deferredOnAnimate = debounce(() => this.onAnimate(), 100);\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param el - element or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public observe(el: Element, config: ESLAnimateConfig = {}): void {\n    const cfg = this.setConfigFor(el, config);\n    cfg.force && CSSClassUtils.remove(el, cfg.cls);\n    this._io.observe(el);\n  }\n\n  /** Unobserve element or elements */\n  public unobserve(el: Element): void {\n    this._io.unobserve(el);\n    this._configMap.delete(el);\n  }\n\n  /** Intersection observable callback */\n  @bind\n  protected onIntersect(entries: IntersectionObserverEntry[]): void {\n    entries.forEach(({target, intersectionRatio, isIntersecting}: IntersectionObserverEntry) => {\n      const config = this.getConfigFor(target);\n      if (!config) return;\n\n      // Item will be marked as visible in case it intersecting to the viewport with a ratio grater then passed visibleRatio\n      if (isIntersecting && intersectionRatio >= config.ratio) {\n        this._entries.add(target);\n      }\n\n      // Item considered as invisible in case it is going to be intersected less then 1% of it's area\n      if (!isIntersecting && intersectionRatio <= 0.01) {\n        this._entries.delete(target);\n\n        if (config.repeat) {\n          CSSClassUtils.remove(target, config.cls);\n          config._timeout && clearTimeout(config._timeout);\n        }\n      }\n    });\n    this.deferredOnAnimate();\n  }\n\n  /** Process animation query */\n  protected onAnimate(): void {\n    let time = -1;\n    this._entries.forEach((target) => {\n      const config = this.getConfigFor(target);\n      if (!config) return;\n\n      if (config._timeout) window.clearTimeout(config._timeout);\n      if (config.group) {\n        time = time === -1 ? 0 : (time + config.groupDelay);\n        config._timeout = window.setTimeout(() => this.onAnimateItem(target), time);\n      } else {\n        this.onAnimateItem(target);\n      }\n      config._unsubscribe = !config.repeat;\n    });\n  }\n\n  /** Animates passed item */\n  protected onAnimateItem(item: Element): void {\n    const config = this.getConfigFor(item);\n    if (!config) return;\n\n    CSSClassUtils.add(item, config.cls);\n    this._entries.delete(item);\n\n    if (config._unsubscribe) {\n      this._io.unobserve(item);\n      this._configMap.delete(item);\n    }\n  }\n\n  /** Returns config */\n  protected getConfigFor(el: Element): ESLAnimateConfigInner | undefined {\n    return this._configMap.get(el);\n  }\n  /** Returns config */\n  protected setConfigFor(el: Element, config: ESLAnimateConfig): ESLAnimateConfigInner {\n    const cfg = Object.assign({}, ESLAnimateService.DEFAULT_CONFIG, config) as ESLAnimateConfigInner;\n    this._configMap.set(el, cfg);\n    return cfg;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ready, memoize, attr, boolAttr} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {ESLBaseElement} from '../../esl-base-element/core';\n\nimport {ESLAnimateService} from './esl-animate-service';\n\n/**\n * ESLAnimate - custom element for quick {@link ESLAnimateService} attaching\n *\n * Have two types of usage:\n * - trough the target-s definition, then esl-animate (without it's own content) became invisible plugin-component\n * `<esl-animate target=\"::next\"></esl-animate><div>Content</div>`\n * - trough the content wrapping\n * `<esl-animate>Content</esl-animate>`\n */\n@ExportNs('Animate')\nexport class ESLAnimate extends ESLBaseElement {\n  public static is = 'esl-animate';\n  public static observedAttributes = ['group', 'repeat', 'target'];\n\n  /**\n   * Class(es) to add on viewport intersection\n   * @see ESLAnimateConfig.cls\n   */\n  @attr({defaultValue: 'in'}) public cls: string;\n\n  /**\n   * Enable group animation for targets\n   * @see ESLAnimateConfig.group\n   */\n  @boolAttr() public group: boolean;\n\n  /**\n   * Delay to start animation from previous item in group\n   * @see ESLAnimateConfig.groupDelay\n   */\n  @attr({defaultValue: '100'}) public groupDelay: string;\n\n  /**\n   * Re-animate item after its getting hidden\n   * @see ESLAnimateConfig.repeat\n   */\n  @boolAttr() public repeat: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   */\n  @attr() public ratio: string;\n\n  /**\n   * Define target(s) to observe and animate\n   * Uses {@link ESLTraversingQuery} with multiple targets support\n   * Default: ` ` - current element, `<esl-animate>` behave as a wrapper\n   */\n  @attr() public target: string;\n\n  /** Elements-targets found by target query */\n  @memoize()\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected attributeChangedCallback(): void {\n    if (!this.connected) return;\n    this.reanimate();\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.reanimate();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    ESLAnimateService.unobserve(this.$targets);\n  }\n\n  /** Reinitialize {@link ESLAnimateService} for targets */\n  public reanimate(): void {\n    ESLAnimateService.unobserve(this.$targets);\n    memoize.clear(this, '$targets');\n    ESLAnimateService.observe(this.$targets, {\n      force: true,\n      cls: this.cls,\n      ratio: parseNumber(this.ratio, 0.4),\n      repeat: this.repeat,\n      group: this.group,\n      groupDelay: parseNumber(this.groupDelay, 0)\n    });\n  }\n}\n","import {setAttr} from '../../esl-utils/dom/attr';\nimport {prop} from '../../esl-utils/decorators';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {\n  ESLEventListener,\n  ESLListenerHandler,\n  ESLListenerCriteria,\n  ESLListenerEventMap,\n  ESLListenerDescriptor\n} from '../../esl-utils/dom/events';\n\n/**\n * Base class for ESL custom elements\n * Allows defining custom element with the optional custom tag name\n */\nexport abstract class ESLBaseElement extends HTMLElement {\n  /** Custom element tag name */\n  public static is = '';\n\n  /** Event to indicate component significant state change that may affect other components state */\n  @prop('esl:refresh') public REFRESH_EVENT: string;\n\n  protected _connected: boolean = false;\n\n  protected connectedCallback(): void {\n    this._connected = true;\n    this.classList.add((this.constructor as typeof ESLBaseElement).is);\n\n    ESLEventUtils.descriptors(this).forEach((desc) => ESLEventUtils.subscribe(this, desc));\n  }\n  protected disconnectedCallback(): void {\n    this._connected = false;\n\n    ESLEventUtils.unsubscribe(this);\n  }\n\n  /** Check that the element is connected and `connectedCallback` has been executed */\n  public get connected(): boolean {\n    return this._connected;\n  }\n\n  /** Subscribes `handler` method marked with `@listen` decorator */\n  public $$on(handler: ESLListenerHandler): ESLEventListener[];\n  /** Subscribes `handler` function by the passed DOM event descriptor {@link ESLListenerDescriptor} or event name */\n  public $$on<EType extends keyof ESLListenerEventMap>(\n    event: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  public $$on(event: any, handler?: any): ESLEventListener[] {\n    return ESLEventUtils.subscribe(this, event, handler);\n  }\n\n  /** Unsubscribes event listener */\n  public $$off(...condition: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventUtils.unsubscribe(this, ...condition);\n  }\n\n  /**\n   * Gets or sets CSS classes for the current element.\n   * @param cls - CSS classes query {@link CSSClassUtils}\n   * @param value - boolean to set CSS class(es) state or undefined to skip mutation\n   * @returns current classes state or passed state\n   */\n  public $$cls(cls: string, value?: boolean): boolean {\n    if (value === undefined) return CSSClassUtils.has(this, cls);\n    CSSClassUtils.toggle(this, cls, value);\n    return value;\n  }\n\n  /**\n   * Gets or sets an attribute for the current element.\n   * If the `value` param is undefined then skips mutation.\n   * @param name - attribute name\n   * @param value - string attribute value, boolean attribute state or `null` to delete attribute\n   * @returns the current attribute value or previous value for mutation\n   */\n  public $$attr(name: string, value?: null | boolean | string): string | null {\n    const prevValue = this.getAttribute(name);\n    if (value !== undefined) setAttr(this, name, value);\n    return prevValue;\n  }\n\n  /**\n   * Dispatches component custom event.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return ESLEventUtils.dispatch(this, eventName, eventInit);\n  }\n\n  /**\n   * Register component in the {@link customElements} registry\n   * @param tagName - custom tag name to register custom element\n   */\n  public static register(this: typeof ESLBaseElement, tagName?: string): void {\n    tagName = tagName || this.is;\n    if (!tagName) throw new Error('Can not define custom element');\n    const constructor: any = customElements.get(tagName);\n    if (constructor) {\n      if (constructor.is !== tagName) throw new Error('Element declaration tag inconsistency');\n      return;\n    }\n    if (this.is !== tagName) {\n      this.is = tagName;\n    }\n    customElements.define(tagName, this as any as CustomElementConstructor);\n  }\n\n  /** Shortcut for `customElements.whenDefined(currentCustomElement)` */\n  public static get registered(): Promise<CustomElementConstructor> {\n    return customElements.whenDefined(this.is);\n  }\n\n  /** Creates an instance of the current custom element */\n  public static create<T extends typeof ESLBaseElement>(this: T): InstanceType<T>;\n  /** General signature of {@link create} to allow simplified overrides of the method */\n  public static create(this: typeof ESLBaseElement): ESLBaseElement;\n  public static create<T extends typeof ESLBaseElement>(this: T): InstanceType<T> {\n    return document.createElement(this.is) as InstanceType<T>;\n  }\n\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {dispatchCustomEvent} from '../../esl-utils/dom/events/misc';\nimport {extractValues} from '../../esl-utils/misc/object';\nimport {ESLEventListener} from './listener';\n\nimport type {\n  ESLListenerHandler,\n  ESLListenerCriteria,\n  ESLListenerDescriptor,\n  ESLListenerEventMap,\n  ESLListenerDescriptorFn\n} from './types';\n\n\n@ExportNs('EventUtils')\nexport class ESLEventUtils {\n  /**\n   * Dispatches custom event. Alias for {@link dispatchCustomEvent}\n   * @see dispatchCustomEvent\n   */\n  public static dispatch(el: EventTarget, eventName: string, eventInit?: CustomEventInit): boolean {\n    return dispatchCustomEvent(el, eventName, eventInit);\n  }\n\n  /** Type guard to check if the passed function is typeof {@link ESLListenerDescriptorFn} */\n  public static isEventDescriptor(obj: any): obj is ESLListenerDescriptorFn {\n    return typeof obj === 'function' && Object.hasOwnProperty.call(obj, 'event');\n  }\n\n  /** Gets {@link ESLListenerDescriptorFn}s of the passed object */\n  public static descriptors(host: unknown, auto: boolean = true): ESLListenerDescriptorFn[] {\n    return extractValues(host, (value) => ESLEventUtils.isEventDescriptor(value) && value.auto === auto);\n  }\n\n  /**\n   * Gets currently subscribed listeners of the host\n   * @param host - host element (listeners context)\n   * @param criteria - optional set of criteria {@link ESLListenerCriteria} to filter listeners list\n   */\n  public static listeners(host: unknown, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventListener.get(host, ...criteria);\n  }\n\n  /** Subscribes decorated `handler` method of the `host` */\n  public static subscribe(host: unknown, handler: ESLListenerHandler): ESLEventListener[];\n  /** Subscribes `handler` function with the passed event type */\n  public static subscribe<EType extends keyof ESLListenerEventMap>(\n    host: unknown,\n    descriptor: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  /** Subscribes `handler` descriptor function with the passed additional descriptor data */\n  public static subscribe<EType extends keyof ESLListenerEventMap>(\n    host: unknown,\n    descriptor: Partial<ESLListenerDescriptor>,\n    handler: ESLListenerDescriptorFn<EType>\n  ): ESLEventListener[];\n  public static subscribe(\n    host: unknown,\n    eventDesc: string | Partial<ESLListenerDescriptor> | ESLListenerHandler,\n    handler: ESLListenerHandler = eventDesc as ESLListenerDescriptorFn\n  ): ESLEventListener[] {\n    if (typeof handler !== 'function') return [];\n    if (typeof eventDesc === 'string') eventDesc = {event: eventDesc};\n    if (ESLEventUtils.isEventDescriptor(handler) && eventDesc !== handler) eventDesc = Object.assign({}, handler, eventDesc);\n\n    const listeners = ESLEventListener.createOrResolve(host, handler, eventDesc as ESLListenerDescriptor);\n    const subscribed = listeners.filter((listener) => listener.subscribe());\n    if (!subscribed.length) console.warn('[ESL]: Empty subscription %o', Object.assign({}, eventDesc, {handler}));\n    return subscribed;\n  }\n\n  /**\n   * Unsubscribes {@link ESLEventListener}(s) from the object\n   * @param host - host element that stores subscriptions (listeners context)\n   * @param criteria - optional set of criteria {@link ESLListenerCriteria} to filter listeners to remove\n   */\n  public static unsubscribe(host: unknown, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    const listeners = ESLEventListener.get(host, ...criteria);\n    listeners.forEach((listener) => listener.unsubscribe());\n    return listeners;\n  }\n}\n\n/** @deprecated alias for {@link ESLEventUtils} */\nexport const EventUtils = ESLEventUtils;\n","import {wrap} from '../../esl-utils/misc/array';\nimport {resolveProperty} from '../../esl-utils/misc/functions';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {isObject} from '../../esl-utils/misc/object/types';\nimport {isSimilar} from '../../esl-utils/misc/object/compare';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {isPassiveByDefault} from '../../esl-utils/dom/events/misc';\n\nimport type {PropertyProvider} from '../../esl-utils/misc/functions';\nimport type {\n  ESLListenerTarget,\n  ESLListenerDefinition,\n  ESLListenerDescriptor,\n  ESLListenerHandler,\n  ESLListenerCriteria\n} from './types';\n\n/** Key to store listeners on the host */\nconst STORE = '__esl_listeners';\n\n/**\n * Splits and deduplicates event string\n * @returns array of unique events presented in events string\n */\nexport const splitEvents = (events: string): string[] => {\n  const terms = (events || '').split(' ').map((term) => term.trim());\n  const deduplicate = new Set<string>();\n  return terms.filter((term) => {\n    if (!term || deduplicate.has(term)) return false;\n    deduplicate.add(term);\n    return true;\n  });\n};\n\n/**\n * `EventListener` instance, used as an 'inner' record to process subscriptions made by `ESLEventUtils`\n * Uses `EventListenerObject` interface to subscribe on event.\n *\n * Use Chrome console `getEventListeners` method to check subscribers details when debugging ESLEventListener subscriptions.\n * */\nexport class ESLEventListener implements ESLListenerDefinition, EventListenerObject {\n  public readonly target?: ESLListenerTarget | PropertyProvider<ESLListenerTarget>;\n  public readonly selector?: string;\n  public readonly capture?: boolean;\n\n  public readonly once?: boolean;\n  public readonly auto?: boolean;\n  public readonly passive?: boolean;\n\n  protected constructor(\n    public readonly host: object,\n    public readonly event: string,\n    public readonly handler: ESLListenerHandler,\n    desc: ESLListenerDescriptor\n  ) {\n    const defaults = {\n      capture: false,\n      passive: isPassiveByDefault(event)\n    };\n    Object.assign(this, defaults, desc, {event});\n  }\n\n  /** @returns target element to listen */\n  @memoize()\n  public get $targets(): EventTarget[] {\n    if (!isObject(this.host)) return [];\n    const target = resolveProperty(this.target, this.host);\n    if (isObject(target)) return wrap(target);\n    const $host  = '$host' in this.host ? this.host.$host : this.host;\n    if (typeof target === 'string') return ESLTraversingQuery.all(target, $host);\n    if (typeof target === 'undefined' && $host instanceof HTMLElement) return [$host];\n    return [];\n  }\n\n  /** @returns resolved selector to check event target */\n  public get delegate(): string | undefined {\n    return resolveProperty(this.selector, this.host);\n  }\n\n  /**\n   * Checks if the passed criteria matches current event listener\n   * - `string` type criteria checked by the `event` name\n   * - `function` type criteria checked by the `handler` reference\n   * - `object` type criteria checked as descriptor using `isSimilar` comparer\n   * Note: `function` (handler) marcher has a priority over descriptor check, so handler function own properties will be ignored\n   */\n  public matches(desc?: ESLListenerCriteria): boolean {\n    if (typeof desc === 'string') return this.event === desc;\n    if (typeof desc === 'function') return this.handler === desc;\n    if (typeof desc === 'object') return isSimilar(this, desc, false);\n    return false;\n  }\n\n  /**\n   * Memoized builder for bound and decorated low level subscription.\n   * Implements DOM API {@link EventListenerObject.handleEvent}\n   */\n  @memoize()\n  public get handleEvent(): EventListener {\n    const handlerBound = this.handler.bind(this.host);\n    const handlerFull = this.once ? ((e: Event): void => (handlerBound(e), this.unsubscribe())) : handlerBound;\n    return this.selector ? (e: Event): void => this.isDelegatedTarget(e) && handlerFull(e) : handlerFull;\n  }\n\n  /** Checks if the passed event can be handled by the current event listener */\n  protected isDelegatedTarget(e: Event): boolean {\n    const target = e.target;\n    const current = e.currentTarget;\n    const delegate = this.delegate;\n    if (typeof delegate !== 'string') return true;\n    if (!delegate || !(target instanceof HTMLElement) || !(current instanceof HTMLElement)) return false;\n    return current.contains(target.closest(delegate));\n  }\n\n  /**\n   * (Re-)Subscribes event listener instance\n   * @returns if subscription was successful\n   */\n  public subscribe(): boolean {\n    const {passive, capture} = this;\n    this.unsubscribe();\n    memoize.clear(this, '$targets');\n    memoize.clear(this, 'handleEvent');\n    if (!this.$targets.length) return false;\n    this.$targets.forEach((el: EventTarget) => el.addEventListener(this.event, this, {passive, capture}));\n    ESLEventListener.add(this.host, this);\n    return true;\n  }\n\n  /** Unsubscribes event listener instance */\n  public unsubscribe(): void {\n    const {capture} = this;\n    if (!memoize.has(this, '$targets')) return;\n    this.$targets.forEach((el: EventTarget) => el.removeEventListener(this.event, this, {capture}));\n    ESLEventListener.remove(this.host, this);\n  }\n\n  /**\n   * Gets stored listeners array the passed `host` object\n   * Supports additional filtration criteria\n   */\n  public static get(host?: any, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    if (!host) return [];\n    const listeners = (host[STORE] || []) as ESLEventListener[];\n    if (!criteria.length) return listeners;\n    return listeners.filter((listener) => criteria.every(listener.matches, listener));\n  }\n  /** Adds listener to the listener store of the host object */\n  protected static add(host: any, instance: ESLEventListener): void {\n    if (!host) return;\n    if (!Object.hasOwnProperty.call(host, STORE)) host[STORE] = [];\n    host[STORE].push(instance);\n  }\n  /** Removes listener from the listener store of the host object */\n  protected static remove(host: any, instance: ESLEventListener): void {\n    const listeners = ESLEventListener.get(host);\n    const value = listeners.filter((listener) => listener !== instance);\n    Object.defineProperty(host, STORE, {value, configurable: true});\n  }\n\n  /** Creates or resolve existing event listeners by handler and descriptors */\n  public static createOrResolve(host: unknown, handler: ESLListenerHandler, desc: ESLListenerDescriptor): ESLEventListener[] {\n    if (!isObject(host)) return [];\n    const eventString = resolveProperty(desc.event, host);\n    const listeners: ESLEventListener[] = [];\n    for (const event of splitEvents(eventString)) {\n      const subscribed = ESLEventListener.get(host, event, handler, {\n        target: desc.target,\n        selector: desc.selector,\n        capture: !!desc.capture\n      });\n      if (subscribed.length) listeners.push(...subscribed);\n      else listeners.push(new ESLEventListener(host, event, handler, desc));\n    }\n    return listeners;\n  }\n}\n","import type {ESLNote} from './esl-note';\n\nexport interface FootnotesItem {\n  index: string[];\n  renderedIndex: string[];\n  text: string;\n}\n\n/** Converts notes list to footnotes items list */\nfunction convertNotesToFootnotesList(notes: ESLNote[]): FootnotesItem[] {\n  return notes.map(({index, renderedIndex, html}) => ({\n    index: [`${index}`],\n    renderedIndex: [renderedIndex],\n    text: html\n  }));\n}\n\n/** Compiles footnotes non-grouped list */\nexport function compileFootnotesNongroupedList(notes: ESLNote[]): FootnotesItem[] {\n  return convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes));\n}\n\n/** Compiles footnotes grouped list */\nexport function compileFootnotesGroupedList(notes: ESLNote[]): FootnotesItem[] {\n  const map = new Map() ;\n  convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes)).forEach((note) => {\n    const {index, renderedIndex, text} = note;\n    map.has(text) ? map.set(text, {\n      index: [...map.get(text).index, ...index],\n      renderedIndex: [...map.get(text).renderedIndex, ...renderedIndex],\n      text\n    }) : map.set(text, note);\n  });\n  const groupedList: FootnotesItem[] = [];\n  map.forEach((note, text) => groupedList.push(note));\n  return groupedList;\n}\n\n/** Sorts notes list */\nexport function sortFootnotes(notes: ESLNote[]): ESLNote[] {\n  return notes.sort((note1: ESLNote, note2: ESLNote): number => {\n    if (note1 === note2) return 0;\n    // eslint-disable-next-line no-bitwise\n    if (note1.compareDocumentPosition(note2) & Node.DOCUMENT_POSITION_PRECEDING) {\n      // note2 comes before note1\n      return 1;\n    }\n    return -1;\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, memoize, attr, listen, prop} from '../../esl-utils/decorators';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {compileFootnotesGroupedList, compileFootnotesNongroupedList, sortFootnotes} from './esl-footnotes-data';\n\nimport type {ESLNote} from './esl-note';\nimport type {FootnotesItem} from './esl-footnotes-data';\n\n@ExportNs('Footnotes')\nexport class ESLFootnotes extends ESLBaseElement {\n  static is = 'esl-footnotes';\n\n  /** Event to request acknowledgment from {@link ESLNotes} instances */\n  @prop('esl:footnotes:request') public FOOTNOTE_REQUEST_EVENT: string;\n  /** Event to acknowledge {@link ESLFootnotes} instance about footnote */\n  @prop('esl:footnotes:response') public FOOTNOTE_RESPONSE_EVENT: string;\n\n  /** Target element {@link ESLTraversingQuery} to define scope */\n  @attr({defaultValue: '::parent'}) public scopeTarget: string;\n\n  /** Grouping note instances with identical content enable/disable */\n  @attr({defaultValue: 'enable'}) public grouping: string;\n\n  /** Label for 'return to note' button title */\n  @attr({defaultValue: 'Back to note'}) public backToNoteLabel: string;\n\n  protected _notes: ESLNote[] = [];\n  protected deferredOnUpdate = debounce(() => this._onUpdate(), 150);\n\n  /** Scope element */\n  @memoize()\n  protected get scopeEl(): HTMLElement {\n    return ESLTraversingQuery.first(this.scopeTarget, this) as HTMLElement;\n  }\n\n  /** Notes that are allowed to be processed by footnotes */\n  public get notes(): ESLNote[] {\n    return this._notes.filter((note) => note.allowFootnotes);\n  }\n\n  /** List of notes to show */\n  protected get footnotesList(): FootnotesItem[] {\n    this.reindex();\n    return this.grouping !== 'enable'\n      ? compileFootnotesNongroupedList(this._notes)\n      : compileFootnotesGroupedList(this._notes);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this._notifyNotes();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this._notes.forEach((el) => el.unlink());\n    this._notes = [];\n  }\n\n  /** Adds the note to the footnotes list */\n  public linkNote(note: ESLNote): void {\n    if (this._notes.includes(note)) return;\n    this._notes.push(note);\n    const index = +sequentialUID(ESLFootnotes.is, '');\n    note.link(this, index);\n  }\n\n  /** Reindexes the list of notes */\n  public reindex(): void {\n    this._sortNotes();\n    this.notes.forEach((note, index) => note.index = index + 1);\n  }\n\n  /** Removes the note from the footnotes list */\n  public unlinkNote(note: ESLNote): void {\n    this._notes = this._notes.filter((el) => el !== note);\n    this.deferredOnUpdate();\n  }\n\n  /** Updates the content of footnotes */\n  public update(): void {\n    this.deferredOnUpdate();\n  }\n\n  /** Sorts list of notes */\n  protected _sortNotes(): void {\n    this._notes = sortFootnotes(this._notes);\n  }\n\n  /** Builds content of footnotes */\n  protected buildItems(): string {\n    const items = this.footnotesList.map((footnote) => this.buildItem(footnote)).join('');\n    return `<ul class=\"esl-footnotes-items\">${items}</ul>`;\n  }\n\n  /** Builds one item from footnotes list */\n  protected buildItem(footnote: FootnotesItem): string {\n    const item = `${this.buildItemIndex(footnote)}${this.buildItemText(footnote)}${this.buildItemBack(footnote)}`;\n    return `<li class=\"esl-footnotes-item\" data-order=\"${footnote.index}\">${item}</li>`;\n  }\n\n  /** Builds item index */\n  protected buildItemIndex(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-index\">${footnote.renderedIndex.join(', ')}</span>`;\n  }\n\n  /** Builds item text */\n  protected buildItemText(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-text\">${footnote.text}</span>`;\n  }\n\n  /** Builds item back-to-note button */\n  protected buildItemBack(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-back-to-note\" tabindex=\"0\" title=\"${this.backToNoteLabel}\"></span>`;\n  }\n\n  /** Actions on update footnotes */\n  @bind\n  protected _onUpdate(): void {\n    this.innerHTML = this.buildItems();\n  }\n\n  /** Handles `response` event from note */\n  @listen({\n    event: (el: ESLFootnotes) => el.FOOTNOTE_RESPONSE_EVENT,\n    target: (el: ESLFootnotes) => el.scopeEl\n  })\n  protected _onNoteSubscribe(e: CustomEvent): void {\n    const note = e.target as ESLNote;\n    this.linkNote(note);\n    this.deferredOnUpdate();\n\n    e.stopImmediatePropagation();\n  }\n\n  /** Handles `click` event */\n  @listen({\n    event: 'click',\n    selector: '.esl-footnotes-back-to-note'\n  })\n  protected _onItemClick(e: MouseEvent | KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n    const orderAttr = target.closest('.esl-footnotes-item')?.getAttribute('data-order');\n    const order = orderAttr?.split(',').map((item) => +item);\n    order && this._onBackToNote(order);\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(event.key)) this._onItemClick(event);\n  }\n\n  /** Actions on back-to-note click  */\n  protected _onBackToNote(order: number[]): void {\n    const index = order[order.length - 1];\n    this.notes.forEach((note) => {\n      note.highlight(order.includes(note.index));\n      if (note.index === index) {\n        note.activate();\n      }\n    });\n  }\n\n  /** Turns off highlight for notes with the same text */\n  public turnOffHighlight(note: ESLNote): void {\n    this._notes\n      .filter((item) => note.html === item.html)\n      .forEach((item) => item.highlight(false));\n  }\n\n  /**\n   * Sends a request to all notes, expecting to get a response from\n   * the unlinked ones and link up with them */\n  protected _notifyNotes(): void {\n    ESLEventUtils.dispatch(this, this.FOOTNOTE_REQUEST_EVENT);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Footnotes: typeof ESLFootnotes;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-footnotes': ESLFootnotes;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, prop} from '../../esl-base-element/core';\nimport {ready, attr, boolAttr, memoize, listen} from '../../esl-utils/decorators';\nimport {ESLTooltip} from '../../esl-tooltip/core';\nimport {promisifyTimeout, repeatSequence} from '../../esl-utils/async/promise';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {scrollIntoView} from '../../esl-utils/dom/scroll';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ESLFootnotes} from './esl-footnotes';\nimport type {TooltipActionParams} from '../../esl-tooltip/core/esl-tooltip';\nimport type {IMediaQueryCondition} from '../../esl-media-query/core/conditions/media-query-base';\n\n@ExportNs('Note')\nexport class ESLNote extends ESLBaseElement {\n  public static is = 'esl-note';\n  public static observedAttributes = ['tooltip-shown', 'ignore'];\n\n  /** Timeout before activating note (to have time to show content with this note) */\n  public static readonly activateTimeout = 100;\n\n  /** Event to request acknowledgment from {@link ESLNotes} instances */\n  @prop('esl:footnotes:request') public FOOTNOTE_REQUEST_EVENT: string;\n  /** Event to acknowledge {@link ESLFootnotes} instance about footnote */\n  @prop('esl:footnotes:response') public FOOTNOTE_RESPONSE_EVENT: string;\n\n  /** Linked state marker */\n  @boolAttr() public linked: boolean;\n  /** Standalone state marker */\n  @boolAttr() public standalone: boolean;\n  /** Tooltip state marker */\n  @boolAttr() public tooltipShown: boolean;\n\n  /** Media query to specify that footnotes must ignore this note. Default: `not all` */\n  @attr({defaultValue: 'not all'}) public ignore: string;\n\n  /** Tooltip content */\n  @attr() public html: string;\n  /**\n   * Note label in stand-alone mode (detached from footnotes),\n   * in the connected state it is a numeric index that is calculated automatically\n   */\n  @attr({defaultValue: '*'}) public standaloneLabel: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackHover: string;\n\n  /** Target to container element {@link ESLTraversingQuery} to define bounds of tooltip visibility (window by default) */\n  @attr() public container: string;\n\n  /** margin around the element that is used as the viewport for checking the visibility of the note tooltip */\n  @attr({defaultValue: '0px'})  public intersectionMargin: string;\n\n  protected _$footnotes: ESLFootnotes | null;\n  protected _index: number;\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  /** Marker to allow footnotes to pick up this note */\n  public get allowFootnotes(): boolean {\n    return !this.queryToIgnore.matches;\n  }\n\n  /** Note index in the scope content */\n  public get index(): number {\n    return this._index;\n  }\n  public set index(value: number) {\n    this._index = value;\n    this.innerHTML = this.renderedIndex;\n  }\n\n  /** Note index in the displayed list of footnotes */\n  public get renderedIndex(): string {\n    return this.allowFootnotes ? `${this._index}` : this.standaloneLabel;\n  }\n\n  /** Query to describe conditions to ignore note by footnotes  */\n  @memoize()\n  public get queryToIgnore(): IMediaQueryCondition {\n    const ignore = this.getClosestRelatedAttr('ignore') || this.ignore;\n    return ESLMediaQuery.for(ignore);\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    this.init();\n    super.connectedCallback();\n    this._sendResponseToFootnote();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._$footnotes?.unlinkNote(this);\n    this.restore();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'tooltip-shown' && newVal === null) {\n      this._$footnotes?.turnOffHighlight(this);\n    }\n    if (attrName === 'ignore') {\n      this.updateIgnoredQuery();\n    }\n  }\n\n  /** Revise the settings for ignoring the note */\n  public updateIgnoredQuery(): void {\n    memoize.clear(this, 'queryToIgnore');\n    this.$$on(this._onBPChange);\n    this._onBPChange();\n  }\n\n  /** Gets attribute value from the closest element with group behavior settings */\n  protected getClosestRelatedAttr(attrName: string): string | null {\n    const tagName = (this.constructor as typeof ESLBaseElement).is;\n    const relatedAttrName = `${tagName}-${attrName}`;\n    const $closest = this.closest(`[${relatedAttrName}]`);\n    return $closest ? $closest.getAttribute(relatedAttrName) : null;\n  }\n\n  /** Activates note */\n  public activate(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    ESLEventUtils.dispatch(this, 'esl:show:request');\n    // TODO: replace timeout with a more reliable mechanism to have time to show content with this note\n    repeatSequence(() => {\n      return promisifyTimeout((this.constructor as typeof ESLNote).activateTimeout)\n        .then(() => scrollIntoView(this, {behavior: 'smooth', block: 'center'}))\n        .then(() => ESLTooltip.open || this.showTooltip());\n    }, 3);\n  }\n\n  /** Highlights note */\n  public highlight(enable: boolean = true): void {\n    this.classList.toggle('highlight', enable);\n  }\n\n  /** Links note with footnotes */\n  public link(footnotes: ESLFootnotes, index: number): void {\n    this.linked = true;\n    this._$footnotes = footnotes;\n    this.index = index;\n    this.tabIndex = 0;\n    this.update();\n  }\n\n  /** Unlinks note from footnotes */\n  public unlink(): void {\n    this.restore();\n    this.update();\n    this._sendResponseToFootnote();\n  }\n\n  /** Updates note state */\n  public update(): void {\n    this.standalone = !(this.linked && this.allowFootnotes);\n  }\n\n  /** Initial initialization of the element during the connection to DOM */\n  protected init(): void {\n    if (!this.html) {\n      this.html = this.innerHTML;\n    }\n    memoize.clear(this, 'queryToIgnore');\n    this.index = 0;\n    this.linked = false;\n    this.update();\n  }\n\n  /** Restores original note content after unlinking */\n  protected restore(): void {\n    this.linked = false;\n    this._$footnotes = null;\n    this.index = 0;\n    this.tabIndex = -1;\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLNote, ...params: TooltipActionParams[]): TooltipActionParams {\n    const container = this.getClosestRelatedAttr('container') || this.container;\n    const containerEl = container ? ESLTraversingQuery.first(container, this) as HTMLElement : undefined;\n    return Object.assign({\n      initiator: 'note',\n      activator: this,\n      containerEl,\n      html: this.html,\n      intersectionMargin: this.intersectionMargin\n    }, ...params);\n  }\n\n  /** Shows tooltip with passed params */\n  public showTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    ESLTooltip.show(actionParams);\n    this.highlight();\n  }\n  /** Hides tooltip with passed params */\n  public hideTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    ESLTooltip.hide(actionParams);\n  }\n  /** Toggles tooltip with passed params */\n  public toggleTooltip(params: TooltipActionParams = {}, state: boolean = !this.tooltipShown): void {\n    state ? this.showTooltip(params) : this.hideTooltip(params);\n  }\n\n  /** Handles `click` event */\n  @listen('click')\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE].includes(event.key)) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles hover `mouseenter` event */\n  @listen('mouseenter')\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.showTooltip({event});\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @listen('mouseleave')\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.hideTooltip({event, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Actions on breakpoint changing */\n  @listen({\n    event: 'change',\n    target: (el: ESLNote) => el.queryToIgnore\n  })\n  protected _onBPChange(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    this.innerHTML = this.renderedIndex;\n    this.update();\n    this._$footnotes?.update();\n  }\n\n  /** Handles footnotes request event */\n  @listen({\n    event: (el: ESLNote) => el.FOOTNOTE_REQUEST_EVENT,\n    target: document.body\n  })\n  protected _onFootnotesReady(e: CustomEvent): void {\n    if (this.linked) return;\n    this._sendResponseToFootnote();\n  }\n\n  /** Sends the response to footnotes */\n  protected _sendResponseToFootnote(): void {\n    ESLEventUtils.dispatch(this, this.FOOTNOTE_RESPONSE_EVENT);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Note: typeof ESLNote;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-note': ESLNote;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {attr, boolAttr} from '../../../esl-utils/decorators';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nimport type {ESLSelectOption} from './esl-select-wrapper';\n\n/**\n * ESLSelectItem component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectItem - inner component to render an option\n */\n@ExportNs('SelectItem')\nexport class ESLSelectItem extends ESLBaseElement {\n  public static readonly is: string = 'esl-select-item';\n  public static observedAttributes = ['selected', 'disabled'];\n\n  /** Option value */\n  @attr() public value: string;\n  /** Selected state marker */\n  @boolAttr() public selected: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n\n  /** Original option */\n  public original: ESLSelectOption;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.tabIndex = 0;\n    this.setAttribute('role', 'checkbox');\n    this.setAttribute('aria-selected', String(this.selected));\n  }\n\n  protected attributeChangedCallback(attrName: string): void {\n    if (attrName === 'selected') {\n      this.setAttribute('aria-selected', String(this.selected));\n    }\n    if (attrName === 'disabled') {\n      this.setAttribute('aria-disabled', String(this.disabled));\n    }\n  }\n\n  public update(option?: ESLSelectOption): void {\n    if (option) this.original = option;\n    this.value = this.original.value;\n    this.disabled = this.original.disabled;\n    this.selected = this.original.selected;\n    this.textContent = this.original.text;\n  }\n\n  /** Helper to create an option item */\n  public static build(option: ESLSelectOption): ESLSelectItem {\n    const item = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    item.update(option);\n    return item;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectItem: typeof ESLSelectItem;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-item': ESLSelectItem;\n  }\n}\n","import {bind, attr, boolAttr, listen} from '../../../esl-utils/decorators';\nimport {ARROW_DOWN, ARROW_UP, ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLScrollbar} from '../../../esl-scrollbar/core';\nimport {ESLSelectItem} from './esl-select-item';\nimport {ESLSelectWrapper} from './esl-select-wrapper';\n\n/**\n * ESLSelectList component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectList is a component to show selectable list of items. Decorates native HTMLSelectElement\n */\n@ExportNs('SelectList')\nexport class ESLSelectList extends ESLSelectWrapper {\n  public static readonly is = 'esl-select-list';\n  public static observedAttributes = ['select-all-label', 'disabled'];\n\n  public static register(): void {\n    ESLSelectItem.register();\n    super.register();\n  }\n\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the list */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $items: ESLSelectItem[];\n  protected $list: HTMLDivElement;\n  protected $scroll: ESLScrollbar;\n  protected $selectAll: ESLSelectItem;\n\n  constructor() {\n    super();\n    this.$list = document.createElement('div');\n    this.$list.setAttribute('role', 'list');\n    this.$list.classList.add('esl-scrollable-content');\n    this.$list.classList.add('esl-select-list-container');\n    this.$scroll = document.createElement(ESLScrollbar.is) as ESLScrollbar;\n    this.$scroll.target = '::prev';\n    this.$selectAll = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    this.$selectAll.classList.add('esl-select-all-item');\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    if (attrName === 'select-all-label') {\n      this.$selectAll.textContent = newVal;\n    }\n    if (attrName === 'disabled') {\n      this._updateDisabled();\n    }\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.bindSelect();\n\n    this._updateDisabled();\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n  }\n\n  protected bindSelect(): void {\n    const target = this.querySelector('[esl-select-target]');\n    if (!target || !(target instanceof HTMLSelectElement)) return;\n    this.$select = target;\n  }\n\n  protected _renderItems(): void {\n    if (!this.$select) return;\n    this.$list.innerHTML = '';\n    this.$items = this.options.map(ESLSelectItem.build);\n    if (this.pinSelected) {\n      this._renderGroup(this.$items.filter((option) => option.selected));\n      this._renderGroup(this.$items.filter((option) => !option.selected));\n    } else {\n      this._renderGroup(this.$items);\n    }\n    this.toggleAttribute('multiple', this.multiple);\n  }\n  protected _renderGroup(items: ESLSelectItem[]): void {\n    items.forEach((item) => this.$list.appendChild(item));\n    const [last] = items.slice(-1);\n    last && last.classList.add('last-in-group');\n  }\n\n  protected _updateSelectAll(): void {\n    if (!this.multiple) {\n      this.$selectAll.removeAttribute('tabindex');\n      return;\n    }\n    this.$selectAll.tabIndex = 0;\n    this.$selectAll.selected = this.isAllSelected();\n    this.$selectAll.textContent = this.selectAllLabel;\n  }\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n  }\n\n  @bind\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined, oldTarget: HTMLSelectElement | undefined): void {\n    super._onTargetChange(newTarget, oldTarget);\n    this._updateSelectAll();\n    this._renderItems();\n  }\n\n  @listen({inherit: true})\n  public _onChange(): void {\n    this._updateSelectAll();\n    this.$items.forEach((item) => item.update());\n  }\n\n  @bind\n  public _onListChange(): void {\n    this._renderItems();\n  }\n\n  @listen('click')\n  protected _onClick(e: MouseEvent | KeyboardEvent): void {\n    if (this.disabled) return;\n    const target = e.target;\n    if (!target || !(target instanceof ESLSelectItem)) return;\n    if (target.classList.contains('esl-select-all-item')) {\n      this.setAllSelected(!target.selected);\n    } else {\n      this.setSelected(target.value, !target.selected);\n    }\n  }\n\n  @listen('keydown')\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this._onClick(e);\n      e.preventDefault();\n    }\n    if ([ARROW_UP, ARROW_DOWN].includes(e.key)) {\n      const index = this.$items.indexOf(document.activeElement as ESLSelectItem);\n      const count = this.$items.length;\n      const increment = e.key === ARROW_UP ? -1 : 1;\n      if (index === -1) return;\n      this.$items[(index + increment + count) % count].focus();\n      e.preventDefault();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectList: typeof ESLSelectList;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-list': ESLSelectList;\n  }\n}\n","import {ESLBaseElement, listen} from '../../../esl-base-element/core';\nimport {ESLEventUtils} from '../../../esl-utils/dom/events';\n\n/** Interface for option definition */\nexport interface ESLSelectOption {\n  /** Label text of the option */\n  text: string;\n  /** Value of the option */\n  value: string;\n  /** Disabled marker */\n  disabled: boolean;\n  /** Selected marker */\n  selected: boolean;\n  /** Initially selected marker */\n  defaultSelected: boolean;\n}\n\n/** Interface to declare options source for select components */\nexport interface ESLSelectModel {\n  /** Allow multiple items */\n  multiple: boolean;\n  /** Get list of options */\n  options: ESLSelectOption[];\n  /** Get list of selected options */\n  selectedOptions: ESLSelectOption[];\n\n  /** Toggle option with passed value to the state */\n  setSelected(value: string, state: boolean): void;\n  /** Check selected state*/\n  isSelected(value: string): boolean;\n  /** Has selected options */\n  hasSelected(): boolean;\n\n  /** Check that all options are selected */\n  isAllSelected(): boolean;\n  /** Toggle all options to the state */\n  setAllSelected(state: boolean): void;\n}\n\n/**\n * Base class for {@link HTMLSelectElement} wrapper element, implements {@link ESLSelectModel} options source\n */\nexport abstract class ESLSelectWrapper extends ESLBaseElement implements ESLSelectModel {\n  protected static observationConfig: MutationObserverInit = {\n    subtree: true,\n    attributes: true,\n    attributeFilter: ['value', 'selected', 'disabled'],\n    childList: true,\n    characterData: true\n  };\n\n  private _$select: HTMLSelectElement;\n  private _mutationObserver = new MutationObserver(this._onTargetMutation.bind(this));\n\n  /** Native select that is wrapped */\n  public get $select(): HTMLSelectElement {\n    return this._$select;\n  }\n  public set $select(select: HTMLSelectElement) {\n    const prev = this._$select;\n    this._$select = select;\n    this._onTargetChange(select, prev);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._mutationObserver.disconnect();\n  }\n\n  @listen({\n    event: 'change',\n    target: (el: ESLSelectWrapper) => el.$select\n  })\n  protected _onChange(event?: Event): void {}\n\n  protected _onListChange(): void {}\n\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined,\n                            oldTarget: HTMLSelectElement | undefined): void {\n    this.$$on(this._onChange);\n    this._mutationObserver.disconnect();\n    const type = (this.constructor as typeof ESLSelectWrapper);\n    if (newTarget) this._mutationObserver.observe(newTarget, type.observationConfig);\n  }\n\n  protected _onTargetMutation(changes: MutationRecord[]): void {\n    const isListChange = (change: MutationRecord): boolean => change.addedNodes.length + change.removedNodes.length > 0;\n    changes.some(isListChange) ? this._onListChange() : this._onChange();\n  }\n\n  @listen({\n    event: 'reset',\n    target: (el: ESLSelectWrapper) => el.ownerDocument\n  })\n  protected _onReset(event: Event): void {\n    if (!event.target || event.target !== this.form) return;\n    setTimeout(() => this._onChange(event));\n  }\n\n  public get multiple(): boolean {\n    return this.$select && this.$select.multiple;\n  }\n\n  public get options(): ESLSelectOption[] {\n    return this.$select ? Array.from(this.$select.options) : [];\n  }\n  public get selectedOptions(): ESLSelectOption[] {\n    return this.options.filter((item) => item.selected);\n  }\n\n  protected getOption(value: string): ESLSelectOption | undefined {\n    return this.options.find((item) => item.value === value);\n  }\n\n  public setSelected(value: string, state: boolean): void {\n    if (!this.$select) return;\n    const option = this.getOption(value);\n    option && (option.selected = state);\n    ESLEventUtils.dispatch(this.$select, 'change');\n  }\n  public isSelected(value: string): boolean {\n    const opt = this.getOption(value);\n    return !!opt && opt.selected;\n  }\n  public hasSelected(): boolean {\n    return this.options.some((item) => item.selected);\n  }\n\n  public isAllSelected(): boolean {\n    return this.options.every((item) => item.selected || item.disabled);\n  }\n\n  public setAllSelected(state: boolean): void {\n    if (!this.multiple || !this.$select) return;\n    this.options.forEach((item: HTMLOptionElement) => item.selected = !item.disabled && state);\n    ESLEventUtils.dispatch(this.$select, 'change');\n  }\n\n  // Proxy select methods and values\n  public get value(): string | undefined {\n    return this.$select?.value;\n  }\n  public get values(): string[] {\n    return this.selectedOptions.map((item: HTMLOptionElement) => item.value);\n  }\n\n  public get form(): HTMLFormElement | null {\n    return this.$select?.form;\n  }\n\n  public get name(): string {\n    return this.$select?.name;\n  }\n  public set name(name: string) {\n    this.$select && (this.$select.name = name);\n  }\n\n  public get required(): boolean {\n    return this.$select?.required;\n  }\n  public set required(required: boolean) {\n    this.$select && (this.$select.required = required);\n  }\n\n  // Validation API values\n  public get validity(): ValidityState {\n    return this.$select?.validity;\n  }\n  public get validationMessage(): string {\n    return this.$select?.validationMessage;\n  }\n  public get willValidate(): boolean {\n    return this.$select?.willValidate;\n  }\n\n  // Validation API methods\n  public checkValidity(): boolean {\n    return this.$select?.checkValidity();\n  }\n  public reportValidity(): boolean {\n    return this.$select?.reportValidity();\n  }\n  public setCustomValidity(error: string): void {\n    this.$select?.setCustomValidity(error);\n  }\n}\n","import {ESLToggleable} from '../../../esl-toggleable/core/esl-toggleable';\nimport {bind, prop, listen} from '../../../esl-utils/decorators';\nimport {TAB} from '../../../esl-utils/dom/keys';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {ESLSelectList} from '../../esl-select-list/core';\n\nimport type {ESLSelect} from './esl-select';\nimport type {ESLToggleableActionParams} from '../../../esl-toggleable/core/esl-toggleable';\n\n/**\n * ESLSelectDropdown component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom component to render {@link ESLSelect} dropdown section\n * Uses {@link ESLSelectList} to render the content\n */\nexport class ESLSelectDropdown extends ESLToggleable {\n  public static readonly is = 'esl-select-dropdown';\n  public static register(): void {\n    ESLSelectList.register();\n    super.register();\n  }\n\n  /** Owner ESLSelect instance */\n  public $owner: ESLSelect;\n\n  /** Inner ESLSelectList component */\n  protected $list: ESLSelectList;\n  protected _disposeTimeout: number;\n  protected _deferredUpdatePosition = rafDecorator(() => this.updatePosition());\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  constructor() {\n    super();\n    this.$list = document.createElement(ESLSelectList.is);\n  }\n\n  protected setInitialState(): void {}\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$list);\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$list);\n  }\n\n  protected onShow(params: ESLToggleableActionParams): void {\n    document.body.appendChild(this);\n    this._disposeTimeout && window.clearTimeout(this._disposeTimeout);\n\n    this.$$cls(this.$owner.dropdownClass, true);\n    this.$list.pinSelected = this.$owner.pinSelected;\n    this.$list.selectAllLabel = this.$owner.selectAllLabel;\n    this.$list.$select = this.$owner.$select;\n\n    super.onShow(params);\n    const focusable: HTMLElement | null = this.querySelector('[tabindex]');\n    focusable?.focus({preventScroll: true});\n    this.updatePosition();\n  }\n  protected onHide(params: ESLToggleableActionParams): void {\n    const select = this.activator;\n    super.onHide(params);\n    this._disposeTimeout = window.setTimeout(() => {\n      if (this.parentNode !== document.body) return;\n      document.body.removeChild(this);\n    }, 1000);\n    select && setTimeout(() => select.focus({preventScroll: true}), 0);\n  }\n\n  @listen('keydown')\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    const els = this.querySelectorAll('[tabindex]');\n    const first = els[0] as HTMLElement;\n    const last = els[els.length - 1] as HTMLElement;\n    if (first && e.target === last && !e.shiftKey) first.focus();\n    if (last && e.target === first && e.shiftKey) last.focus();\n  }\n\n  @listen({event: 'resize', target: window})\n  protected _onResize(): void {\n    if (!this.activator) return;\n    this._deferredUpdatePosition();\n  }\n\n  @bind\n  public updatePosition(): void {\n    if (!this.activator) return;\n    const windowY = window.scrollY || window.pageYOffset;\n    const rect = this.activator.getBoundingClientRect();\n\n    this.style.top = `${windowY + rect.top + rect.height}px`;\n    this.style.left = `${rect.left}px`;\n    this.style.width = `${rect.width}px`;\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-dropdown': ESLSelectDropdown;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {format} from '../../../esl-utils/misc/format';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {attr, boolAttr, decorate, listen} from '../../../esl-utils/decorators';\n\nimport type {ESLSelect} from './esl-select';\n\n/**\n * ESLSelectRenderer component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom element to render {@link ESLSelect} inline field\n */\nexport class ESLSelectRenderer extends ESLBaseElement {\n  public static readonly is = 'esl-select-renderer';\n\n  /** Attribute for empty text value */\n  @attr() public emptyText: string;\n  /** Attribute for more label format */\n  @attr() public moreLabelFormat: string;\n  /** Marker attribute to reflect filled state */\n  @boolAttr() public hasValue: boolean;\n\n  protected $container: HTMLDivElement;\n  protected $rest: HTMLElement;\n  protected $text: HTMLElement;\n  protected $remove: HTMLButtonElement;\n\n  constructor() {\n    super();\n\n    this.$remove = document.createElement('button');\n    this.$remove.type = 'button';\n    this.$remove.setAttribute('aria-label', 'Clear');\n    this.$remove.classList.add('esl-select-clear-btn');\n    this.$remove.classList.add('icon-nav-close-menu');\n\n    this.$container = document.createElement('div');\n    this.$container.classList.add('esl-select-text-container');\n    this.$text = document.createElement('span');\n    this.$text.classList.add('esl-select-text');\n    this.$container.appendChild(this.$text);\n    this.$rest = document.createElement('span');\n    this.$rest.classList.add('esl-select-text');\n    this.$container.appendChild(this.$rest);\n  }\n\n  /** ESLSelect owner */\n  get owner(): ESLSelect | null {\n    if (!this.parentElement || !this.parentElement.matches('esl-select')) return null;\n    return this.parentElement as ESLSelect;\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$container);\n    this.appendChild(this.$remove);\n    Promise.resolve().then(() => this.render());\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$container);\n    this.removeChild(this.$remove);\n  }\n\n  /** Rerender component with markers */\n  @listen({\n    event: 'esl:change:value',\n    target: (el: ESLSelectRenderer) => el.owner\n  })\n  public render(): void {\n    if (!this.owner) return;\n    const selected = this.owner.selectedOptions;\n    this.hasValue = !!selected.length;\n    this.toggleAttribute('multiple', this.owner.multiple);\n    this.applyItems(selected.map((item) => item.text));\n  }\n\n  /** Render item with a visible items limit */\n  protected apply(items: string[], limit: number): void {\n    const length = items.length;\n    const rest = length - limit;\n    const options = {rest, length, limit};\n    this.$text.textContent = items.slice(0, limit).join(', ');\n    if (rest > 0) {\n      this.$rest.textContent = format(this.moreLabelFormat || '', options);\n    } else {\n      this.$rest.textContent = '';\n    }\n  }\n  /** Render items using adaptive algorithm */\n  protected applyItems(items: string[]): void {\n    let size = 0;\n    do {\n      this.apply(items, ++size); // Render with extended limit while it not fits to the container\n    } while (size <= items.length && this.$container.scrollWidth <= this.$container.clientWidth);\n    this.apply(items, size - 1); // Render last limit that fits\n  }\n\n  /** Handle clear button click */\n  @listen({event: 'click', selector: '.esl-select-clear-btn'})\n  protected _onClear(e: MouseEvent): void {\n    if (!this.owner) return;\n    this.owner.setAllSelected(false);\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  @listen({event: 'resize', target: window})\n  @decorate(rafDecorator)\n  protected _onResize(): void {\n    this.render();\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-renderer': ESLSelectRenderer;\n  }\n}\n","import {attr, boolAttr, listen} from '../../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLEventUtils} from '../../../esl-utils/dom/events';\n\nimport {ESLSelectWrapper} from '../../esl-select-list/core/esl-select-wrapper';\nimport {ESLSelectRenderer} from './esl-select-renderer';\nimport {ESLSelectDropdown} from './esl-select-dropdown';\n\n/**\n * ESLSelect component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelect is a component on top of native select that brings more customization features.\n * Uses \"select with dropdown\" view. Supports both single and multiple selection.\n */\n@ExportNs('Select')\nexport class ESLSelect extends ESLSelectWrapper {\n  public static readonly is = 'esl-select';\n  public static observedAttributes = ['disabled', 'dropdown-class'];\n\n  public static register(): void {\n    ESLSelectDropdown.register();\n    ESLSelectRenderer.register();\n    super.register();\n  }\n\n  /** Placeholder text property */\n  @attr() public placeholder: string;\n  /** Class(es) to mark not empty state */\n  @attr() public hasValueClass: string;\n  /** Class(es) for focused state. Select is also focused if the dropdown list is opened */\n  @attr() public hasFocusClass: string;\n  /** Class(es) for select dropdown */\n  @attr() public dropdownClass: string;\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /**\n   * Text to add when there is not enough space to show all selected options inline,\n   * Supports `{rest}`, `{length}` and `{limit}` placeholders\n   */\n  @attr({defaultValue: '+ {rest} more...'}) public moreLabelFormat: string;\n\n  /** Dropdown open marker */\n  @boolAttr() public open: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the dropdown */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $renderer: ESLSelectRenderer;\n  protected $dropdown: ESLSelectDropdown;\n\n  constructor() {\n    super();\n\n    this.$renderer = document.createElement(ESLSelectRenderer.is);\n    this.$dropdown = document.createElement(ESLSelectDropdown.is);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (attrName === 'disabled') this._updateDisabled();\n    if (attrName === 'dropdown-class') {\n      this.$dropdown.$$cls(oldVal, false);\n      this.$dropdown.$$cls(newVal, true);\n    }\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this.$select = this.querySelector('[esl-select-target]')!;\n    if (!this.$select) return;\n\n    this._prepare();\n    this._updateDisabled();\n    this._updateMarkers();\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._dispose();\n  }\n\n  /** Catches the focus */\n  public focus(options?: FocusOptions): void {\n    this.$select.focus(options);\n  }\n  /** Updates select component */\n  public update(valueChanged = true): void {\n    this._updateMarkers();\n    if (!valueChanged) return;\n    // TODO: silent updates\n    ESLEventUtils.dispatch(this, 'esl:change:value', {detail: {event: null}});\n  }\n\n  protected _prepare(): void {\n    this.$renderer.className = this.$select.className;\n    this.$renderer.emptyText = this.placeholder;\n    this.$renderer.moreLabelFormat = this.moreLabelFormat;\n    this.$dropdown.$owner = this;\n    this.appendChild(this.$renderer);\n  }\n  protected _dispose(): void {\n    this.$select.className = this.$renderer.className;\n    this.removeChild(this.$renderer);\n  }\n\n  protected _updateMarkers(): void {\n    const hasValue = this.hasSelected();\n    this.toggleAttribute('has-value', hasValue);\n    CSSClassUtils.toggle(this, this.hasValueClass, hasValue);\n\n    const focusEl = document.activeElement;\n    const hasFocus = this.open || (focusEl && this.contains(focusEl));\n    CSSClassUtils.toggle(this, this.hasFocusClass, !!hasFocus);\n  }\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n    if (this.disabled && this.open) this.$dropdown.hide();\n  }\n\n  @listen({inherit: true})\n  protected _onChange(event: Event): void {\n    this._updateMarkers();\n    ESLEventUtils.dispatch(this, 'esl:change:value', {detail: {event}});\n  }\n\n  @listen('focusout')\n  protected _onFocusOut(): void {\n    this._updateMarkers();\n  }\n\n  @listen('click')\n  protected _onClick(): void {\n    if (this.disabled) return;\n    this.$dropdown.toggle(!this.$dropdown.open, {\n      activator: this,\n      initiator: 'select'\n    });\n  }\n\n  @listen('keydown')\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this.click();\n      e.preventDefault();\n    }\n  }\n\n  @listen({\n    event: 'esl:show esl:hide',\n    target: (el: ESLSelect) => el.$dropdown\n  })\n  protected _onPopupStateChange(e: CustomEvent): void {\n    this.open = this.$dropdown.open;\n    this._updateMarkers();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Select: typeof ESLSelect;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select': ESLSelect;\n  }\n}\n","import {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport type {ESLImage} from './esl-image';\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Image lazy loading IntersectionObserver instance */\nexport function getIObserver(): IntersectionObserver {\n  if (!iObserver) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [0.01], // 0 + 1 are not correctly handled by all browsers\n      rootMargin: DeviceDetector.isMobile ? '250px' : '500px' // rootMargin value for IntersectionObserver\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const image = entry.target as ESLImage;\n\n  // Check that entry is going to appear in the viewport area\n  if (entry.isIntersecting || entry.intersectionRatio > 0) {\n    image.triggerLoad();\n  }\n}\n","import {sanitize} from '../../esl-utils/dom/sanitize';\n\nimport type {ESLImage} from './esl-image';\n\nexport const EMPTY_IMAGE = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\nexport const isEmptyImage = (src: string): boolean => src === EMPTY_IMAGE;\n\n/**\n * Describe mods configurations\n */\nexport interface ESLImageRenderStrategy {\n  /** Apply image from shadow loader */\n  apply: (img: ESLImage, shadowImg: HTMLImageElement) => void;\n  /** Clean strategy specific changes from ESLImage */\n  clear: (img: ESLImage) => void;\n}\n\n/**\n * Describes object that contains strategies mapping\n */\nexport interface ESLImageStrategyMap {\n  [mode: string]: ESLImageRenderStrategy;\n}\n\nexport const STRATEGIES: ESLImageStrategyMap = {\n  'cover': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n    },\n    clear(img): void {\n      img.style.backgroundImage = '';\n    }\n  },\n  'save-ratio': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n      if (shadowImg.width === 0) return;\n      img.style.paddingTop = isEmpty ? '' : `${(shadowImg.height * 100 / shadowImg.width)}%`;\n    },\n    clear(img): void {\n      img.style.paddingTop = '';\n      img.style.backgroundImage = '';\n    }\n  },\n  'fit': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.removeAttribute('width');\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'origin': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.width = shadowImg.width / window.devicePixelRatio;\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'inner-svg': {\n    apply(img, shadowImg): void {\n      const request = new XMLHttpRequest();\n      request.open('GET', shadowImg.src, true);\n      request.onreadystatechange = (): void => {\n        if (request.readyState !== 4 || request.status !== 200) return;\n        img.innerHTML = sanitize(request.responseText, ['svg']);\n      };\n      request.send();\n    },\n    clear(img): void {\n      img.innerHTML = '';\n    }\n  }\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, prop, attr, boolAttr} from '../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core/esl-traversing-query';\n\nimport {getIObserver} from './esl-image-iobserver';\nimport {EMPTY_IMAGE, STRATEGIES, isEmptyImage} from './esl-image-strategies';\n\nimport type {ESLImageRenderStrategy} from './esl-image-strategies';\n\ntype LoadState = 'error' | 'loaded' | 'ready';\nconst isLoadState = (state: string): state is LoadState => ['error', 'loaded', 'ready'].includes(state);\n\n/**\n * ESLImage - custom element, that provides flexible ways to include images on web pages.\n * Was originally developed as an alternative to `<picture>` element, but with more features inside.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Image')\nexport class ESLImage extends ESLBaseElement {\n  public static is = 'esl-image';\n  public static observedAttributes = ['alt', 'role', 'mode', 'aria-label', 'data-src', 'data-src-base', 'lazy-triggered'];\n\n  /** Default container class value */\n  public static DEFAULT_CONTAINER_CLS = 'img-container-loaded';\n\n  public static readonly STRATEGIES = STRATEGIES;\n  public static readonly EMPTY_IMAGE = EMPTY_IMAGE;\n\n  /** Event that represents ready state of {@link ESLImage} */\n  @prop('ready') public READY_EVENT: string;\n  /** Event that represents successfully loaded state of {@link ESLImage} */\n  @prop('load') public LOAD_EVENT: string;\n  /** Event that represents error state of {@link ESLImage} */\n  @prop('error') public ERROR_EVENT: string;\n\n  @attr() public alt: string;\n  @attr({defaultValue: 'save-ratio'}) public mode: string;\n  @attr({dataAttr: true}) public src: string;\n  @attr({dataAttr: true}) public srcBase: string;\n\n  @attr({defaultValue: 'none'}) public lazy: 'auto' | 'manual' | 'none' | '';\n  @boolAttr() public lazyTriggered: boolean;\n\n  @boolAttr() public refreshOnUpdate: boolean;\n  @attr({defaultValue: 'inner-image'}) public innerImageClass: string;\n\n  @attr({defaultValue: null}) public containerClass: string | null;\n  @attr({defaultValue: '::parent'}) public containerClassTarget: string;\n  @attr({defaultValue: 'ready'}) public containerClassState: string;\n\n  @boolAttr({readonly: true}) public readonly ready: boolean;\n  @boolAttr({readonly: true}) public readonly loaded: boolean;\n  @boolAttr({readonly: true}) public readonly error: boolean;\n\n  private _strategy: ESLImageRenderStrategy | null;\n  private _innerImg: HTMLImageElement | null;\n  private _srcRules: ESLMediaRuleList<string>;\n  private _currentSrc: string;\n  private _detachLazyTrigger: () => void;\n  private _shadowImageElement: HTMLImageElement;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.alt =\n      this.alt || this.getAttribute('aria-label') || this.getAttribute('data-alt') || '';\n    this.updateA11y();\n    this.srcRules.addEventListener(this._onMediaMatchChange);\n    if (this.lazyObservable) {\n      this.removeAttribute('lazy-triggered');\n      getIObserver().observe(this);\n      this._detachLazyTrigger = function (): void {\n        getIObserver().unobserve(this);\n        this._detachLazyTrigger = null;\n      };\n    }\n    this.refresh();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._detachLazyTrigger && this._detachLazyTrigger();\n    if (this._srcRules) {\n      this._srcRules.removeEventListener(this._onMediaMatchChange);\n    }\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'aria-label':\n        this.alt = newVal || '';\n        break;\n      case 'alt':\n      case 'role':\n        this.updateA11y();\n        break;\n      case 'data-src':\n        this.srcRules = ESLMediaRuleList.parse(newVal);\n        this.refresh();\n        break;\n      case 'data-src-base':\n        this.refresh();\n        break;\n      case 'mode':\n        this.changeMode(oldVal, newVal);\n        break;\n      case 'lazy-triggered':\n        this.lazyTriggered && this.update();\n        break;\n    }\n  }\n\n  public get srcRules(): ESLMediaRuleList<string> {\n    if (!this._srcRules) {\n      this.srcRules = ESLMediaRuleList.parse(this.src);\n    }\n    return this._srcRules;\n  }\n\n  public set srcRules(rules: ESLMediaRuleList<string>) {\n    if (this._srcRules) {\n      this._srcRules.removeEventListener(this._onMediaMatchChange);\n    }\n    this._srcRules = rules;\n    this._srcRules.addEventListener(this._onMediaMatchChange);\n  }\n\n  public get currentSrc(): string {\n    return this._currentSrc;\n  }\n\n  public get empty(): boolean {\n    return !this._currentSrc || isEmptyImage(this._currentSrc);\n  }\n\n  public get canUpdate(): boolean {\n    return this.lazyTriggered || this.lazy === 'none';\n  }\n\n  public get lazyObservable(): boolean {\n    return this.lazy !== 'none' && this.lazy !== 'manual';\n  }\n\n  public get originalWidth(): number {\n    return this._shadowImageElement ? this._shadowImageElement.width : 0;\n  }\n\n  public get originalHeight(): number {\n    return this._shadowImageElement ? this._shadowImageElement.height : 0;\n  }\n\n  public triggerLoad(): void {\n    this.setAttribute('lazy-triggered', '');\n  }\n\n  protected changeMode(oldVal: string, newVal: string): void {\n    oldVal = oldVal || 'save-ratio';\n    newVal = newVal || 'save-ratio';\n    if (oldVal === newVal) return;\n    if (!STRATEGIES[newVal]) {\n      this.mode = oldVal;\n      throw new Error('ESL Image: Unsupported mode: ' + newVal);\n    }\n    this.clearImage();\n    if (this.loaded) this.syncImage();\n  }\n\n  protected update(force: boolean = false): void {\n    if (!this.canUpdate) return;\n\n    const src = this.getPath(this.srcRules.activeValue);\n\n    if (this._currentSrc !== src || !this.ready || force) {\n      this._currentSrc = src;\n      this._shadowImg.src = src;\n\n      if (this.refreshOnUpdate || !this.ready) {\n        this.syncImage();\n      }\n\n      if (this._shadowImg.complete) {\n        this._shadowImgError ? this._onError() : this._onLoad();\n      }\n    }\n\n    this._detachLazyTrigger && this._detachLazyTrigger();\n  }\n\n  protected updateA11y(): void {\n    const role = this.getAttribute('role') || 'img';\n    this.setAttribute('role', role);\n    this.innerImage && (this.innerImage.alt = this.alt);\n    if (role === 'img') this.setAttribute('aria-label', this.alt);\n  }\n\n  protected getPath(src: string | undefined): string {\n    if (!src || src === '0' || src === 'none') {\n      return ESLImage.EMPTY_IMAGE;\n    }\n    return this.srcBase + src;\n  }\n\n  public refresh(): void {\n    this.removeAttribute('loaded');\n    this.removeAttribute('ready');\n    this.updateContainerClasses();\n    this.clearImage();\n    this.update(true);\n  }\n\n  private syncImage(): void {\n    const strategy = STRATEGIES[this.mode];\n    this._strategy = strategy;\n    strategy && strategy.apply(this, this._shadowImg);\n  }\n\n  private clearImage(): void {\n    this._strategy && this._strategy.clear(this);\n    this._strategy = null;\n  }\n\n  public get innerImage(): HTMLImageElement | null {\n    return this._innerImg;\n  }\n\n  public attachInnerImage(): HTMLImageElement {\n    if (!this._innerImg) {\n      this._innerImg = this.querySelector(`img.${this.innerImageClass}`) ||\n        this._shadowImg.cloneNode() as HTMLImageElement;\n      this._innerImg.className = this.innerImageClass;\n    }\n    if (!this._innerImg.parentNode) {\n      this.appendChild(this._innerImg);\n    }\n    this._innerImg.alt = this.alt;\n    return this._innerImg;\n  }\n\n  public removeInnerImage(): void {\n    if (!this.innerImage) return;\n    this.removeChild(this.innerImage);\n    setTimeout(() => {\n      if (this._innerImg && !this._innerImg.parentNode) {\n        this._innerImg = null;\n      }\n    });\n  }\n\n  protected get _shadowImg(): HTMLImageElement {\n    if (!this._shadowImageElement) {\n      this._shadowImageElement = new Image();\n      this._shadowImageElement.onload = this._onLoad;\n      this._shadowImageElement.onerror = this._onError;\n    }\n    return this._shadowImageElement;\n  }\n\n  protected get _shadowImgError(): boolean {\n    if (!this._shadowImg.complete) return false;\n    if (this._shadowImg.src.slice(-4) === '.svg') return false;\n    return this._shadowImg.naturalHeight <= 0;\n  }\n\n  @bind\n  private _onLoad(): void {\n    this.syncImage();\n    this._onReadyState(true);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onError(): void {\n    this._onReadyState(false);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onMediaMatchChange(): void {\n    this.update();\n  }\n\n  private _onReadyState(successful: boolean): void {\n    if (this.ready) return;\n    this.toggleAttribute('loaded', successful);\n    this.toggleAttribute('error', !successful);\n    this.toggleAttribute('ready', true);\n\n    this.$$fire(successful ? this.LOAD_EVENT : this.ERROR_EVENT, {bubbles: false});\n    this.$$fire(this.READY_EVENT, {bubbles: false});\n  }\n\n  public updateContainerClasses(): void {\n    if (this.containerClass === null) return;\n    const cls = this.containerClass || (this.constructor as typeof ESLImage).DEFAULT_CONTAINER_CLS;\n    const state = isLoadState(this.containerClassState) && this[this.containerClassState];\n\n    const targetEl = ESLTraversingQuery.first(this.containerClassTarget, this) as HTMLElement;\n    targetEl && CSSClassUtils.toggle(targetEl, cls, state);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Image: typeof ESLImage;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-image': ESLImage;\n  }\n}\n","import {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst shortcuts = new Map<string, string | boolean>();\n\n/**\n * Static shortcuts preprocessor. Used to store device related shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('EnvShortcuts')\nexport class ESLEnvShortcuts {\n  // For debug purposes\n  private static readonly _shortcuts = shortcuts;\n\n  /**\n   * Add mapping\n   * @param shortcut - term to find in query\n   * @param value - media query string or boolean result (that represents `all` or `not all` conditions)\n   */\n  public static add(shortcut: string, value: string | boolean): void {\n    if (!['boolean', 'string'].includes(typeof value)) value = false;\n    shortcuts.set(shortcut.toLowerCase(), value);\n  }\n\n  /** Remove mapping for passed shortcut term */\n  public static remove(shortcut: string): boolean {\n    return shortcuts.delete(shortcut.toLowerCase());\n  }\n\n  /** Replaces shortcut to registered result */\n  public static process(match: string): string | boolean | undefined {\n    if (shortcuts.has(match)) return shortcuts.get(match);\n  }\n}\n\n// Touch check\nESLEnvShortcuts.add('touch', DeviceDetector.isTouchDevice);\n\n// Basic device type shortcuts\nESLEnvShortcuts.add('bot', DeviceDetector.isBot);\nESLEnvShortcuts.add('mobile', DeviceDetector.isMobile);\nESLEnvShortcuts.add('desktop', !DeviceDetector.isMobile);\nESLEnvShortcuts.add('android', DeviceDetector.isAndroid);\nESLEnvShortcuts.add('ios', DeviceDetector.isMobileIOS);\n\n// Basic browser shortcuts\nESLEnvShortcuts.add('ie', DeviceDetector.isIE);\nESLEnvShortcuts.add('edge', DeviceDetector.isEdgeHTML);\nESLEnvShortcuts.add('gecko', DeviceDetector.isGecko);\nESLEnvShortcuts.add('webkit', DeviceDetector.isWebkit);\nESLEnvShortcuts.add('blink', DeviceDetector.isBlink);\nESLEnvShortcuts.add('safari', DeviceDetector.isSafari);\nESLEnvShortcuts.add('safari-ios', DeviceDetector.isMobileSafari);\n\ndeclare global {\n  export interface ESLLibrary {\n    EnvShortcuts: typeof ESLEnvShortcuts;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst registry = new Map<string, ESLScreenBreakpoint>();\n\n/**\n * ESL Screen Breakpoints registry\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Screen Breakpoint registry is used to provide custom breakpoints for {@link ESLMediaQuery}\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenBreakpoints')\nexport abstract class ESLScreenBreakpoints {\n  protected static readonly BP_REGEXP = /^([+-]?)([a-z]+)/i;\n  protected static readonly BP_NAME_REGEXP = /^[a-z]+/i;\n\n  /**\n   * Add or replace breakpoint shortcut that can be used inside ESLMediaQuery\n   * @param name - name of shortcut\n   * @param minWidth - min width for breakpoint\n   * @param maxWidth - max width for breakpoint\n   */\n  public static add(name: string, minWidth: number, maxWidth: number): ESLScreenBreakpoint | undefined {\n    name = name.toLowerCase();\n    if (ESLScreenBreakpoints.BP_NAME_REGEXP.test(name)) {\n      const current = registry.get(name);\n      registry.set(name, new ESLScreenBreakpoint(name, minWidth, maxWidth));\n      return current;\n    }\n    throw new Error('The shortcut should consist only of Latin characters and be at least one character long.');\n  }\n\n  /** Removes screen breakpoint */\n  public static remove(name: string): boolean {\n    return registry.delete(name.toLowerCase());\n  }\n\n  /** @returns known breakpoint shortcut instance */\n  public static get(name: string): ESLScreenBreakpoint | undefined {\n    return registry.get((name || '').toLowerCase());\n  }\n\n  /** All available breakpoints names */\n  public static get names(): string[] {\n    const keys: string[] = [];\n    registry.forEach((value, key) => keys.push(key));\n    return keys;\n  }\n\n  /** @returns breakpoints shortcut replacement */\n  public static process(term: string): string | undefined {\n    const [, sign, bp] = term.match(ESLScreenBreakpoints.BP_REGEXP) || [];\n    const shortcut = ESLScreenBreakpoints.get(bp);\n    if (!shortcut) return;\n    if (sign === '+') return shortcut.mediaQueryGE;\n    if (sign === '-') return shortcut.mediaQueryLE;\n    return shortcut.mediaQuery;\n  }\n}\n\n/** ESL Screen Breakpoint description */\nexport class ESLScreenBreakpoint {\n  constructor(\n    public readonly name: string,\n    public readonly min: number,\n    public readonly max: number\n  ) {}\n\n  public get mediaQuery(): string {\n    return `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\n  }\n\n  public get mediaQueryGE(): string {\n    return `(min-width: ${this.min}px)`;\n  }\n\n  public get mediaQueryLE(): string {\n    return `(max-width: ${this.max}px)`;\n  }\n\n  public toString(): string {\n    return `[${this.name}]: ${this.min} to ${this.max}`;\n  }\n}\n\n// Defaults\nESLScreenBreakpoints.add('xs', 1, 767);\nESLScreenBreakpoints.add('sm', 768, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenBreakpoints: typeof ESLScreenBreakpoints;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\n\n/**\n * DPR preprocessor. Used to replace DPR shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenDPR')\nexport class ESLScreenDPR {\n  protected static readonly VALUE_REGEXP = /(\\d(\\.\\d)?)x/;\n\n  /** Option to exclude dpr greater then 2 for bots */\n  public static ignoreBotsDpr = false;\n\n  public static toDPI(dpr: number): string {\n    return (96 * dpr).toFixed(1);\n  }\n\n  public static process(match: string): string | undefined {\n    if (!ESLScreenDPR.VALUE_REGEXP.test(match)) return;\n    const dpr = parseFloat(match);\n    if (dpr < 0 || isNaN(dpr)) return;\n    if (ESLScreenDPR.ignoreBotsDpr && DeviceDetector.isBot && dpr > 1) return 'not all';\n    if (DeviceDetector.isSafari) return `(-webkit-min-device-pixel-ratio: ${dpr})`;\n    return `(min-resolution: ${ESLScreenDPR.toDPI(dpr)}dpi)`;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenDPR: typeof ESLScreenDPR;\n  }\n}\n","export interface IMediaQueryCondition extends EventTarget {\n  /** @returns true if current environment satisfies query */\n  matches: boolean;\n\n  /** @deprecated alias for `addEventListener` */\n  addListener(cb: EventListener): void;\n  /** Subscribes to media query state change. Shortcut for `addEventListener('change', callback)` */\n  addEventListener(callback: EventListener): void;\n  /** Subscribes to media query state change. Implements {@link EventTarget} interface */\n  addEventListener(type: 'change', callback: EventListener): void;\n\n  /** @deprecated alias for `removeEventListener` */\n  removeListener(cb: EventListener): void;\n  /** Unsubscribes from media query state change event. Shortcut for `removeEventListener('change', callback)` */\n  removeEventListener(callback: EventListener): void;\n  /** Unsubscribes from media query state change event. Implements {@link EventTarget} interface */\n  removeEventListener(type: 'change', callback: EventListener): void;\n\n  /** Optimize condition with nested hierarchy */\n  optimize(): IMediaQueryCondition;\n}\n\n/** Custom event dispatched by {@link ESLMediaQuery} instances */\nexport class ESLMediaChangeEvent extends Event {\n  /** `true` if the query is matched device conditions when event was dispatched */\n  public readonly matches: boolean;\n  public readonly target: IMediaQueryCondition;\n\n  constructor(matches: boolean) {\n    super('change');\n    this.matches = matches;\n  }\n\n  /** Returns serialized value of the current {@link ESLMediaQuery} */\n  public get media(): string {\n    return String(this.target);\n  }\n}\n","import {SyntheticEventTarget} from '../../../esl-utils/dom/events';\nimport {ALL, NOT_ALL} from './media-query-const';\nimport {ESLMediaChangeEvent} from './media-query-base';\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Simple media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Wraps matchMedia instance\n */\nexport class MediaQueryCondition extends SyntheticEventTarget implements IMediaQueryCondition {\n  protected readonly _inverted: boolean;\n  protected readonly _mq: MediaQueryList;\n\n  constructor(query: string, inverted = false) {\n    super();\n    this._inverted = inverted;\n    this._mq = matchMedia(query.trim() || 'all');\n    this._onChange = this._onChange.bind(this);\n  }\n\n  public get matches(): boolean {\n    return this._inverted ? !this._mq.matches : this._mq.matches;\n  }\n\n  public addEventListener(callback: EventListener): void;\n  public addEventListener(type: 'change', callback: EventListener): void;\n  public addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.hasEventListener(1)) return;\n    if (typeof this._mq.addEventListener === 'function') {\n      this._mq.addEventListener('change', this._onChange);\n    } else {\n      this._mq.addListener(this._onChange);\n    }\n  }\n\n  public removeEventListener(callback: EventListener): void;\n  public removeEventListener(type: 'change', callback: EventListener): void;\n  public removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    if (typeof this._mq.removeEventListener === 'function') {\n      this._mq.removeEventListener('change', this._onChange);\n    } else {\n      this._mq.removeListener(this._onChange);\n    }\n  }\n\n  /** Optimize query. Can simplify query to {@link MediaQueryConstCondition} */\n  public optimize(): IMediaQueryCondition {\n    if (ALL.eq(this)) return this._inverted ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(this)) return this._inverted ? ALL : NOT_ALL;\n    return this;\n  }\n\n  public toString(): string {\n    const query = this._mq.media;\n    const inverted = this._inverted;\n    const complex = inverted && /\\)[\\s\\w]+\\(/.test(query);\n    return (inverted ? 'not ' : '') + (complex ? `(${query})` : query);\n  }\n\n  /** Handles query change and dispatches it on top level in case result value is changed */\n  protected _onChange(): void {\n    this.dispatchEvent(new ESLMediaChangeEvent(this._mq.matches));\n  }\n}\n","import type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Const media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Ignores listeners always return the same result.\n * Have only two instances: {@link ALL} and {@link NOT_ALL}\n */\nclass MediaQueryConstCondition implements IMediaQueryCondition {\n  constructor(private readonly _matches: boolean) {}\n\n  public get matches(): boolean {\n    return this._matches;\n  }\n\n  public addListener(): void {}\n  public addEventListener(): void {}\n\n  public removeListener(): void {}\n  public removeEventListener(): void {}\n\n  public dispatchEvent(): boolean {\n    return false;\n  }\n\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n  public toString(): string {\n    return this._matches ? 'all' : 'not all';\n  }\n\n  /** Compares const media condition with the passed query instance or string */\n  public eq(val: IMediaQueryCondition | string): boolean {\n    return String(val).trim() === this.toString();\n  }\n}\n\nexport const ALL = new MediaQueryConstCondition(true);\nexport const NOT_ALL = new MediaQueryConstCondition(false);\n","import {SyntheticEventTarget} from '../../../esl-utils/dom/events';\nimport {ESLMediaChangeEvent} from './media-query-base';\nimport {ALL, NOT_ALL} from './media-query-const';\n\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Abstract multiple media conditions container\n * @author Alexey Stsefanovich (ala'n)\n *\n * Observe all child items. Dispatch changes when the whole condition result is changed\n */\nabstract class MediaQueryContainer extends SyntheticEventTarget implements IMediaQueryCondition {\n  protected _matches: boolean;\n\n  constructor(protected readonly items: IMediaQueryCondition[] = []) {\n    super();\n    this._matches = this.matches;\n    this._onChange = this._onChange.bind(this);\n  }\n\n  public addEventListener(callback: EventListener): void;\n  public addEventListener(type: 'change', callback: EventListener): void;\n  public addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.hasEventListener(1)) return;\n    this.items.forEach((item) => item.addEventListener('change', this._onChange));\n  }\n\n  public removeEventListener(callback: EventListener): void;\n  public removeEventListener(type: 'change', callback: EventListener): void;\n  public removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    this.items.forEach((item) => item.removeEventListener('change', this._onChange));\n  }\n\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n  public get matches(): boolean {\n    return false;\n  }\n\n  /** Handles query change and dispatches it on top level in case result value is changed */\n  protected _onChange(): void {\n    const {matches} = this;\n    if (this._matches ===  matches) return;\n    this.dispatchEvent(new ESLMediaChangeEvent(this._matches = matches));\n  }\n}\n\n/** Conjunction (AND) group of media conditions */\nexport class MediaQueryConjunction extends MediaQueryContainer {\n  public get matches(): boolean {\n    return this.items.every((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => NOT_ALL.eq(item))) return NOT_ALL;\n    const items = optimizedItems.filter((item) => !ALL.eq(item));\n    if (items.length === 0) return ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryConjunction(items);\n  }\n\n  public toString(): string {\n    return this.items.join(' and ');\n  }\n}\n\n/** Disjunction (OR) group of media conditions */\nexport class MediaQueryDisjunction extends MediaQueryContainer {\n  public get matches(): boolean {\n    return this.items.some((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => ALL.eq(item))) return ALL;\n    const items = optimizedItems.filter((item) => !NOT_ALL.eq(item));\n    if (items.length === 0) return NOT_ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryDisjunction(items);\n  }\n\n  public toString(pretty = false): string {\n    return this.items.join(pretty ? ' or ' : ', ');\n  }\n}\n","import {memoize} from '../../esl-utils/decorators';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\n\nimport {ESLScreenDPR} from './common/screen-dpr';\nimport {ESLScreenBreakpoints} from './common/screen-breakpoint';\nimport {ESLEnvShortcuts} from './common/env-shortcuts';\n\nimport {ALL, NOT_ALL} from './conditions/media-query-const';\nimport {MediaQueryCondition} from './conditions/media-query-condition';\nimport {MediaQueryConjunction, MediaQueryDisjunction} from './conditions/media-query-containers';\n\nimport type {IMediaQueryCondition} from './conditions/media-query-base';\n\nexport interface IMediaQueryPreprocessor {\n  process: (match: string) => string | boolean | undefined;\n}\n\n/**\n * ESL Media Query\n * @implements EventTarget\n * Provides special media condition syntax - ESLMediaQuery\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n *\n * Utility to support extended MediaQuery features\n * Supports\n * - CSS MediaQuery matching check\n * - DPR display queries (`@x1|@x2|@x3`)\n * - Registered screen default sizes (breakpoints) shortcuts (`@[-|+](XS|SM|MD|LG|XL)`)\n * - Device and browser shortcuts (`@MOBILE|@DESKTOP|@IE`)\n * - Custom static shortcuts and custom query preprocessors\n * - `not` logic operation (can have multiple not operators before any term of the query)\n * - `or` or `,` logical operator (have a lowest priority)\n * - Query matching change listeners\n * - Implements {@link EventTarget}, compatible with {@link ESLEventListener}\n *\n * Building query process:\n *\n * [Building query logical tree] - [preprocess nodes queries] - [building native MediaQueryList nodes] - [query tree optimization]\n */\n@ExportNs('MediaQuery')\nexport abstract class ESLMediaQuery implements IMediaQueryCondition {\n  /** Always true condition */\n  public static readonly ALL: ESLMediaQuery = ALL;\n  /** Always false condition */\n  public static readonly NOT_ALL: ESLMediaQuery = NOT_ALL;\n\n  protected static readonly SHORTCUT_PATTERN = /@([a-z0-9.+-]+)/i;\n  protected static readonly _preprocessors: IMediaQueryPreprocessor[] = [];\n\n  /** Adds {@link IMediaQueryPreprocessor} instance for query preprocessing step */\n  public static use(preprocessor: IMediaQueryPreprocessor): typeof ESLMediaQuery {\n    this._preprocessors.unshift(preprocessor);\n    return this;\n  }\n\n  /** Cached method to create {@link ESLMediaQuery} condition instance from query string */\n  @memoize()\n  public static for(query: string): ESLMediaQuery {\n    return ESLMediaQuery.from(query);\n  }\n\n  /** Creates {@link ESLMediaQuery} condition instance from query string */\n  public static from(query: string): ESLMediaQuery {\n    const conjunctions = query.split(/\\sor\\s|,/).map((term) => {\n      const conditions = term.split(/\\sand\\s/).map(ESLMediaQuery.parseSimpleQuery);\n      return new MediaQueryConjunction(conditions);\n    });\n    return new MediaQueryDisjunction(conjunctions).optimize();\n  }\n\n  /** Preprocess simple query term by applying replacers and shortcuts rules */\n  protected static preprocess(term: string): string {\n    if (!this.SHORTCUT_PATTERN.test(term)) return term;\n    const shortcut = term.trim().substring(1).toLowerCase();\n    for (const replacer of this._preprocessors) {\n      const result = replacer.process(shortcut);\n      if (typeof result === 'string') return result;\n      if (typeof result === 'boolean') return result ? 'all' : 'not all';\n    }\n    return term;\n  }\n\n  /** Creates simple {@link ESLMediaQuery} condition */\n  protected static parseSimpleQuery(term: string): ESLMediaQuery {\n    const query = term.replace(/^\\s*not\\s+/, '');\n    const queryInverted = query !== term;\n    const processedQuery = ESLMediaQuery.preprocess(query);\n    const sanitizedQuery = processedQuery.replace(/^\\s*not\\s+/, '');\n    const resultInverted = processedQuery !== sanitizedQuery;\n    const invert = queryInverted !== resultInverted;\n\n    if (ALL.eq(sanitizedQuery)) return invert ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(sanitizedQuery)) return invert ? ALL : NOT_ALL;\n    return new MediaQueryCondition(sanitizedQuery, invert);\n  }\n\n  // Implements IESLMQCondition to allow use ESLMediaQuery as IESLMQCondition type alias\n  public abstract matches: boolean;\n\n  public abstract optimize(): ESLMediaQuery;\n  public abstract dispatchEvent(event: Event): boolean;\n  public abstract toString(): string;\n\n  public abstract addEventListener(callback: EventListener): void;\n  public abstract addEventListener(type: 'change', callback: EventListener): void;\n  public abstract removeEventListener(callback: EventListener): void;\n  public abstract removeEventListener(type: 'change', callback: EventListener): void;\n\n  /** @deprecated alias for `addEventListener` */\n  public abstract addListener(cb: EventListener): void;\n  /** @deprecated alias for `removeEventListener` */\n  public abstract removeListener(cb: EventListener): void;\n}\n\n// Register otb preprocessors\nESLMediaQuery.use(ESLScreenDPR);\nESLMediaQuery.use(ESLScreenBreakpoints);\nESLMediaQuery.use(ESLEnvShortcuts);\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaQuery: typeof ESLMediaQuery;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {evaluate} from '../../esl-utils/misc/format';\nimport {deepMerge, isEqual} from '../../esl-utils/misc/object';\nimport {SyntheticEventTarget} from '../../esl-utils/dom/events';\nimport {ESLMediaRule} from './esl-media-rule';\n\nimport type {RulePayloadParser} from './esl-media-rule';\n\n/** Custom event dispatched by {@link ESLMediaRuleList} instances */\nexport class ESLMediaRuleListEvent<T = any> extends Event {\n  /** Current value of target {@link ESLMediaRuleList} instances */\n  public readonly current: T;\n  /** Previous value of target {@link ESLMediaRuleList} instances */\n  public readonly previous: T;\n  /** Target {@link ESLMediaRuleList} instances */\n  public readonly target: ESLMediaRuleList<T>;\n\n  constructor(current: T, previous: T) {\n    super('change');\n    Object.assign(this, {current, previous});\n  }\n}\n\n/**\n * ESLMediaRuleList - {@link ESLMediaRule} observable collection\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Represents observable object that wraps environment to value mapping\n */\n@ExportNs('MediaRuleList')\nexport class ESLMediaRuleList<T = any> extends SyntheticEventTarget {\n  /** String value parser (default) */\n  public static STRING_PARSER: RulePayloadParser<string> = String;\n  /** Object value parser. Uses {@link evaluate} to parse value */\n  public static OBJECT_PARSER = <U = any>(val: string): U | undefined => evaluate(val);\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Expect serialized {@link ESLMediaRule}s separated by '|'\n   * Uses exact strings as rule list values\n   *\n   * @param query - query string\n   */\n  public static parse(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation.\n   * Expect serialized {@link ESLMediaRule}s separated by '|'\n   *\n   * @param query - query string\n   * @param parser - value parser function\n   */\n  public static parse<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parse('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5')\n   * ```\n   */\n  public static parse(mask: string, values: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   * @param parser - value parser function\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5', Number)\n   * ```\n   */\n  public static parse<U>(mask: string, values: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parse(query: string, ...common: (string | RulePayloadParser<any>)[]): ESLMediaRuleList {\n    const parser: RulePayloadParser<any> = typeof common[common.length - 1] === 'function' ? common.pop() as any : String;\n    const value = common.pop();\n    return typeof value === 'string' ?\n      ESLMediaRuleList.parseTuple(query, value, parser) :\n      ESLMediaRuleList.parseQuery(query, parser);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Uses exact strings as rule list values\n   * @param query - query string\n   */\n  public static parseQuery(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * @param query - query string\n   * @param parser - value parser function\n   */\n  public static parseQuery<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parseQuery(query: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const rules = query.split('|')\n      .map((lex: string) => ESLMediaRule.parse(lex, parser))\n      .filter((rule: ESLMediaRule) => !!rule) as ESLMediaRule[];\n    return new ESLMediaRuleList(rules);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5')\n   * ```\n   */\n  public static parseTuple(mask: string, values: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   * @param parser - value parser function\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple(@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5', Number)\n   * ```\n   */\n  public static parseTuple<U>(mask: string, values: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parseTuple(mask: string, values: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const queries = mask.split('|');\n    const valueList = values.split('|');\n    while (valueList.length < queries.length && valueList.length !== 0) valueList.push(valueList[valueList.length - 1]);\n    if (valueList.length !== queries.length) throw Error('Value doesn\\'t correspond to mask');\n    const rules: (ESLMediaRule | undefined)[] = queries.map((query, i) => ESLMediaRule.create(valueList[i], query, parser));\n    const validRules = rules.filter((rule) => !!rule) as ESLMediaRule[];\n    return new ESLMediaRuleList(validRules);\n  }\n\n  protected _value: T | undefined;\n  protected readonly _rules: ESLMediaRule<T>[];\n\n  private constructor(rules: ESLMediaRule<T>[]) {\n    super();\n    this._rules = rules;\n    this._onMatchChanged = this._onMatchChanged.bind(this);\n  }\n\n  /** Subscribes to the instance active rule change */\n  public addEventListener(callback: EventListener): void;\n  public addEventListener(type: 'change', callback: EventListener): void;\n  public addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.hasEventListener(1)) return;\n    this._value = this.computedValue;\n    this.rules.forEach((rule) => rule.addEventListener(this._onMatchChanged));\n  }\n\n  /** Unsubscribes from the instance active rule change */\n  public removeEventListener(callback: EventListener): void;\n  public removeEventListener(type: 'change', callback: EventListener): void;\n  public removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    delete this._value;\n    this.rules.forEach((rule) => rule.removeEventListener(this._onMatchChanged));\n  }\n\n  /** Array of {@link ESLMediaRule}s that forms the current {@link ESLMediaRuleList} */\n  public get rules(): ESLMediaRule<T>[] {\n    return this._rules;\n  }\n\n  /** All active {@link ESLMediaRule}s */\n  public get active(): ESLMediaRule<T>[] {\n    return this.rules.filter((rule) => rule.matches);\n  }\n  /** Value of the last of active rules */\n  public get activeValue(): T | undefined {\n    return this.active.pop()?.payload;\n  }\n  /** All active rule values */\n  public get activeValues(): T[] {\n    return this.active.map((rule) => rule.payload);\n  }\n\n  /**\n   * Current value of {@link ESLMediaRuleList} object\n   * Uses cache if current object is under observation\n   */\n  public get value(): T | undefined {\n    if (!this.hasEventListener()) return this.computedValue;\n    return Object.hasOwnProperty.call(this, '_value') ? this._value : this.computedValue;\n  }\n  /** Always computed value of the current {@link ESLMediaRuleList} object */\n  public get computedValue(): T | undefined {\n    return deepMerge(undefined, ...this.activeValues);\n  }\n\n  /** Handles inner rules state change */\n  private _onMatchChanged(): void {\n    const curValue = this.value;\n    const newValue = this.computedValue;\n    if (isEqual(curValue, newValue)) return;\n    this._value = newValue;\n    this.dispatchEvent(new ESLMediaRuleListEvent(newValue, curValue));\n  }\n\n  /** @returns serialized {@link ESLMediaRuleList} object representation*/\n  public toString(): string {\n    return this.rules.join('|');\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaRuleList: typeof ESLMediaRuleList;\n  }\n}\n","import {ESLMediaQuery} from './esl-media-query';\n\nexport type RulePayloadParser<T> = (val: string) => T | undefined;\n\n/**\n * ESL Media Rule\n * @author Yuliya Adamskaya\n *\n * Helper class to wrap {@link ESLMediaQuery} with the payload value\n * @see ESLMediaQuery\n * @see ESLMediaRuleList\n */\nexport class ESLMediaRule<T = any> {\n  public readonly query: ESLMediaQuery;\n  public readonly payload: T;\n\n  constructor(payload: T, query: string = '') {\n    this.query = ESLMediaQuery.for(query);\n    this.payload = payload;\n  }\n\n  /** @returns if the inner {@link ESLMediaQuery} is matching current device configuration */\n  public get matches(): boolean {\n    return this.query.matches;\n  }\n\n  /** Subscribes on inner {@link ESLMediaQuery} changes */\n  public addEventListener(callback: EventListener): void;\n  public addEventListener(type: 'change', callback: EventListener): void;\n  public addEventListener(type: any, callback: EventListener = type): void {\n    this.query.addEventListener(callback);\n  }\n\n  /** Unsubscribes from inner {@link ESLMediaQuery} changes */\n  public removeEventListener(callback: EventListener): void;\n  public removeEventListener(type: 'change', callback: EventListener): void;\n  public removeEventListener(type: any, callback: EventListener = type): void {\n    this.query.removeEventListener(callback);\n  }\n\n  public toString(): string {\n    const val = typeof this.payload === 'object' ?\n      JSON.stringify(this.payload) :\n      String(this.payload);\n    return `${this.query} => ${val}`;\n  }\n\n  /**\n   * Creates the {@link ESLMediaRule} instance from payload string, query and valueParser.\n   * If the payload parse result is undefined then rule will be undefined.\n   */\n  public static create<U>(payload: string, query: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const payloadValue = parser(payload.trim());\n    if (typeof payloadValue === 'undefined') return undefined;\n    return new ESLMediaRule<U>(payloadValue, query.trim());\n  }\n\n  /** Parses the rule string to the {@link ESLMediaRule} instance */\n  public static parse<U>(lex: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const parts = lex.split('=>');\n    const query = parts.length === 2 ? parts[0] : '';\n    const payload = parts.length === 2 ? parts[1] : parts[0];\n    return ESLMediaRule.create(payload, query, parser);\n  }\n\n  /** Shortcut to create always active {@link ESLMediaRule} with passed value */\n  public static all<U>(payload: U): ESLMediaRule<U> {\n    return new ESLMediaRule<U>(payload, 'all');\n  }\n  /** Shortcut to create always inactive {@link ESLMediaRule} */\n  public static empty(): ESLMediaRule<undefined> {\n    return new ESLMediaRule(undefined, 'all');\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable, at least global\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable, at least global\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Media Play-In-Viewport IntersectionObserver instance */\nexport function getIObserver(lazy: boolean = false): IntersectionObserver {\n  if (!iObserver && !lazy) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const video = entry.target as ESLMedia;\n\n  // Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\n  if (video.active && entry.intersectionRatio <= RATIO_TO_DEACTIVATE) {\n    video.pause();\n  }\n  // Play should start only for inactive and background(muted) videos that are visible more than on RATIO_TO_ACTIVATE\n  if (!video.active && video.autoplay && entry.intersectionRatio >= RATIO_TO_ACTIVATE) {\n    video.play();\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst managerMap = new Map<string, ESLMedia>();\n\n/**\n * Group restriction manager for {@link ESLMedia}\n * Only one media in group can be played\n * Empty group is ignored\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\nexport class MediaGroupRestrictionManager {\n  /** @internal */\n  static get managerMap(): Map<string, ESLMedia> {\n    return managerMap;\n  }\n\n  /** Register instance play state in group */\n  public static registerPlay(instance: ESLMedia): void {\n    if (instance.group) {\n      const current = managerMap.get(instance.group);\n      managerMap.set(instance.group, instance);\n      if (!current || current === instance || !current.active) return;\n      if (current.$$fire(current.MANAGED_PAUSE_EVENT)) current.pause();\n    }\n  }\n\n  /** Unregister instance */\n  public static unregister(instance: ESLMedia): void {\n    if (instance.group) {\n      const reg = managerMap.get(instance.group);\n      if (reg === instance) managerMap.delete(instance.group);\n    }\n  }\n}\n","import {ESLMediaProviderRegistry} from './esl-media-registry';\n\nimport type {ESLMedia} from './esl-media';\n\nexport enum PlayerStates {\n  BUFFERING = 3,\n  ENDED = 0,\n  PAUSED = 2,\n  PLAYING = 1,\n  UNSTARTED = -1,\n  VIDEO_CUED = 5,\n  UNINITIALIZED = -2\n}\n\nexport interface MediaProviderConfig {\n  mediaSrc?: string;\n  mediaId?: string;\n  loop: boolean;\n  muted: boolean;\n  controls: boolean;\n  autoplay: boolean;\n  title: string;\n  preload?: 'none' | 'metadata' | 'auto' | '';\n  playsinline?: boolean;\n}\n\nexport type ProviderType = (new(component: ESLMedia, config: MediaProviderConfig) => BaseProvider) & typeof BaseProvider;\n\nexport type ProviderObservedParams = 'loop' | 'muted' | 'controls';\n\n/**\n * BaseProvider class for media API providers\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n */\nexport abstract class BaseProvider {\n  static readonly providerName: string;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    return null;\n  }\n  static parseConfig(component: ESLMedia): MediaProviderConfig {\n    const {loop, muted, controls, autoplay, title, preload, playsinline, mediaId, mediaSrc} = component;\n    const config = {loop, muted, controls, autoplay, title, preload, playsinline};\n    if (mediaId) Object.assign(config, {mediaId});\n    if (mediaSrc) Object.assign(config, {mediaSrc});\n    return config;\n  }\n\n  protected config: MediaProviderConfig;\n  protected component: ESLMedia;\n  protected _el: HTMLElement;\n  protected _ready: Promise<any>;\n\n  public constructor(component: ESLMedia, config: MediaProviderConfig) {\n    this.config = config;\n    this.component = component;\n  }\n\n  /** Wraps _ready promise */\n  get ready(): Promise<any> {\n    if (!this._ready) {\n      const res = Promise.reject('Not Initialized');\n      res.catch((e) => console.log('Rejected Media Operation: ', e));\n      return res;\n    }\n    return this._ready;\n  }\n\n  /** Bind the provider instance to the component */\n  public abstract bind(): void;\n\n  /** Unbind the provider instance from the component */\n  public unbind(): void {\n    Array.from(this.component.querySelectorAll('.esl-media-inner'))\n      .forEach((el: Node) => el.parentNode && el.parentNode.removeChild(el));\n  }\n\n  /** Provider name */\n  public get name(): string {\n    return (this.constructor as typeof BaseProvider).providerName;\n  }\n\n  /** @returns current state of the player */\n  public abstract get state(): PlayerStates;\n\n  /** @returns recommended aspect ratio */\n  public abstract get defaultAspectRatio(): number;\n\n  /** @returns resource duration */\n  public abstract get duration(): number;\n\n  /** @returns resource current time */\n  public abstract get currentTime(): number;\n\n  /** Low-level provider 'seek to' method implementation */\n  protected abstract seekTo(pos?: number): void | Promise<any>;\n\n  /** Low-level provider 'play' method implementation */\n  protected abstract play(): void | Promise<any>;\n\n  /** Low-level provider 'pause' method implementation */\n  protected abstract pause(): void | Promise<any>;\n\n  /** Low-level provider 'stop' method implementation */\n  protected abstract stop(): void | Promise<any>;\n\n  /** Set focus to the inner content */\n  public focus(): void {\n    this._el?.focus();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.config[param] = value;\n  }\n\n  /** Set size for inner content */\n  public setSize(width: number | 'auto', height: number | 'auto'): void {\n    if (!this._el) return;\n    this._el.style.setProperty('width', width === 'auto' ? null : `${width}px`);\n    this._el.style.setProperty('height', height === 'auto' ? null : `${height}px`);\n  }\n\n  /**\n   * Executes toggle action:\n   * If the player is PAUSED then it starts playing otherwise it pause playing\n   */\n  protected toggle(): void | Promise<any> {\n    if ([PlayerStates.PAUSED, PlayerStates.UNSTARTED, PlayerStates.VIDEO_CUED].includes(this.state)) {\n      return this.play();\n    } else {\n      return this.pause();\n    }\n  }\n\n  /** Executes onConfigChange action when api is ready */\n  public onSafeConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.ready.then(() => this.onConfigChange(param, value));\n  }\n\n  /** Executes seekTo action when api is ready */\n  public safeSeekTo(pos: number): Promise<void> {\n    return this.ready.then(() => this.seekTo(pos));\n  }\n\n  /** Executes play when api is ready */\n  public safePlay(): Promise<void> {\n    return this.ready.then(() => this.play());\n  }\n\n  /** Executes pause when api is ready */\n  public safePause(): Promise<void> {\n    return this.ready.then(() => this.pause());\n  }\n\n  /**\n   * Executes stop when api is ready\n   * @returns Promise\n   */\n  public safeStop(): Promise<void> {\n    return this.ready.then(() => this.stop());\n  }\n\n  /**\n   * Executes toggle when api is ready\n   * @returns Promise\n   */\n  public safeToggle(): Promise<void> {\n    return this.ready.then(() => this.toggle());\n  }\n\n  /**\n   * Register current provider.\n   * Can be used as a decorator.\n   */\n  public static register(this: ProviderType): void;\n  public static register(this: unknown, provider?: ProviderType): void;\n  public static register(this: any, provider?: ProviderType): void {\n    provider = provider || this;\n    if (provider === BaseProvider) throw new Error('`BaseProvider` can\\'t be registered.');\n    if (!(provider?.prototype instanceof BaseProvider)) throw new Error('Provider should be instanceof `BaseProvider`');\n    ESLMediaProviderRegistry.instance.register(provider);\n  }\n}\n","import {Observable} from '../../esl-utils/abstract/observable';\nimport type {BaseProvider, ProviderType} from './esl-media-provider';\n\nimport type {ESLMedia} from './esl-media';\n\nlet evRegistryInstance: ESLMediaProviderRegistry | null = null;\n/**\n * ESLMediaProviderRegistry class to store media API providers\n * @author Yuliya Adamskaya, Natallia Harshunova\n */\nexport class ESLMediaProviderRegistry extends Observable<(name: string, provider: ProviderType) => void> {\n  private providersMap: Map<string, ProviderType> = new Map();\n\n  public static get instance(): ESLMediaProviderRegistry {\n    if (!evRegistryInstance) {\n      evRegistryInstance = new ESLMediaProviderRegistry();\n    }\n    return evRegistryInstance;\n  }\n\n  /** List of registered providers */\n  public get providers(): ProviderType[] {\n    const list: ProviderType[] = [];\n    this.providersMap.forEach((provider) => list.push(provider));\n    return list;\n  }\n\n  /** Register provider */\n  public register(provider: ProviderType): void {\n    if (!provider.providerName) throw new Error('Provider should have a name');\n    this.providersMap.set(provider.providerName, provider);\n    this.fire(provider.providerName, provider);\n  }\n\n  /** Check that provider is registered for passed name */\n  public has(name: string): boolean {\n    return this.providersMap.has(name);\n  }\n\n  /** Find provider by name */\n  public findByName(name: string): ProviderType | null {\n    if (!name || name === 'auto') return null;\n    return this.providersMap.get(name.toLowerCase()) || null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance */\n  public createFor(media: ESLMedia): BaseProvider | null {\n    return this.createByType(media) || this.createBySrc(media);\n  }\n\n  /** Create provider instance for passed ESLMedia instance via provider name */\n  private createByType(media: ESLMedia): BaseProvider | null {\n    const provider = this.findByName(media.mediaType);\n    return provider ? ESLMediaProviderRegistry._create(provider, media) : null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance via url */\n  private createBySrc(media: ESLMedia): BaseProvider | null {\n    for (const provider of this.providers.reverse()) {\n      const cfg = provider.parseUrl(media.mediaSrc);\n      if (cfg) return ESLMediaProviderRegistry._create(provider, media, cfg);\n    }\n    return null;\n  }\n\n  /** Create provider instance for passed configuration */\n  private static _create(provider: ProviderType, media: ESLMedia, cfg = provider.parseUrl(media.mediaSrc)): BaseProvider {\n    const config = Object.assign({}, cfg || {}, provider.parseConfig(media));\n    return new provider(media, config);\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind, prop, attr, boolAttr} from '../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {parseAspectRatio} from '../../esl-utils/misc/format';\n\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport {SPACE, PAUSE} from '../../esl-utils/dom/keys';\nimport {getIObserver} from './esl-media-iobserver';\nimport {PlayerStates} from './esl-media-provider';\nimport {ESLMediaProviderRegistry} from './esl-media-registry';\nimport {MediaGroupRestrictionManager} from './esl-media-manager';\n\nimport type {BaseProvider} from './esl-media-provider';\n\nexport type ESLMediaFillMode = 'cover' | 'inscribe' | '';\n\n/**\n * ESLMedia - custom element, that provides an ability to add and configure media (video / audio)\n * using a single tag as well as work with external providers using simple native-like API.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Media')\nexport class ESLMedia extends ESLBaseElement {\n  public static is = 'esl-media';\n  public static observedAttributes = [\n    'disabled',\n    'load-condition',\n    'media-type',\n    'media-id',\n    'media-src',\n    'fill-mode',\n    'aspect-ratio',\n    'play-in-viewport',\n    'muted',\n    'loop',\n    'controls'\n  ];\n\n  /** Event to dispatch on ready state */\n  @prop('esl:media:ready') public READY_EVENT: string;\n  /** Event to dispatch on error state */\n  @prop('esl:media:error') public ERROR_EVENT: string;\n  /** Event to dispatch when player plays */\n  @prop('esl:media:play') public PLAY_EVENT: string;\n  /** Event to dispatch when player paused */\n  @prop('esl:media:paused') public PAUSED_EVENT: string;\n  /** Event to dispatch when player ended */\n  @prop('esl:media:ended') public ENDED_EVENT: string;\n  /** Event to dispatch when player detached */\n  @prop('esl:media:detached') public DETACHED_EVENT: string;\n  /** Event to dispatch when player paused by another instance in group */\n  @prop('esl:media:managedpause') public MANAGED_PAUSE_EVENT: string;\n\n  /** Media resource identifier */\n  @attr() public mediaId: string;\n  /** Media resource src/url path */\n  @attr() public mediaSrc: string;\n  /** Media resource type. 'auto' (auto detection from src) by default */\n  @attr() public mediaType: string;\n\n  /** Media elements group name */\n  @attr() public group: string;\n  /** Media resource rendering strategy relative to the element area: 'cover', 'inscribe' or not defined */\n  @attr() public fillMode: ESLMediaFillMode;\n  /** Strict aspect ratio definition */\n  @attr() public aspectRatio: string;\n\n\n  /** Disabled marker to prevent rendering */\n  @boolAttr() public disabled: boolean;\n  /** Autoplay resource marker */\n  @boolAttr() public autoplay: boolean;\n  /** Autofocus on play marker */\n  @boolAttr() public autofocus: boolean;\n  /** Mute resource marker */\n  @boolAttr() public muted: boolean;\n  /** Loop resource play */\n  @boolAttr() public loop: boolean;\n  /** Marker to show controls for resource player */\n  @boolAttr() public controls: boolean;\n  /** Allow media to play inline (see HTML video/audio spec) */\n  @boolAttr() public playsinline: boolean;\n  /** Allows play resource only in viewport area */\n  @boolAttr() public playInViewport: boolean;\n\n  /** Preload resource */\n  @attr({defaultValue: 'auto'}) public preload: 'none' | 'metadata' | 'auto' | '';\n\n  /** Ready state class/classes */\n  @attr() public readyClass: string;\n  /** Ready state class/classes target */\n  @attr() public readyClassTarget: string;\n\n  /** Class / classes to add when media is accepted */\n  @attr() public loadClsAccepted: string;\n  /** Class / classes to add when media is declined */\n  @attr() public loadClsDeclined: string;\n  /** Condition {@link ESLMediaQuery} to allow load of media resource. Default: `all` */\n  @attr({defaultValue: 'all'}) public loadCondition: string;\n  /** Target element {@link ESLTraversingQuery} select to add accepted/declined classes */\n  @attr({defaultValue: '::parent'}) public loadClsTarget: string;\n\n  /** @readonly Ready state marker */\n  @boolAttr({readonly: true}) public ready: boolean;\n  /** @readonly Active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n  /** @readonly Resource played marker */\n  @boolAttr({readonly: true}) public played: boolean;\n  /** @readonly Error state marker */\n  @boolAttr({readonly: true}) public error: boolean;\n\n  private _provider: BaseProvider | null;\n\n  private deferredResize = rafDecorator(() => this._onResize());\n  private deferredReinitialize = debounce(() => this.reinitInstance());\n\n  /**\n   * Map object with possible Player States, values:\n   * BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\n   */\n  static get PLAYER_STATES(): typeof PlayerStates {\n    return PlayerStates;\n  }\n\n  static supports(name: string): boolean {\n    return ESLMediaProviderRegistry.instance.has(name);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'application');\n    }\n    this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\n    this.bindEvents();\n    this.attachViewportConstraint();\n    this.deferredReinitialize();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this.detachViewportConstraint();\n    this._provider && this._provider.unbind();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'disabled':\n      case 'media-id':\n      case 'media-src':\n      case 'media-type':\n        this.deferredReinitialize();\n        break;\n      case 'loop':\n      case 'muted':\n      case 'controls':\n        this._provider && this._provider.onSafeConfigChange(attrName, newVal !== null);\n        break;\n      case 'fill-mode':\n      case 'aspect-ratio':\n        this.deferredResize();\n        break;\n      case 'play-in-viewport':\n        this.playInViewport ?\n          this.attachViewportConstraint() :\n          this.detachViewportConstraint();\n        break;\n      case 'load-condition':\n        ESLMediaQuery.for(oldVal).removeEventListener(this.deferredReinitialize);\n        ESLMediaQuery.for(newVal).addEventListener(this.deferredReinitialize);\n        this.deferredReinitialize();\n        break;\n    }\n  }\n\n  protected bindEvents(): void {\n    ESLMediaProviderRegistry.instance.addListener(this._onRegistryStateChange);\n    this.conditionQuery.addEventListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.addEventListener('resize', this.deferredResize);\n    }\n    window.addEventListener(this.REFRESH_EVENT, this._onRefresh);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents(): void {\n    ESLMediaProviderRegistry.instance.removeListener(this._onRegistryStateChange);\n    this.conditionQuery.removeEventListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.removeEventListener('resize', this.deferredResize);\n    }\n    window.removeEventListener(this.REFRESH_EVENT, this._onRefresh);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  public canActivate(): boolean {\n    if (this.disabled) return false;\n    return this.conditionQuery.matches;\n  }\n\n  private reinitInstance(): void {\n    console.debug('[ESL] Media reinitialize ', this);\n    this._provider && this._provider.unbind();\n    this._provider = null;\n\n    if (this.canActivate()) {\n      this._provider = ESLMediaProviderRegistry.instance.createFor(this);\n      if (this._provider) {\n        this._provider.bind();\n        console.debug('[ESL] Media provider bound', this._provider);\n      } else {\n        this._onError();\n      }\n    }\n\n    this.updateContainerMarkers();\n  }\n\n  public updateContainerMarkers(): void {\n    const targetEl = ESLTraversingQuery.first(this.loadClsTarget, this) as HTMLElement;\n    if (!targetEl) return;\n\n    const active = this.canActivate();\n    CSSClassUtils.toggle(targetEl, this.loadClsAccepted, active);\n    CSSClassUtils.toggle(targetEl, this.loadClsDeclined, !active);\n  }\n\n  /** Seek to given position of media */\n  public seekTo(pos: number): Promise<void> | null {\n    return this._provider && this._provider.safeSeekTo(pos);\n  }\n\n  /**\n   * Start playing media\n   * @param allowActivate - allows to remove disabled marker\n   */\n  public play(allowActivate: boolean = false): Promise<void> | null {\n    if (this.disabled && allowActivate) {\n      this.disabled = false;\n      this.deferredReinitialize.cancel();\n      this.reinitInstance();\n    }\n    if (!this.canActivate()) return null;\n    return this._provider && this._provider.safePlay();\n  }\n\n  /** Pause playing media */\n  public pause(): Promise<void> | null {\n    return this._provider && this._provider.safePause();\n  }\n\n  /** Stop playing media */\n  public stop(): Promise<void> | null {\n    return this._provider && this._provider.safeStop();\n  }\n\n  /** Toggle play/pause state of the media */\n  public toggle(): Promise<void> | null {\n    return this._provider && this._provider.safeToggle();\n  }\n\n  /** Focus inner player **/\n  public focusPlayer(): void {\n    this._provider && this._provider.focus();\n  }\n\n  // media live-cycle handlers\n  public _onReady(): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', false);\n    this.updateReadyClass();\n    this.deferredResize();\n    this.$$fire(this.READY_EVENT);\n  }\n\n  public _onError(detail?: any, setReadyState = true): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', true);\n    this.$$fire(this.ERROR_EVENT, {detail});\n    setReadyState && this.$$fire(this.READY_EVENT);\n  }\n\n  public _onDetach(): void {\n    this.removeAttribute('active');\n    this.removeAttribute('ready');\n    this.removeAttribute('played');\n    this.updateReadyClass();\n    this.$$fire(this.DETACHED_EVENT);\n  }\n\n  public _onPlay(): void {\n    if (this.autofocus) this.focus();\n    this.deferredResize();\n    this.setAttribute('active', '');\n    this.setAttribute('played', '');\n    this.$$fire(this.PLAY_EVENT);\n    MediaGroupRestrictionManager.registerPlay(this);\n  }\n\n  public _onPaused(): void {\n    this.removeAttribute('active');\n    this.$$fire(this.PAUSED_EVENT);\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onEnded(): void {\n    this.removeAttribute('active');\n    this.$$fire(this.ENDED_EVENT);\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onResize(): void {\n    if (!this._provider) return;\n    if (this.fillModeEnabled && this.actualAspectRatio > 0) {\n      let stretchVertically = this.offsetWidth / this.offsetHeight < this.actualAspectRatio;\n      if (this.fillMode === 'inscribe') stretchVertically = !stretchVertically; // Inscribe behaves inversely\n      stretchVertically ?\n        this._provider.setSize(this.actualAspectRatio * this.offsetHeight, this.offsetHeight) : // h\n        this._provider.setSize(this.offsetWidth, this.offsetWidth / this.actualAspectRatio);   // w\n    } else {\n      this._provider.setSize('auto', 'auto');\n    }\n  }\n\n  @bind\n  protected _onRefresh(e: Event): void {\n    const {target} = e;\n    if (target instanceof HTMLElement && target.contains(this)) {\n      this._onResize();\n    }\n  }\n\n  @bind\n  protected _onRegistryStateChange(name: string): void {\n    const type = this.mediaType.toLowerCase() || 'auto';\n    if (name === type || (!this.providerType && type === 'auto')) {\n      this.reinitInstance();\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    if (e.target !== this) return;\n    if ([SPACE, PAUSE].includes(e.key)) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.toggle();\n    }\n  }\n\n  /** Update ready class state */\n  protected updateReadyClass(): void {\n    const target = ESLTraversingQuery.first(this.readyClassTarget, this) as HTMLElement;\n    target && CSSClassUtils.toggle(target, this.readyClass, this.ready);\n  }\n\n  /** Applied provider */\n  public get providerType(): string {\n    return this._provider ? this._provider.name : '';\n  }\n\n  /** Current player state, see {@link ESLMedia.PLAYER_STATES} values */\n  public get state(): PlayerStates {\n    return this._provider ? this._provider.state : PlayerStates.UNINITIALIZED;\n  }\n\n  /** Duration of the media resource */\n  public get duration(): number {\n    return this._provider ? this._provider.duration : 0;\n  }\n\n  /** Current time of media resource */\n  public get currentTime(): number {\n    return this._provider ? this._provider.currentTime : 0;\n  }\n\n  /** Set current time of media resource */\n  public set currentTime(time: number) {\n    (this._provider) && this._provider.safeSeekTo(time);\n  }\n\n  /** ESLMediaQuery to limit ESLMedia loading */\n  public get conditionQuery(): ESLMediaQuery {\n    return ESLMediaQuery.for(this.loadCondition);\n  }\n\n  /** Fill mode should be handled for element */\n  public get fillModeEnabled(): boolean {\n    return this.fillMode === 'cover' || this.fillMode === 'inscribe';\n  }\n\n  /** Used resource aspect ratio forced by attribute or returned by provider */\n  public get actualAspectRatio(): number {\n    if (this.aspectRatio && this.aspectRatio !== 'auto') return parseAspectRatio(this.aspectRatio);\n    return this._provider ? this._provider.defaultAspectRatio : 0;\n  }\n\n  protected attachViewportConstraint(): void {\n    if (this.playInViewport) {\n      getIObserver().observe(this);\n    }\n  }\n  protected detachViewportConstraint(): void {\n    const observer = getIObserver(true);\n    observer && observer.unobserve(this);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Media: typeof ESLMedia;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-media': ESLMedia;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {ESLMedia} from '../core/esl-media';\nimport type {ProviderObservedParams} from '../core/esl-media-provider';\nimport type {VideoJsPlayer} from 'video.js';\n\nconst API_SCRIPT_ID = 'BC_API_SOURCE';\n\nexport interface BCPlayerAccount {\n  playerId: string | null;\n  accountId: string | null;\n}\n\n/**\n * Brightcove API provider for {@link ESLMedia}\n * @author Julia Murashko\n */\n@BaseProvider.register\nexport class BrightcoveProvider extends BaseProvider {\n  static readonly providerName: string = 'brightcove';\n\n  protected videojsClasses = 'video-js vjs-default-skin video-js-brightcove';\n\n  protected _api: VideoJsPlayer;\n  protected _account: BCPlayerAccount;\n  protected _autoplay: boolean;\n\n  /**\n   * @returns settings, get from element by default\n   */\n  protected static getAccount(el: ESLMedia): BCPlayerAccount {\n    return {\n      playerId: el.getAttribute('player-id'),\n      accountId: el.getAttribute('player-account')\n    };\n  }\n\n  /** Loads player API according defined settings */\n  protected static loadAPI(account: BCPlayerAccount): Promise<Event> {\n    const apiSrc =\n      `//players.brightcove.net/${account.accountId}/${account.playerId}_default/index.min.js`;\n    const apiScript = document.getElementById(API_SCRIPT_ID);\n    if (apiScript && apiScript.parentNode && apiScript.getAttribute('src') !== apiSrc) {\n      apiScript.parentNode.removeChild(apiScript);\n    }\n    return loadScript(API_SCRIPT_ID, apiSrc);\n  }\n\n  /** Build video brightcove element */\n  protected buildVideo(): HTMLElement {\n    const el = document.createElement('video-js');\n    el.id = 'esl-media-brightcove-' + randUID();\n    el.className = 'esl-media-inner esl-media-brightcove ' + this.videojsClasses;\n    el.title = this.config.title;\n    el.toggleAttribute('loop', this.config.loop);\n    el.toggleAttribute('muted', this.config.muted);\n    el.toggleAttribute('controls', this.config.controls);\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('data-embed', 'default');\n    el.setAttribute('data-video-id', `ref:${this.config.mediaId}`);\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    this._account.playerId && el.setAttribute('data-player', this._account.playerId);\n    this._account.accountId && el.setAttribute('data-account', this._account.accountId);\n    return el;\n  }\n\n  /** Utility method to convert api event to promise */\n  protected $$fromEvent(eventName: string): Promise<void> {\n    if (!this._api) return Promise.reject();\n    return new Promise((resolve, reject) => this._api ? this._api.one(eventName, resolve) : reject());\n  }\n\n  /**\n   * Executes as soon as api script detected or loaded.\n   * @returns promise with provided API\n   */\n  protected onAPILoaded(): Promise<void> | void {\n    if (typeof window.bc !== 'function' || typeof window.videojs !== 'function') {\n      throw new Error('Brightcove API is not in the global scope');\n    }\n    console.debug('ESL Media: Brightcove API init for ', this);\n    this._api = window.bc(this._el);\n    return new Promise((resolve, reject) => this._api ? this._api.ready(resolve) : reject());\n  }\n\n  /**\n   * Executes after API ready state resolved\n   * Basic onAPIReady should be called to subscribe to API state\n   */\n  protected onAPIReady(): Promise<void> | void {\n    console.debug('ESL Media: Brightcove API is ready ', this);\n    // Set autoplay though js because BC is unresponsive while processing it natively\n    this._api.autoplay(this._autoplay || this.config.autoplay);\n\n    // Listeners to control player state\n    this._api.on('play', () => this.component._onPlay());\n    this._api.on('pause', () => this.component._onPaused());\n    this._api.on('ended', () => this.component._onEnded());\n    this.component._onReady();\n\n    // Can handle query only when loadedmetadata have happened\n    return this.$$fromEvent('loadedmetadata');\n  }\n\n  public bind(): void {\n    const Provider = (this.constructor as typeof BrightcoveProvider);\n    this._account = Provider.getAccount(this.component);\n    this._el = this.buildVideo();\n    this.component.appendChild(this._el);\n\n    this._ready = Provider.loadAPI(this._account)\n      .then(() => this.onAPILoaded())\n      .then(() => this.onAPIReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.dispose();\n    super.unbind();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (typeof this._api[param] === 'function') {\n      this._api[param](value);\n    }\n  }\n\n  public focus(): void {\n    this._api && this._api.focus();\n  }\n\n  public get state(): PlayerStates {\n    if (this._api) {\n      if (this._api.ended()) return PlayerStates.ENDED;\n      if (this._api.paused()) return PlayerStates.PAUSED;\n      if (!this._api.played()) return PlayerStates.UNSTARTED;\n      return PlayerStates.PLAYING;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get defaultAspectRatio(): number {\n    if (!this._api) return 0;\n    return this._api.videoWidth() / this._api.videoHeight();\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.currentTime() : 0;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.duration() : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.currentTime(pos);\n  }\n\n  public play(): void {\n    this._api.play();\n  }\n\n  public pause(): void {\n    this._api.pause();\n  }\n\n  public stop(): void {\n    this._api.currentTime(0);\n    this._api.pause();\n  }\n\n  // Overrides to set tech autoplay marker\n  public safePlay(): Promise<any> {\n    this._autoplay = true;\n    return super.safePlay();\n  }\n  public safeStop(): Promise<any> {\n    this._autoplay = true;\n    return super.safeStop();\n  }\n}\n\n// root typing\ndeclare global {\n  interface Window {\n    bc?: (el: HTMLElement, ...args: any[]) => VideoJsPlayer;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Audio API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class AudioProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'audio';\n  static readonly urlPattern = /\\.(mp3|wav|aac)(\\?|$)/;\n\n  protected _el: HTMLAudioElement;\n\n  protected createElement(): HTMLAudioElement {\n    const el = document.createElement('audio');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public get defaultAspectRatio(): number {\n    return 0;\n  }\n}\n","import {BaseProvider, PlayerStates} from '../../core/esl-media-provider';\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../../core/esl-media-provider';\n\n/**\n * Simple Native Media API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n */\nexport abstract class HTMLMediaProvider extends BaseProvider {\n  static readonly urlPattern: RegExp;\n\n  static parseUrl(mediaSrc: string): Partial<MediaProviderConfig> | null {\n    if (this.urlPattern.test(mediaSrc)) {\n      return {mediaSrc};\n    }\n    return null;\n  }\n\n  protected _el: HTMLMediaElement;\n\n  protected static applyElementSettings(el: HTMLMediaElement, cfg: MediaProviderConfig): HTMLMediaElement {\n    el.classList.add('esl-media-inner');\n    el.autoplay = cfg.autoplay;\n    el.preload = cfg.preload || 'auto' ;\n    el.loop = cfg.loop;\n    el.muted = cfg.muted;\n    el.controls = cfg.controls;\n    el.tabIndex = 0;\n    el.toggleAttribute('playsinline', cfg.playsinline);\n    return el;\n  }\n\n  protected abstract createElement(): HTMLMediaElement;\n\n  public onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n  }\n\n  public bind(): void {\n    this._el = this.createElement();\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n    this.component.appendChild(this._el);\n    this.bindListeners();\n  }\n\n  protected bindListeners(): void {\n    this._el.addEventListener('loadedmetadata', () => this.component._onReady());\n    this._el.addEventListener('play', () => this.component._onPlay());\n    this._el.addEventListener('pause', () => this.component._onPaused());\n    this._el.addEventListener('ended', () => this.component._onEnded());\n    this._el.addEventListener('error', (e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    super.unbind();\n  }\n\n  get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public get state(): PlayerStates {\n    if (!this._el) return PlayerStates.UNINITIALIZED;\n    if (this._el.ended) return PlayerStates.ENDED;\n    if (!this._el.played || !this._el.played.length) return PlayerStates.UNSTARTED;\n    if (this._el.paused) return PlayerStates.PAUSED;\n    return PlayerStates.PLAYING;\n  }\n\n  public get duration(): number {\n    return this._el ? this._el.duration : 0;\n  }\n\n  public get currentTime(): number {\n    return this._el ? this._el.currentTime : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._el.currentTime = pos;\n  }\n\n  public play(): Promise<any> {\n    return this._el.play();\n  }\n\n  public pause(): void {\n    this._el.pause();\n  }\n\n  public stop(): void {\n    this._el.pause();\n    this._el.currentTime = 0;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Video API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class VideoProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'video';\n  static readonly urlPattern = /\\.(mp4|webm|ogv|mov)(\\?|$)/;\n\n  protected _el: HTMLVideoElement;\n\n  protected createElement(): HTMLVideoElement {\n    const el = document.createElement('video');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  get defaultAspectRatio(): number {\n    return this._el.videoWidth / this._el.videoHeight;\n  }\n}\n","import {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {MediaProviderConfig} from '../core/esl-media-provider';\n\n/**\n * Simple Basic Iframe provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class IframeBasicProvider extends BaseProvider {\n  static readonly providerName: string = 'iframe';\n\n  private _state: PlayerStates = PlayerStates.UNINITIALIZED;\n  protected _el: HTMLIFrameElement;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    try {\n      if (!url) return null;\n      const {protocol} = new URL(url);\n      if (protocol !== 'http:' && protocol !== 'https:') return null;\n      return {mediaSrc: url};\n    } catch {\n      return null;\n    }\n  }\n\n  protected buildIframe(): HTMLIFrameElement {\n    const el = document.createElement('iframe');\n    el.id = 'esl-media-iframe-' + randUID();\n    el.className = 'esl-media-inner esl-media-iframe';\n    el.title = this.config.title;\n    el.setAttribute('aria-label', this.config.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('scrolling', 'no');\n    el.setAttribute('allowfullscreen', 'yes');\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public bind(): void {\n    if (this._state !== PlayerStates.UNINITIALIZED) return;\n    this._ready = new Promise((resolve, reject) => {\n      this._el = this.buildIframe();\n      this._el.onload = (): void => resolve(this);\n      this._el.onerror = (e): void => reject(e);\n      this._state = PlayerStates.UNSTARTED;\n      this.component.appendChild(this._el);\n    });\n    this._ready.then(() => {\n      this._state = PlayerStates.PLAYING;\n      this.component._onReady();\n      this.component._onPlay();\n    });\n    this._ready.catch((e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._state = PlayerStates.UNINITIALIZED;\n    super.unbind();\n  }\n\n  get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public focus(): void {\n    if (this._el && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    return this._state;\n  }\n\n  public get duration(): number {\n    return 0;\n  }\n\n  public get currentTime(): number {\n    return 0;\n  }\n\n  get defaultAspectRatio(): number {\n    return 0;\n  }\n\n  public seekTo(pos: number): void {\n    console.error('[ESLMedia] Unsupported action: can not execute seekTo on abstract iframe provider');\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.UNINITIALIZED) {\n      this.bind();\n    }\n  }\n\n  public pause(): void {\n    this.unbind();\n  }\n\n  public stop(): void {\n    this.unbind();\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\nimport PlayerVars = YT.PlayerVars;\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../core/esl-media-provider';\n\nconst DEFAULT_ASPECT_RATIO = 16 / 9;\n\n/**\n * Youtube API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class YouTubeProvider extends BaseProvider {\n  static readonly providerName: string = 'youtube';\n  static readonly idRegexp = /(?:v\\/|v=|vi=|vi\\/|e\\/|embed\\/|user\\/.*\\/u\\/\\d+\\/)([_0-9a-zA-Z-]+)/i;\n  static readonly providerRegexp = /^\\s*(?:http(?:s)?:\\/\\/)?(?:www\\.)?(?:youtu\\.be|youtube(-nocookie)?\\.com)/i;\n\n  protected _el: HTMLDivElement | HTMLIFrameElement;\n  protected _api: YT.Player;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    if (this.providerRegexp.test(url)) {\n      const [, id] = url.match(this.idRegexp) || [];\n      return id ? {mediaId: id} : null;\n    }\n    return null;\n  }\n\n  private static _coreApiPromise: Promise<void>;\n  protected static getCoreApi(): Promise<void> {\n    if (!YouTubeProvider._coreApiPromise) {\n      YouTubeProvider._coreApiPromise = new Promise((resolve) => {\n        if (window.YT && window.YT.Player) return resolve(window.YT);\n        loadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\n        const cbOrigin = window.onYouTubeIframeAPIReady;\n        window.onYouTubeIframeAPIReady = (): void => {\n          try {\n            (typeof cbOrigin === 'function') && cbOrigin.apply(window);\n          } catch (err) { // eslint-disable-line\n            // Do Nothing\n          }\n          return resolve(window.YT);\n        };\n      });\n    }\n    return YouTubeProvider._coreApiPromise;\n  }\n\n  protected static mapOptions(cfg: MediaProviderConfig): PlayerVars {\n    return {\n      enablejsapi: 1,\n      origin: location.origin,\n      rel: 0,\n      showinfo: 0,\n      iv_load_policy: 0, // eslint-disable-line\n      autoplay: Number(cfg.autoplay),\n      controls: Number(cfg.controls),\n      playsinline: Number(cfg.playsinline),\n      disablekb: Number(!cfg.controls), // TODO: criteria\n      autohide: Number(!cfg.controls) // TODO: criteria\n    };\n  }\n\n  protected static buildIframe(sm: MediaProviderConfig): HTMLDivElement | HTMLIFrameElement {\n    const el = document.createElement('div');\n    el.id = 'esl-media-yt-' + randUID();\n    el.className = 'esl-media-inner esl-media-youtube';\n    el.title = sm.title;\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('allowfullscreen', 'yes');\n    return el;\n  }\n\n  public bind(): void {\n    this._el = YouTubeProvider.buildIframe(this.config);\n    this.component.appendChild(this._el);\n    this._ready = YouTubeProvider.getCoreApi()\n      .then(() => this.onCoreApiReady())\n      .then(() => this.onPlayerReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  /** Init YT.Player on target element */\n  protected onCoreApiReady(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      console.debug('[ESL]: Media Youtube Player initialization for ', this);\n      this._api = new YT.Player(this._el.id, {\n        videoId: this.config.mediaId,\n        events: {\n          onError: (e): void => reject(e),\n          onReady: (): void => resolve(this),\n          onStateChange: (e): void => this._onStateChange(e)\n        },\n        playerVars: YouTubeProvider.mapOptions(this.config)\n      });\n    });\n  }\n  /** Post YT.Player init actions */\n  protected onPlayerReady(): void {\n    console.debug('[ESL]: Media Youtube Player ready ', this);\n    this._el = this._api.getIframe();\n    if (this.config.muted) {\n      this._api.mute();\n    }\n    this.component._onReady();\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.destroy();\n    super.unbind();\n  }\n\n  private _onStateChange(event: YT.OnStateChangeEvent): void {\n    switch (+event.data) {\n      case PlayerStates.PLAYING:\n        this.component._onPlay();\n        break;\n      case PlayerStates.PAUSED:\n        this.component._onPaused();\n        break;\n      case PlayerStates.ENDED:\n        if (this.config.loop) {\n          this._api.playVideo();\n        } else {\n          this.component._onEnded();\n        }\n        break;\n    }\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (param === 'muted') {\n      value ? this._api.mute() : this._api.unMute();\n    }\n  }\n\n  public focus(): void {\n    if (this._el instanceof HTMLIFrameElement && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    if (this._api && typeof this._api.getPlayerState === 'function') {\n      return this._api.getPlayerState() as number as PlayerStates;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.getDuration() : 0;\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.getCurrentTime() : 0;\n  }\n\n  public get defaultAspectRatio(): number {\n    return DEFAULT_ASPECT_RATIO;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.seekTo(pos, false);\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.ENDED) {\n      this._api.seekTo(0, false);\n    }\n    this._api.playVideo();\n  }\n\n  public pause(): void {\n    this._api.pauseVideo();\n  }\n\n  public stop(): void {\n    this._api.stopVideo();\n  }\n}\n\n// typings\ndeclare global {\n  interface YT extends Promise<void> {\n    Player: YT.Player;\n  }\n\n  interface Window {\n    YT?: YT;\n    onYouTubeIframeAPIReady?: () => void;\n  }\n}\n","import {setAttr} from '../../esl-utils/dom/attr';\nimport {prop} from '../../esl-utils/decorators';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMixinRegistry} from './esl-mixin-registry';\n\nimport type {AttributeTarget} from '../../esl-utils/dom/attr';\nimport type {\n  ESLEventListener,\n  ESLListenerCriteria,\n  ESLListenerDescriptor,\n  ESLListenerEventMap,\n  ESLListenerHandler\n} from '../../esl-utils/dom/events';\n\n/**\n * Base class for mixin elements.\n * Mixin elements attaches to the DOM element via attribute.\n * Allows multiple mixin elements per one DOM element\n */\nexport class ESLMixinElement implements AttributeTarget {\n  /** Root attribute to identify mixin targets. Should contain dash in the name. */\n  static is: string;\n  /** Additional observed attributes */\n  static observedAttributes: string[] = [];\n\n  /** Event to indicate component significant state change that may affect other components state */\n  @prop('esl:refresh') public REFRESH_EVENT: string;\n\n  /** Additional attributes observer */\n  private _attr$$: MutationObserver;\n\n  public constructor(\n    public readonly $host: HTMLElement\n  ) {}\n\n  /** Callback of mixin instance initialization */\n  public connectedCallback(): void {\n    const constructor = this.constructor as typeof ESLMixinElement;\n    if (constructor.observedAttributes.length) {\n      this._attr$$ = new MutationObserver(this._onAttrMutation.bind(this));\n      this._attr$$.observe(this.$host, {\n        attributes: true,\n        attributeFilter: constructor.observedAttributes,\n        attributeOldValue: true\n      });\n    }\n\n    ESLEventUtils.descriptors(this).forEach((desc) => ESLEventUtils.subscribe(this, desc));\n  }\n\n  /** Callback to execute on mixin instance destroy */\n  public disconnectedCallback(): void {\n    if (this._attr$$) this._attr$$.disconnect();\n\n    ESLEventUtils.unsubscribe(this);\n  }\n\n  /** Callback to handle changing of additional attributes */\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {}\n\n  /** Attribute change mutation record processor */\n  private _onAttrMutation(records: MutationRecord[]): void {\n    records.forEach(({attributeName, oldValue}: MutationRecord) => {\n      if (!attributeName) return;\n      const newValue = this.$$attr(attributeName);\n      this.attributeChangedCallback(attributeName, oldValue, newValue);\n    });\n  }\n\n  /** Subscribes `handler` method marked with `@listen` decorator */\n  public $$on(handler: ESLListenerHandler): ESLEventListener[];\n  /** Subscribes `handler` function by the passed DOM event descriptor {@link ESLListenerDescriptor} or event name */\n  public $$on<EType extends keyof ESLListenerEventMap>(\n    event: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  public $$on(event: any, handler?: any): ESLEventListener[] {\n    return ESLEventUtils.subscribe(this, event, handler);\n  }\n\n  /** Unsubscribes event listener */\n  public $$off(...condition: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventUtils.unsubscribe(this, ...condition);\n  }\n\n  /**\n   * Gets or sets CSS classes for the `$host`\n   * @param cls - CSS classes query {@link CSSClassUtils}\n   * @param value - boolean to set CSS class(es) state or undefined to skip mutation\n   * @returns current classes state or passed state\n   */\n  public $$cls(cls: string, value?: boolean): boolean {\n    if (value === undefined) return CSSClassUtils.has(this.$host, cls);\n    CSSClassUtils.toggle(this.$host, cls, value);\n    return value;\n  }\n\n  /**\n   * Gets or sets attribute for the `$host`.\n   * If the `value` param is undefined then skips mutation.\n   * @param name - attribute name\n   * @param value - string attribute value, boolean attribute state or `null` to delete attribute\n   * @returns current attribute value or previous value for mutation\n   */\n  public $$attr(name: string, value?: null | boolean | string): string | null {\n    const prevValue = this.$host.getAttribute(name);\n    if (value !== undefined) setAttr(this, name, value);\n    return prevValue;\n  }\n\n  /**\n   * Dispatches component custom event on the `$host`.\n   * Uses 'esl:' prefix for event name, overridable to customize event namespaces.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return ESLEventUtils.dispatch(this.$host, eventName, eventInit);\n  }\n\n  /** Returns mixin instance by element */\n  public static get<T extends typeof ESLMixinElement>(this: T, $el: HTMLElement): InstanceType<T> | null {\n    return ESLMixinRegistry.get($el, this.is) as InstanceType<T>;\n  }\n  /** Register current mixin definition */\n  public static register(): void {\n    (new ESLMixinRegistry()).register(this);\n  }\n}\n\nexport type ConstructableESLMixin = typeof ESLMixinElement & (new($root: HTMLElement) => ESLMixinElement);\n","import type {ESLMixinElement, ConstructableESLMixin} from './esl-mixin-element';\n\n// Private key to store mixin instances\nconst STORE = '__esl_mixins';\n\n// Singleton for registry\nlet global: ESLMixinRegistry;\n\n/** Registry to store and initialize {@link ESLMixinElement} instances */\nexport class ESLMixinRegistry {\n  /** Map that stores available mixins under their identifier (attribute) */\n  protected store = new Map<string, ConstructableESLMixin>();\n  /** MutationObserver instance to track DOM changes and init mixins on-fly */\n  protected mutation$$ = new MutationObserver(this._onMutation.bind(this));\n\n  public constructor() {\n    if (global) return global;\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    global = this;\n  }\n\n  /** Array of registered mixin tags */\n  public get observedAttributes(): string[] {\n    const attrs: string[] = [];\n    this.store.forEach((mixin, name) => attrs.push(name));\n    return attrs;\n  }\n\n  /** Register mixin definition */\n  public register(mixin: ConstructableESLMixin): void {\n    if (!mixin.is || mixin.is.indexOf('-') === -1) {\n      throw Error(`[ESL]: Illegal mixin attribute name \"${mixin.is}\"`);\n    }\n    if (this.store.has(mixin.is) && this.store.get(mixin.is) !== mixin) {\n      throw Error(`[ESL]: Attribute ${mixin.is} is already occupied by another mixin`);\n    }\n    this.store.set(mixin.is, mixin);\n    this.invalidateRecursive();\n    this.resubscribe();\n  }\n\n  /** Resubscribes DOM observer */\n  public resubscribe(root: Element = document.body): void {\n    this.mutation$$.disconnect();\n    this.mutation$$.observe(root, {\n      subtree: true,\n      childList: true,\n      attributes: true,\n      attributeFilter: this.observedAttributes\n    });\n  }\n\n  /** Invalidates all mixins on the element and subtree */\n  public invalidateRecursive(root: HTMLElement = document.body): void {\n    if (!root) return;\n    this.invalidateAll(root);\n    if (!root.children || !root.children.length) return;\n    Array.prototype.forEach.call(root.children, (child: Element) => this.invalidateRecursive(child as HTMLElement));\n  }\n\n  /** Invalidates all mixins on the element */\n  public invalidateAll(el: HTMLElement): void {\n    const hasStore = Object.hasOwnProperty.call(el, STORE);\n    this.store.forEach((mixin: ConstructableESLMixin, name: string) => {\n      if (el.hasAttribute(name)) {\n        ESLMixinRegistry.init(el, mixin);\n      } else if (hasStore) {\n        ESLMixinRegistry.destroy(el, name);\n      }\n    });\n  }\n\n  /** Invalidates passed mixin on the element */\n  public invalidate(el: HTMLElement, mixin: string): void {\n    if (el.hasAttribute(mixin)) {\n      const mixinType = this.store.get(mixin);\n      mixinType && ESLMixinRegistry.init(el, mixinType);\n    } else {\n      ESLMixinRegistry.destroy(el, mixin);\n    }\n  }\n\n  /** Destroys passed mixin on the element */\n  public destroy(el: HTMLElement, mixin: string | ConstructableESLMixin | undefined): void {\n    if (typeof mixin === 'string') mixin = this.store.get(mixin);\n    if (!mixin) return;\n    const current = ESLMixinRegistry.get(el, mixin.is);\n    if (current) current.disconnectedCallback();\n  }\n\n  /** Destroys all mixins on the element */\n  public destroyAll(el: HTMLElement): void {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement> | undefined;\n    store && Object.keys(store).forEach((name) => ESLMixinRegistry.destroy(el, name));\n  }\n\n  /** Handles DOM mutation list */\n  protected _onMutation(mutations: MutationRecord[]): void {\n    mutations.forEach((record: MutationRecord) => {\n      if (record.type === 'attributes' && record.attributeName && this.store.has(record.attributeName)) {\n        this.invalidate(record.target as HTMLElement, record.attributeName);\n      }\n      if (record.type === 'childList') {\n        record.addedNodes.forEach((node) => {\n          if (node.nodeType === Node.ELEMENT_NODE) this.invalidateRecursive(node as HTMLElement);\n        });\n        record.removedNodes.forEach((node) => {\n          if (node.nodeType === Node.ELEMENT_NODE) this.destroyAll(node as HTMLElement);\n        });\n      }\n    });\n  }\n\n  /** @returns mixin instance by name */\n  public static get(el: HTMLElement, mixin: string): ESLMixinElement | null {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement> | undefined;\n    return (store && store[mixin]) || null;\n  }\n\n  /** @returns if the passed mixin exists on the element */\n  public static has(el: HTMLElement, mixin: string): boolean {\n    return !!this.get(el, mixin);\n  }\n\n  /** Sets mixin instance to the element store */\n  private static set(el: HTMLElement, mixin: ESLMixinElement): void {\n    if (!Object.hasOwnProperty.call(el, STORE)) Object.defineProperty(el, STORE, {value: {}, configurable: true});\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement>;\n    store[(mixin.constructor as ConstructableESLMixin).is] = mixin;\n  }\n\n  /** Inits mixin instance on the element */\n  private static init(el: HTMLElement, Mixin: ConstructableESLMixin): ESLMixinElement | null {\n    if (this.has(el, Mixin.is)) return null;\n    const instance = new Mixin(el);\n    ESLMixinRegistry.set(el, instance);\n    instance.connectedCallback();\n    return instance;\n  }\n\n  /** Destroys passed mixin on the element */\n  private static destroy(el: HTMLElement, mixin: string): void {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement>;\n    if (!store) return;\n    const instance = store[mixin];\n    if (!instance) return;\n    instance.disconnectedCallback();\n    delete store[mixin];\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {defined} from '../../esl-utils/misc/object/utils';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {decorate, memoize, attr, jsonAttr, prop, listen} from '../../esl-utils/decorators';\nimport {format} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaQuery, ESLMediaRuleList} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLPanel} from '../../esl-panel/core';\n\nimport type {PanelActionParams} from '../../esl-panel/core';\n\n/** Converts special 'all' value to positive infinity */\nconst parseCount = (value: string): number => value === 'all' ? Number.POSITIVE_INFINITY : parseInt(value, 10);\n\n/**\n * ESLPanelGroup component\n * @author Julia Murashko, Anastasia Lesun, Alexey Stsefanovich (ala'n)\n *\n * ESLPanelGroup is a custom element that is used as a container for a group of {@link ESLPanel}s\n */\n@ExportNs('PanelGroup')\nexport class ESLPanelGroup extends ESLBaseElement {\n  public static is = 'esl-panel-group';\n\n  public static observedAttributes = ['mode', 'refresh-strategy', 'min-open-items', 'max-open-items'];\n  /** List of supported modes */\n  public static supportedModes = ['accordion', 'tabs'];\n\n  /** Event that dispatched on instance mode change */\n  @prop('esl:change:mode') public MODE_CHANGE_EVENT: string;\n  /** Inner event that dispatched after group-handled animation end */\n  @prop('esl:after:animate') public AFTER_ANIMATE_EVENT: string;\n\n  /** Child panels selector (Default `esl-panel`) */\n  @attr({defaultValue: ESLPanel.is}) public panelSel: string;\n\n  /** Rendering mode of the component (takes values from the list of supported modes; 'accordion' by default) */\n  @attr({defaultValue: 'accordion'}) public mode: string;\n  /** Rendering mode class pattern. Uses {@link format} syntax for `mode` placeholder */\n  @attr({defaultValue: 'esl-{mode}-view'}) public modeCls: string;\n  /** Element {@link ESLTraversingQuery} selector to add class that identifies the rendering mode (ESLPanelGroup itself by default) */\n  @attr({defaultValue: ''}) public modeClsTarget: string;\n\n  /**\n   * ESLMediaQuery string to define a list of media conditions\n   * to disable collapse/expand animation (for both Group and Panel animations)\n   */\n  @attr({defaultValue: 'not all'}) public noAnimate: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animationClass: string;\n\n  /** Define minimum number of panels that could be opened */\n  @attr({defaultValue: '1'}) public minOpenItems: string;\n  /** Define maximum number of panels that could be opened */\n  @attr({defaultValue: '1'}) public maxOpenItems: string;\n\n  /**\n   * Define active panel(s) behaviour in case of configuration change (mode, min-open-items, max-open-items)\n   * `last` (default) - try to preserve currently active panel(s)\n   * `initial` - activates initially opened panel(s)\n   * `open` - open max of available panels\n   * `close` - close all the panels (to the min of open items)\n   */\n  @attr({defaultValue: 'last'}) public refreshStrategy: string;\n\n  /** Action params to pass into panels when executing reset action (happens when mode is changed) */\n  @jsonAttr({defaultValue: {noAnimate: true}}) public transformParams: PanelActionParams;\n\n\n  /** Height of previous active panel */\n  protected _previousHeight: number = 0;\n\n  protected connectedCallback(): void {\n    ESLPanel.registered.then(() => {\n      super.connectedCallback();\n      this.refresh();\n    });\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'mode' || attrName === 'min-open-items' || attrName === 'max-open-items') {\n      this.$$off(this._onConfigChange);\n      memoize.clear(this, 'modeRules');\n      memoize.clear(this, 'minValueRules');\n      memoize.clear(this, 'maxValueRules');\n      this.$$on(this._onConfigChange);\n      this.refresh();\n    }\n    if (attrName === 'refresh-strategy') {\n      memoize.clear(this, 'refreshRules');\n    }\n  }\n\n  /** Updates element state according to current mode */\n  protected refresh(): void {\n    const prevMode = this.getAttribute('current-mode');\n    const currentMode = this.currentMode;\n    this.setAttribute('current-mode', currentMode);\n\n    this.updateModeCls();\n    this.reset();\n\n    if (prevMode !== currentMode) this.$$fire(this.MODE_CHANGE_EVENT, {detail: {prevMode, currentMode}});\n  }\n\n  /** Updates mode class marker */\n  protected updateModeCls(): void {\n    const {modeCls, currentMode} = this;\n    if (!modeCls) return;\n    const $target = ESLTraversingQuery.first(this.modeClsTarget, this);\n    if (!$target) return;\n    ESLPanelGroup.supportedModes.forEach((mode) => {\n      const className = format(modeCls, {mode});\n      $target.classList.toggle(className, currentMode === mode);\n    });\n  }\n\n  /** @returns ESLMediaRuleList instance of the mode mapping */\n  @memoize()\n  public get modeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.mode);\n  }\n\n  /** @returns ESLMediaRuleList instance of the min-open-items mapping */\n  @memoize()\n  public get minValueRules(): ESLMediaRuleList<number> {\n    return ESLMediaRuleList.parse(this.minOpenItems, parseCount);\n  }\n\n  /** @returns ESLMediaRuleList instance of the max-open-items mapping */\n  @memoize()\n  public get maxValueRules(): ESLMediaRuleList<number> {\n    return ESLMediaRuleList.parse(this.maxOpenItems, parseCount);\n  }\n\n  /** @returns ESLMediaRuleList instance of the refresh-strategy mapping */\n  @memoize()\n  public get refreshRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.refreshStrategy);\n  }\n\n  /** @returns current mode */\n  public get currentMode(): string {\n    return this.modeRules.activeValue || '';\n  }\n\n  /** @returns current value of min-open-items */\n  public get currentMinItems(): number {\n    const min = 0;\n    const val = defined(this.minValueRules.activeValue, 1);\n    const max = this.currentMode === 'tabs' ? 1 : this.$panels.length;\n    return Math.min(max, Math.max(min, val)); // minmax\n  }\n\n  /** @returns current value of max-open-items */\n  public get currentMaxItems(): number {\n    const min = this.currentMinItems;\n    const val = defined(this.maxValueRules.activeValue, 1);\n    const max = this.currentMode === 'tabs' ? 1 : this.$panels.length;\n    return Math.min(max, Math.max(min, val)); // minmax\n  }\n\n  /** @returns panels that are processed by the current panel group */\n  public get $panels(): ESLPanel[] {\n    const els = Array.from(this.querySelectorAll(this.panelSel));\n    return els.filter((el) => this.includesPanel(el)) as ESLPanel[];\n  }\n\n  /** @returns panels that are active */\n  public get $activePanels(): ESLPanel[] {\n    return this.$panels.filter((el: ESLPanel) => el.open);\n  }\n\n  /** @returns panels that was initially opened */\n  public get $initialPanels(): ESLPanel[] {\n    return this.$panels.filter((el: ESLPanel) => el.initiallyOpened);\n  }\n\n  /** @returns panels that requested to be opened on refresh */\n  public get $resetStatePanels(): ESLPanel[] {\n    switch (this.refreshRules.activeValue) {\n      case 'close': return [];\n      case 'open': return this.$panels;\n      case 'initial': return this.$initialPanels;\n      default: return this.$activePanels;\n    }\n  }\n\n  /** @returns whether the collapse/expand animation should be handheld by the breakpoints */\n  public get shouldAnimate(): boolean {\n    return !ESLMediaQuery.for(this.noAnimate).matches;\n  }\n\n  /** @returns action params config that's used (inherited) by controlled {@link ESLPanel}s */\n  public get panelConfig(): PanelActionParams {\n    return {\n      capturedBy: this.currentMode === 'tabs' ? this : undefined,\n      noAnimate: !this.shouldAnimate || (this.currentMode === 'tabs')\n    };\n  }\n\n  /** @returns merged panel action params for show/hide requests from the group */\n  protected mergeActionParams(...params: PanelActionParams[]): PanelActionParams {\n    return Object.assign({initiator: 'group', activator: this}, ...params);\n  }\n\n  /** Condition-guard to check if the passed target is a Panel that should be controlled by the Group */\n  public includesPanel(target: any): target is ESLPanel {\n    if (!(target instanceof ESLPanel)) return false;\n    return target.$group === this;\n  }\n\n  /** Shows all panels besides excluded ones */\n  public showAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$panels.forEach((el) => !excluded.includes(el) && el.show(this.mergeActionParams(params)));\n  }\n  /** Hides all active panels besides excluded ones */\n  public hideAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$activePanels.forEach((el) => !excluded.includes(el) && el.hide(this.mergeActionParams(params)));\n  }\n\n  /** Resets to default state applicable to the current panel group configuration */\n  public reset(): void {\n    // $activePanels - collection of items to open (ideally; without normalization)\n    const $activePanels = this.$resetStatePanels;\n    // $orderedPanels = $activePanels U ($panels / $activePanels) - the list of ordered panels\n    const $orderedPanels = $activePanels.concat(this.$panels.filter((item) => !$activePanels.includes(item)));\n    // we use current open active panels count but normalized in range of minmax\n    const activeCount = Math.min(this.currentMaxItems, Math.max($activePanels.length, this.currentMinItems));\n\n    const params = this.mergeActionParams(this.transformParams);\n    $orderedPanels.forEach((panel, index) => panel.toggle(index < activeCount, params));\n  }\n\n  /** Animates the height of the component */\n  protected onAnimate(from: number, to: number): void {\n    const hasCurrent = this.style.height && this.style.height !== 'auto';\n    if (hasCurrent) {\n      this.style.height = `${to}px`;\n      this.fallbackAnimate();\n    } else {\n      // set initial height\n      this.style.height = `${from}px`;\n      // make sure that browser applies initial height to animate\n      afterNextRender(() => {\n        this.style.height = `${to}px`;\n        this.fallbackAnimate();\n      });\n    }\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented */\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.height) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    CSSClassUtils.add(this, this.animationClass);\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(silent?: boolean): void {\n    this.style.removeProperty('height');\n    CSSClassUtils.remove(this, this.animationClass);\n\n    if (silent) return;\n    this.$$fire(this.AFTER_ANIMATE_EVENT, {bubbles: false});\n  }\n\n  /** Process {@link ESLPanel} pre-show event */\n  @listen('esl:before:show')\n  protected _onBeforeShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n\n    const max = this.currentMaxItems;\n    const params = this.mergeActionParams({event: e});\n    const balanceMarker = e.detail?.params?.event?.type !== 'esl:before:hide';\n\n    // All currently active except panel that requested to be open\n    const $activePanels = this.$activePanels.filter((el) => el !== panel);\n\n    // overflow = pretended to be active (current active + balanceMarker (1 if nothing hides)) - limit\n    const overflow = Math.max(0, $activePanels.length + Number(balanceMarker) - max);\n    // close all extra active panels (not includes requested one)\n    $activePanels.slice(0, overflow).forEach((el) => el.hide(params));\n\n    if (max <= 0) return e.preventDefault();\n  }\n\n  /** Process {@link ESLPanel} show event */\n  @listen('esl:show')\n  protected _onShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode !== 'tabs') return;\n\n    this.beforeAnimate();\n    if (this.shouldAnimate) {\n      this.onAnimate(this._previousHeight, panel.initialHeight);\n    } else {\n      afterNextRender(() => this.afterAnimate(true));\n    }\n  }\n\n  /** Process {@link ESLPanel} pre-hide event */\n  @listen('esl:before:hide')\n  protected _onBeforeHide(e: CustomEvent): void {\n    const {target: panel, detail} = e;\n    if (!this.includesPanel(panel)) return;\n\n    const min = this.currentMinItems;\n    // Check if the hide event was produced by the show event\n    const balanceMarker = detail?.params?.event?.type === 'esl:before:show';\n    // activePanels = currentActivePanels - 1 (hide) + 1 if the event produced by 'before:show'\n    const activeNumber = this.$activePanels.length - 1 + Number(balanceMarker);\n\n    if (activeNumber < min) {\n      const $firstInactive = this.$panels.find(($panel: ESLPanel) => !$panel.open);\n      if (min === 1 || !$firstInactive) return e.preventDefault();\n      const params = this.mergeActionParams({event: e});\n      $firstInactive.show(params);\n    }\n\n    this._previousHeight = this.clientHeight;\n  }\n\n  /** Catches CSS transition end event to start post-animate processing */\n  @listen('transitionend')\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Handles configuration change */\n  @listen({\n    event: 'change',\n    target: (group: ESLPanelGroup) => [group.modeRules, group.minValueRules, group.maxValueRules]\n  })\n  @decorate(debounce, 0)\n  protected _onConfigChange(): void {\n    this.refresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PanelGroup: typeof ESLPanelGroup;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-panel-group': ESLPanelGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {attr, boolAttr, jsonAttr, listen} from '../../esl-utils/decorators';\nimport {afterNextRender, skipOneRender} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\n\nimport type {ESLPanelGroup} from '../../esl-panel-group/core';\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core';\n\n/** {@link ESLPanel} action params interface */\nexport interface PanelActionParams extends ESLToggleableActionParams {\n  /** Panel group */\n  capturedBy?: ESLPanelGroup;\n  /** Prevents collapsing/expanding animation */\n  noAnimate?: boolean;\n}\n\n/**\n * ESLPanel component\n * @author Julia Murashko\n *\n * ESLPanel is a custom element that is used as a wrapper for content that can be shown or hidden.\n * Can use collapsing/expanding animation (smooth height change).\n * Can be used in conjunction with {@link ESLPanelGroup} to control a group of ESLPopups\n */\n@ExportNs('Panel')\nexport class ESLPanel extends ESLToggleable {\n  public static is = 'esl-panel';\n\n  /** Class(es) to be added for active state ('open' by default) */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animateClass: string;\n  /** Class(es) to be added during animation after next render ('post-animate' by default) */\n  @attr({defaultValue: 'post-animate'}) public postAnimateClass: string;\n\n  /** CSS selector of the parent group (default: 'esl-panel-group') */\n  @attr({defaultValue: 'esl-panel-group'}) public panelGroupSel: string;\n\n  /** Initial params for current ESLPanel instance */\n  @jsonAttr<PanelActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: PanelActionParams;\n\n  /** Active while animation in progress */\n  @boolAttr({readonly: true}) public animating: boolean;\n\n  /** Inner height state that updates after show/hide actions but before show/hide events triggered */\n  protected _initialHeight: number = 0;\n\n  /** @returns Previous active panel height at the start of the animation */\n  public get initialHeight(): number {\n    return this._initialHeight;\n  }\n\n  /** @returns Closest panel group or null if not presented */\n  public get $group(): ESLPanelGroup | null {\n    if (this.groupName === 'none' || this.groupName) return null;\n    return this.closest(this.panelGroupSel);\n  }\n\n  /** Process show action */\n  protected onShow(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onShow(params);\n\n    this.beforeAnimate();\n    if (params.noAnimate) return this.postAnimate(params.capturedBy);\n    this.onAnimate(0, this._initialHeight);\n  }\n\n  /** Process hide action */\n  protected onHide(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onHide(params);\n\n    this.beforeAnimate();\n    if (params.noAnimate) return this.postAnimate(null);\n    this.onAnimate(this._initialHeight, 0);\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    this.toggleAttribute('animating', true);\n    CSSClassUtils.add(this, this.animateClass);\n    this.postAnimateClass && afterNextRender(() => CSSClassUtils.add(this, this.postAnimateClass));\n  }\n\n  /** Handles post animation process to initiate after animate step */\n  protected postAnimate(capturedBy?: ESLPanelGroup | null): void {\n    if (capturedBy) {\n      capturedBy.$$on({\n        event: capturedBy.AFTER_ANIMATE_EVENT,\n        once: true\n      }, () => this.afterAnimate());\n    } else {\n      skipOneRender(() => this.afterAnimate());\n    }\n  }\n\n  /** Process animation */\n  protected onAnimate(from: number, to: number): void {\n    // set initial height\n    this.style.setProperty('max-height', `${from}px`);\n    // make sure that browser applies initial height for animation\n    afterNextRender(() => {\n      this.style.setProperty('max-height', `${to}px`);\n      this.fallbackAnimate();\n    });\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented*/\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.maxHeight) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(): void {\n    const {animating} = this;\n    this.clearAnimation();\n    // Prevent fallback calls from being tracked\n    if (!animating) return;\n    this.$$fire(this.open ? this.AFTER_SHOW_EVENT : this.AFTER_HIDE_EVENT);\n  }\n\n  /** Clear animation properties */\n  protected clearAnimation(): void {\n    this.toggleAttribute('animating', false);\n    this.style.removeProperty('max-height');\n    CSSClassUtils.remove(this, this.animateClass);\n    CSSClassUtils.remove(this, this.postAnimateClass);\n  }\n\n  /** Catching CSS transition end event to start post-animate processing */\n  @listen('transitionend')\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'max-height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Merge params that are used by panel group for actions */\n  protected mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    const stackConfig = this.$group?.panelConfig || {};\n    return Object.assign({}, stackConfig, this.defaultParams, params || {});\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Panel: typeof ESLPanel;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-panel': ESLPanel;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLPopup} from './esl-popup';\n\n@ExportNs('PopupPlaceholder')\nexport class ESLPopupPlaceholder extends ESLToggleablePlaceholder {\n  public static is = 'esl-popup-placeholder';\n\n  public $origin: ESLPopup | null;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PopupPlaceholder: typeof ESLPopupPlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup-placeholder': ESLPopupPlaceholder;\n  }\n}\n","import {Rect} from '../../esl-utils/dom/rect';\n\nexport type PositionType = 'top' | 'bottom' | 'left' | 'right';\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport interface PopupPositionValue {\n  placedAt: PositionType;\n  popup: Rect;\n  arrow: Point;\n}\n\nexport interface IntersectionRatioRect {\n  top?: number;\n  left?: number;\n  right?: number;\n  bottom?: number;\n}\n\nexport interface PopupPositionConfig {\n  position: PositionType;\n  behavior: string;\n  marginArrow: number;\n  offsetArrowRatio: number;\n  intersectionRatio: IntersectionRatioRect;\n  arrow: DOMRect | Rect;\n  element: DOMRect;\n  inner: Rect;\n  outer: Rect;\n  trigger: Rect;\n}\n\n/**\n * Checks that the position along the horizontal axis\n * @param position - name of position\n */\nexport function isMajorAxisHorizontal(position: PositionType): boolean {\n  return ['left', 'right'].includes(position);\n}\n\n/**\n * Calculates the position of the popup on the minor axis\n * @param cfg - popup position config\n * @param centerPosition - position of the center of the trigger on the minor axis\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcPopupPositionByMinorAxis(cfg: PopupPositionConfig, centerPosition: number, dimensionName: 'height' | 'width'): number {\n  return centerPosition - cfg.arrow[dimensionName] / 2 - cfg.marginArrow - calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * TODO: optimize switch\n * Calculates Rect for given popup position config.\n * @param cfg - popup position config\n * */\nfunction calcPopupBasicRect(cfg: PopupPositionConfig): Rect {\n  let x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n  let y = cfg.inner.y - cfg.element.height;\n  switch (cfg.position) {\n    case 'left':\n      x = cfg.inner.x - cfg.element.width;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'right':\n      x = cfg.inner.right;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'bottom':\n      x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n      y = cfg.inner.bottom;\n      break;\n  }\n\n  return new Rect(x, y, cfg.element.width, cfg.element.height);\n}\n\n/**\n * Gets opposite position.\n * @param position - name of position\n * */\nfunction getOppositePosition(position: PositionType): PositionType {\n  return ({\n    top: 'bottom',\n    left: 'right',\n    right: 'left',\n    bottom: 'top'\n  }[position] || position) as PositionType;\n}\n\n/**\n * TODO: move the actionsToFit definition outside the function and optimize\n * Updates popup and arrow positions to fit on major axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMajorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): PositionType {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-major') return cfg.position;\n\n  let isMirrored = false;\n  const actionsToFit: Record<PositionType, () => void> = {\n    'bottom': () => {\n      if (cfg.intersectionRatio.bottom || cfg.outer.bottom < rect.bottom) {\n        rect.y = cfg.inner.y - cfg.element.height;\n        isMirrored = true;\n      }\n    },\n    'left': () => {\n      if (cfg.intersectionRatio.left || rect.x < cfg.outer.x) {\n        rect.x = cfg.inner.right;\n        isMirrored = true;\n      }\n    },\n    'right': () => {\n      if (cfg.intersectionRatio.right || cfg.outer.right < rect.right) {\n        rect.x = cfg.inner.x - cfg.element.width;\n        isMirrored = true;\n      }\n    },\n    'top': () => {\n      if (cfg.intersectionRatio.top || rect.y < cfg.outer.y) {\n        rect.y = cfg.inner.bottom;\n        isMirrored = true;\n      }\n    }\n  };\n  actionsToFit[cfg.position]();\n\n  return isMirrored ? getOppositePosition(cfg.position) : cfg.position;\n}\n\n/**\n * Calculates adjust for popup position to fit container bounds\n * @param elCoord - coordinate of the popup\n * @param outerCoord - coordinate of the outer border element\n * @param arrowCoord - coordinate of the arrow\n * @param arrowLimit - the limit value of the arrow coordinate\n * @param startingSide - is it starting side?\n * @returns adjustment value for the coordinates of the arrow and the popup\n */\nfunction adjustAlignmentBySide(elCoord: number, outerCoord: number, arrowCoord: number, arrowLimit: number, isStartingSide: boolean): number {\n  let arrowAdjust = 0;\n\n  if (isStartingSide ? elCoord < outerCoord : elCoord > outerCoord) {\n    arrowAdjust = elCoord - outerCoord;\n    const newCoord = arrowCoord + arrowAdjust;\n    if (isStartingSide ? newCoord < arrowLimit : newCoord > arrowLimit) {\n      arrowAdjust = 0;\n    }\n    /** It was decided that if the relative positions of the trigger and container\n     *  do not allow the popup to be displayed correctly together with the arrow,\n     *  the popup should be displayed as-is without adjusting the position of the minor axis\n     *\n     *  The following code adheres to a different strategy - maximum position adaptation,\n     *  with the popup having minimal overhang outside the container.\n     *  Perhaps in the future, we should allow the user to choose the strategy.\n     *\n     * const func = isStartingSide ? Math.max : Math.min;\n     * arrowAdjust = func(elCoord - outerCoord, arrowLimit - arrowCoord);\n     */\n  }\n\n  return arrowAdjust;\n}\n\n/**\n * Updates popup and arrow positions to fit on minor axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMinorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): void {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-minor') return;\n\n  const isHorizontal = isMajorAxisHorizontal(cfg.position);\n  const start = isHorizontal ? 'y' : 'x';\n  const end = isHorizontal ? 'bottom' : 'right';\n  const dimension = isHorizontal ? 'height' : 'width';\n\n  if (cfg.outer[dimension] < cfg.element[dimension] ||  // cancel fit mode if the popup size is greater than the outer limiter size\n      cfg.trigger[start] < cfg.outer[start] ||          // or the trigger is outside the outer limiting element\n      cfg.trigger[end] > cfg.outer[end]\n  ) return;\n\n  let coordAdjust = 0;\n  // check the starting side of the axis\n  let arrowLimit = cfg.marginArrow;\n  coordAdjust = adjustAlignmentBySide(rect[start], cfg.outer[start], arrow[start], arrowLimit, true);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n  // check the final side of the axis\n  arrowLimit += calcUsableSizeForArrow(cfg, dimension);\n  coordAdjust = adjustAlignmentBySide(rect[end], cfg.outer[end], arrow[start], arrowLimit, false);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n}\n\n/**\n * Calculates the usable size available for the arrow\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcUsableSizeForArrow(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.element[dimensionName] - cfg.arrow[dimensionName] - 2 * cfg.marginArrow;\n}\n\n/**\n * Calculates the position of the arrow on the minor axis\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcArrowPosition(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.marginArrow + calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * Calculates popup and arrow popup positions.\n * @param cfg - popup position config\n * */\nexport function calcPopupPosition(cfg: PopupPositionConfig): PopupPositionValue {\n  const popup = calcPopupBasicRect(cfg);\n  const arrow = {\n    x: calcArrowPosition(cfg, 'width'),\n    y: calcArrowPosition(cfg, 'height'),\n    position: cfg.position\n  };\n\n  const placedAt = fitOnMajorAxis(cfg, popup, arrow);\n  fitOnMinorAxis(cfg, popup, arrow);\n\n  return {\n    popup,\n    placedAt,\n    arrow\n  };\n}\n","import {range} from '../../esl-utils/misc/array';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, memoize, ready, prop, attr, boolAttr, jsonAttr} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {afterNextRender, rafDecorator} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {Rect} from '../../esl-utils/dom/rect';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\nimport {getListScrollParents} from '../../esl-utils/dom/scroll';\nimport {getWindowRect} from '../../esl-utils/dom/window';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {calcPopupPosition, isMajorAxisHorizontal} from './esl-popup-position';\nimport {ESLPopupPlaceholder} from './esl-popup-placeholder';\n\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core';\nimport type {PositionType, IntersectionRatioRect} from './esl-popup-position';\n\nconst INTERSECTION_LIMIT_FOR_ADJACENT_AXIS = 0.7;\nconst DEFAULT_OFFSET_ARROW = 50;\nconst scrollOptions = {passive: true} as EventListenerOptions;\n\nconst parsePercent = (value: string | number, nanValue: number = 0): number => {\n  const rawValue = parseNumber(value, nanValue);\n  return Math.max(0, Math.min(rawValue !== undefined ? rawValue : nanValue, 100));\n};\n\nexport interface PopupActionParams extends ESLToggleableActionParams {\n  /** popup position relative to trigger */\n  position?: PositionType;\n  /** popup behavior if it does not fit in the window */\n  behavior?: string;\n  /** Disable hiding the popup depending on the visibility of the activator */\n  disableActivatorObservation?: boolean;\n  /** Margins on the edges of the arrow. */\n  marginArrow?: string;\n  /** offset of the arrow as a percentage of the popup edge (0% - at the left edge, 100% - at the right edge, for RTL it is vice versa) */\n  offsetArrow?: string;\n  /** offset in pixels from trigger element */\n  offsetTrigger?: number;\n  /**\n   * offset in pixels from the edges of the container (or window if the container is not defined)\n   *  value as a number for equals x and y offsets\n   *  value as an array for different x and y offsets\n   */\n  offsetContainer?: number | [number, number];\n  /** margin around the element that is used as the viewport for checking the visibility of the popup activator */\n  intersectionMargin?: string;\n  /** Target to container element to define bounds of popups visibility */\n  container?: string;\n  /** Container element that defines bounds of popups visibility (is not taken into account if the container attr is set on popup) */\n  containerEl?: HTMLElement;\n}\n\nexport interface ActivatorObserver {\n  unsubscribers?: (() => void)[];\n  observer?: IntersectionObserver;\n}\n\n@ExportNs('Popup')\nexport class ESLPopup extends ESLToggleable {\n  public static is = 'esl-popup';\n\n  public $arrow: HTMLElement | null;\n  public $placeholder: ESLPopupPlaceholder | null;\n\n  protected _containerEl?: HTMLElement;\n  protected _offsetTrigger: number;\n  protected _offsetContainer: number | [number, number];\n  protected _deferredUpdatePosition = rafDecorator(() => this._updatePosition());\n  protected _activatorObserver: ActivatorObserver;\n  protected _intersectionMargin: string;\n  protected _intersectionRatio: IntersectionRatioRect = {};\n  protected _updateLoopID: number;\n\n  /**\n   * Popup position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public position: PositionType;\n\n  /** Popup behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Disable hiding the popup depending on the visibility of the activator */\n  @boolAttr() public disableActivatorObservation: boolean;\n  /**\n   * Margins on the edges of the arrow.\n   * This is the value in pixels that will be between the edge of the popup and\n   * the arrow at extreme positions of the arrow (when offsetArrow is set to 0 or 100)\n   */\n  @attr({defaultValue: '5'}) public marginArrow: string;\n\n  /**\n   * Offset of the arrow as a percentage of the popup edge\n   * (0% - at the left edge,\n   *  100% - at the right edge,\n   *  for RTL it is vice versa) */\n  @attr({defaultValue: `${DEFAULT_OFFSET_ARROW}`}) public offsetArrow: string;\n\n  /** Target to container element {@link ESLTraversingQuery} to define bounds of popups visibility (window by default) */\n  @attr() public container: string;\n\n  /** Default params to merge into passed action params */\n  @jsonAttr<PopupActionParams>({defaultValue: {\n    offsetTrigger: 3,\n    offsetContainer: 15,\n    intersectionMargin: '0px'\n  }})\n  public defaultParams: PopupActionParams;\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  /** Container element that define bounds of popups visibility */\n  @memoize()\n  protected get $container(): HTMLElement | undefined {\n    return this.container ? ESLTraversingQuery.first(this.container, this) as HTMLElement : this._containerEl;\n  }\n\n  /** Get the size and position of the container */\n  protected get containerRect(): Rect {\n    const {$container} = this;\n    if (!$container) return getWindowRect();\n    const containerRect = $container.getBoundingClientRect();\n    return new Rect(containerRect.left, containerRect.top + window.pageYOffset, containerRect.width, containerRect.height);\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.$arrow = this.querySelector('span.esl-popup-arrow');\n    this.moveToBody();\n  }\n\n  /** Checks that the position along the horizontal axis */\n  @memoize()\n  protected get _isMajorAxisHorizontal(): boolean {\n    return isMajorAxisHorizontal(this.position);\n  }\n\n  /** Checks that the position along the vertical axis */\n  @memoize()\n  protected get _isMajorAxisVertical(): boolean {\n    return !isMajorAxisHorizontal(this.position);\n  }\n\n  /** Get offsets arrow ratio */\n  @memoize()\n  protected get _offsetArrowRatio(): number {\n    const ratio = parsePercent(this.offsetArrow, DEFAULT_OFFSET_ARROW) / 100;\n    return RTLUtils.isRtl(this) ? 1 - ratio : ratio;\n  }\n\n  /** Moves popup into document.body */\n  protected moveToBody(): void {\n    const {parentNode, $placeholder} = this;\n    if (!parentNode || parentNode === document.body) return;\n\n    // to be safe and prevent leaks\n    $placeholder && $placeholder.parentNode?.removeChild($placeholder);\n\n    // replace this with placeholder element\n    this.$placeholder = ESLPopupPlaceholder.from(this);\n    parentNode.replaceChild(this.$placeholder, this);\n    document.body.appendChild(this);\n  }\n\n  /**\n   * Actions to execute on show popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire esl:refresh event by default.\n   */\n  protected onShow(params: PopupActionParams): void {\n    super.onShow(params);\n\n    if (params.position) {\n      this.position = params.position;\n    }\n    if (params.behavior) {\n      this.behavior = params.behavior;\n    }\n    if (params.disableActivatorObservation) {\n      this.disableActivatorObservation = params.disableActivatorObservation;\n    }\n    if (params.marginArrow) {\n      this.marginArrow = params.marginArrow;\n    }\n    if (params.offsetArrow) {\n      this.offsetArrow = params.offsetArrow;\n    }\n    if (params.container) {\n      this.container = params.container;\n    }\n    this._containerEl = params.containerEl;\n    this._offsetTrigger = params.offsetTrigger || 0;\n    this._offsetContainer = params.offsetContainer || 0;\n    this._intersectionMargin = params.intersectionMargin || '0px';\n\n    this.style.visibility = 'hidden'; // eliminates the blinking of the popup at the previous position\n\n    afterNextRender(() => this.afterOnShow()); // running as a separate task solves the problem with incorrect positioning on the first showing\n  }\n\n  /**\n   * Actions to execute on hide popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and updates a11y by default.\n   */\n  protected onHide(params: PopupActionParams): void {\n    this.beforeOnHide();\n    super.onHide(params);\n\n    this._stopUpdateLoop();\n    this.activator && this._removeActivatorObserver(this.activator);\n\n    // clear all memoize data\n    memoize.clear(this, '_isMajorAxisHorizontal');\n    memoize.clear(this, '_isMajorAxisVertical');\n    memoize.clear(this, '_offsetArrowRatio');\n    memoize.clear(this, '$container');\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected afterOnShow(): void {\n    this._updatePosition();\n    this.style.visibility = 'visible';\n    this.activator && this._addActivatorObserver(this.activator);\n    this._startUpdateLoop();\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected beforeOnHide(): void {}\n\n  /**\n   * Checks activator intersection for adjacent axis.\n   * Hides the popup if the intersection ratio exceeds the limit.\n   */\n  protected _checkIntersectionForAdjacentAxis(isAdjacentAxis: boolean, intersectionRatio: number): void {\n    if (isAdjacentAxis && intersectionRatio < INTERSECTION_LIMIT_FOR_ADJACENT_AXIS) {\n      this.hide();\n    }\n  }\n\n  /** Actions to execute on activator intersection event. */\n  @bind\n  protected onActivatorIntersection(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void {\n    const entry = entries[0];\n    this._intersectionRatio = {};\n    if (!entry.isIntersecting) {\n      this.hide();\n      return;\n    }\n\n    if (entry.intersectionRect.y !== entry.boundingClientRect.y) {\n      this._intersectionRatio.top = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.top);\n    }\n    if (entry.intersectionRect.bottom !== entry.boundingClientRect.bottom) {\n      this._intersectionRatio.bottom = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.bottom);\n    }\n    if (entry.intersectionRect.x !== entry.boundingClientRect.x) {\n      this._intersectionRatio.left = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.left);\n    }\n    if (entry.intersectionRect.right !== entry.boundingClientRect.right) {\n      this._intersectionRatio.right = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.right);\n    }\n  }\n\n  /** Actions to execute on activator scroll event. */\n  @bind\n  protected onActivatorScroll(e: Event): void {\n    if (this._updateLoopID) return;\n    this._updatePosition();\n  }\n\n  /** Creates listeners and observers to observe activator after showing popup */\n  protected _addActivatorObserver(target: HTMLElement): void {\n    const scrollParents = getListScrollParents(target);\n\n    this._activatorObserver = {\n      unsubscribers: scrollParents.map(($root) => {\n        $root.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        return (): void => {\n          $root && $root.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        };\n      })\n    };\n\n    if (!this.disableActivatorObservation) {\n      const options = {\n        rootMargin: this._intersectionMargin,\n        threshold: range(9, (x) => x / 8)\n      } as IntersectionObserverInit;\n\n      const observer = new IntersectionObserver(this.onActivatorIntersection, options);\n      observer.observe(target);\n\n      this._activatorObserver.observer = observer;\n    }\n\n    window.addEventListener('resize', this._deferredUpdatePosition);\n    window.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    document.body.addEventListener('transitionstart', this._startUpdateLoop);\n  }\n\n  /** Removes activator listeners and observers after hiding popup */\n  protected _removeActivatorObserver(target: HTMLElement): void {\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n    window.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    document.body.removeEventListener('transitionstart', this._startUpdateLoop);\n\n    if (!this._activatorObserver) return;\n    this._activatorObserver.observer?.disconnect();\n    this._activatorObserver.observer = undefined;\n    this._activatorObserver.unsubscribers?.forEach((cb) => cb());\n    this._activatorObserver.unsubscribers = [];\n  }\n\n  /**\n   * Starts loop for update position of popup.\n   * The loop ends when the position and size of the activator have not changed\n   * for the last 2 frames of the animation.\n   */\n  @bind\n  protected _startUpdateLoop(): void {\n    if (this._updateLoopID) return;\n\n    let same = 0;\n    let lastRect = new Rect();\n    const updateLoop = (): void => {\n      if (!this.activator) {\n        this._stopUpdateLoop();\n        return;\n      }\n\n      const newRect = Rect.from(this.activator.getBoundingClientRect());\n      if (!Rect.isEqual(lastRect, newRect)) {\n        same = 0;\n        lastRect = newRect;\n      }\n\n      if (same++ > 2) {\n        this._stopUpdateLoop();\n        return;\n      }\n      this._updatePosition();\n      this._updateLoopID = requestAnimationFrame(updateLoop);\n    };\n\n    this._updateLoopID = requestAnimationFrame(updateLoop);\n  }\n\n  /**\n   * Stops loop for update position of popup.\n   * Also cancels the animation frame request.\n   */\n  @bind\n  protected _stopUpdateLoop(): void {\n    if (!this._updateLoopID) return;\n    cancelAnimationFrame(this._updateLoopID);\n    this._updateLoopID = 0;\n  }\n\n  /** Updates position of popup and its arrow */\n  protected _updatePosition(): void {\n    if (!this.activator) return;\n\n    const triggerRect = this.activator.getBoundingClientRect();\n    const popupRect = this.getBoundingClientRect();\n    const arrowRect = this.$arrow ? this.$arrow.getBoundingClientRect() : new Rect();\n    const trigger = new Rect(triggerRect.left, triggerRect.top + window.pageYOffset, triggerRect.width, triggerRect.height);\n    const innerMargin = this._offsetTrigger + arrowRect.width / 2;\n    const {containerRect} = this;\n\n    const config = {\n      position: this.position,\n      behavior: this.behavior,\n      marginArrow: +this.marginArrow,\n      offsetArrowRatio: this._offsetArrowRatio,\n      intersectionRatio: this._intersectionRatio,\n      arrow: arrowRect,\n      element: popupRect,\n      trigger,\n      inner: Rect.from(trigger).grow(innerMargin),\n      outer: (typeof this._offsetContainer === 'number') ?\n        containerRect.shrink(this._offsetContainer) :\n        containerRect.shrink(...this._offsetContainer)\n    };\n\n    const {placedAt, popup, arrow} = calcPopupPosition(config);\n\n    this.setAttribute('placed-at', placedAt);\n    // set popup position\n    this.style.left = `${popup.x}px`;\n    this.style.top = `${popup.y}px`;\n    // set arrow position\n    if (this.$arrow) {\n      this.$arrow.style.left = this._isMajorAxisVertical ? `${arrow.x}px` : '';\n      this.$arrow.style.top = this._isMajorAxisHorizontal ? `${arrow.y}px` : '';\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Popup: typeof ESLPopup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup': ESLPopup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLMixinElement} from '../../esl-mixin-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core/esl-toggleable';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {listen, attr} from '../../esl-utils/decorators';\nimport {copyDefinedKeys} from '../../esl-utils/misc/object/copy';\n\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\nexport type ESLRelatedTargetActionType = 'all' | 'show' | 'hide';\n\n/**\n * ESLRelatedTarget mixin element\n * @author Anastasia Lesun, Alexey Stsefanovich (ala'n)\n *\n * ESLRelatedTarget is a custom mixin element that can be used with {@link ESLToggleable}s to sync their states\n */\n@ExportNs('RelatedTarget')\nexport class ESLRelatedTarget extends ESLMixinElement {\n  static is = 'esl-related-target';\n\n  /** Selector/query ({@link ESLTraversingQuery}) to find related ESLToggleable element */\n  @attr({name: ESLRelatedTarget.is}) public selector: string;\n  /** Action to synchronize between toggleables */\n  @attr({name: ESLRelatedTarget.is + '-action', defaultValue: 'all'}) public action: ESLRelatedTargetActionType;\n\n  /** @returns related toggleable instances */\n  public get $targets(): ESLToggleable[] {\n    const {selector} = this;\n    if (!selector) return [];\n    const targets = ESLTraversingQuery.all(selector, this.$host);\n    return targets.filter(\n      (target: HTMLElement): target is ESLToggleable => target instanceof ESLToggleable && target !== this.$host\n    );\n  }\n\n  /** Merges params that are used to initiate actions */\n  protected mergeParams(params: ESLToggleableActionParams): ESLToggleableActionParams {\n    return Object.assign(copyDefinedKeys(params), {\n      initiator: 'relatedToggleable',\n      activator: this.$host\n    });\n  }\n\n  /** Processes {@link ESLToggleable} show event */\n  @listen('esl:show')\n  protected onShow(e: CustomEvent): void {\n    if (this.action === 'hide') return;\n    const {params} = e.detail;\n    this.$targets.forEach((target) => target.show({params: this.mergeParams(params)}));\n  }\n\n  /** Processes {@link ESLToggleable} hide event */\n  @listen('esl:hide')\n  protected onHide(e: CustomEvent): void {\n    if (this.action === 'show') return;\n    const {params} = e.detail;\n    this.$targets.forEach((target) => target.hide({params: this.mergeParams(params)}));\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind, ready, attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {isMouseEvent, isTouchEvent, getTouchPoint, getOffsetPoint} from '../../esl-utils/dom/events';\nimport {isRelativeNode} from '../../esl-utils/dom/traversing';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\n\n/**\n * ESLScrollbar is a reusable web component that replaces the browser's default scrollbar with\n * a custom scrollbar implementation.\n *\n * @author Yuliya Adamskaya\n */\n@ExportNs('Scrollbar')\nexport class ESLScrollbar extends ESLBaseElement {\n  public static is = 'esl-scrollbar';\n  public static observedAttributes = ['target', 'horizontal'];\n\n  /** Horizontal scroll orientation marker */\n  @boolAttr() public horizontal: boolean;\n  /** Disable continuous scroll when the mouse pressed on scrollbar */\n  @boolAttr() public noContinuousScroll: boolean;\n\n  /** Target element {@link ESLTraversingQuery} selector. Parent element by default */\n  @attr({defaultValue: '::parent'}) public target: string;\n  /** Custom class for thumb element. 'scrollbar-thumb' by default */\n  @attr({defaultValue: 'scrollbar-thumb'}) public thumbClass: string;\n  /** Custom class for track element area. 'scrollbar-track' by default */\n  @attr({defaultValue: 'scrollbar-track'}) public trackClass: string;\n\n  /** @readonly Dragging state marker */\n  @boolAttr({readonly: true}) public dragging: boolean;\n  /** @readonly Inactive state marker */\n  @boolAttr({readonly: true}) public inactive: boolean;\n\n  /** @readonly Indicates that the scroll is at the beginning */\n  @boolAttr({readonly: true}) public atStart: boolean;\n  /** @readonly Indicates that the scroll is at the end */\n  @boolAttr({readonly: true}) public atEnd: boolean;\n\n  protected $scrollbarThumb: HTMLElement;\n  protected $scrollbarTrack: HTMLElement;\n\n  protected _$target: HTMLElement | null;\n  protected _pointerPosition: number;\n  protected _initialPosition: number;\n  protected _initialMousePosition: number;\n\n  protected _deferredDrag = rafDecorator((e) => this._onPointerDrag(e));\n  protected _deferredRefresh = rafDecorator(() => this.refresh());\n  protected _scrollTimer: number = 0;\n  protected _resizeObserver = new ResizeObserver(this._deferredRefresh);\n  protected _mutationObserver = new MutationObserver((rec) => this.updateContentObserve(rec));\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n    this.findTarget();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    this.unbindTargetEvents();\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'target') this.findTarget();\n    if (attrName === 'horizontal') this.refresh();\n  }\n\n  protected findTarget(): void {\n    this.$target = this.target ?\n      ESLTraversingQuery.first(this.target, this) as HTMLElement :\n      null;\n  }\n\n  /** Target element to observe and scroll */\n  public get $target(): HTMLElement | null {\n    return this._$target || null;\n  }\n\n  public set $target(content: HTMLElement | null) {\n    this.unbindTargetEvents();\n    this._$target = content;\n    this.bindTargetEvents();\n    this._deferredRefresh();\n  }\n\n  protected render(): void {\n    this.innerHTML = '';\n    this.$scrollbarTrack = document.createElement('div');\n    this.$scrollbarTrack.className = this.trackClass;\n    this.$scrollbarThumb = document.createElement('div');\n    this.$scrollbarThumb.className = this.thumbClass;\n\n    this.$scrollbarTrack.appendChild(this.$scrollbarThumb);\n    this.appendChild(this.$scrollbarTrack);\n  }\n\n  protected bindTargetEvents(): void {\n    if (!this.$target) return;\n    // Container resize/scroll observers/listeners\n    if (document.documentElement === this.$target) {\n      this.$$on({event: 'scroll resize', target: window}, this._onScrollOrResize);\n    } else {\n      this.$$on({event: 'scroll', target: this.$target}, this._onScrollOrResize);\n      this._resizeObserver.observe(this.$target);\n    }\n    // Subscribes to the child elements resizes\n    this._mutationObserver.observe(this.$target, {childList: true});\n    Array.from(this.$target.children).forEach((el) => this._resizeObserver.observe(el));\n  }\n\n  /** Resubscribes resize observer on child elements when container content changes */\n  protected updateContentObserve(recs: MutationRecord[] = []): void {\n    if (!this.$target) return;\n    const contentChanges = recs.filter((rec) => rec.type === 'childList');\n    contentChanges.forEach((rec) => {\n      Array.from(rec.addedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.observe(el));\n      Array.from(rec.removedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.unobserve(el));\n    });\n    if (contentChanges.length) this._deferredRefresh();\n  }\n\n  protected unbindTargetEvents(): void {\n    if (!this.$target) return;\n    this.$$off(this._onScrollOrResize);\n    if (document.documentElement !== this.$target) {\n      this._resizeObserver.disconnect();\n      this._mutationObserver.disconnect();\n    }\n  }\n\n  /** @readonly Scrollable distance size value (px) */\n  public get scrollableSize(): number {\n    if (!this.$target) return 0;\n    return this.horizontal ?\n      this.$target.scrollWidth - this.$target.clientWidth :\n      this.$target.scrollHeight - this.$target.clientHeight;\n  }\n\n  /** @readonly Track size value (px) */\n  public get trackOffset(): number {\n    return this.horizontal ? this.$scrollbarTrack.offsetWidth : this.$scrollbarTrack.offsetHeight;\n  }\n\n  /** @readonly Thumb size value (px) */\n  public get thumbOffset(): number {\n    return this.horizontal ? this.$scrollbarThumb.offsetWidth : this.$scrollbarThumb.offsetHeight;\n  }\n\n  /** @readonly Relative thumb size value (between 0.0 and 1.0) */\n  public get thumbSize(): number {\n    // behave as native scroll\n    if (!this.$target || !this.$target.scrollWidth || !this.$target.scrollHeight) return 1;\n    const areaSize = this.horizontal ? this.$target.clientWidth : this.$target.clientHeight;\n    const scrollSize = this.horizontal ? this.$target.scrollWidth : this.$target.scrollHeight;\n    return Math.min((areaSize + 1) / scrollSize, 1);\n  }\n\n  /** Relative position value (between 0.0 and 1.0) */\n  public get position(): number {\n    if (!this.$target) return 0;\n    const scrollOffset = this.horizontal ? RTLUtils.normalizeScrollLeft(this.$target) : this.$target.scrollTop;\n    return this.scrollableSize ? (scrollOffset / this.scrollableSize) : 0;\n  }\n\n  public set position(position: number) {\n    this.scrollTargetTo(this.scrollableSize * this.normalizePosition(position));\n    this.update();\n  }\n\n  /** Normalizes position value (between 0.0 and 1.0) */\n  protected normalizePosition(position: number): number {\n    const relativePosition = Math.min(1, Math.max(0, position));\n    if (!RTLUtils.isRtl(this.$target) || !this.horizontal) return relativePosition;\n    return RTLUtils.scrollType === 'negative' ? (relativePosition - 1) : (1 - relativePosition);\n  }\n\n  /** Scrolls target element to passed position */\n  protected scrollTargetTo(pos: number): void {\n    if (!this.$target) return;\n    this.$target.scrollTo({\n      [this.horizontal ? 'left' : 'top']: pos,\n      behavior: this.dragging ? 'auto' : 'smooth'\n    });\n  }\n\n  /** Updates thumb size and position */\n  public update(): void {\n    this.$$fire('esl:change:scroll', {bubbles: false});\n    if (!this.$scrollbarThumb || !this.$scrollbarTrack) return;\n    const thumbSize = this.trackOffset * this.thumbSize;\n    const thumbPosition = (this.trackOffset - thumbSize) * this.position;\n    const style = {\n      [this.horizontal ? 'left' : 'top']: `${thumbPosition}px`,\n      [this.horizontal ? 'width' : 'height']: `${thumbSize}px`\n    };\n    Object.assign(this.$scrollbarThumb.style, style);\n  }\n\n  /** Updates auxiliary markers */\n  public updateMarkers(): void {\n    const {position, thumbSize} =  this;\n    this.toggleAttribute('at-start', thumbSize < 1 && position <= 0);\n    this.toggleAttribute('at-end', thumbSize < 1 && position >= 1);\n    this.toggleAttribute('inactive', thumbSize >= 1);\n  }\n\n  /** Refreshes scroll state and position */\n  public refresh(): void {\n    this.update();\n    this.updateMarkers();\n  }\n\n  /** Returns position from MouseEvent coordinates (not normalized) */\n  public toPosition(event: MouseEvent | TouchEvent): number {\n    const {horizontal, thumbOffset, trackOffset} = this;\n    const point = getTouchPoint(event);\n    const offset = getOffsetPoint(this.$scrollbarTrack);\n    const pointPosition = horizontal ? point.x - offset.x : point.y - offset.y;\n    const freeTrackArea = trackOffset - thumbOffset; // size of free track px\n    const clickPositionNoOffset = pointPosition - thumbOffset / 2;\n    return clickPositionNoOffset / freeTrackArea;\n  }\n\n  // Event listeners\n  /** Handles `mousedown` / `touchstart` event to manage thumb drag start and scroll clicks */\n  @listen('mousedown touchstart')\n  protected _onPointerDown(event: MouseEvent | TouchEvent): void {\n    this._initialPosition = this.position;\n    this._pointerPosition = this.toPosition(event);\n    const point = getTouchPoint(event);\n    this._initialMousePosition = this.horizontal ? point.x : point.y;\n\n    if (event.target === this.$scrollbarThumb) {\n      this._onThumbPointerDown(event); // Drag start handler\n    } else {\n      this._onPointerDownTick(true); // Continuous scroll and click handler\n    }\n\n    // Subscribes inverse handlers\n    isMouseEvent(event) && this.$$on({event: 'mouseup', target: window}, this._onPointerUp);\n    isTouchEvent(event) && this.$$on({event: 'touchend', target: window}, this._onPointerUp);\n\n    // Prevents default text selection, etc.\n    if (!isTouchEvent(event)) event.preventDefault();\n  }\n\n  /** Handles a scroll click / continuous scroll*/\n  @bind\n  protected _onPointerDownTick(first: boolean): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n\n    const position = this.position;\n    const allowedOffset = (first ? 1 : 1.5) * this.thumbSize;\n    this.position = Math.min(position + allowedOffset, Math.max(position - allowedOffset, this._pointerPosition));\n\n    if (this.position === this._pointerPosition || this.noContinuousScroll) return;\n    this._scrollTimer = window.setTimeout(this._onPointerDownTick, 400);\n  }\n\n  /** Handles thumb drag start */\n  @bind\n  protected _onThumbPointerDown(event: MouseEvent | TouchEvent): void {\n    this.toggleAttribute('dragging', true);\n    this.$target?.style.setProperty('scroll-behavior', 'auto');\n    // Attaches drag listeners\n    this.$$on(this._onBodyClick);\n    isMouseEvent(event) && this.$$on({event: 'mousemove', target: window}, this._onPointerMove);\n    isTouchEvent(event) && this.$$on({event: 'touchmove', target: window}, this._onPointerMove);\n  }\n\n  /** Sets position on drag */\n  protected _onPointerDrag(event: MouseEvent | TouchEvent): void {\n    const point = getTouchPoint(event);\n    const mousePosition = this.horizontal ? point.x : point.y;\n    const positionChange = mousePosition - this._initialMousePosition;\n    const scrollableAreaHeight = this.trackOffset - this.thumbOffset;\n    const absChange = scrollableAreaHeight ? (positionChange / scrollableAreaHeight) : 0;\n    this.position = this._initialPosition + absChange;\n\n    this.updateMarkers();\n  }\n\n  /** `mousemove` document handler for thumb drag event. Active only if drag action is active */\n  protected _onPointerMove(event: MouseEvent | TouchEvent): void {\n    if (!this.dragging) return;\n    // Request position update\n    this._deferredDrag(event);\n    // Prevents default text selection, etc.\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /** `mouseup` short-time document handler for drag end action */\n  protected _onPointerUp(event: MouseEvent | TouchEvent): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n    this.toggleAttribute('dragging', false);\n    this.$target?.style.removeProperty('scroll-behavior');\n\n    // Unbinds drag listeners\n    this.$$off(this._onPointerMove);\n    this.$$off(this._onPointerUp);\n  }\n\n  /** Body `click` short-time handler to prevent clicks event on thumb drag. Handles capture phase */\n  @listen({auto: false, event: 'click', target: window, once: true, capture: true})\n  protected _onBodyClick(event: MouseEvent): void {\n    event.stopImmediatePropagation();\n  }\n\n  /**\n   * Handler for refresh event\n   * @param event - instance of 'esl:refresh' event.\n   */\n  @listen({\n    event: (el: ESLScrollbar) => el.REFRESH_EVENT,\n    target: window\n  })\n  protected _onRefresh(event: Event): void {\n    if (!(event.target instanceof Element)) return;\n    if (!isRelativeNode(event.target.parentNode, this.$target)) return;\n    this._deferredRefresh();\n  }\n\n  /**\n   * Handler for scroll and resize events\n   * @param event - instance of 'resize' or 'scroll' event\n   */\n  protected _onScrollOrResize(event: Event): void {\n    if (event.type === 'scroll' && this.dragging) return;\n    this._deferredRefresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Scrollbar: typeof ESLScrollbar;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-scrollbar': ESLScrollbar;\n  }\n}\n","import {attr} from '../../esl-utils/decorators';\nimport {setAttr} from '../../esl-utils/dom/attr';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLTrigger} from '../../esl-trigger/core';\n\n/**\n * ESlTab component\n * @author Julia Murashko\n *\n * Tab trigger item, usually used in conjunction with a {@link ESLTabs}.\n * Can control any {@link ESLToggleable} instance but is usually used in conjunction with {@link ESLPanel}\n */\n@ExportNs('Tab')\nexport class ESLTab extends ESLTrigger {\n  public static is = 'esl-tab';\n\n  @attr({defaultValue: 'show'}) public mode: string;\n  @attr({defaultValue: 'active'}) public activeClass: string;\n\n  public initA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    if (target.hasAttribute('role')) return;\n    setAttr(target, 'role', 'tab');\n  }\n\n  public updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    if (this.a11yLabelActive !== null || this.a11yLabelInactive !== null) {\n      setAttr(target, 'aria-label', this.a11yLabel);\n    }\n    setAttr(target, 'aria-selected', String(this.active));\n    setAttr(target, 'tabindex', this.active ? '0' : '-1');\n\n    if (this.$target && this.$target.id) {\n      setAttr(target, 'aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tab: typeof ESLTab;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tab': ESLTab;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {memoize, attr, listen, decorate} from '../../esl-utils/decorators';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {ESLMediaRuleList} from '../../esl-media-query/core/esl-media-rule-list';\nimport {ESLTab} from './esl-tab';\n\n/**\n * ESlTabs component\n * @author Julia Murashko\n *\n * Tabs container component for Tabs trigger group.\n * Uses {@link ESLTab} as an item.\n * Each individual {@link ESLTab} can control {@link ESLToggleable} or, usually, {@link ESLPanel}\n */\n@ExportNs('Tabs')\nexport class ESLTabs extends ESLBaseElement {\n  public static is = 'esl-tabs';\n  public static observedAttributes = ['scrollable'];\n\n  /** List of supported scrollable types */\n  public static supportedScrollableTypes = ['disabled', 'side', 'center'];\n\n  /**\n   * Scrollable mode (supports {@link ESLMediaRuleList}).\n   * Supported types for different breakpoints ('disabled' by default):\n   * - 'disabled' or not defined -  scroll behavior is disabled;\n   * - 'center' - scroll behavior is enabled, tab is center-aligned;\n   * - 'side' - scroll behavior is enabled, tab is side-aligned;\n   * - empty or unsupported value is equal to 'side' behavior;\n   */\n  @attr({defaultValue: 'disabled'}) public scrollable: string;\n\n  /** Inner element to contain {@link ESLTab} collection. Will be scrolled in a scrollable mode */\n  @attr({defaultValue: '.esl-tab-container'}) public scrollableTarget: string;\n\n  protected _deferredUpdateArrows = debounce(this.updateArrows, 100, this);\n  protected _deferredFitToViewport = debounce(this.fitToViewport, 100, this);\n\n  /** ESLMediaRuleList instance of the scrollable type mapping */\n  @memoize()\n  public get scrollableTypeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.scrollable);\n  }\n\n  /** @returns current scrollable type */\n  public get currentScrollableType(): string {\n    return this.scrollableTypeRules.activeValue || 'side';\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.updateScrollableType();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'scrollable') {\n      memoize.clear(this, 'scrollableTypeRules');\n      this.$$on(this._onScrollableTypeChange);\n      this.updateScrollableType();\n    }\n  }\n\n  protected bindScrollableEvents(): void {\n    this.$$on(this._onScroll);\n    this.$$on(this._onResize);\n  }\n  protected unbindScrollableEvents(): void {\n    this.$$off(this._onScroll);\n    this.$$off(this._onResize);\n  }\n\n  /** Collection of inner {@link ESLTab} items */\n  public get $tabs(): ESLTab[] {\n    const els = this.querySelectorAll(ESLTab.is);\n    return els ? Array.from(els) as ESLTab[] : [];\n  }\n\n  /** Active {@link ESLTab} item */\n  public get $current(): ESLTab | null {\n    return this.$tabs.find((el) => el.active) || null;\n  }\n\n  /** Container element to scroll */\n  public get $scrollableTarget(): HTMLElement | null {\n    return this.querySelector(this.scrollableTarget);\n  }\n\n  /** Is the scrollable mode enabled ? */\n  public get isScrollable(): boolean {\n    return this.currentScrollableType !== 'disabled';\n  }\n\n  /** Move scroll to the next/previous item */\n  public moveTo(direction: string, behavior: ScrollBehavior = 'smooth'): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n    let left = $scrollableTarget.offsetWidth;\n    left = RTLUtils.isRtl(this) && RTLUtils.scrollType !== 'reverse' ? -left : left;\n    left = direction === 'left' ? -left : left;\n\n    $scrollableTarget.scrollBy({left, behavior});\n  }\n\n  /** Scroll tab to the view */\n  protected fitToViewport($trigger: ESLTab | null, behavior: ScrollBehavior = 'smooth'): void {\n    this.updateMarkers();\n\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget || !$trigger) return;\n\n    const areaRect = $scrollableTarget.getBoundingClientRect();\n    const itemRect = $trigger.getBoundingClientRect();\n\n    $scrollableTarget.scrollBy({\n      left: this.calcScrollOffset(itemRect, areaRect),\n      behavior\n    });\n\n    this.updateArrows();\n  }\n\n  /** Get scroll offset position from the selected item rectangle */\n  protected calcScrollOffset(itemRect: DOMRect, areaRect: DOMRect): number | undefined {\n    const isReversedRTL = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'reverse';\n\n    if (this.currentScrollableType === 'center') {\n      const shift = itemRect.left + itemRect.width / 2 - (areaRect.left + areaRect.width / 2);\n      return isReversedRTL ? -shift : shift;\n    }\n\n    // item is out of area from the right side\n    // else item out is of area from the left side\n    if (itemRect.right > areaRect.right) {\n      return isReversedRTL ? Math.floor(areaRect.right - itemRect.right) : Math.ceil(itemRect.right - areaRect.right);\n    } else if (itemRect.left < areaRect.left) {\n      return isReversedRTL ? Math.ceil(areaRect.left - itemRect.left) : Math.floor(itemRect.left - areaRect.left);\n    }\n  }\n\n  protected updateArrows(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const swapSides = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'default';\n    const scrollStart = Math.abs($scrollableTarget.scrollLeft) > 1;\n    const scrollEnd = Math.abs($scrollableTarget.scrollLeft) + $scrollableTarget.clientWidth + 1 < $scrollableTarget.scrollWidth;\n\n    const $rightArrow = this.querySelector('[data-tab-direction=\"right\"]');\n    const $leftArrow = this.querySelector('[data-tab-direction=\"left\"]');\n\n    $leftArrow && $leftArrow.toggleAttribute('disabled', !(swapSides ? scrollEnd : scrollStart));\n    $rightArrow && $rightArrow.toggleAttribute('disabled', !(swapSides ? scrollStart : scrollEnd));\n  }\n\n  protected updateMarkers(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const hasScroll = this.isScrollable && ($scrollableTarget.scrollWidth > this.clientWidth);\n    this.toggleAttribute('has-scroll', hasScroll);\n  }\n\n  /** Update element state according to scrollable type */\n  protected updateScrollableType(): void {\n    ESLTabs.supportedScrollableTypes.forEach((type) => {\n      this.$$cls(`scrollable-${type}`, this.currentScrollableType === type);\n    });\n    this._deferredFitToViewport(this.$current);\n\n    if (this.currentScrollableType === 'disabled') {\n      this.unbindScrollableEvents();\n    } else {\n      this.bindScrollableEvents();\n    }\n  }\n\n  @listen('esl:change:active')\n  protected _onTriggerStateChange({detail}: CustomEvent): void {\n    if (!detail.active) return;\n    this._deferredFitToViewport(this.$current);\n  }\n\n  @listen('click')\n  protected _onClick(event: Event): void {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const target: HTMLElement | null = eventTarget.closest('[data-tab-direction]');\n    const direction = target && target.dataset.tabDirection;\n\n    if (!direction) return;\n    this.moveTo(direction);\n  }\n\n  @listen('focusin')\n  protected _onFocus(e: FocusEvent): void {\n    const target = e.target;\n    if (target instanceof ESLTab) this._deferredFitToViewport(target);\n  }\n\n  @listen({\n    auto: false,\n    event: 'scroll',\n    target: (el: ESLTabs) => el.$scrollableTarget\n  })\n  protected _onScroll(): void {\n    this._deferredUpdateArrows();\n  }\n\n  @listen({\n    auto: false,\n    event: 'resize',\n    target: window,\n    passive: true\n  })\n  @decorate(rafDecorator)\n  protected _onResize(): void {\n    this._deferredFitToViewport(this.$current, 'auto');\n  }\n\n  /** Handles scrollable type change */\n  @listen({\n    event: 'change',\n    target: (el: ESLTabs) => el.scrollableTypeRules\n  })\n  protected _onScrollableTypeChange(): void {\n    this.updateScrollableType();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tabs: typeof ESLTabs;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-tabs': ESLTabs;\n  }\n}\n","import {ESLBaseElement, listen} from '../../esl-base-element/core';\nimport {getCompositeTarget} from '../../esl-utils/dom/events';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleable} from './esl-toggleable';\n\n/**\n * ESLToggleableDispatcher\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleableDispatcher - plugin component, that prevents activation of multiple ESLToggleable instances in bounds of managed container.\n */\n@ExportNs('ToggleableDispatcher')\nexport class ESLToggleableDispatcher extends ESLBaseElement {\n  public static readonly is = 'esl-toggleable-dispatcher';\n\n  /**\n   * Initialize ToggleableGroupDispatcher\n   * Uses esl-toggleable-dispatcher tag and document body root by default\n   */\n  public static init(root: HTMLElement = document.body, tagName: string = this.is): void {\n    if (!root) throw new Error('Root element should be specified');\n    const instances = root.getElementsByTagName(tagName);\n    if (instances.length) return;\n    this.register(tagName);\n    root.insertAdjacentElement('afterbegin', document.createElement(tagName));\n  }\n\n  protected _popups: Map<string, ESLToggleable> = new Map<string, ESLToggleable>();\n\n  /** Observed element */\n  public get root(): HTMLElement | null {\n    return this.parentElement;\n  }\n\n  /** Guard-condition for targets */\n  protected isAcceptable(target: any): target is ESLToggleable {\n    if (!(target instanceof ESLToggleable)) return false;\n    return !!target.groupName && target.groupName !== 'none';\n  }\n\n  /** Hides active element in group */\n  public hideActive(groupName: string, activator?: HTMLElement): void {\n    const active = this.getActive(groupName);\n    if (!active || active === activator) return;\n    active.hide({\n      initiator: 'dispatcher',\n      dispatcher: this,\n      activator\n    });\n  }\n\n  /** Sets active element in group */\n  public setActive(groupName: string, popup: ESLToggleable): void {\n    if (!groupName) return;\n    this.hideActive(groupName, popup);\n    this._popups.set(groupName, popup);\n  }\n\n  /** Gets active element in group or undefined if group doesn't exist */\n  public getActive(groupName: string): ESLToggleable | undefined {\n    return this._popups.get(groupName);\n  }\n\n  /** Deletes element from the group if passed element is currently active */\n  public deleteActive(groupName: string, popup: ESLToggleable): void {\n    if (this.getActive(groupName) !== popup) return;\n    this._popups.delete(groupName);\n  }\n\n  /** Hides active element before e.target will be shown */\n  @listen({\n    event: ESLToggleable.prototype.BEFORE_SHOW_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onBeforeShow(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.hideActive(target.groupName, target);\n  }\n\n  /** Updates active element after a new element is shown */\n  @listen({\n    event: ESLToggleable.prototype.SHOW_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onShow(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.setActive(target.groupName, target);\n  }\n\n  /** Updates group state after active element is hidden */\n  @listen({\n    event: ESLToggleable.prototype.HIDE_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onHide(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.deleteActive(target.groupName, target);\n  }\n\n  /** Updates active elements */\n  @listen({\n    event: ESLToggleable.prototype.GROUP_CHANGED_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onChangeGroup(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    const {oldGroupName, newGroupName} = e.detail;\n    this.deleteActive(oldGroupName, target);\n    this.setActive(newGroupName, target);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleableDispatcher: typeof ESLToggleableDispatcher;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-dispatcher': ESLToggleableDispatcher;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\n\nimport type {ESLToggleable} from '../../esl-toggleable/core';\n\n@ExportNs('ToggleablePlaceholder')\nexport class ESLToggleablePlaceholder extends ESLBaseElement {\n  public static is = 'esl-toggleable-placeholder';\n\n  /** List of attributes allowed to copy from origin to this element */\n  public static readonly allowedAttrs: string[] = ['id', 'class'];\n\n  public $origin: ESLToggleable | null;\n\n  /** reates a placeholder for a given element of the toggleable's descendant */\n  public static from<T extends typeof ESLToggleablePlaceholder>(this: T, $el: ESLToggleable): InstanceType<T> {\n    const $placeholder = document.createElement(this.is) as InstanceType<T>;\n    $placeholder.$origin = $el;\n    return $placeholder;\n  }\n\n  public connectedCallback(): void {\n    this.copyAttributesFromOrigin();\n    super.connectedCallback();\n  }\n\n  /** Builds attribute name for copy */\n  protected buildAttrName(name: string): string {\n    return name === 'id' ? 'original-id' : name;\n  }\n\n  /** Copies allowed attributes from origin to this element */\n  protected copyAttributesFromOrigin(): void {\n    const {$origin} = this;\n    if (!$origin) return;\n\n    (this.constructor as typeof ESLToggleablePlaceholder).allowedAttrs.forEach((name) => {\n      const value = $origin.getAttribute(name);\n      if (value) {\n        this.setAttribute(this.buildAttrName(name), value);\n      }\n    });\n\n    // sanitize class list of placeholder from the tag name of origin's element\n    this.classList.remove(($origin.constructor as typeof ESLBaseElement).is);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleablePlaceholder: typeof ESLToggleablePlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-placeholder': ESLToggleablePlaceholder;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESC, SYSTEM_KEYS} from '../../esl-utils/dom/keys';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {prop, attr, jsonAttr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {defined, copyDefinedKeys} from '../../esl-utils/misc/object';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {DelayedTask} from '../../esl-utils/async/delayed-task';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {isMatches} from '../../esl-utils/dom/traversing';\n\n/** Default Toggleable action params type definition */\nexport interface ESLToggleableActionParams {\n  /** Initiator string identifier */\n  initiator?: string;\n  /** Delay timeout for both show and hide actions */\n  delay?: number;\n  /** Show delay timeout */\n  showDelay?: number;\n  /** Hide delay timeout */\n  hideDelay?: number;\n  /** Force action independently of current state of the Toggleable */\n  force?: boolean;\n  /** Do not throw events on action */\n  silent?: boolean;\n  /** Activate hover tracking to hide Toggleable */\n  trackHover?: boolean;\n  /** Element activator of the action */\n  activator?: HTMLElement | null;\n  /** Event that initiates the action */\n  event?: Event;\n\n  /** Custom user data */\n  [key: string]: any;\n}\n\nexport interface ESLToggleableRequestDetails extends ESLToggleableActionParams {\n  // Selector to match or exact predicate to check if the target should process request\n  match?: string | ((target: Element) => boolean);\n}\n\n/** @deprecated alias for ESLToggleableActionParams */\nexport type ToggleableActionParams = ESLToggleableActionParams;\n\nconst activators: WeakMap<ESLToggleable, HTMLElement | undefined> = new WeakMap();\n\n/**\n * ESLToggleable component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleable - a custom element, that is used as a base for \"Popup-like\" components creation\n */\n@ExportNs('Toggleable')\nexport class ESLToggleable extends ESLBaseElement {\n  public static is = 'esl-toggleable';\n  public static observedAttributes = ['open', 'group'];\n\n  /** Event to dispatch when toggleable is going to be activated */\n  @prop('esl:before:show') public BEFORE_SHOW_EVENT: string;\n  /** Event to dispatch when toggleable is going to be deactivated */\n  @prop('esl:before:hide') public BEFORE_HIDE_EVENT: string;\n\n  /** Event to dispatch when toggleable is activated */\n  @prop('esl:show') public SHOW_EVENT: string;\n  /** Event to dispatch when toggleable is deactivated */\n  @prop('esl:hide') public HIDE_EVENT: string;\n\n  /** Event to dispatch when toggleable has end activation process */\n  @prop('esl:after:show') public AFTER_SHOW_EVENT: string;\n  /** Event to dispatch when toggleable has end deactivation process */\n  @prop('esl:after:hide') public AFTER_HIDE_EVENT: string;\n\n  /** Event to activate toggleables on event way */\n  @prop('esl:show:request') public SHOW_REQUEST_EVENT: string;\n  /** Event to deactivate toggleables on event way */\n  @prop('esl:hide:request') public HIDE_REQUEST_EVENT: string;\n\n  /** Event to dispatch when toggleable group has changed */\n  @prop('esl:change:group') public GROUP_CHANGED_EVENT: string;\n\n  /** CSS class to add on the body element */\n  @attr() public bodyClass: string;\n  /** CSS class to add when the Toggleable is active */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n\n  /** Toggleable group meta information to organize groups */\n  @attr({name: 'group'}) public groupName: string;\n  /** Selector to mark inner close triggers */\n  @attr({name: 'close-on'}) public closeTrigger: string;\n\n  /** Disallow automatic id creation when it's empty */\n  @boolAttr() public noAutoId: boolean;\n  /** Close the Toggleable on ESC keyboard event */\n  @boolAttr() public closeOnEsc: boolean;\n  /** Close the Toggleable on a click/tap outside */\n  @boolAttr() public closeOnOutsideAction: boolean;\n\n  /** Initial params to pass to show/hide action on the start */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: ESLToggleableActionParams;\n  /** Default params to merge into passed action params */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {}})\n  public defaultParams: ESLToggleableActionParams;\n  /** Hover params to pass from track hover listener */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {}})\n  public trackHoverParams: ESLToggleableActionParams;\n\n  /** Marker of initially opened toggleable instance */\n  public initiallyOpened: boolean;\n\n  /** Inner state */\n  private _open: boolean = false;\n\n  /** Inner show/hide task manager instance */\n  protected _task: DelayedTask = new DelayedTask();\n  /** Marker for current hover listener state */\n  protected _trackHover: boolean = false;\n  /** Delay for track hover listeners actions */\n  protected _trackHoverDelay: number | undefined;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.id && !this.noAutoId) {\n      const tag = (this.constructor as typeof ESLToggleable).is;\n      this.id = sequentialUID(tag, tag + '-');\n    }\n    this.initiallyOpened = this.hasAttribute('open');\n    this.setInitialState();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    activators.delete(this);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    switch (attrName) {\n      case 'open':\n        if (this.open === this.hasAttribute('open')) return;\n        this.toggle(this.open, {initiator: 'attribute', showDelay: 0, hideDelay: 0});\n        break;\n      case 'group':\n        this.$$fire(this.GROUP_CHANGED_EVENT,  {\n          detail: {oldGroupName: oldVal, newGroupName: newVal}\n        });\n        break;\n    }\n  }\n\n  /** Set initial state of the Toggleable */\n  protected setInitialState(): void {\n    if (this.initialParams) {\n      this.toggle(this.initiallyOpened, this.initialParams);\n    }\n  }\n\n  /** Bind outside action event listeners */\n  protected bindOutsideEventTracking(track: boolean): void {\n    track ? this.$$on(this._onOutsideAction) : this.$$off(this._onOutsideAction);\n  }\n  /** Bind hover events listeners for the Toggleable itself */\n  protected bindHoverStateTracking(track: boolean, hideDelay?: number | string): void {\n    if (!DeviceDetector.hasHover) return;\n    this._trackHoverDelay = track && hideDelay !== undefined ? +hideDelay : undefined;\n    if (this._trackHover === track) return;\n    this._trackHover = track;\n\n    track ? this.$$on(this._onMouseEnter) : this.$$off(this._onMouseEnter);\n    track ? this.$$on(this._onMouseLeave) : this.$$off(this._onMouseLeave);\n  }\n\n  /** Function to merge the result action params */\n  protected mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    return Object.assign({}, this.defaultParams, copyDefinedKeys(params));\n  }\n\n  /** Toggle the element state */\n  public toggle(state: boolean = !this.open, params?: ESLToggleableActionParams): ESLToggleable {\n    return state ? this.show(params) : this.hide(params);\n  }\n\n  /** Change the element state to active */\n  public show(params?: ESLToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.showTask.bind(this, params), defined(params.showDelay, params.delay));\n    this.bindOutsideEventTracking(this.closeOnOutsideAction);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n  /** Change the element state to inactive */\n  public hide(params?: ESLToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.hideTask.bind(this, params), defined(params.hideDelay, params.delay));\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n\n  /** Actual show task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected showTask(params: ESLToggleableActionParams): void {\n    if (!params.force && this.open) return;\n    if (!params.silent && !this.$$fire(this.BEFORE_SHOW_EVENT, {detail: {params}})) return;\n    this.activator = params.activator;\n    this.open = true;\n    this.onShow(params);\n    if (!params.silent) this.$$fire(this.SHOW_EVENT, {detail: {params}, cancelable: false});\n  }\n  /** Actual hide task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected hideTask(params: ESLToggleableActionParams): void {\n    if (!params.force && !this.open) return;\n    if (!params.silent && !this.$$fire(this.BEFORE_HIDE_EVENT, {detail: {params}})) return;\n    this.open = false;\n    this.onHide(params);\n    this.bindOutsideEventTracking(false);\n    if (!params.silent) this.$$fire(this.HIDE_EVENT, {detail: {params}, cancelable: false});\n  }\n\n  /**\n   * Actions to execute on show toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire {@link ESLToggleable.REFRESH_EVENT} event by default.\n   */\n  protected onShow(params: ESLToggleableActionParams): void {\n    CSSClassUtils.add(this, this.activeClass);\n    CSSClassUtils.add(document.body, this.bodyClass, this);\n    this.updateA11y();\n    this.$$fire(this.REFRESH_EVENT); // To notify other components about content change\n  }\n\n  /**\n   * Actions to execute on hide toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and update a11y by default.\n   */\n  protected onHide(params: ESLToggleableActionParams): void {\n    CSSClassUtils.remove(this, this.activeClass);\n    CSSClassUtils.remove(document.body, this.bodyClass, this);\n    this.updateA11y();\n  }\n\n  /** Active state marker */\n  public get open(): boolean {\n    return this._open;\n  }\n  public set open(value: boolean) {\n    this.toggleAttribute('open', this._open = value);\n  }\n\n  /** Last component that has activated the element. Uses {@link ESLToggleableActionParams.activator}*/\n  public get activator(): HTMLElement | null | undefined {\n    return activators.get(this);\n  }\n  public set activator(el: HTMLElement | null | undefined) {\n    el ? activators.set(this, el) : activators.delete(this);\n  }\n\n  /** Returns the element to apply a11y attributes */\n  protected get $a11yTarget(): HTMLElement | null {\n    const target = this.getAttribute('a11y-target');\n    if (target === 'none') return null;\n    return target ? this.querySelector(target) : this;\n  }\n\n  /** Called on show and on hide actions to update a11y state accordingly */\n  protected updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-hidden', String(!this._open));\n  }\n\n  /** @returns if the passed event should trigger hide action */\n  public isOutsideAction(e: Event): boolean {\n    const target = e.target as HTMLElement;\n    // target is inside current toggleable\n    if (this.contains(target)) return false;\n    // target is inside last activator\n    if (this.activator && this.activator.contains(target)) return false;\n    // Event is not a system command key\n    return !(e instanceof KeyboardEvent && SYSTEM_KEYS.includes(e.key));\n  }\n\n  @listen({\n    event: 'click',\n    selector: (el: ESLToggleable) => el.closeTrigger || ''\n  })\n  protected _onCloseClick(e: MouseEvent): void {\n    this.hide({initiator: 'close', activator: e.target as HTMLElement, event: e});\n  }\n\n  @listen({\n    auto: false,\n    event: 'keydown mouseup touchend',\n    target: document.body,\n    capture: true\n  })\n  protected _onOutsideAction(e: Event): void {\n    if (!this.isOutsideAction(e)) return;\n    // Used 0 delay to decrease priority of the request\n    this.hide({initiator: 'outsideaction', hideDelay: 0, event: e});\n  }\n\n  @listen('keydown')\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    if (this.closeOnEsc && e.key === ESC) {\n      this.hide({initiator: 'keyboard', event: e});\n    }\n  }\n\n  @listen({auto: false, event: 'mouseenter'})\n  protected _onMouseEnter(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ESLToggleableActionParams = {initiator: 'mouseenter', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.show(Object.assign(baseParams, this.trackHoverParams));\n  }\n  @listen({auto: false, event: 'mouseleave'})\n  protected _onMouseLeave(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ESLToggleableActionParams = {initiator: 'mouseleave', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.hide(Object.assign(baseParams, this.trackHoverParams));\n  }\n\n  /** Prepares toggle request events param */\n  protected buildRequestParams(e: CustomEvent<ESLToggleableRequestDetails>): ESLToggleableActionParams | null {\n    const detail = e.detail || {};\n    if (!isMatches(this, detail.match)) return null;\n    return Object.assign({}, detail, {event: e});\n  }\n\n  /** Actions to execute on show request */\n  @listen((el: ESLToggleable) => el.SHOW_REQUEST_EVENT)\n  protected _onShowRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    const params = this.buildRequestParams(e);\n    params && this.show(params);\n  }\n  /** Actions to execute on hide request */\n  @listen((el: ESLToggleable) => el.HIDE_REQUEST_EVENT)\n  protected _onHideRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    const params = this.buildRequestParams(e);\n    params && this.hide(params);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Toggleable: typeof ESLToggleable;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable': ESLToggleable;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLPopup} from '../../esl-popup/core';\nimport {memoize, attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {TAB} from '../../esl-utils/dom/keys';\nimport {getKeyboardFocusableElements} from '../../esl-utils/dom/focus';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {PopupActionParams} from '../../esl-popup/core';\nimport type {PositionType} from '../../esl-popup/core/esl-popup-position';\n\nexport interface TooltipActionParams extends PopupActionParams {\n  /** text to be shown */\n  text?: string;\n  /** html content to be shown */\n  html?: string;\n  /** tooltip without arrow */\n  disableArrow?: boolean;\n}\n\n@ExportNs('Tooltip')\nexport class ESLTooltip extends ESLPopup {\n  static is = 'esl-tooltip';\n\n  /**\n   * Tooltip position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public position: PositionType;\n\n  /** Tooltip behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Disable arrow at Tooltip */\n  @boolAttr() public disableArrow: boolean;\n\n  /** Shared instanse of Tooltip */\n  @memoize()\n  public static get sharedInstance(): ESLTooltip {\n    return document.createElement('esl-tooltip');\n  }\n\n  /** List of all focusable elements inside Tooltip */\n  public get focusableElements(): Element[] {\n    return getKeyboardFocusableElements(this);\n  }\n\n  /** First focusable element inside Tooltip */\n  public get firstFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[0] : null;\n  }\n\n  /** Last focusable element inside Tooltip */\n  public get lastFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[els.length - 1] : null;\n  }\n\n  /** Active state marker */\n  public static get open(): boolean {\n    return this.sharedInstance.open;\n  }\n\n  /** Changes the element state to active */\n  public static show(params: TooltipActionParams = {}): void {\n    this.sharedInstance.show(params);\n  }\n\n  /** Changes the element state to inactive */\n  public static hide(params: TooltipActionParams = {}): void {\n    this.sharedInstance.hide(params);\n  }\n\n  public connectedCallback(): void {\n    if (!this.disableArrow) {\n      this._appendArrow();\n    }\n    super.connectedCallback();\n    this.classList.add(ESLPopup.is);\n    this.tabIndex = 0;\n  }\n\n  /** Sets initial state of the Tooltip */\n  protected setInitialState(): void {}\n\n  /** Creates arrow at Tooltip */\n  @memoize()\n  protected _createArrow(): HTMLElement {\n    const arrow = document.createElement('span');\n    arrow.className = 'esl-popup-arrow';\n    return arrow;\n  }\n\n  /** Appends arrow to Tooltip */\n  protected _appendArrow(): void {\n    this.$arrow = this._createArrow();\n    this.appendChild(this.$arrow);\n  }\n\n  /** Actions to execute on show Tooltip. */\n  public onShow(params: TooltipActionParams): void {\n    if (params.disableArrow) {\n      this.disableArrow = params.disableArrow;\n    }\n    if (params.text) {\n      this.innerText = params.text;\n    }\n    if (params.html) {\n      this.innerHTML = params.html;\n    }\n    if (params.extraClass) {\n      CSSClassUtils.add(this, params.extraClass);\n    }\n    document.body.appendChild(this);\n    super.onShow(params);\n    this._updateActivatorState(true);\n  }\n\n  /** Actions to execute on Tooltip hiding. */\n  public onHide(params: TooltipActionParams): void {\n    this._updateActivatorState(false);\n    super.onHide(params);\n    document.body.removeChild(this);\n    if (params.extraClass) {\n      CSSClassUtils.remove(this, params.extraClass);\n    }\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected afterOnShow(): void {\n    super.afterOnShow();\n    this.focus({preventScroll: true});\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected beforeOnHide(): void {\n    this.activator?.focus({preventScroll: true});\n  }\n\n  @listen({inherit: true})\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    if (!this.activator) return;\n    const {firstFocusableElement, lastFocusableElement} = this;\n    if (\n      !lastFocusableElement ||\n      e.target === lastFocusableElement && !e.shiftKey ||\n      e.target === firstFocusableElement && e.shiftKey\n    ) {\n      this.activator.focus();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  protected _updateActivatorState(newState: boolean): void {\n    this.activator?.toggleAttribute('tooltip-shown', newState);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tooltip: typeof ESLTooltip;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tooltip': ESLTooltip;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {tuple, wrap, uniq} from '../../esl-utils/misc/array';\nimport {unwrapParenthesis} from '../../esl-utils/misc/format';\nimport {findAll, findChildren, findNext, findParent, findClosest, findPrev} from '../../esl-utils/dom/traversing';\nimport {isVisible} from '../../esl-utils/dom/visible';\n\ntype ProcessorDescriptor = [string?, string?];\ntype ElementProcessor = (base: Element, sel: string) => Element | Element[] | null;\ntype CollectionProcessor = (els: Element[], sel: string) => Element[];\n\n/**\n * Traversing Query utility to find element via extended selector query\n * Extended query supports\n * - plain CSS selectors\n * - relative selectors (selectors that don't start from a plain selector will use passed base Element as a root)\n * - ::next and ::prev sibling pseudo-selectors\n * - ::parent, ::closest and ::child pseudo-selectors\n * - ::find pseudo-selector\n * - ::first, ::last and :nth(#) limitation pseudo-selectors\n * - ::filter, ::not filtration pseudo-selectors\n *\n * @example\n * - `#id .class [attr]` - find by CSS selector in a current document\n * - ` ` - get current base element\n * - `::next` - get next sibling element\n * - `::prev` - get previous sibling element\n * - `::parent` - get base element parent\n * - `::parent(#id .class [attr])` - find the closest parent matching passed selector\n * - `::closest(#id .class [attr])` - find the closest ancestor including base element that matches passed selector\n * - `::child(#id .class [attr])` - find direct child element(s) that match passed selector\n * - `::find(#id .class [attr])` - find child element(s) that match passed selector\n * - `::find(buttons, a)::not([hidden])` - find all buttons and anchors that are not have hidden attribute\n * - `::find(buttons, a)::filter(:first-child)` - find all buttons and anchors that are first child in container\n * - `::parent::child(some-tag)` - find direct child element(s) that match tag 'some-tag' in the parent\n * - `#id .class [attr]::parent` - find parent of element matching selector '#id .class [attr]' in document\n * - `::find(.row)::last::parent` - find parent of the last element matching selector '.row' from the base element subtree\n */\n@ExportNs('TraversingQuery')\nexport class ESLTraversingQuery {\n  private static ELEMENT_PROCESSORS: Record<string, ElementProcessor> = {\n    '::find': findAll,\n    '::next': findNext,\n    '::prev': findPrev,\n    '::child': findChildren,\n    '::parent': findParent,\n    '::closest': findClosest\n  };\n  private static COLLECTION_PROCESSORS: Record<string, CollectionProcessor> = {\n    '::first': (list: Element[]) => list.slice(0, 1),\n    '::last': (list: Element[]) => list.slice(-1),\n    '::nth': (list: Element[], sel?: string) => {\n      const index = sel ? +sel : NaN;\n      return wrap(list[index - 1]);\n    },\n    '::not': (list: Element[], sel?: string) => list.filter((el) => !el.matches(sel || '')),\n    '::visible': (list: Element[]) => list.filter((el) => (el instanceof HTMLElement) && isVisible(el)),\n    '::filter': (list: Element[], sel?: string) => list.filter((el) => el.matches(sel || ''))\n  };\n\n  /**\n   * @returns RegExp that selects all known processors in query string\n   * e.g. /(::parent|::closest|::child|::next|::prev)/\n   */\n  private static get PROCESSORS_REGEX(): RegExp {\n    const keys = Object.keys(this.ELEMENT_PROCESSORS).concat(Object.keys(this.COLLECTION_PROCESSORS));\n    return new RegExp(`(${keys.join('|')})`, 'g');\n  }\n\n  private static isCollectionProcessor([name]: ProcessorDescriptor): boolean {\n    return !!name && (name in this.COLLECTION_PROCESSORS);\n  }\n  private static processElement(el: Element, [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.ELEMENT_PROCESSORS)) return [];\n    return wrap(this.ELEMENT_PROCESSORS[name](el, sel));\n  }\n  private static processCollection(els: Element[], [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.COLLECTION_PROCESSORS)) return [];\n    return wrap(this.COLLECTION_PROCESSORS[name](els, sel));\n  }\n\n  private static traverseChain(collection: Element[], processors: ProcessorDescriptor[], findFirst: boolean): Element[] {\n    if (!processors.length || !collection.length) return collection;\n    const [processor, ...rest] = processors;\n    if (this.isCollectionProcessor(processor)) {\n      const processedItem = this.processCollection(collection, processor);\n      return this.traverseChain(processedItem, rest, findFirst);\n    }\n    const result: Element[] = [];\n    for (const target of collection) {\n      const processedItem = this.processElement(target, processor);\n      const resultCollection: Element[] = this.traverseChain(processedItem, rest, findFirst);\n      if (!resultCollection.length) continue;\n      if (findFirst) return resultCollection.slice(0, 1);\n      result.push(...resultCollection);\n    }\n    return uniq(result);\n  }\n\n  /** Split multiple queries separated by comma (respects query brackets) */\n  // This can be solved by RegEx /(?<!\\([^\\)]*),(?![^\\(]*\\))/g)/, when the WebKit browser implements this feature\n  public static splitQueries(str: string): string[] {\n    let last = 0;\n    let stack = 0;\n    const result = [];\n    for (let i = 0; i < str.length; i++) {\n      if (str[i] === '(') stack++;\n      if (str[i] === ')') stack = Math.max(0, stack - 1);\n      if (str[i] === ',' && !stack) {\n        result.push(str.substring(last, i).trim());\n        last = i + 1;\n      }\n    }\n    result.push(str.substring(last).trim());\n    return result;\n  }\n\n  protected static traverse(query: string, findFirst: boolean, base?: Element | null, scope: Element | Document = document): Element[] {\n    const found: Element[] = [];\n    for (const part of ESLTraversingQuery.splitQueries(query)) {\n      const els = this.traverseQuery(part, findFirst, base, scope);\n      if (findFirst && els.length) return [els[0]];\n      found.push(...els);\n    }\n    return uniq(found);\n  }\n\n  protected static traverseQuery(query: string, findFirst: boolean, base?: Element | null, scope: Element | Document = document): Element[] {\n    const parts = query.split(this.PROCESSORS_REGEX).map((term) => term.trim());\n    const rootSel = parts.shift();\n    const baseCollection = base ? [base] : [];\n    const initial: Element[] = rootSel ? Array.from(scope.querySelectorAll(rootSel)) : baseCollection;\n    return this.traverseChain(initial, tuple(parts), findFirst);\n  }\n\n  /** @returns first matching element reached via {@link ESLTraversingQuery} rules */\n  static first(query: string, base?: Element | null, scope?: Element | Document): Element | null {\n    return ESLTraversingQuery.traverse(query, true, base, scope)[0] || null;\n  }\n  /** @returns Array of all matching elements reached via {@link ESLTraversingQuery} rules */\n  static all(query: string, base?: Element | null, scope?: Element | Document): Element[] {\n    return ESLTraversingQuery.traverse(query, false, base, scope);\n  }\n}\n\n/** @deprecated alias for {@link ESLTraversingQuery} */\nexport const TraversingQuery = ESLTraversingQuery;\n\ndeclare global {\n  export interface ESLLibrary {\n    TraversingQuery: typeof ESLTraversingQuery;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {setAttr} from '../../esl-utils/dom/attr';\nimport {attr, boolAttr, prop, listen, ready} from '../../esl-utils/decorators';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ENTER, SPACE, ESC} from '../../esl-utils/dom/keys';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLToggleable, ESLToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n@ExportNs('Trigger')\nexport class ESLTrigger extends ESLBaseElement {\n  public static is = 'esl-trigger';\n  public static observedAttributes = ['target'];\n\n  /** Event that represents {@link ESLTrigger} state change */\n  @prop('esl:change:active') public CHANGE_EVENT: string;\n  /** Events to observe target {@link ESLToggleable} instance state */\n  @prop('esl:show esl:hide') public OBSERVED_EVENTS: string;\n\n  /** @readonly Observed Toggleable active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n\n  /** CSS classes to set on active state */\n  @attr({defaultValue: ''}) public activeClass: string;\n  /** Target element {@link ESLTraversingQuery} selector to set `activeClass` */\n  @attr({defaultValue: ''}) public activeClassTarget: string;\n\n  /** Selector for ignored inner elements */\n  @attr({defaultValue: 'a[href]'}) public ignore: string;\n\n  /** Target Toggleable {@link ESLTraversingQuery} selector. `::next` by default */\n  @attr({defaultValue: '::next'}) public target: string;\n  /** Action to pass to the Toggleable. Supports `show`, `hide` and `toggle` values. `toggle` by default */\n  @attr({defaultValue: 'toggle'}) public mode: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `none` */\n  @attr({defaultValue: 'not all'}) public trackHover: string;\n\n  /** Selector of inner target element to place aria attributes. Uses trigger itself if blank */\n  @attr({defaultValue: ''}) public a11yTarget: string;\n\n  /** Value of aria-label for active state */\n  @attr({defaultValue: null}) public a11yLabelActive: string | null;\n  /** Value of aria-label for inactive state */\n  @attr({defaultValue: null}) public a11yLabelInactive: string | null;\n\n  /** Show delay value */\n  @attr({defaultValue: 'none'}) public showDelay: string;\n  /** Hide delay value */\n  @attr({defaultValue: 'none'}) public hideDelay: string;\n\n  /**\n   * Show delay value override for hover.\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverShowDelay: string;\n  /**\n   * Hide delay value override for hover\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverHideDelay: string;\n\n  /** Prevent ESC keyboard event handling for target element hiding */\n  @boolAttr() public ignoreEsc: boolean;\n\n  protected _$target: ESLToggleable | null;\n\n  protected attributeChangedCallback(attrName: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') return this.updateTargetFromSelector();\n  }\n\n  /** Target observable Toggleable */\n  public get $target(): ESLToggleable | null {\n    return this._$target;\n  }\n  public set $target(newPopupInstance: ESLToggleable | null) {\n    this.$$off(this._onTargetStateChange);\n    this._$target = newPopupInstance;\n    this.$$on(this._onTargetStateChange);\n    this._onTargetStateChange();\n  }\n\n  /** Element target to setup aria attributes */\n  public get $a11yTarget(): HTMLElement | null {\n    return this.a11yTarget ? this.querySelector(this.a11yTarget) : this;\n  }\n\n  /** Value to setup aria-label */\n  public get a11yLabel(): string | null {\n    if (!this.$target) return null;\n    return (this.$target.open ? this.a11yLabelActive : this.a11yLabelInactive) || null;\n  }\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.updateTargetFromSelector();\n    this.initA11y();\n  }\n\n  /** Update `$target` Toggleable  from `target` selector */\n  public updateTargetFromSelector(): void {\n    if (!this.target) return;\n    this.$target = ESLTraversingQuery.first(this.target, this) as ESLToggleable;\n\n    if (this.$target instanceof ESLToggleablePlaceholder && this.$target.$origin) {\n      // change target if it is an instance of the placeholder element\n      this.$target = this.$target.$origin;\n    }\n  }\n\n  /** Check if the event target should be ignored */\n  protected isTargetIgnored(target: EventTarget | null): boolean {\n    if (!target || !(target instanceof HTMLElement) || !this.ignore) return false;\n    const $ignore = target.closest(this.ignore);\n    // Ignore only inner elements (but do not ignore the trigger itself)\n    return !!$ignore && $ignore !== this && this.contains($ignore);\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLTrigger, ...params: ESLToggleableActionParams[]): ESLToggleableActionParams {\n    return Object.assign({\n      initiator: 'trigger',\n      activator: this\n    }, ...params);\n  }\n\n  /** Show target toggleable with passed params */\n  public showTarget(params: ESLToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.showDelay)\n    }, params);\n    if (this.$target && typeof this.$target.show === 'function') {\n      this.$target.show(actionParams);\n    }\n  }\n  /** Hide target toggleable with passed params */\n  public hideTarget(params: ESLToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.hideDelay)\n    }, params);\n    if (this.$target && typeof this.$target.hide === 'function') {\n      this.$target.hide(actionParams);\n    }\n  }\n  /** Toggles target toggleable with passed params */\n  public toggleTarget(params: ESLToggleableActionParams = {}, state: boolean = !this.active): void {\n    state ? this.showTarget(params) : this.hideTarget(params);\n  }\n\n  /**\n   * Updates trigger state according to toggleable state\n   * Does not produce `esl:change:active` event\n   */\n  public updateState(): boolean {\n    const isActive = !!this.$target?.open;\n    const wasActive = this.active;\n\n    this.toggleAttribute('active', isActive);\n    const clsTarget = ESLTraversingQuery.first(this.activeClassTarget, this) as HTMLElement;\n    clsTarget && CSSClassUtils.toggle(clsTarget, this.activeClass, isActive);\n\n    this.updateA11y();\n\n    return isActive !== wasActive;\n  }\n\n  /** Handles ESLToggleable state change */\n  @listen({\n    event: (that: ESLTrigger) => that.OBSERVED_EVENTS,\n    target: (that: ESLTrigger) => that.$target\n  })\n  protected _onTargetStateChange(originalEvent?: Event): void {\n    if (!this.updateState()) return;\n    const detail = {active: this.active, originalEvent};\n    this.$$fire(this.CHANGE_EVENT, {detail});\n  }\n\n  /** Handles `click` event */\n  @listen('click')\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    this._onPrimaryEvent(event);\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE, ESC].includes(event.key) || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    if (event.key === ESC) {\n      if (this.ignoreEsc) return;\n      this.hideTarget({event});\n    } else {\n      this._onPrimaryEvent(event);\n    }\n  }\n\n  /** Handles target primary (observed) event */\n  protected _onPrimaryEvent(event: Event): void {\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles hover `mouseenter` event */\n  @listen('mouseenter')\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    const delay = parseNumber(this.hoverShowDelay);\n    this.toggleTarget({event, delay}, this.mode !== 'hide');\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @listen('mouseleave')\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    if (this.mode === 'show' || this.mode === 'hide') return;\n    const delay = parseNumber(this.hoverHideDelay);\n    this.hideTarget({event, delay, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Set initial a11y attributes. Do nothing if trigger contains actionable element */\n  public initA11y(): void {\n    if (this.$a11yTarget !== this) return;\n    if (!this.hasAttribute('role')) this.setAttribute('role', 'button');\n    if (this.getAttribute('role') === 'button' && !this.hasAttribute('tabindex')) {\n      this.setAttribute('tabindex', '0');\n    }\n  }\n\n  /** Update aria attributes */\n  public updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    if (this.a11yLabelActive !== null || this.a11yLabelInactive !== null) {\n      setAttr(target, 'aria-label', this.a11yLabel);\n    }\n    setAttr(target, 'aria-expanded', String(this.active));\n    if (this.$target && this.$target.id) {\n      setAttr(target, 'aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Trigger: typeof ESLTrigger;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-trigger': ESLTrigger;\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Abstract Observable implementation\n * @author Yuliya Adamskaya\n */\nexport abstract class Observable <Callback extends AnyToVoidFnSignature = AnyToVoidFnSignature> {\n  protected _listeners = new Set<Callback>();\n\n  public addListener(listener: Callback): void {\n    this._listeners.add(listener);\n  }\n  public removeListener(listener: Callback): void {\n    this._listeners.delete(listener);\n  }\n\n  protected fire(...args: Parameters<Callback>): void {\n    this._listeners.forEach((listener) => {\n      try {\n        listener.apply(this, args);\n      } catch (e) {\n        console.error(e);\n      }\n    });\n  }\n}\n","import {createDeferred} from './promise';\n\nimport type {AnyToAnyFnSignature} from '../misc/functions';\nimport type {Deferred} from './promise';\n\n/** Debounced<F> is a function wrapper type for a function decorated via debounce */\nexport interface Debounced<F extends AnyToAnyFnSignature> {\n  /** Debounced method signature */\n  (...args: Parameters<F>): void;\n  /** Promise of deferred function call */\n  promise: Promise<ReturnType<F> | void>;\n  /** Cancel debounced call */\n  cancel(): void;\n}\n\n/**\n * Creates a debounced function that implements {@link Debounced}.\n * Debounced function delays invoking func until after wait milliseconds have elapsed\n * since the last time the debounced function was invoked.\n * The func is invoked with the last arguments provided to the debounced function.\n * @param fn - function to decorate\n * @param wait - time to debounce\n * @param thisArg - optional context to call original function, use debounced method call context if not defined\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function debounce<F extends AnyToAnyFnSignature>(fn: F, wait = 10, thisArg?: object): Debounced<F> {\n  let timeout: number | null = null;\n  let deferred: Deferred<ReturnType<F>> | null = null;\n\n  function debouncedSubject(...args: any[]): void {\n    deferred = deferred || createDeferred();\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = window.setTimeout(() => {\n      timeout = null;\n      // fn.apply to save call context\n      deferred!.resolve(fn.apply(thisArg || this, args));\n      deferred = null;\n    }, wait);\n  }\n  function cancel(): void {\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = null;\n    deferred?.reject();\n    deferred = null;\n  }\n\n  Object.defineProperty(debouncedSubject, 'promise', {\n    get: () => deferred ? deferred.promise : Promise.resolve()\n  });\n  Object.defineProperty(debouncedSubject, 'cancel', {\n    writable: false,\n    enumerable: false,\n    value: cancel\n  });\n\n  return debouncedSubject as Debounced<F>;\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Task placeholder with a single place for executing deferred task.\n * Only one task can be planed per DelayedTask instance.\n * @see put DelayedTask.put behaviour description.\n */\nexport class DelayedTask {\n  protected _fn: AnyToVoidFnSignature | null = null;\n  protected _timeout: number | null = null;\n\n  /** Execute deferred task immediately */\n  protected run = (): void => {\n    this._timeout = null;\n    this._fn && this._fn();\n  };\n\n  /** @returns Function of currently deferred (planned) task */\n  public get fn(): AnyToVoidFnSignature | null {\n    return this._fn;\n  }\n\n  /**\n   * Cancel deferred task and planning passed\n   * @param task - task function\n   * @param delay - time to delay task execution\n   *  - pass negative or false to execute task immediately\n   *  - pass 0 to plan task to the macrotask\n   *  - pass positive number x to delay task on x ms.\n   * */\n  public put(task: AnyToVoidFnSignature, delay: number | string | boolean = false): AnyToVoidFnSignature | null {\n    const prev = this.cancel();\n    if (typeof task === 'function') {\n      if (delay && typeof delay === 'string') delay = +delay;\n      if (typeof delay === 'number' && delay >= 0) {\n        this._fn = task;\n        this._timeout = window.setTimeout(this.run, delay);\n      } else {\n        task();\n      }\n    }\n    return prev;\n  }\n\n  /** Cancel deferred (planned) task */\n  public cancel(): AnyToVoidFnSignature | null {\n    const prev = this._fn;\n    (typeof this._timeout === 'number') && clearTimeout(this._timeout);\n    this._fn = this._timeout = null;\n    return prev;\n  }\n}\n","import type {AnyToAnyFnSignature} from '../misc/functions';\n\n/**\n * @returns Promise that will be resolved or rejected in `timeout` with an optional `payload`\n * If `isReject` is `true` the result promise will be rejected, otherwise (by default) the result promise will be resolved\n */\nexport function promisifyTimeout<T>(timeout: number, payload?: T, isReject?: boolean): Promise<T> {\n  return new Promise<T>((resolve, reject) =>\n    setTimeout((isReject ? reject : resolve).bind(null, payload), timeout)\n  );\n}\n\n/** Interface to describe abstract listenable target */\nexport type ListenableTarget = {\n  addEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n  removeEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n};\n\n/**\n * @returns Promise that will be resolved by dispatching `event` on `target`\n * Or it will be rejected in `timeout` if it's specified\n * Optional `options` for addEventListener can be also specified\n */\nexport function promisifyEvent(\n  target: ListenableTarget,\n  event: string,\n  timeout?: number | null | undefined,\n  options?: boolean | AddEventListenerOptions\n): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    function eventCallback(e: Event): void {\n      target.removeEventListener(event, eventCallback, options);\n      resolve(e);\n    }\n\n    target.addEventListener(event, eventCallback, options);\n    if (typeof timeout === 'number' && timeout >= 0) {\n      setTimeout(() => reject(new Error('Rejected by timeout')), timeout);\n    }\n  });\n}\n\n/**\n * Short helper to make Promise from element state marker\n * @returns Promise that will be resolved if the target `marker` property is truthful or `event` is dispatched\n * @example\n * `const imgReady = promisifyMarker(eslImage, 'ready');`\n */\nexport function promisifyMarker(target: HTMLElement, marker: string, event: string = marker): Promise<HTMLElement> {\n  if ((target as any)[marker]) return Promise.resolve(target);\n  return promisifyEvent(target, event).then(() => target);\n}\n\n/**\n * Call `callback` limited by `tryCount` amount of times with interval in `timeout` ms\n * @returns Promise that will be resolved as soon as callback returns truthy value, or reject it by limit.\n */\nexport function tryUntil<T>(callback: () => T, tryCount = 2, timeout = 100): Promise<T> {\n  return new Promise((resolve, reject) => {\n    (function check(): void {\n      let result: T | undefined;\n      try {\n        result = callback();\n      } catch {\n        result = undefined;\n      }\n\n      if (result || (tryCount--) < 0) {\n        result ? resolve(result) : reject(new Error('Rejected by limit of tries'));\n      } else {\n        setTimeout(check, timeout);\n      }\n    })();\n  });\n}\n\n/**\n * Call async callback in a sequence passed number of times\n * Initial call starts as a microtask\n * @param callback - async chain function\n * @param count - count o calls\n * @returns sequence end promise\n */\nexport function repeatSequence<T>(callback: () => Promise<T>, count = 1): Promise<T> {\n  if (count < 1) return Promise.reject();\n  if (count === 1) return Promise.resolve().then(callback);\n  return repeatSequence(callback, count - 1).then(callback);\n}\n\n/** Deferred object represents promise with it's resolve/reject methods */\nexport type Deferred<T> = {\n  /** Wrapped promise */\n  promise: Promise<T>;\n  /** Function that resolves wrapped promise */\n  resolve: (arg: T) => void;\n  /** Function that rejects wrapped promise */\n  reject: (arg?: any) => void;\n};\n\n/**\n * Create Deferred Object that wraps promise and its resolve and reject callbacks\n */\nexport function createDeferred<T>(): Deferred<T> {\n  let reject: any;\n  let resolve: any;\n  // Both reject and resolve will be assigned anyway while the Promise constructing.\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {promise, resolve, reject};\n}\n\n/** Creates function type with the same signature but with the result type wrapped into promise */\nexport type PromisifyResultFn<F extends AnyToAnyFnSignature> =\n  ((...args: Parameters<F>) => Promise<ReturnType<F> | void>);\n\n/**\n * Safe wrap for Promise.resolve to use in Promise chain\n * @example\n * `const resolvedPromise = rejectedPromise.catch(resolvePromise);`\n */\nexport function resolvePromise<T>(arg: T | PromiseLike<T>): Promise<T> {\n  return Promise.resolve(arg);\n}\n\n/**\n * Safe wrap for Promise.reject to use in Promise chain\n * @example\n * `const rejectedPromise = resolvedPromise.then(rejectPromise);`\n */\nexport function rejectPromise<T = never>(arg?: T | PromiseLike<T>): Promise<T> {\n  return Promise.reject(arg);\n}\n\n/**\n * Promise utils helper class\n * Note: use individual methods in case you need correct \"tree shaking\"\n */\nexport abstract class PromiseUtils {\n  static fromTimeout = promisifyTimeout;\n  static fromEvent = promisifyEvent;\n  static fromMarker = promisifyMarker;\n\n  static repeat = repeatSequence;\n  static tryUntil = tryUntil;\n\n  static deferred = createDeferred;\n  static resolve = resolvePromise;\n  static reject = rejectPromise;\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Postpone action after next render\n */\nexport const afterNextRender = (callback: () => void): number => requestAnimationFrame(() => requestAnimationFrame(callback));\n\n/**\n * Postpone action after a couple of renders\n */\nexport const skipOneRender = (callback: () => void): number => requestAnimationFrame(() => afterNextRender(callback));\n\n/**\n * Decorate function to schedule execution after next render\n * @returns decorated function\n */\nexport const rafDecorator = <T extends AnyToVoidFnSignature>(fn: T): T => {\n  let lastArgs: any[] | null = null; // null if no calls requested\n  return function (...args: any[]) {\n    if (lastArgs === null) {\n      requestAnimationFrame(() => {\n        lastArgs && fn.call(this, ...lastArgs);\n        lastArgs = null;\n      });\n    }\n    lastArgs = args;\n  } as T;\n};\n","import {identity} from '../misc/functions';\nimport {parseString, toKebabCase} from '../misc/format';\nimport {getAttr, setAttr} from '../dom/attr';\nimport type {AttributeDecorator, AttributeTarget} from '../dom/attr';\n\nexport type AttrParser<T> = (attr: string | null) => T;\nexport type AttrSerializer<T> = (val: T) => null | boolean | string;\n\n/** HTML attribute mapping configuration */\ntype AttrDescriptor<T = string> = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n  /** Parser from attribute value */\n  parser?: AttrParser<T>;\n  /** Serializer to transform passed value to attribute value */\n  serializer?: AttrSerializer<T>;\n};\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value.\n * Maps string type property.\n * @param config - mapping configuration. See {@link AttrDescriptor}\n */\nexport const attr = <T = string>(config: AttrDescriptor<T> = {}): AttributeDecorator => {\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n\n    function get(): T | null {\n      const val = getAttr(this, attrName);\n      if (val === null && 'defaultValue' in config) return config.defaultValue as T;\n      return (config.parser || parseString as AttrParser<any>)(val);\n    }\n    function set(value: T): void {\n      setAttr(this, attrName, (config.serializer as AttrSerializer<any> || identity)(value));\n    }\n\n    Object.defineProperty(target, propName, config.readonly ? {get} : {get, set});\n  };\n};\n","import {getPropertyDescriptor} from '../misc/object/utils';\n\n/** Decorator \"bind\" allows to bind prototype method context to class instance */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bind<Fn extends Function>(target: object,\n                                          propertyKey: string,\n                                          descriptor: TypedPropertyDescriptor<Fn>): TypedPropertyDescriptor<Fn> {\n  // Validation check\n  if (!descriptor || (typeof descriptor.value !== 'function')) {\n    throw new TypeError('Only class methods can be decorated via @bind');\n  }\n  // Original function\n  const originalFn = descriptor.value;\n\n  return descriptor = {\n    enumerable: descriptor.enumerable,\n    configurable: true,\n\n    get: function getBound(): Fn {\n      const proto = Object.getPrototypeOf(this);\n      const desc = getPropertyDescriptor(proto, propertyKey);\n      const isProtoCall = !desc || desc.get !== getBound;\n      return isProtoCall ? originalFn : (this[propertyKey] = originalFn.bind(this));\n    },\n    set(value: Fn): void {\n      Object.defineProperty(this, propertyKey, {\n        value,\n        writable: true,\n        configurable: true,\n        enumerable: descriptor.enumerable\n      });\n    }\n  };\n}\n","import {hasAttr, setAttr} from '../dom/attr';\nimport {toKebabCase} from '../misc/format';\nimport type {AttributeDecorator, AttributeTarget} from '../dom/attr';\n\n/** HTML boolean (marker) attribute mapping configuration */\ntype BoolAttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n};\n\nfunction buildConditionalDescriptor(attrName: string, readOnly: boolean): PropertyDescriptor {\n  function get(): boolean {\n    return hasAttr(this, attrName);\n  }\n  function set(value: unknown): void {\n    setAttr(this, attrName, !!value);\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element boolean (marker) attribute state.\n * Maps boolean type property.\n * @param config - mapping configuration. See {@link BoolAttrDescriptor}\n */\nexport const boolAttr = (config: BoolAttrDescriptor = {}): AttributeDecorator => {\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildConditionalDescriptor(attrName, !!config.readonly));\n  };\n};\n","import {getPropertyDescriptor} from '../misc/object/utils';\nimport type {AnyToAnyFnSignature} from '../misc/functions';\n\n/**\n * Common TS decorator to apply decorator function\n * (like {@link debounce}, {@link throttle}, {@link rafDecorator})\n * to the class method\n * @param decorator - function decorator, should accept decorated method as first argument\n * @param args - additional arguments to pass into `decorator`\n */\nexport function decorate<Args extends any[], Fn extends AnyToAnyFnSignature>(\n  decorator: (fn: Fn, ...params: Args) => Fn,\n  ...args: Args\n) {\n  return function (target: any, propertyKey: string, descriptor: TypedPropertyDescriptor<Fn>): TypedPropertyDescriptor<Fn> {\n    if (!descriptor || typeof descriptor.value !== 'function') {\n      throw new TypeError('Only class methods can be decorated');\n    }\n\n    const originalFn: Fn = descriptor.value;\n\n    return descriptor = {\n      enumerable: descriptor.enumerable,\n      configurable: true,\n\n      get: function getBound(): Fn {\n        // Skip own properties\n        const proto = Object.getPrototypeOf(this);\n        // Find the closest descriptor for property\n        const desc = getPropertyDescriptor(proto, propertyKey);\n        // Return original function in case of prototype or super call\n        if (!desc || desc.get !== getBound) return originalFn;\n        // Create a new decorated instance of function\n        const decoratedFn = decorator(originalFn.bind(this), ...args);\n        // Copy original function own keys\n        Object.assign(decoratedFn, originalFn);\n        // Defines own property with the decorated instance\n        return this[propertyKey] = decoratedFn;\n      },\n      set(value: Fn): void {\n        Object.defineProperty(this, propertyKey, {\n          value,\n          writable: true,\n          configurable: true,\n          enumerable: descriptor.enumerable\n        });\n      }\n    };\n  };\n}\n","import {getAttr, setAttr} from '../dom/attr';\nimport {toKebabCase, evaluate} from '../misc/format';\nimport type {AttributeDecorator, AttributeTarget} from '../dom/attr';\n\n/** HTML attribute to object property mapping configuration */\ninterface JsonAttrDescriptor<T> {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n}\n\nfunction buildJsonAttrDescriptor<T>(attrName: string, readOnly: boolean, defaultValue: T | null): PropertyDescriptor {\n  function get(): T | null {\n    const attrContent = getAttr(this, attrName, '').trim();\n    return evaluate(attrContent, defaultValue);\n  }\n\n  function set(value: any): void {\n    try {\n      if (typeof value !== 'object') throw Error('value should be object');\n      setAttr(this, attrName, value ? JSON.stringify(value) : false);\n    } catch (e) {\n      console.error('[ESL] jsonAttr: Can not set json value ', e);\n    }\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value using JSON (de-)serialization rules.\n * Maps object type property.\n * @param config - mapping configuration. See {@link JsonAttrDescriptor}\n */\nexport const jsonAttr = <T>(config: JsonAttrDescriptor<T> = {}): AttributeDecorator => {\n  config = Object.assign({defaultValue: {}}, config);\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildJsonAttrDescriptor(attrName, !!config.readonly, config.defaultValue));\n  };\n};\n","import {ESLEventUtils} from '../../esl-event-listener/core';\n\nimport type {PropertyProvider} from '../misc/functions';\nimport type {ESLListenerHandler, ESLListenerEventMap, ESLListenerDescriptor} from '../dom/events';\n\ntype ListenDecorator<EType extends Event> =\n  (target: any, property: string, descriptor: TypedPropertyDescriptor<ESLListenerHandler<EType>>) => void;\n\ntype ESLListenerDescriptorExt<T extends keyof ESLListenerEventMap = string> = Partial<ESLListenerDescriptor<T>> & {\n  /** Defines if the listener metadata should be inherited from the method of the superclass */\n  inherit?: boolean;\n};\n\n/**\n * Decorator to declare listener ({@link ESLEventListener}) meta information\n * Defines auto-subscribable event\n * @param event - event type string or event provider function\n */\nexport function listen<K extends keyof ESLListenerEventMap>(event: K | PropertyProvider<K>): ListenDecorator<ESLListenerEventMap[K]>;\n/**\n * Decorator to declare listener ({@link ESLEventListener}) meta information using {@link ESLListenerDescriptor}\n * Defines auto-subscribable event by default\n * @param desc - event listener configuration {@link ESLListenerDescriptor}\n */\nexport function listen<K extends keyof ESLListenerEventMap>(desc: ESLListenerDescriptorExt<K>): ListenDecorator<ESLListenerEventMap[K]>;\n\nexport function listen(desc: string | ESLListenerDescriptorExt): ListenDecorator<Event> {\n  return function listener<T extends ESLListenerHandler>(target: HTMLElement,\n                                                         propertyKey: string,\n                                                         descriptor: TypedPropertyDescriptor<T>): void {\n    const superDesc = Object.getPrototypeOf(target)[propertyKey];\n    desc = typeof desc === 'string' || typeof desc === 'function' ? {event: desc} : desc;\n    desc = Object.assign({auto: true}, desc.inherit && ESLEventUtils.isEventDescriptor(superDesc) ? superDesc : {}, desc);\n\n    const fn = descriptor.value || descriptor.get && descriptor.get.call(target);\n    if (typeof fn !== 'function') {\n      throw new TypeError('Only class methods can be decorated via listener decorator');\n    }\n    if (ESLEventUtils.isEventDescriptor(fn) && fn.event !== desc.event) {\n      throw new TypeError(`Method ${propertyKey} already decorated as ESLListenerDescriptor`);\n    }\n\n    Object.assign(fn, desc);\n    // Allow collecting\n    descriptor.enumerable = true;\n  };\n}\n","import {defaultArgsHashFn, memoizeFn} from '../misc/memoize';\nimport {isPrototype, getPropertyDescriptor} from '../misc/object';\n\nimport type {MemoHashFn} from '../misc/memoize';\nimport type {MethodTypedDecorator} from '../misc/functions';\n\nexport function memoize(): MethodDecorator;\nexport function memoize<H extends MemoHashFn>(hashFn: H): MethodTypedDecorator<(...args: Parameters<H>) => any>;\n/**\n * Memoization decorator helper.\n * @see memoizeFn Original memoizeFn function decorator.\n */\nexport function memoize(hashFn: MemoHashFn = defaultArgsHashFn) {\n  return function (target: any, prop: string, descriptor: TypedPropertyDescriptor<any>): void {\n    if (!descriptor || typeof (descriptor.value || descriptor.get) !== 'function') {\n      throw new TypeError('Only get accessors or class methods can be decorated via @memoize');\n    }\n\n    if (isPrototype(target)) {\n      // Object members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeGetter(descriptor.get, prop));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeMethod(descriptor.value, prop, hashFn));\n    } else {\n      // Static members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeFn(descriptor.get));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeFn(descriptor.value, hashFn));\n    }\n  };\n}\n\n// Lock storage to prevent cache logic for some key\nconst locks = new WeakMap();\nconst defineOwnKeySafe = (obj: any, prop: string, value: any): void => {\n  locks.set(obj, prop); // IE try to get key with the prototype instance call, so we lock it\n  Object.defineProperty(obj, prop, {value, writable: true, configurable: true});\n  locks.delete(obj); // Free property key\n};\n\n/** Cache getter result as an object own property */\nfunction memoizeGetter(originalMethod: any, prop: string) {\n  return function (): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const value = originalMethod.call(this);\n    defineOwnKeySafe(this, prop, value);\n    return value;\n  };\n}\n\n/** Cache method memo function in the current context on call */\nfunction memoizeMethod(originalMethod: any, prop: string, hashFn: MemoHashFn) {\n  return function (this: any, ...args: any[]): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const memo = memoizeFn(originalMethod, hashFn);\n    defineOwnKeySafe(this, prop, memo);\n    return memo.apply(this, args);\n  };\n}\n\n/**\n * Clear memoization cache for passed target and property.\n * Accepts not own properties.\n * Note: be sure that you targeting memoized property or function.\n * Clear utility has no 100% check to prevent modifying incorrect (not memoized) property keys\n */\nmemoize.clear = function (target: any, property: string | string[]): void {\n  if (Array.isArray(property)) return property.forEach((prop) => memoize.clear(target, prop));\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).clear === 'function') return (desc.get as any).clear();\n  if (typeof desc.value === 'function' && typeof desc.value.clear === 'function') return desc.value.clear();\n  if (Object.hasOwnProperty.call(target, property)) delete target[property];\n};\n\n/** Check if property has cache for the passed params */\nmemoize.has = function (target: any, property: string, ...params: any[]): boolean {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return false;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).has === 'function') return (desc.get as any).has(...params);\n  if (typeof desc.value === 'function' && typeof desc.value.has === 'function') return desc.value.has(...params);\n  return Object.hasOwnProperty.call(target, property);\n};\n","/** Property configuration */\nexport type OverrideDecoratorConfig = {\n  /** To define enumerable property */\n  enumerable?: boolean;\n  /** To define readonly property */\n  readonly?: boolean;\n};\n\n/**\n * `@prop` is auxiliary decorator to define a field on the prototype level.\n *` @prop` can be used to override decorated property from the parent level\n *\n * You can also use an @override decorator in combination with ECMA Script class property definition:\n * `@prop() public field: any = initial value;`\n *\n * The class property initial value is a part of object creation, so it goes to the object itself,\n * while the @override value is defined on the prototype level.\n *\n * @param value - value to setup in prototype\n * @param prototypeConfig - prototype property configuration\n */\nexport function prop(value?: any, prototypeConfig: OverrideDecoratorConfig = {}) {\n  return function (obj: any, name: string): void {\n    if (Object.hasOwnProperty.call(obj, name)) {\n      throw new TypeError('Can\\'t override own property');\n    }\n    Object.defineProperty(obj, name, {\n      value,\n      writable: !prototypeConfig.readonly,\n      enumerable:  !prototypeConfig.enumerable,\n      configurable: true\n    });\n  };\n}\n","import {onDocumentReady} from '../dom/ready';\nimport type {AnyToVoidFnSignature} from '../misc/functions';\n\n/** Defer method execution to the next task with dom ready state precondition */\nexport function ready<T extends AnyToVoidFnSignature>(target: any,\n                                                      propertyKey: string,\n                                                      descriptor: TypedPropertyDescriptor<T>): void {\n  if (!descriptor || typeof descriptor.value !== 'function') {\n    throw new TypeError('Only class methods can be decorated via document ready decorator');\n  }\n  const fn = descriptor.value;\n  descriptor.value = function (...arg: any[]) {\n    onDocumentReady(() => fn.call(this, ...arg));\n  } as T;\n}\n","/**\n * Get the Element that is the root element of the document.\n * @param element - element for which to get the document element\n * */\nexport const getDocument = (element: Element | Window = window): Element => {\n  return (element instanceof Window ? element.document : element.ownerDocument).documentElement;\n};\n\n/**\n * Get the name of node.\n * @param element - element for which to get the name\n */\nexport const getNodeName = (element?: Node | Window): string  => {\n  return element && !(element instanceof Window) ? (element.nodeName).toLowerCase() : '';\n};\n\n/**\n * Get the parent of the specified element in the DOM tree.\n * @param element - element for which to get the parent\n */\nexport const getParentNode = (element: Element | ShadowRoot): Node => {\n  if (getNodeName(element) === 'html') return element;\n  return (window.ShadowRoot\n    ? element instanceof ShadowRoot\n      ? element.host\n      : element.assignedSlot || element.parentNode\n    : element.parentNode) || getDocument(element as Element);\n};\n","export type AttributeTarget = {$host: Element};\nexport type AttributeDecorator = (target: Element | AttributeTarget, propName: string) => void;\n\n/** @returns if attribute presented */\nexport function hasAttr($el: Element | AttributeTarget, name: string): boolean {\n  if ('$host' in $el) $el = $el.$host;\n  return $el.hasAttribute(name);\n}\n\n/** @returns attribute or passed fallback value. Identical to getAttribute by default */\nexport function getAttr($el: Element | AttributeTarget, name: string): string | null;\nexport function getAttr<T>($el: Element | AttributeTarget, name: string, fallback: T): string | T;\nexport function getAttr($el: Element | AttributeTarget, name: string, fallback: string | null = null): string | null {\n  if ('$host' in $el) $el = $el.$host;\n  const value = $el.getAttribute(name);\n  return value === null ? fallback : value;\n}\n\n/** Set attribute */\nexport function setAttr($el: Element | AttributeTarget, name: string, value: undefined | null | boolean | string): void {\n  if ('$host' in $el) $el = $el.$host;\n  if (value === undefined || value === null || value === false) {\n    $el.removeAttribute(name);\n  } else {\n    $el.setAttribute(name, value === true ? '' : value);\n  }\n}\n","import {wrap} from '../misc/array';\n\n/** Describe locker elements collection per class name */\ntype Locks = Map<string, Set<Element>>;\n/** Store locks for key element classes*/\nconst lockStore = new WeakMap<Element, Locks>();\n\n/** Mange className lock for the element */\nconst lock = (el: Element, className: string, locker: Element): void => {\n  const elLocks: Locks = lockStore.get(el) || new Map();\n  const classLocks: Set<Element> = elLocks.get(className) || new Set();\n  classLocks.add(locker);\n  elLocks.set(className, classLocks);\n  lockStore.set(el, elLocks);\n};\n/**\n * Manage className unlock for the element\n * @returns true if className have no locks\n */\nconst unlock = (el: Element, className: string, locker: Element): boolean => {\n  const elLocks = lockStore.get(el);\n  if (!elLocks) return true;\n  const classLocks = elLocks.get(className);\n  if (!classLocks) return true;\n  classLocks.delete(locker);\n  return !classLocks.size;\n};\n\n/**\n * Add single class to the element.\n * Supports inversion and locker management.\n */\nconst add = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return remove(el, className.substring(1), locker);\n  if (locker) lock(el, className, locker);\n  el.classList.add(className);\n};\n\n/**\n * Remove single class from the element.\n * Supports inversion and locker management.\n */\nconst remove = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return add(el, className.substring(1), locker);\n  if (locker && !unlock(el, className, locker)) return;\n  if (!locker) CSSClassUtils.unlock(el, className);\n  el.classList.remove(className);\n};\n\n/**\n * Check if the element matches passed CSS class.\n * Supports inversion.\n */\nconst has = (el: Element, className: string): boolean => {\n  if (className[0] === '!') return !has(el, className.substring(1));\n  return el.classList.contains(className);\n};\n\n/**\n * CSS class manipulation utilities.\n *\n * Allows manipulating with CSS classes with the following set of sub-features:\n * - JQuery-like enumeration - you can pass multiple tokens separated by space\n * - safe checks - empty or falsy token sting will be ignored without throwing an error\n * - inversion syntax - tokens that start from '!' will be processed with inverted action\n * (e.g. addCls(el, '!class') - will remove 'class' from the element, while removeCls(el, '!class') adds 'class' to the element)\n * - class locks - you can manipulate with classes using `locker` option that takes into account the modification initiator.\n * That means the class added in 'locker' mode will not be removed until all initiators that requested add class have requested its removal.\n * */\nexport abstract class CSSClassUtils {\n  /** Splitting passed token string into CSS class names array. */\n  public static splitTokens(tokenString: string | null | undefined): string[] {\n    return (tokenString || '').split(' ').filter((str) => !!str);\n  }\n\n  /**\n   * Add all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static add(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => add(el, className, locker)));\n  }\n\n  /**\n   * Remove all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static remove(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => remove(el, className, locker)));\n  }\n\n  /**\n   * Toggle all classes from the class token string on the element to the passed state.\n   * @see CSSClassUtils\n   * */\n  public static toggle(els: Element | Element[], cls: string | null | undefined, state: boolean, locker?: Element): void {\n    (state ? CSSClassUtils.add : CSSClassUtils.remove)(els, cls, locker);\n  }\n\n  /**\n   * Check if all class from token string matches to the element or elements.\n   * @see CSSClassUtils\n   * */\n  public static has(els: Element | Element[], cls: string): boolean {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    return wrap(els).every((el) => tokens.every((className) => has(el, className)));\n  }\n\n  /** Remove all lockers for the element or passed element className */\n  public static unlock(els: Element | Element[], className?: string): void {\n    if (className) {\n      wrap(els).forEach((el) => lockStore.get(el)?.delete(className));\n    } else {\n      wrap(els).forEach((el) => lockStore.delete(el));\n    }\n  }\n}\n","/** Checks if the passed event is {@link MouseEvent} */\nexport const isMouseEvent = (event: Event): event is MouseEvent => window.MouseEvent && event instanceof MouseEvent;\n\n/** Checks if the passed event is {@link TouchEvent} */\nexport const isTouchEvent = (event: Event): event is TouchEvent => window.TouchEvent && event instanceof TouchEvent;\n\n/** Checks if the passed event is {@link PointerEvent} */\nexport const isPointerEvent = (event: Event): event is PointerEvent => window.PointerEvent && event instanceof PointerEvent;\n\nconst PASSIVE_EVENTS = ['wheel', 'mousewheel', 'touchstart', 'touchmove'];\n/**\n * @returns true if the passed event should be passive by default\n * @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n */\nexport const isPassiveByDefault = (event: string): boolean => PASSIVE_EVENTS.includes(event);\n\n/** Gets the original CustomEvent source in case event bubbles from Shadow DOM */\nexport const getCompositeTarget = (e: CustomEvent): EventTarget | null => {\n  const targets = (e.composedPath && e.composedPath());\n  return targets ? targets[0] : e.target;\n};\n\n/** Object that describes coordinates */\nexport interface Point {\n  x: number;\n  y: number;\n}\n\n/** @returns touch point coordinates of {@link TouchEvent} or {@link PointerEvent} */\nexport const getTouchPoint = (event: TouchEvent | PointerEvent | MouseEvent): Point => {\n  const source = isTouchEvent(event) ? event.changedTouches[0] : event;\n  return {\n    x: source.pageX,\n    y: source.pageY\n  };\n};\n\n/** @returns element offset point coordinates */\nexport const getOffsetPoint = (el: Element): Point => {\n  const props = el.getBoundingClientRect();\n  const y = props.top + window.scrollY;\n  const x = props.left + window.scrollX;\n  return {x, y};\n};\n\n/**\n * Dispatches custom event.\n * Event bubbles and is cancelable by default, use `eventInit` to override that.\n * @param el - EventTarget to dispatch event\n * @param eventName - name of the event to dispatch\n * @param eventInit - object that specifies characteristics of the event. See {@link CustomEventInit}\n */\nexport const dispatchCustomEvent = (el: EventTarget, eventName: string, eventInit?: CustomEventInit): boolean => {\n  const init = Object.assign({\n    bubbles: true,\n    composed: true,\n    cancelable: true\n  }, eventInit || {});\n  return el.dispatchEvent(new CustomEvent(eventName, init));\n};\n","/**\n * Synthetic implementation of EventTarget\n * Replicates behavior of native event\n * Doesn't give explicit access to callback storage\n */\nexport class SyntheticEventTarget implements EventTarget {\n  private readonly _listeners: Record<string, EventListenerOrEventListenerObject[]> = {};\n\n  public hasEventListener(): boolean;\n  public hasEventListener(type: string | number): boolean;\n  public hasEventListener(type: string, minCount: number): boolean;\n  public hasEventListener(type: string | number = 'change', minCount: number = 0): boolean {\n    if (typeof type !== 'string') return this.hasEventListener('change', type || 0);\n    return this._listeners[type]?.length > minCount;\n  }\n\n  public addEventListener(callback: EventListenerOrEventListenerObject): void;\n  public addEventListener(type: string, callback: EventListenerOrEventListenerObject): void;\n  public addEventListener(type: string | EventListenerOrEventListenerObject, callback?: EventListenerOrEventListenerObject): void {\n    if (typeof type !== 'string') return this.addEventListener('change', type);\n\n    validateEventListenerType(callback);\n    if (this._listeners[type] && this._listeners[type].includes(callback!)) return;\n    if (this._listeners[type]) this._listeners[type].push(callback!);\n    else Object.assign(this._listeners, {[type]: [callback]});\n  }\n\n  public removeEventListener(callback: EventListenerOrEventListenerObject): void;\n  public removeEventListener(type: string, callback: EventListenerOrEventListenerObject): void;\n  public removeEventListener(type: string | EventListenerOrEventListenerObject, callback?: EventListenerOrEventListenerObject): void {\n    if (typeof type !== 'string') return this.removeEventListener('change', type);\n\n    validateEventListenerType(callback);\n    if (!this._listeners[type]) return;\n    this._listeners[type] = this._listeners[type].filter((cb) => cb !== callback);\n  }\n\n  public dispatchEvent(e: Event): boolean {\n    const target = (): EventTarget => this; // use get due IE specific\n    Object.defineProperty(e, 'target', {get: target, enumerable: true});\n    Object.defineProperty(e, 'currentTarget', {get: target, enumerable: true});\n    Object.defineProperty(e, 'srcElement', {get: target, enumerable: true});\n    this._listeners[e.type]?.forEach((listener) => {\n      if (typeof listener === 'function') listener.call(this, e);\n      else listener.handleEvent.call(listener, e);\n    });\n    return e.defaultPrevented;\n  }\n\n  /** @deprecated alias for `addEventListener` */\n  public addListener(cb: EventListener): void {\n    this.addEventListener(cb);\n  }\n  /** @deprecated alias for `removeEventListener` */\n  public removeListener(cb: EventListener): void {\n    this.removeEventListener(cb);\n  }\n}\n\nfunction validateEventListenerType(callback: any): void | never {\n  if (!callback || typeof callback !== 'function' && typeof callback.handleEvent !== 'function') {\n    throw Error('Callback should be a function or EventListenerObject');\n  }\n}\n","import {TAB} from './keys';\n\n/**\n * Chain focus order between passed elements.\n * Passive (should be called inside keyboard event handler)\n */\nexport const handleFocusChain = (e: KeyboardEvent, first: HTMLElement, last: HTMLElement): boolean | undefined => {\n  if (e.key !== TAB) return;\n  if (last && e.target === first && e.shiftKey) {\n    last.focus();\n    e.preventDefault();\n    return true;\n  }\n  if (first && e.target === last && !e.shiftKey) {\n    first.focus();\n    e.preventDefault();\n    return true;\n  }\n};\n\n/**\n * TODO: add visibility check\n * Gets keyboard-focusable elements within a specified root element\n * @param root - root element\n */\nexport const getKeyboardFocusableElements = (root: HTMLElement | Document = document): Element[] => {\n  return Array.from(root.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])'))\n    .filter((el) => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n};\n","export const TAB = 'Tab';\nexport const ENTER = 'Enter';\nexport const ESC = 'Escape';\nexport const SPACE = ' ';\nexport const BACKSPACE = 'Backspace';\n\nexport const ALT = 'Alt';\nexport const SHIFT = 'Shift';\nexport const CONTROL = 'Control';\n\nexport const PAUSE = 'Pause';\nexport const END = 'End';\nexport const HOME = 'Home';\nexport const DELETE = 'Delete';\n\nexport const PAGE_UP = 'PageUp';\nexport const PAGE_DOWN = 'PageDown';\n\nexport const ARROW_LEFT = 'ArrowLeft';\nexport const ARROW_UP = 'ArrowUp';\nexport const ARROW_RIGHT = 'ArrowRight';\nexport const ARROW_DOWN = 'ArrowDown';\n\nexport const SYSTEM_KEYS = [TAB, ALT, SHIFT, CONTROL, PAGE_UP, PAGE_DOWN, ARROW_LEFT, ARROW_UP, ARROW_RIGHT, ARROW_DOWN];\n","/**\n * Execute callback in bounds of the next task with dom ready state precondition\n */\nexport function onDocumentReady(callback: () => void): void {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      setTimeout(() => callback());\n    });\n  } else {\n    setTimeout(() => callback());\n  }\n}\n","/**\n * A Rect describes the size and position of a rectangle.\n */\nexport class Rect {\n  /** The X coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public x = 0;\n  /** The Y coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public y = 0;\n  /** The width of the Rect. */\n  public width = 0;\n  /** The height of the Rect. */\n  public height = 0;\n\n  /**\n   * The static method creates a new Rect instance from a rect-like object.\n   * @param rect - rect-like object\n   */\n  public static from(rect: {x?: number, left?: number, y?: number, top?: number, width?: number, height?: number} = {}): Rect {\n    return new this(rect.x || rect.left, rect.y || rect.top, rect.width, rect.height);\n  }\n\n  /**\n   * The static method checks the equality of the two Rect instances.\n   * @param rect1 - first instance of Rect\n   * @param rect2 - second instance of Rect\n   */\n  public static isEqual(rect1: Rect, rect2: Rect): boolean {\n    return rect1.x === rect2.x && rect1.y === rect2.y && rect1.width === rect2.width && rect1.height === rect2.height;\n  }\n\n  /**\n   * The static method returns intersection Rect of two Rect instances\n   * @param rect1 - first instance of Rect\n   * @param rect2 - second instance of Rect\n   */\n  public static intersect(rect1: Rect, rect2: Rect): Rect {\n    const top = Math.max(rect1.top, rect2.top);\n    const left = Math.max(rect1.left, rect2.left);\n    const bottom = Math.min(rect1.bottom, rect2.bottom);\n    const right = Math.min(rect1.right, rect2.right);\n    const width = Math.max(right - left, 0);\n    const height = Math.max(bottom - top, 0);\n    return Rect.from({top, left, width, height});\n  }\n\n  public constructor(x?: number, y?: number, width?: number, height?: number) {\n    this.x = x || 0;\n    this.y = y || 0;\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n\n  /**\n   * Get the top coordinate value of the Rect (has the same value as y).\n   */\n  public get top(): number {\n    return this.y;\n  }\n\n  /**\n   * Get the left coordinate value of the Rect (has the same value as x).\n   */\n  public get left(): number {\n    return this.x;\n  }\n\n  /**\n   * Get the right coordinate value of the DOMRect.\n   */\n  public get right(): number {\n    return this.x + this.width;\n  }\n\n  /**\n   * Get the bottom coordinate value of the Rect.\n   */\n  public get bottom(): number {\n    return this.y + this.height;\n  }\n\n  /**\n   * Get the center X coordinate value of the Rect.\n   */\n  public get cx(): number {\n    return this.x + this.width / 2;\n  }\n\n  /**\n   * Get the center Y coordinate value of the Rect.\n   */\n  public get cy(): number {\n    return this.y + this.height / 2;\n  }\n\n  /**\n   * Method that accepts one argument and grows the Rect by the specified increment in pixels.\n   * It increases the size of the Rect by moving each point on the edge of the Rect to a certain distance further away from the center of the Rect.\n   * @param increment - distance to grow in pixels for both X and Y-axis\n   */\n  public grow(increment: number): Rect;\n  /**\n   * Method that accepts two arguments where each specified increment grows the rect in different axis in pixels.\n   * @param incrementX -  distance to grow in pixels for X-axis\n   * @param incrementY -  distance to grow in pixels for Y-axis\n   */\n  public grow(incrementX: number, incrementY: number): Rect;\n  public grow(incrementX: number, incrementY: number = incrementX): Rect {\n    this.y -= incrementY;\n    this.x -= incrementX;\n    this.height += 2 * incrementY;\n    this.width += 2 * incrementX;\n    return this;\n  }\n\n  /**\n   * Method that accepts one argument and shrinks the Rect by the specified decrement in pixels.\n   * It reduces the size of the Rect by moving each point on the edge of the Rect to a certain distance closer to the center of the Rect.\n   * @param decrement - distance to shrink in pixels for both X and Y-axis\n   */\n  public shrink(decrement: number): Rect;\n  /**\n   * Method that accepts two arguments where each specified decrement shrinks the rect in different axis in pixels.\n   * @param decrementX -  distance to shrink in pixels for X-axis\n   * @param decrementY -  distance to shrink in pixels for Y-axis\n   */\n  public shrink(decrementX: number, decrementY: number): Rect;\n  public shrink(decrementX: number, decrementY: number = decrementX): Rect {\n    return this.grow(-decrementX, -decrementY);\n  }\n\n  /** @returns the numeric value of rectangle area */\n  public get area(): number {\n    return this.height * this.width;\n  }\n}\n","import {memoize} from '../decorators/memoize';\n\nexport type ScrollType = 'default' | 'negative' | 'reverse';\n\n// TODO: functional\nexport abstract class RTLUtils {\n  /** Check if the element in a RTL direction context */\n  static isRtl(el?: HTMLElement | null): boolean {\n    return getComputedStyle(el || document.body).direction === 'rtl';\n  }\n\n  /**\n   * @returns RTL scroll type (lazy, memoized)\n   */\n  @memoize()\n  static get scrollType(): ScrollType {\n    let scrollType: ScrollType = 'default';\n    const el = createDummyEl();\n    document.body.appendChild(el);\n    if (el.scrollLeft <= 0) {\n      el.scrollLeft = 2;\n      scrollType = el.scrollLeft < 2 ? 'negative' : 'reverse';\n    }\n    document.body.removeChild(el);\n    return scrollType;\n  }\n\n  static normalizeScrollLeft(el: HTMLElement, value: number | null = null, isRtl: boolean = RTLUtils.isRtl(el)): number {\n    value = (value === null) ? el.scrollLeft : value;\n    switch (isRtl ? RTLUtils.scrollType : '') {\n      case 'negative':\n        return el.scrollWidth - el.clientWidth + value;\n      case 'reverse':\n        return el.scrollWidth - el.clientWidth - value;\n      default:\n        return value;\n    }\n  }\n}\n\n/** Creates the dummy test element with a horizontal scroll presented */\nfunction createDummyEl(): HTMLElement {\n  const el = document.createElement('div');\n  el.appendChild(document.createTextNode('ESL!'));\n  el.dir = 'rtl';\n  Object.assign(el.style, {\n    position: 'absolute',\n    top: '-1000px',\n    width: '4px',\n    height: '1px',\n    fontSize: '14px',\n    overflow: 'scroll'\n  });\n  return el;\n}\n","/** checks if the attribute is dangerous */\nconst isDangerousAttribute = (name: string, value: string): boolean => {\n  const val = value.replace(/\\s+/g, '').toLowerCase();\n  if (['src', 'data', 'href', 'xlink:href'].includes(name)\n    && (val.includes('javascript:') || val.includes('data:text/html'))) return true;\n  return name.indexOf('on') === 0;\n};\n\n/** loops through each attribute, if it's dangerous, remove it */\nconst removeDangerousAttributes = (el: Element): void => {\n  Array.from(el.attributes).forEach(({name, value}) => {\n    if (isDangerousAttribute(name, value)) {\n      el.removeAttribute(name);\n    }\n  });\n};\n\n/** removes malicious attributes from element and its children */\nconst sanitizeElAttributes = (body: Element): void => {\n  Array.from(body.children).forEach((el) => {\n    removeDangerousAttributes(el);\n    sanitizeElAttributes(el);\n  });\n};\n\n/** removes script elements inside element */\nconst removeScripts = (body: Element): void => {\n  const scripts = body.querySelectorAll('script');\n  Array.from(scripts).forEach((script) => script.remove());\n};\n\nconst filterElements = (body: Element, allowedTopLevelTags: string[]): void => {\n  if (!allowedTopLevelTags.length) return;\n  Array.from(body.childNodes).forEach((el: Element) => {\n    if (!allowedTopLevelTags.includes(el.tagName)) body.removeChild(el);\n  });\n};\n\n/**\n * Sanitizes html string from malicious attributes, values, and scripts\n * Can also filter elements at the top nesting level by tag names.\n * @param html - html string to sanitize\n * @param allowedTopLevelTags - array of allowed tag names\n */\nexport function sanitize(html: string, allowedTopLevelTags: string[] = []): string {\n  // converts the string to an HTML document\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(html, 'text/html');\n  const body = doc.body || document.createElement('body');\n  // sanitizes html\n  removeScripts(body);\n  sanitizeElAttributes(body);\n  // filter allowed tags\n  filterElements(body, allowedTopLevelTags);\n\n  return body.innerHTML;\n}\n","/**\n * Creates new async script tag by id and src\n */\nconst createAsyncScript = (id: string, src: string): HTMLScriptElement => {\n  const script = document.createElement('script');\n  script.id = id;\n  script.async = true;\n  script.src = src;\n  return script;\n};\n\n/**\n * Common function that loads script async\n * @param id - unique script id that is used as a marker to prevent future load\n * @param src - script src (url) to load\n */\nexport function loadScript(id: string, src: string): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    const script: HTMLScriptElement =\n      (document.getElementById(id) || createAsyncScript(id, src)) as HTMLScriptElement;\n    const state = script.getAttribute('state');\n\n    switch (state) {\n      case 'success': resolve(new Event('load')); break;\n      case 'error': reject(new Event('error')); break;\n      default:\n        script.addEventListener('load', (e: Event) => {\n          script.setAttribute('state', 'success');\n          resolve(e);\n        });\n        script.addEventListener('error', (e: Event) => {\n          script.setAttribute('state', 'error');\n          reject(e);\n        });\n    }\n    if (!script.parentNode) {\n      const firstScriptTag =\n        document.querySelector('script') || document.querySelector('head title');\n      if (firstScriptTag && firstScriptTag.parentNode) {\n        firstScriptTag.parentNode.insertBefore(script, firstScriptTag);\n      } else {\n        reject('Page document structure is incorrect');\n      }\n    }\n  });\n}\n","import {getNodeName, getParentNode} from '../api';\n\n/**\n * Get the list of all scroll parents, up the list of ancestors until we get to the top window object.\n * @param element - element for which you want to get the list of all scroll parents\n * @param list - array of elements to concatenate with the list of all scroll parents of element (optional)\n */\nexport function getListScrollParents(element: Element, list: Element[] = []): Element[] {\n  const scrollParent = getScrollParent(element);\n  const isBody = scrollParent === element.ownerDocument?.body;\n  const target = isBody\n    ? isScrollable(scrollParent) ? scrollParent : []\n    : scrollParent;\n\n  const updatedList = list.concat(target);\n  return isBody\n    ? updatedList\n    : updatedList.concat(getListScrollParents(getParentNode(scrollParent) as Element));\n}\n\n/**\n * Get the scroll parent of the specified element in the DOM tree.\n * @param node - element for which to get the scroll parent\n */\nexport function getScrollParent(node: Element): Element {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    return node.ownerDocument?.body as Element;\n  }\n\n  if (node instanceof HTMLElement && isScrollable(node as Element)) {\n    return node as Element;\n  }\n\n  return getScrollParent(getParentNode(node) as Element);\n}\n\n/**\n * Check that element is scroll parent.\n * @param element - element for checking\n * */\nexport function isScrollable(element: Element): boolean {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  const {overflow, overflowX, overflowY} = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\n","import {tryUntil} from '../../async/promise';\n\n/**\n * This is a promise-based version of scrollIntoView().\n * Method scrolls the element's parent container such that the element on which\n * scrollIntoView() is called is visible to the user. The promise is resolved when\n * the element became visible to the user and scrolling stops.\n *\n * Note: Please, use the native element.scrollIntoView() if you don't need a promise\n * to detect the moment when the scroll is finished or you don't use smooth behavior.\n * @param element - element to be made visible to the user\n * @param options - scrollIntoView options\n */\nexport function scrollIntoView(element: Element, options?: boolean | ScrollIntoViewOptions | undefined): Promise<boolean> {\n  let same = 0;\n  let lastLeft: number;\n  let lastTop: number;\n  const check = (): boolean => {\n    const {top, left} = element.getBoundingClientRect();\n\n    if (top !== lastTop || left !== lastLeft) {\n      same = 0;\n      lastTop = top;\n      lastLeft = left;\n    }\n    return same++ > 2;\n  };\n\n  element.scrollIntoView(options);\n  return tryUntil(check, 333, 30); // will check top position every 30ms, but not more than 250 times (10s)\n}\n","import type {Predicate} from '../misc/functions';\n/** Check that `nodeA` and `nodeB` are from the same tree path */\nexport const isRelativeNode = (nodeA: Node | null, nodeB: Node | null): boolean => {\n  return !!(nodeA && nodeB) && (nodeA.contains(nodeB) || nodeB.contains(nodeA));\n};\n\ntype IteratorFn = (el: Element) => Element | null;\n\n/** Create function that finds next dom element, that matches selector, in the sequence declared by `next` function */\nexport const createSequenceFinder = (next: IteratorFn, includeSelf: boolean = false) => {\n  return function (base: Element, predicate: string | Predicate<Element>): Element | null {\n    if (!predicate) return includeSelf ? base : next(base);\n    for (let target: Element | null = includeSelf ? base : next(base); target; target = next(target)) {\n      if (typeof predicate === 'string' && target.matches(predicate)) return target;\n      if (typeof predicate === 'function' && predicate.call(target, target)) return target;\n    }\n    return null;\n  };\n};\n\n/** Checks if element matches passed selector or exact predicate function */\nexport const isMatches = (el: Element, matcher?: string | ((el: Element) => boolean)): boolean => {\n  if (typeof matcher === 'string') return el.matches(matcher);\n  if (typeof matcher === 'function') return matcher(el);\n  return typeof matcher === 'undefined';\n};\n\n/** @returns first matching next sibling or null*/\nexport const findNext = createSequenceFinder((el) => el.nextElementSibling);\n/** @returns first matching previous sibling or null*/\nexport const findPrev = createSequenceFinder((el) => el.previousElementSibling);\n/** @returns first matching parent or null*/\nexport const findParent = createSequenceFinder((el) => el.parentElement);\n/** @returns first matching ancestor starting from passed element or null*/\nexport const findClosest = createSequenceFinder((el) => el.parentElement, true);\n/** @returns first matching host element starting from passed element*/\nexport const findHost = createSequenceFinder((el) => {\n  const root = el.getRootNode();\n  return (root instanceof ShadowRoot) ? root.host : null;\n}, true);\n\n/** @returns Array of all matching elements in subtree or empty array */\nexport const findAll = (base: Element, sel: string): Element[] => {\n  return sel ? Array.from(base.querySelectorAll(sel)) : [base];\n};\n/** @returns Array of all matching children or empty array */\nexport const findChildren = (base: Element, sel: string): Element[] => {\n  return Array.from(base.children).filter((el: Element) => !sel || el.matches(sel));\n};\n\n/**\n * Find closest parent node of `node` by `predicate`.\n * Optional `skipSelf` to skip initial node\n */\nexport const findClosestBy = (node: Node | null, predicate: (node: Node) => boolean, skipSelf = false): Node | null => {\n  let current = skipSelf && node ? node.parentNode : node;\n  while (current) {\n    if (predicate(current)) return current;\n    current = current.parentNode;\n  }\n  return null;\n};\n\n/** @deprecated Cumulative traversing utility set */\nexport abstract class TraversingUtils {\n  static isRelative = isRelativeNode;\n  static closestBy = findClosestBy;\n  static createSequenceFinder = createSequenceFinder;\n\n  static findNext = findNext;\n  static findPrev = findPrev;\n  static findParent = findParent;\n  static findClosest = findClosest;\n\n  static findAll = findAll;\n  static findChildren = findChildren;\n}\n","import {Rect} from './rect';\nimport {getListScrollParents} from './scroll';\nimport {findClosestBy, findHost} from './traversing';\nimport {getWindowRect} from './window';\n\nexport interface VisibilityOptions {\n  /** Element will be considered invisible if opacity set to '0' */\n  opacity?: boolean;\n  /** Element will be considered invisible if visibility set to 'hidden' */\n  visibility?: boolean;\n  /** Element will be considered invisible if it's not in viewport */\n  viewport?: boolean;\n}\n\n/**\n * Checks if the specified element is visible\n * @param el - element to be checked\n * @param options - object of additional visibility options to include\n */\nexport function isVisible(el: HTMLElement, options: VisibilityOptions = {visibility: true}): boolean {\n  if (!el.getClientRects().length) return false;\n  if (options.visibility && findHost(el, (host) => getComputedStyle(host).visibility === 'hidden')) return false;\n  if (options.opacity &&\n    findClosestBy(el, (parent) => parent instanceof Element && getComputedStyle(parent).opacity === '0')) return false;\n  return !(options.viewport && !isInViewport(el));\n}\n\n/**\n * Checks if the specified element is inside the viewport\n * @param el - element to be checked\n */\nexport function isInViewport(el: HTMLElement): boolean {\n  const wndIntersection = Rect.intersect(getWindowRect(), Rect.from(el.getBoundingClientRect()));\n  if (wndIntersection.area === 0) return false;\n  return !getListScrollParents(el).some((parent: HTMLElement) =>\n    Rect.intersect(wndIntersection, Rect.from(parent.getBoundingClientRect())).area === 0);\n}\n","import {Rect} from './rect';\n\n/**\n * Get the window object associated with a document of the specified element.\n * @param node - element for which to get window\n * */\nexport function getWindow(node: Node | Window): Window {\n  if (node === null) return window;\n  if (node instanceof Window) return node;\n  const ownerDocument = node.ownerDocument;\n  return ownerDocument ? ownerDocument.defaultView || window : window;\n}\n\n/**\n * Get the size and position of the window.\n * @returns\n */\nexport function getWindowRect(wnd: Window = window): Rect {\n  return Rect.from({\n    x: wnd.scrollX || wnd.pageXOffset,\n    y: wnd.scrollY || wnd.pageYOffset,\n    width: wnd.innerWidth || wnd.document.documentElement.clientWidth,\n    height: wnd.innerHeight || wnd.document.documentElement.clientHeight\n  });\n}\n","import {ExportNs} from './export-ns';\n\nconst {userAgent, vendor, platform} = window.navigator;\n\n// IE Detection\nexport const isTrident = /trident/i.test(userAgent);\nexport const isIE = isTrident;\n\n// Edge Detection\nexport const isEdgeHTML = /edg([ea]|ios)/i.test(userAgent);\nexport const isBlinkEdge = /\\sedg\\//i.test(userAgent);\nexport const isEdge = isEdgeHTML || isBlinkEdge;\n\n// Gecko\nexport const isGecko = /gecko/i.test(userAgent) && !/like gecko/i.test(userAgent);\nexport const isFirefox = /firefox|iceweasel|fxios/i.test(userAgent);\n\n// Opera / Chrome\nexport const isOpera = /(?:^opera.+?version|opr)/.test(userAgent);\nexport const isChrome = !isOpera && /google inc/.test(vendor);\n\n// Webkit\nexport const isWebkit = /(apple)?webkit/i.test(userAgent);\n\n// Safari\nexport const isSafari = isWebkit && /^((?!chrome|android).)*safari/i.test(userAgent);\n\n// Blink\nexport const isBlink = isWebkit && !isSafari;\n\n// Bot detection\nexport const isBot = /Chrome-Lighthouse|Google Page Speed Insights/i.test(userAgent);\n\n// Mobile\nexport const isAndroid = /Android/i.test(userAgent);\nexport const isMobileIOS13 = /* iOS 13+ detection */ (platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\nexport const isMobileIOS = /iPad|iPhone|iPod/.test(platform) || isMobileIOS13;\nexport const isLegacyMobile = /webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\nexport const isMobile = isMobileIOS || isAndroid || isLegacyMobile;\nexport const isMobileSafari = isMobileIOS && isWebkit && /CriOS/i.test(userAgent);\n\n// Touch Detection\nexport const isTouchDevice = ((): boolean => {\n  const navApi: any = window.navigator;\n  if (navApi.maxTouchPoints || navApi.msMaxTouchPoints) return true;\n  return ('ontouchstart' in window) || ('DocumentTouch' in window && document instanceof Touch);\n})();\n\n// Hover check\n// Note: always true for IE\nexport const hasHover = !matchMedia('(hover: none)').matches;\n\ntype TouchEventsDefinition = {\n  START: string;\n  MOVE: string;\n  END: string;\n};\n/** @deprecated TODO: needs to be reworked or moved away from device detector */\nexport const TOUCH_EVENTS = ((): TouchEventsDefinition => {\n  const isTouch = isTouchDevice;\n  return {\n    START: isTouch ? 'touchstart' : 'pointerdown',\n    MOVE: isTouch ? 'touchmove' : 'pointermove',\n    END: isTouch ? 'touchend' : 'pointerup'\n  };\n})();\n\n/**\n * Device detection utility\n * @readonly\n */\n@ExportNs('DeviceDetector')\nexport abstract class DeviceDetector {\n  // IE Detection\n  public static readonly isTrident = isTrident;\n  public static readonly isIE = isIE;\n\n  // Edge Detection\n  public static readonly isEdgeHTML = isEdgeHTML;\n  public static readonly isBlinkEdge = isBlinkEdge;\n  public static readonly isEdge = isEdge;\n\n  // Gecko\n  public static readonly isGecko = isGecko;\n  public static readonly isFirefox = isFirefox;\n\n  // Opera / Chrome\n  public static readonly isOpera = isOpera;\n  public static readonly isChrome = isChrome;\n\n  // Webkit\n  public static readonly isWebkit = isWebkit;\n\n  // Safari\n  public static readonly isSafari = isSafari;\n\n  // Blink\n  public static readonly isBlink = isBlink;\n\n  // Bot detection\n  public static readonly isBot = isBot;\n\n  // Mobile\n  public static readonly isAndroid = isAndroid;\n  public static readonly isMobileIOS13 = isMobileIOS13;\n  public static readonly isMobileIOS = isMobileIOS;\n  public static readonly isLegacyMobile = isLegacyMobile;\n\n  public static readonly isMobile = isMobile;\n  public static readonly isMobileSafari = isMobileSafari;\n\n  // Touch Detection\n  public static isTouchDevice = isTouchDevice;\n\n  // Hover check\n  // Note: always true for IE\n  public static hasHover = hasHover;\n\n  /** @deprecated TODO: needs to be reworked or moved away from device detector */\n  static TOUCH_EVENTS = TOUCH_EVENTS;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    DeviceDetector: typeof DeviceDetector;\n  }\n}\n","const NS_NAME = 'ESL';\n\n/**\n * Nested declaration helper\n */\nfunction define(root: any, name: string, value: any): void {\n  name.split('.').reduce((obj: any, key, index, parts) => {\n    if (parts.length === index + 1) {\n      return (obj[key] = obj[key] || value);\n    }\n    const type = typeof obj[key];\n    if (type !== 'undefined' && type !== 'object' && type !== 'function') {\n      throw new Error(`Can not define ${value} on ${name}`);\n    }\n    return (obj[key] = obj[key] || {});\n  }, root);\n}\n\n/**\n * Method to manually declare key in library namespace\n * See {@link ExportNs} decorator for details\n */\nexport const exportNs = (name: string, module: any): void => {\n  if (!(NS_NAME in window)) return;\n  define((window as any)[NS_NAME], name, module);\n};\n\n/**\n * Decorator to declare function or class in a global ns\n * @param name - key path to declare in ESL global ns\n * NOTE: path parts should be separated by dots\n * @example\n * ```ts\n * @Export('Package.Component')\n * ```\n * NOTE: in case declaration contains components-packages, their origins will be mixed with declaration in a Runtime\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function ExportNs<T extends Function>(name?: string) {\n  return (module: T): void => exportNs(name || module.name, module);\n}\n\n/** Declare ESL global */\nExportNs.declare = (): void => {\n  if ('ESL' in window) return;\n  Object.defineProperty(window, 'ESL', {value: {}});\n};\n","/** Fix IE browser to allow to display alert under iframe */\nexport function createZIndexIframe(): HTMLElement {\n  const iframe = document.createElement('iframe');\n  iframe.className = 'ie-zindex-fix';\n  iframe.src = 'about:blank';\n  return iframe;\n}\n","import {rafDecorator} from '../async/raf';\nimport {DeviceDetector} from '../environment/device-detector';\n\n/**\n * Small utility to provide 100vw and 100vh alternative CSS Variables\n * - vwProp (default: `--100vw`) - scroll independent viewport width value\n * - vhProp (default: `--100vh`) - device independent viewport height value (also known as 100vh iOS fix)\n */\nexport class ESLVSizeCSSProxy {\n  public static vwProp = '--100vw';\n  public static vhProp = '--100vh';\n\n  /** Inits custom CSS variables for viewport sizes and it's observation */\n  public static observe(): void {\n    // IE doesnt support CSS Variables (hopefully same as 100vh issue :D)\n    if (DeviceDetector.isIE) return;\n\n    this.update();\n    window.addEventListener('resize', this.updateDebounced);\n  }\n  /** Destroys observer */\n  public static destroy(): void {\n    window.removeEventListener('resize', this.updateDebounced);\n  }\n\n  /** Update custom CSS variables with actual viewport sizes */\n  protected static update(): void {\n    const $html = document.documentElement;\n    $html.style.setProperty(this.vwProp, `${this.viewportWidth}px`);\n    $html.style.setProperty(this.vhProp, `${this.viewportHeight}px`);\n  }\n  protected static readonly updateDebounced = rafDecorator(this.update.bind(this));\n\n  /** @returns current viewport width */\n  public static get viewportWidth(): number {\n    return document.documentElement.clientWidth;\n  }\n  /** @returns current viewport height */\n  public static get viewportHeight(): number {\n    return window.innerHeight;\n  }\n}\n","import {identity} from './functions';\nimport {isArrayLike} from './object';\n\ntype Tuple<T> = [T?, T?];\n\n/** Split array into tuples */\nexport const tuple = <T>(arr: T[]): Tuple<T>[] => arr.reduce((acc: Tuple<T>[], el) => {\n  if (acc.length === 0 || acc[acc.length - 1].length >= 2) acc.push([]);\n  acc[acc.length - 1].push(el);\n  return acc;\n}, []);\n\n/** Flat array - unwraps one level of nested arrays */\nexport const flat = <T>(arr: (null | T | T[])[]): T[] =>\n  arr.reduce((acc: T[], el) => el ? acc.concat(el) : acc, []) as T[];\n\n/** Wraps passed object or primitive to array */\nexport const wrap = <T>(arr: undefined | null | T | T[]): T[] => {\n  if (arr === undefined || arr === null) return [];\n  if (Array.isArray(arr)) return arr;\n  return [arr];\n};\n\n/** Unwraps and returns the first element if passed object is array-like, returns original object otherwise */\nexport function unwrap(value: []): undefined;\nexport function unwrap<T>(value: (ArrayLike<T> & {0: T}) | T): T;\nexport function unwrap<T extends Node>(value: NodeListOf<T>): T | undefined;\nexport function unwrap(value: any): any;\nexport function unwrap(value: any): any {\n  return isArrayLike(value) ? value[0] : value;\n}\n\n/** Makes array values unique */\nexport const uniq = <T> (arr: T[]): T[] => {\n  if (arr.length < 2) return arr.slice(0);\n  const result: T[] = [];\n  const set = new Set<T>();\n  arr.forEach((item) => set.add(item));\n  set.forEach((item) => result.push(item));\n  return result;\n};\n\n/** Create an array filled with the range [0,..,N-1] */\nexport function range(n: number): number[];\n/** Create an array filled with values returned by the filler callback */\nexport function range<T>(n: number, filler: (i: number) => T): T[];\nexport function range(n: number, filler: (i: number) => any = identity): any[] {\n  const arr = Array(n);\n  let i = 0;\n  while (i < n) arr[i] = filler(i++);\n  return arr;\n}\n\n/**\n * @returns object with a criteria value as a key and an array of original items that belongs to the current criteria value\n */\nexport const groupBy = <T, V extends string | number>(array: T[], group: (item: T) => V): Record<V, T[]> => {\n  return array.reduce((obj: Record<V, T[]>, el: T) => {\n    const key = group(el);\n    obj[key] ? obj[key].push(el) : obj[key] = [el];\n    return obj;\n  }, {} as Record<V, T[]>);\n};\n","import {get} from './object';\n\n/** Converts string to kebab-case notation */\nexport const toKebabCase = (str: string): string => {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\n};\n\n/** Converts string to camelCase notation */\nexport const toCamelCase = (str: string): string => {\n  return str.trim().replace(/[\\s-,_]+([a-zA-Z0-9]?)/g, (match: string, word: string) => word.toUpperCase());\n};\n\n/** Makes the first non-indent (space, tab, newline) letter in the string capitalized */\nexport const capitalize = (str: string): string => {\n  let i = 0;\n  while (i < str.length && (str[i] === ' ' || str[i] === '\\t' || str[i] === '\\n')) i++;\n  return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);\n};\n\n/** Unwraps string from parenthesis */\nexport const unwrapParenthesis = (str: string): string => {\n  return str.trim().replace(/^\\((.*)\\)$/, '$1').trim();\n};\n\n/** Parses `null` and `undefined` as an empty string */\nexport const parseString = (val: string | null): string => String(val ?? '');\n\n/** Parses string representation of the boolean value */\nexport const parseBoolean = (val: string | null): boolean => val !== null && val !== 'false';\n\n/**\n * Parses number with the ability to pass an alternative fallback for NaN.\n * Note: falsy values except 0 are treated as NaN\n */\nexport const parseNumber = (str: string | number, nanValue?: number | undefined): number | undefined => {\n  if (str === 0) return 0;\n  const value = +(str || NaN);\n  return isNaN(value) ? nanValue : value;\n};\n\n/**\n * Common function that returns coefficient aspect ratio\n * Supported formats: w:h, w/h, coefficient\n * @example\n * `16:9`, `16/9`, `1.77`\n * @param str - string to parse\n * @returns aspect ratio coefficient\n */\nexport function parseAspectRatio(str: string): number {\n  const [w, h] = str.split(/[:/]/);\n  if (typeof h !== 'undefined') return +w / +h;\n  return +w || 0;\n}\n\n/** Evaluates passed string or returns `defaultValue` */\nexport function evaluate(str: string, defaultValue?: any): any {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    return str ? (new Function(`return ${str}`))() : defaultValue;\n  } catch (e) {\n    console.warn('Cannot parse value ', str, e);\n    return defaultValue;\n  }\n}\n\n/** Default RegExp to match replacements in the string for the {@link format} function */\nexport const DEF_FORMAT_MATCHER = /{[{%]?([\\w.]+)[%}]?}/g;\n\n/** Replaces `{key}` patterns in the string from the source object */\nexport function format(str: string, source: Record<string, any>, matcher: RegExp = DEF_FORMAT_MATCHER): string {\n  return str.replace(matcher, (match, key) => {\n    const val = get(source, key);\n    return val === undefined ? match : val;\n  });\n}\n","/** Function that does nothing */\nexport const noop: AnyToVoidFnSignature = () => undefined;\n\n/** Function that returns the first argument */\nexport const identity = <T>(arg: T): T => arg;\n\nexport type NoopFnSignature = () => void;\n\nexport type AnyToVoidFnSignature = (...args: any[]) => void;\n\nexport type AnyToAnyFnSignature = (...args: any[]) => any;\n\nexport type MethodTypedDecorator<T> = (target: any, property: string, descriptor: TypedPropertyDescriptor<T>) => TypedPropertyDescriptor<T> | void;\n\nexport type Predicate<T> = (el: T) => boolean;\n\n/**\n * Property provider function\n * @param that - (equal to `this` context) host or context\n */\nexport type PropertyProvider<T> = (this: unknown, that: unknown) => T;\n\n/** Resolves {@link PropertyProvider} function to the value */\nexport const resolveProperty = <T>(val: T | PropertyProvider<T>, origin: unknown): T => typeof val === 'function' ? val.call(origin, origin) : val;\n","import type {AnyToAnyFnSignature} from './functions';\n\n/** Memoized function type */\nexport type MemoizedFn<T extends AnyToAnyFnSignature> = T & {\n  /** Cache instance */\n  cache: Map<null | string, ReturnType<T>>;\n  /** Clear memoization cache */\n  clear: () => void;\n  /** Check existence of cache for passed params */\n  has: (...params: Parameters<T>) => boolean;\n};\n\n/**\n * Memoization decorator function. Caches the original function result according to hash generated from arguments.\n * In case the hash function returns `undefined` value will not be memoized.\n * @see MemoHashFn Hash function signature.\n */\nexport function memoizeFn<F extends AnyToAnyFnSignature>(fn: F, hashFn: MemoHashFn<F> = defaultArgsHashFn): MemoizedFn<F> {\n  function memo(...args: Parameters<F>): any {\n    const key = hashFn(...args);\n    if (key !== null && typeof key !== 'string') {\n      console.warn(`Can't cache value for ${fn.name} call.`);\n      return fn.apply(this, args);\n    }\n    if (!memo.cache.has(key)) {\n      memo.cache.set(key, fn.apply(this, args));\n    }\n    return memo.cache.get(key);\n  }\n\n  memo.cache = new Map<null | string, ReturnType<F>>();\n  memo.clear = (): void => memo.cache.clear();\n  memo.has = (...args: Parameters<F>): boolean => {\n    const key = hashFn(...args);\n    return key === undefined ? false : memo.cache.has(key);\n  };\n  return memo as MemoizedFn<F>;\n}\n\n/**\n * Describe abstract memoization hash function. Memoization should have the same or compatible signature as the decorated function.\n * Hash function can return string or null as a hash result. Note: null is correct hash for arguments!\n * If the result is `undefined` - it means that the hash can not be generated.\n */\nexport type MemoHashFn<F extends AnyToAnyFnSignature = AnyToAnyFnSignature> = (...args: Parameters<F>) => undefined | null | string;\n\n/**\n * Default arguments hash function.\n * Supports only 0-1 arguments with a primitive type.\n */\nexport function defaultArgsHashFn(...args: any[]): string | null | undefined {\n  if (args.length === 0) return null;\n  if (args.length > 1) return;\n  if (typeof args[0] !== 'string' && typeof args[0] !== 'number' && typeof args[0] !== 'boolean') return;\n  return String(args[0]);\n}\n","import {isObject} from './types';\n\n/** Deeply compares passed objects */\nexport function isEqual(obj1: any, obj2: any): boolean {\n  if (Object.is(obj1, obj2)) return true;\n  if (typeof obj1 !== typeof obj2) return false;\n  if (isObject(obj1) && isObject(obj2)) {\n    const keys1 = Object.keys(obj1);\n    const keys2 = Object.keys(obj2);\n    if (keys1.length !== keys2.length) return false;\n    return !keys1.some((key) => !isEqual(obj1[key], obj2[key]));\n  }\n  return false;\n}\n\n/** @deprecated alias for `isEqual` method */\nexport const deepCompare = isEqual;\n\n/** Check if arr and arr mask has intersection */\nfunction isIntersect(arrObj: any[], arrMask: any[], comparer: (a: any, b: any) => boolean): boolean {\n  return arrMask.every((key) => arrObj.some((itm) => comparer(itm, key)));\n}\n\n/**\n * Checks if all keys presented in the `mask` are equal to the `obj` keys\n * Note: array order is not taken into account and uses intersection strategy\n */\nexport function isSimilar(obj: any, mask: any, deep: boolean = true): boolean {\n  if (Array.isArray(obj) && Array.isArray(mask)) return isIntersect(obj, mask, deep ? isSimilar : Object.is);\n  if (!isObject(obj) || !isObject(mask)) return Object.is(obj, mask);\n  return Object.keys(mask).every((key: string) => (deep ? isSimilar : Object.is)(obj[key], mask[key]));\n}\n","export type CopyPredicate = (key: string, value: any) => boolean;\n\n/** Makes a plain copy of obj with properties satisfying the predicate\n * If no predicate provided copies all own properties */\nexport function copy<T>(obj: T, predicate: CopyPredicate = (): boolean => true): Partial<T> {\n  const result: any = Object.assign({}, obj || {});\n  Object.keys(result).forEach((key) => {\n    (!predicate(key, result[key])) && delete result[key];\n  });\n  return result;\n}\n\n/** Makes a flat copy without undefined keys */\nexport function copyDefinedKeys<T>(obj?: T): Partial<T> {\n  return copy(obj || {}, (key, value) => value !== void 0);\n}\n\n/** Omits copying provided properties from object */\nexport function omit<T>(obj: T, keys: string[]): Partial<T> {\n  return copy(obj, (key) => !keys.includes(key));\n}\n","import {isObject} from './types';\n\n/**\n * Performs a deep copy of object.\n * @returns deep copy of the object\n */\nexport function deepMerge<T>(obj: T): T;\n/**\n * Performs a deep merge of two objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U>(obj1: T, obj2: U): T & U;\n/**\n * Performs a deep merge of three objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V>(obj1: T, obj2: U, obj3: V): T & U & V;\n/**\n * Performs a deep merge of four objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V, W>(obj1: T, obj2: U, obj3: V, obj4: W): T & U & V & W;\n/**\n * Performs a deep merge of objects and returns new object. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge(...objects: any[]): any;\nexport function deepMerge(...objects: any[]): any {\n  return objects.reduce((res: any, obj: any) => {\n    if (typeof obj === 'undefined') return res;\n    if (typeof res === 'undefined') res = Array.isArray(obj) ? [] : {};\n    if (!isObject(obj) || !isObject(res)) return obj;\n\n    Object.keys(obj).forEach((key) => {\n      res[key] = isObject(obj[key]) ? deepMerge(res[key], obj[key]) : obj[key];\n    });\n\n    return res;\n  }, undefined);\n}\n","import {isObjectLike} from './types';\n\n/** Full key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKeyDef = {\n  /** Key name */\n  key: string | number;\n  /** Key represents collection index */\n  isIndex?: boolean;\n  /** Key should produce array if not exists */\n  isIndexed?: boolean;\n};\n/** Key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKey = PathKeyDef | string | number;\n\n/** @returns PathKeyDef from the PathDef */\nconst toKeyDef = (key: PathKey): PathKeyDef => typeof key === 'object' ? key : {key};\n\n/** Parses path to full {@link PathKeyDef} array */\nexport const parseKeys = (path: string | PathKey[]): PathKeyDef[] => {\n  if (Array.isArray(path)) return path.map(toKeyDef);\n  return parseKeysPath(path || '.');\n};\n\n/** Parses string path to full {@link PathKeyDef} array */\nconst parseKeysPath = (path: string): PathKeyDef[] => {\n  let start = 0;\n  const parts: PathKeyDef[] = [];\n\n  while (start < path.length) {\n    let end = start = start + +(path[start] === '.'); // skip initial '.'\n    if (path[start] === '[') { // handle index syntax\n      end = ++start; // start bracket ignored\n      while (end < path.length && path[end] !== ']') ++end;\n      const key = path.substring(start, end);\n      const isIndex = !key || Math.floor(+key) === +key;\n      parts.push({key, isIndex});\n      start = ++end; // skip end bracket\n    } else { // handle simple key\n      while (end < path.length && path[end] !== '[' && path[end] !== '.') ++end;\n      const key = path.substring(start, end);\n      parts.push({key});\n      start = end;\n    }\n  }\n  return parts;\n};\n\n/**\n * Gets object property using \"path\" key\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param data - object\n * @param path - key path. string or {@link PathKey} array\n * @param defaultValue - default\n * @returns specified object property\n */\nexport const getByPath = (data: any, path: string | PathKey[], defaultValue?: any): any => {\n  const keys = parseKeys(path);\n  const result = keys.reduce((curr: any, {key}: PathKeyDef) => {\n    if (isObjectLike(curr)) return curr[key];\n    return undefined;\n  }, data);\n  return typeof result === 'undefined' ? defaultValue : result;\n};\n\n/**\n * Gets object property using \"path\" with a keys separated by `.`\n * @see getByPath\n */\nexport const get = (data: any, path: string, defaultValue?: any): any => getByPath(data, (path || '').split('.'), defaultValue);\n\n/**\n * Sets object property using \"path\" key\n * Creates empty object if sub-key value is not presented.\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax and collection creation):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param target - object\n * @param path - key path. string or {@link PathKey} array\n * @param value - value of property\n * @returns original object\n */\nexport const setByPath = (target: any, path: string | PathKey[], value: any): any => {\n  const keys = parseKeys(path);\n  const depth = keys.length - 1;\n  keys.reduce((cur: any, {key, isIndex, isIndexed}: PathKeyDef, pos: number) => {\n    if (isIndex && !key) key = cur.length || 0; // a[] only\n    if (pos !== depth && isObjectLike(cur[key])) return cur[key]; // key already presented\n    if (isIndexed === undefined && pos !== depth) isIndexed = keys[pos + 1].isIndex;\n    return cur[key] = (pos === depth) ? value : (isIndexed ? [] : {});\n  }, target);\n  return target;\n};\n\n/**\n * Sets object property using \"path\" with a keys separated by `.`\n * @see setByPath\n */\nexport const set = (target: any, path: string, value: any): any => setByPath(target, (path || '').split('.'), value);\n","/** Checks that passed value is object, but not a callable-object (function) */\nexport const isObject = (obj: any): obj is Record<string, any> => !!obj && typeof obj === 'object';\n/** Checks that passed value is an object or function */\nexport const isObjectLike = (obj: any): boolean => isObject(obj) || typeof obj === 'function';\n/** Checks if the passed value is primitive */\nexport const isPrimitive = (obj: any): obj is string | number | boolean | symbol | undefined | null =>\n  obj === null ||\n  typeof obj === 'undefined' ||\n  typeof obj === 'string' ||\n  typeof obj === 'number' ||\n  typeof obj === 'boolean' ||\n  typeof obj === 'symbol';\n/** Checks that passed object is prototype of some class */\nexport const isPrototype = (obj: any): boolean => Object.hasOwnProperty.call(obj, 'constructor');\n\n/** Array-like type definition */\nexport type ArrayLike<T = any> = {\n  [key: number]: T;\n  length: number;\n};\n/** Checks that passed object is array-like */\nexport const isArrayLike = (value: any): value is ArrayLike => {\n  if (!value || typeof value !== 'object') return false;\n  if (Array.isArray(value)) return true;\n  if (typeof value.length !== 'number' || value.length < 0) return false;\n  return !value.length || Object.hasOwnProperty.call(value, value.length - 1);\n};\n","export function defined(): undefined;\nexport function defined<T>(a: T): T;\nexport function defined(a: undefined, b: undefined): undefined;\nexport function defined<T>(a: T | undefined, b: T): T;\nexport function defined(a: undefined, b: undefined, c: undefined): undefined;\nexport function defined<T>(a: T | undefined, b: T | undefined, c: T): T;\nexport function defined<T>(...params: T[]): T | undefined;\n/** @returns first defined param */\nexport function defined<T>(...params: T[]): T | undefined {\n  for (const param of params) {\n    if (param !== undefined) return param;\n  }\n}\n\n/** Finds the closest property descriptor */\nexport function getPropertyDescriptor(o: any, prop: PropertyKey): PropertyDescriptor | undefined {\n  let proto = o;\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc) return desc;\n    proto = Object.getPrototypeOf(proto);\n  }\n}\n\n\nexport function extractValues(obj: any, filter: (value: any, key: string | symbol) => boolean): any[];\nexport function extractValues<T>(obj: any, filter: (value: any, key: string | symbol) => value is T): T[];\nexport function extractValues(obj: any, filter: (value: any, key: string | symbol) => boolean): any[] {\n  if (!obj) return [];\n  const desc: any[] = [];\n  for (const key in obj) {\n    if (filter(obj[key], key)) desc.push(obj[key]);\n  }\n  return desc;\n}\n","const ns = window || global;\nconst sequences = ns.__esl_sequences__ || new Map<string, number>();\nns.__esl_sequences__ = sequences;\n\ndeclare global {\n  interface Window {\n    __esl_sequences__: Map<string, number>;\n  }\n}\n\n/** Create and return sequential id */\nexport const sequentialUID = (name: string, prefix: string = name): string => {\n  const uid = (sequences.get(name) || 0) + 1;\n  sequences.set(name, uid);\n  return prefix + uid;\n};\n\n/** Return random unique identifier */\nexport const randUID = (prefix: string = ''): string => {\n  const time = Date.now().toString(32);\n  const rand = Math.round(Math.random() * 1024 * 1024).toString(32);\n  return prefix + time + '-' + rand;\n};\n\n/**\n * Generate unique id\n * @deprecated Alias for {@link randUID}\n */\nexport const generateUId = randUID;\n","import {ExportNs} from './esl-utils/environment/export-ns';\n\ndeclare global {\n  interface ESLLibrary {}\n  const ESL: ESLLibrary;\n  export interface Window {\n    ESl: ESLLibrary;\n  }\n}\n\nExportNs.declare();\n","/** Shim for ES5 style inheritance support of classes in modern browsers */\nexport function shimES5Constructor(Class: new (...args: any[]) => any): void {\n  if (window.Reflect === undefined || typeof Class !== 'function') return;\n  if (String(Class).indexOf('[native code]') === -1) return;\n  const constructor = function (...args: any[]): any {\n    return Reflect.construct(Class, args, this.constructor);\n  };\n  Object.defineProperty(constructor, 'name', {value: Class.name});\n  Object.defineProperty(window, Class.name, {value: constructor});\n  const Element = (window as any)[Class.name];\n  Element.prototype = Class.prototype;\n  Element.prototype.constructor = Element;\n  Object.setPrototypeOf(Element, Class);\n}\n\nshimES5Constructor(Event);\nshimES5Constructor(HTMLElement);\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`, `Safari < 13`\n * Element.toggleAttribute polyfill\n */\nif (!Element.prototype.toggleAttribute) {\n  Element.prototype.toggleAttribute = function (name: string, force: boolean | undefined): boolean {\n    const has = this.hasAttribute(name);\n    const state = force === void 0 ? !has : !!force;\n\n    if (has !== state) {\n      (state) ? this.setAttribute(name, '') : this.removeAttribute(name);\n    }\n    return state;\n  };\n}\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`\n * KeyboardEvent.prototype.key shim to normalize key values to W3C spec\n * Based on published shim https://www.npmjs.com/package/shim-keyboard-event-key\n */\n(function (KeyboardEventProto): void {\n  const desc = Object.getOwnPropertyDescriptor(KeyboardEventProto, 'key');\n  if (!desc) return;\n\n  const keyMap: Record<string, string> = {\n    Win: 'Meta',\n    Scroll: 'ScrollLock',\n    Spacebar: ' ',\n\n    Down: 'ArrowDown',\n    Left: 'ArrowLeft',\n    Right: 'ArrowRight',\n    Up: 'ArrowUp',\n\n    Del: 'Delete',\n    Apps: 'ContextMenu',\n    Esc: 'Escape',\n\n    Multiply: '*',\n    Add: '+',\n    Subtract: '-',\n    Decimal: '.',\n    Divide: '/',\n  };\n\n  Object.defineProperty(KeyboardEventProto, 'key', {\n    get() {\n      const key = desc.get!.call(this);\n      return Object.prototype.hasOwnProperty.call(keyMap, key) ? keyMap[key] : key;\n    },\n  });\n})(KeyboardEvent.prototype);\n","/**\n * Group: DOM polyfills\n * Target browsers: `IE11`, `Edge <= 18`\n * Node.isConnected polyfill\n */\nif (!('isConnected' in Node.prototype)) {\n  Object.defineProperty(Node.prototype, 'isConnected', {\n    get() {\n      return !this.ownerDocument ||\n        // eslint-disable-next-line no-bitwise\n        !(this.ownerDocument.compareDocumentPosition(this) & this.DOCUMENT_POSITION_DISCONNECTED);\n    }\n  });\n}\n","if (!('customElements' in window)) {\n  throw new Error('Browser is not support customElements, load polyfills before');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// Support for ES5 bundle target\nimport '../../src/polyfills/es5-target-shim';\n// Builtin polyfills\nimport '../../src/polyfills/polyfills.es6';\n// Validate environment\nimport '../../src/polyfills/polyfills.validate';\n\n// With Namespace\nimport '../../src/modules/lib';\n// Config\nimport './common/breakpoints';\n\nimport {\n  ESLVSizeCSSProxy,\n  ESLImage,\n  ESLMedia,\n  ESLToggleable,\n  ESLPopup,\n  ESLPopupPlaceholder,\n  ESLPanel,\n  ESLPanelGroup,\n  ESLTrigger,\n  ESLA11yGroup,\n  ESLTabs,\n  ESLTab,\n  ESLScrollbar,\n  ESLAlert,\n  ESLToggleableDispatcher,\n  ESLSelect,\n  ESLSelectList,\n  ESLNote,\n  ESLFootnotes,\n  ESLTooltip,\n  ESLAnimate,\n  ESLRelatedTarget\n} from '../../src/modules/all';\n\nimport '../../src/modules/esl-media/providers/iframe-provider';\nimport '../../src/modules/esl-media/providers/html5/audio-provider';\nimport '../../src/modules/esl-media/providers/html5/video-provider';\nimport '../../src/modules/esl-media/providers/youtube-provider';\nimport '../../src/modules/esl-media/providers/brightcove-provider';\n\nimport {\n  ESLCarousel,\n  ESLCarouselPlugins\n} from '../../src/modules/draft/all';\n\nimport './esl-media-demo/test-media';\nimport './esl-media-demo/test-media-source';\n\nimport {ESLDemoBackLink} from './back-link/back-link';\nimport {ESLDemoMarquee} from './landing/landing';\nimport {ESLDemoSearchBox} from './navigation/header/header-search';\nimport {ESLDemoSearchPageWrapper} from './search/search';\nimport {ESLDemoSidebar} from './navigation/navigation';\nimport {ESLDemoAnchorLink} from './anchor/anchor-link';\n\nESLVSizeCSSProxy.observe();\n\n// Register Demo components\nESLDemoSidebar.register();\nESLDemoMarquee.register();\nESLDemoSearchBox.register();\nESLDemoSearchPageWrapper.register();\nESLDemoAnchorLink.register();\nESLDemoBackLink.register();\n\n// Register ESL Components\nESLImage.register();\nESLMedia.register();\n\nESLToggleableDispatcher.init();\nESLToggleable.register();\nESLPopup.register();\nESLPopupPlaceholder.register();\n\nESLPanelGroup.register();\nESLPanel.register();\n\nESLTrigger.register();\nESLTab.register();\n\nESLA11yGroup.register();\nESLTabs.register();\n\nESLScrollbar.register();\n\nESLAlert.register();\nESLAlert.init({\n  closeOnOutsideAction: true\n});\n\nESLSelectList.register();\nESLSelect.register();\n\nESLFootnotes.register();\nESLNote.register();\nESLTooltip.register();\n\nESLAnimate.register();\n\nESLCarousel.register();\nESLCarouselPlugins.Dots.register();\nESLCarouselPlugins.Link.register();\nESLCarouselPlugins.Touch.register();\nESLCarouselPlugins.Autoplay.register();\n\n// Register ESL Mixins\nESLRelatedTarget.register();\n"],"names":["ESLDemoAnchorLink","anchorHref","this","$host","HTMLAnchorElement","url","URL","href","hash","substring","anchorTarget","document","getElementById","moveToTarget","$target","console","warn","scrollIntoView","behavior","onClick","e","preventDefault","history","pushState","is","ESLDemoBackLink","connectedCallback","super","referrer","host","window","location","$$attr","ESLDemoMediaSource","$targets","target","render","onChange","form","createElement","innerHTML","action","appendChild","inputs","querySelectorAll","Array","from","forEach","input","HTMLInputElement","type","toggleAttribute","name","checked","setAttribute","value","register","ESLDemoMediaControls","actionList","actions","split","actionName","ACTIONS","dataset","actionDesc","actionFn","$el","call","renderButton","btn","className","textContent","title","play","pause","stop","ACTIONS_ALL","Object","keys","join","defaultValue","ESLDemoMarquee","_$active","_animateTimer","startAnimation","disconnectedCallback","stopAnimation","$stars","constructor","STARS_SEL","$randomStar","index","Math","floor","random","length","setTimeout","_onIteration","iterationTime","clearTimeout","$candidates","targetsNumber","star","classList","remove","add","ESLDemoSearchBox","closeOnOutsideAction","onShow","params","postCls","then","showSearchElements","autofocus","$focusEl","firstFocusable","focus","postClsDelay","loadingAnimationEL","querySelector","onHide","activator","preventScroll","ESLDemoSidebar","closeOnEsc","submenus","activeMenuAttr","$submenus","storeState","open","localStorage","removeItem","setItem","setInitialState","isDesktop","matches","isStoredOpen","getItem","toggle","force","initiator","immediate","collapseAll","menu","hide","expandActive","noAnimate","filter","hasAttribute","show","updateA11y","targetEl","$a11yTarget","String","_animation","onBreakpointChange","_onOutsideAction","event","inherit","onGSSReady","Promise","resolve","__gcse","parsetags","initializationCallback","requestGss","ESLDemoSearchPageWrapper","afterSearchScriptLoad","ESLCarouselPlugins","Dots","Link","Touch","Autoplay","ESLCarouselSlide","parentNode","prototype","indexOf","children","active","_setActive","first","_setFirst","ESLCarousel","observedAttributes","_currentConfig","_plugins","Map","_onMatchChange","update","bind","_onRegistryChange","$slidesArea","$slides","els","count","activeIndexes","reduce","el","push","activeCount","activeConfig","firstIndex","findIndex","slide","max","config","assign","goTo","nextIndex","direction","isAnimated","eventDetails","bubbles","detail","approved","$$fire","_view","i","computedIndex","view","prev","next","_bindEvents","_unbindEvents","attributeChangedCallback","attrName","oldVal","newVal","configRules","addEventListener","_onClick","removeEventListener","_configRules","rules","removeListener","addListener","activeValue","viewType","draw","getNextGroup","shiftGroupsCount","lastIndex","currentGroup","countGroups","ceil","markedTarget","closest","slideTarget","group","substr","lastGroup","addPlugin","plugin","carousel","removePlugin","get","removeChild","_addPlugin","has","key","set","isConnected","_removePlugin","unbind","delete","static","tagName","customElements","whenDefined","Slide","ESLCarouselView","eslRegistryInstance","ESLCarouselViewRegistry","registry","instance","createViewInstance","View","registerView","Error","fire","ESLMultiCarouselView","slideStyles","getComputedStyle","currentTrans","transform","parseFloat","slidesAreaStyles","slideWidth","width","marginLeft","marginRight","computedLeft","style","minWidth","left","slideIndex","areaWidth","transitionDuration","currentLeft","shiftCount","trans","nextActiveIndexes","intersectionIndexes","includes","animatedCount","minActive","min","orderIndex","time","copyLeft","sIndex","removeAttribute","ESLSingleCarouselView","activeSlide","nextSlide","_cleanAnimation","getAttribute","ESLCarouselAutoplayPlugin","_timeout","_onInterval","_onInteract","_active","start","reset","timeout","ESLCarouselDotsPlugin","_onUpdate","rerender","html","activeDot","buildDot","isActive","freePlacement","ESLCarouselLinkPlugin","_onSlideChange","to","$source","_target","ESLCarouselPlugin","findCarouselOwner","nodeName","toLowerCase","_carousel","ESLCarouselTouchPlugin","isTouchStarted","startPoint","x","y","onTouchStart","TouchEvent","touches","PointerEvent","pointerType","onTouchMove","onTouchEnd","point","offset","abs","stopPropagation","events","START","MOVE","END","ESLA11yGroup","$root","parentElement","targets","_onKeydown","groupTarget","KEY_MAP","current","activateSelected","click","trigger","triggers","$active","activeElement","ESLAlert","options","alert","body","mergeDefaultParams","defaultConfig","defaultParams","connected","$content","_$target","$$on","_onShowRequest","_onHideRequest","_clearTimeout","text","clear","hideTime","cls","activeCls","buildRequestParams","match","SHOW_REQUEST_EVENT","HIDE_REQUEST_EVENT","hideDelay","ESLAnimateService","_io","IntersectionObserver","onIntersect","OPTIONS_OBSERVER","_entries","Set","_configMap","WeakMap","deferredOnAnimate","onAnimate","item","observe","unobserve","getConfigFor","cfg","setConfigFor","entries","intersectionRatio","isIntersecting","ratio","repeat","groupDelay","onAnimateItem","_unsubscribe","DEFAULT_CONFIG","threshold","ESLAnimate","reanimate","ESLBaseElement","HTMLElement","_connected","desc","handler","$$off","condition","$$cls","undefined","prevValue","eventName","eventInit","define","registered","ESLEventUtils","obj","hasOwnProperty","auto","isEventDescriptor","criteria","eventDesc","subscribed","listener","subscribe","listeners","unsubscribe","STORE","ESLEventListener","defaults","capture","passive","delegate","selector","handleEvent","handlerBound","handlerFull","once","isDelegatedTarget","currentTarget","contains","every","defineProperty","configurable","eventString","terms","map","term","trim","deduplicate","splitEvents","convertNotesToFootnotesList","notes","renderedIndex","compileFootnotesNongroupedList","note","allowFootnotes","compileFootnotesGroupedList","groupedList","sortFootnotes","sort","note1","note2","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","ESLFootnotes","_notes","deferredOnUpdate","scopeEl","scopeTarget","footnotesList","reindex","grouping","_notifyNotes","unlink","linkNote","link","_sortNotes","unlinkNote","buildItems","footnote","buildItem","buildItemIndex","buildItemText","buildItemBack","backToNoteLabel","_onNoteSubscribe","stopImmediatePropagation","_onItemClick","orderAttr","order","_onBackToNote","highlight","activate","turnOffHighlight","FOOTNOTE_REQUEST_EVENT","FOOTNOTE_RESPONSE_EVENT","ESLNote","allowHover","trackHover","allowClick","trackClick","queryToIgnore","_index","standaloneLabel","ignore","getClosestRelatedAttr","init","_sendResponseToFootnote","_$footnotes","restore","updateIgnoredQuery","_onBPChange","relatedAttrName","$closest","hideTooltip","activateTimeout","block","showTooltip","enable","footnotes","linked","tabIndex","standalone","mergeToggleableParams","container","containerEl","intersectionMargin","actionParams","toggleTooltip","state","tooltipShown","_onMouseEnter","_onMouseLeave","_onFootnotesReady","ESLSelectItem","selected","disabled","option","original","ESLSelectList","$list","$scroll","$selectAll","_updateDisabled","bindSelect","HTMLSelectElement","$select","_renderItems","$items","pinSelected","_renderGroup","multiple","items","last","slice","_updateSelectAll","isAllSelected","selectAllLabel","_onTargetChange","newTarget","oldTarget","_onChange","_onListChange","setAllSelected","setSelected","increment","ESLSelectWrapper","_mutationObserver","MutationObserver","_onTargetMutation","_$select","select","disconnect","observationConfig","changes","some","change","addedNodes","removedNodes","_onReset","selectedOptions","getOption","find","isSelected","opt","hasSelected","values","required","validity","validationMessage","willValidate","checkValidity","reportValidity","setCustomValidity","error","subtree","attributes","attributeFilter","childList","characterData","ownerDocument","ESLSelectDropdown","_deferredUpdatePosition","updatePosition","_disposeTimeout","$owner","dropdownClass","focusable","_onKeyboardEvent","_onTabKey","shiftKey","_onResize","windowY","scrollY","pageYOffset","rect","getBoundingClientRect","top","height","ESLSelectRenderer","$remove","$container","$text","$rest","owner","hasValue","applyItems","apply","limit","rest","moreLabelFormat","size","scrollWidth","clientWidth","_onClear","ESLSelect","$renderer","$dropdown","_prepare","_updateMarkers","_dispose","valueChanged","emptyText","placeholder","hasValueClass","focusEl","hasFocus","hasFocusClass","_onFocusOut","_onPopupStateChange","iObserver","getIObserver","handleViewport","rootMargin","entry","image","triggerLoad","EMPTY_IMAGE","isEmptyImage","src","STRATEGIES","img","shadowImg","isEmpty","backgroundImage","paddingTop","innerImg","attachInnerImage","removeInnerImage","devicePixelRatio","request","XMLHttpRequest","onreadystatechange","readyState","status","responseText","send","ESLImage","alt","srcRules","_onMediaMatchChange","lazyObservable","_detachLazyTrigger","refresh","_srcRules","changeMode","lazyTriggered","currentSrc","_currentSrc","empty","canUpdate","lazy","originalWidth","_shadowImageElement","originalHeight","mode","clearImage","loaded","syncImage","getPath","ready","_shadowImg","refreshOnUpdate","complete","_shadowImgError","_onError","_onLoad","role","innerImage","srcBase","updateContainerClasses","strategy","_strategy","_innerImg","innerImageClass","cloneNode","Image","onload","onerror","naturalHeight","_onReadyState","successful","LOAD_EVENT","ERROR_EVENT","READY_EVENT","containerClass","DEFAULT_CONTAINER_CLS","isLoadState","containerClassState","containerClassTarget","dataAttr","readonly","shortcuts","ESLEnvShortcuts","shortcut","_shortcuts","ESLScreenBreakpoints","maxWidth","BP_NAME_REGEXP","test","ESLScreenBreakpoint","names","sign","bp","BP_REGEXP","mediaQueryGE","mediaQueryLE","mediaQuery","toString","ESLScreenDPR","dpr","toFixed","VALUE_REGEXP","isNaN","ignoreBotsDpr","toDPI","ESLMediaChangeEvent","Event","media","MediaQueryCondition","query","inverted","_inverted","_mq","matchMedia","callback","hasEventListener","optimize","dispatchEvent","MediaQueryConstCondition","_matches","eq","val","ALL","NOT_ALL","MediaQueryContainer","MediaQueryConjunction","optimizedItems","MediaQueryDisjunction","pretty","ESLMediaQuery","preprocessor","_preprocessors","unshift","conjunctions","conditions","parseSimpleQuery","SHORTCUT_PATTERN","replacer","result","process","replace","queryInverted","processedQuery","preprocess","sanitizedQuery","invert","use","ESLMediaRuleListEvent","previous","ESLMediaRuleList","common","parser","pop","parseTuple","parseQuery","lex","rule","mask","queries","valueList","validRules","_rules","_onMatchChanged","_value","computedValue","payload","activeValues","curValue","newValue","STRING_PARSER","OBJECT_PARSER","ESLMediaRule","JSON","stringify","payloadValue","parts","create","video","autoplay","managerMap","MediaGroupRestrictionManager","MANAGED_PAUSE_EVENT","PlayerStates","BaseProvider","component","loop","muted","controls","preload","playsinline","mediaId","mediaSrc","_ready","res","reject","catch","log","providerName","_el","onConfigChange","param","setSize","setProperty","PAUSED","UNSTARTED","VIDEO_CUED","onSafeConfigChange","safeSeekTo","pos","seekTo","safePlay","safePause","safeStop","safeToggle","provider","evRegistryInstance","ESLMediaProviderRegistry","providersMap","providers","list","findByName","createFor","createByType","createBySrc","mediaType","_create","reverse","parseUrl","parseConfig","ESLMedia","deferredResize","deferredReinitialize","reinitInstance","PLAYER_STATES","bindEvents","attachViewportConstraint","unbindEvents","detachViewportConstraint","_provider","playInViewport","_onRegistryStateChange","conditionQuery","fillModeEnabled","REFRESH_EVENT","_onRefresh","canActivate","debug","updateContainerMarkers","loadClsTarget","loadClsAccepted","loadClsDeclined","allowActivate","cancel","focusPlayer","_onReady","updateReadyClass","setReadyState","_onDetach","DETACHED_EVENT","_onPlay","PLAY_EVENT","_onPaused","PAUSED_EVENT","_onEnded","ENDED_EVENT","actualAspectRatio","stretchVertically","offsetWidth","offsetHeight","fillMode","providerType","readyClassTarget","readyClass","duration","currentTime","loadCondition","aspectRatio","defaultAspectRatio","observer","API_SCRIPT_ID","BrightcoveProvider","videojsClasses","playerId","accountId","account","apiSrc","apiScript","buildVideo","id","_account","$$fromEvent","_api","one","onAPILoaded","bc","videojs","onAPIReady","_autoplay","on","Provider","getAccount","loadAPI","dispose","ended","paused","played","videoWidth","videoHeight","AudioProvider","urlPattern","HTMLMediaProvider","applyElementSettings","bindListeners","VideoProvider","IframeBasicProvider","_state","protocol","buildIframe","contentWindow","YouTubeProvider","providerRegexp","idRegexp","_coreApiPromise","YT","Player","cbOrigin","onYouTubeIframeAPIReady","err","enablejsapi","origin","rel","showinfo","iv_load_policy","Number","disablekb","autohide","sm","getCoreApi","onCoreApiReady","onPlayerReady","videoId","onError","onReady","onStateChange","_onStateChange","playerVars","mapOptions","getIframe","mute","destroy","data","playVideo","unMute","HTMLIFrameElement","getPlayerState","getDuration","getCurrentTime","pauseVideo","stopVideo","ESLMixinElement","_attr$$","_onAttrMutation","attributeOldValue","oldValue","records","attributeName","global","ESLMixinRegistry","store","mutation$$","_onMutation","attrs","mixin","invalidateRecursive","resubscribe","root","invalidateAll","child","hasStore","invalidate","mixinType","destroyAll","mutations","record","node","nodeType","ELEMENT_NODE","Mixin","parseCount","POSITIVE_INFINITY","parseInt","ESLPanelGroup","_previousHeight","_onConfigChange","prevMode","currentMode","updateModeCls","MODE_CHANGE_EVENT","modeCls","modeClsTarget","supportedModes","modeRules","minValueRules","minOpenItems","maxValueRules","maxOpenItems","refreshRules","refreshStrategy","currentMinItems","$panels","currentMaxItems","panelSel","includesPanel","$activePanels","$initialPanels","initiallyOpened","$resetStatePanels","shouldAnimate","panelConfig","capturedBy","mergeActionParams","$group","showAll","excluded","hideAll","$orderedPanels","concat","transformParams","panel","fallbackAnimate","distance","clientHeight","afterAnimate","beforeAnimate","animationClass","silent","removeProperty","AFTER_ANIMATE_EVENT","_onBeforeShow","balanceMarker","overflow","_onShow","initialHeight","_onBeforeHide","$firstInactive","$panel","_onTransitionEnd","propertyName","ESLPanel","_initialHeight","groupName","panelGroupSel","scrollHeight","postAnimate","animateClass","postAnimateClass","maxHeight","animating","clearAnimation","AFTER_SHOW_EVENT","AFTER_HIDE_EVENT","stackConfig","ESLPopupPlaceholder","isMajorAxisHorizontal","position","calcPopupPositionByMinorAxis","centerPosition","dimensionName","arrow","marginArrow","calcUsableSizeForArrow","offsetArrowRatio","adjustAlignmentBySide","elCoord","outerCoord","arrowCoord","arrowLimit","isStartingSide","arrowAdjust","newCoord","element","calcArrowPosition","calcPopupPosition","popup","inner","cx","cy","right","bottom","calcPopupBasicRect","placedAt","isMirrored","outer","fitOnMajorAxis","isHorizontal","end","dimension","coordAdjust","fitOnMinorAxis","scrollOptions","ESLPopup","_updatePosition","_intersectionRatio","_containerEl","containerRect","$arrow","moveToBody","_isMajorAxisHorizontal","_isMajorAxisVertical","_offsetArrowRatio","nanValue","rawValue","parsePercent","offsetArrow","$placeholder","replaceChild","disableActivatorObservation","_offsetTrigger","offsetTrigger","_offsetContainer","offsetContainer","_intersectionMargin","visibility","afterOnShow","beforeOnHide","_stopUpdateLoop","_removeActivatorObserver","_addActivatorObserver","_startUpdateLoop","_checkIntersectionForAdjacentAxis","isAdjacentAxis","onActivatorIntersection","intersectionRect","boundingClientRect","onActivatorScroll","_updateLoopID","scrollParents","_activatorObserver","unsubscribers","cb","same","lastRect","updateLoop","newRect","requestAnimationFrame","cancelAnimationFrame","triggerRect","popupRect","arrowRect","innerMargin","grow","shrink","ESLRelatedTarget","mergeParams","ESLScrollbar","_deferredDrag","_onPointerDrag","_deferredRefresh","_scrollTimer","_resizeObserver","ResizeObserver","rec","updateContentObserve","findTarget","unbindTargetEvents","content","bindTargetEvents","$scrollbarTrack","trackClass","$scrollbarThumb","thumbClass","documentElement","_onScrollOrResize","recs","contentChanges","Element","scrollableSize","horizontal","trackOffset","thumbOffset","thumbSize","areaSize","scrollSize","scrollOffset","scrollTop","scrollTargetTo","normalizePosition","relativePosition","scrollTo","dragging","thumbPosition","updateMarkers","toPosition","_onPointerDown","_initialPosition","_pointerPosition","_initialMousePosition","_onThumbPointerDown","_onPointerDownTick","_onPointerUp","allowedOffset","noContinuousScroll","_onBodyClick","_onPointerMove","positionChange","scrollableAreaHeight","absChange","ESLTab","initA11y","a11yLabelActive","a11yLabelInactive","a11yLabel","ESLTabs","_deferredUpdateArrows","updateArrows","_deferredFitToViewport","fitToViewport","scrollableTypeRules","scrollable","currentScrollableType","updateScrollableType","_onScrollableTypeChange","bindScrollableEvents","_onScroll","unbindScrollableEvents","$tabs","$current","$scrollableTarget","scrollableTarget","isScrollable","moveTo","scrollBy","$trigger","areaRect","itemRect","calcScrollOffset","isReversedRTL","shift","swapSides","scrollStart","scrollLeft","scrollEnd","$rightArrow","$leftArrow","hasScroll","supportedScrollableTypes","_onTriggerStateChange","tabDirection","_onFocus","ESLToggleableDispatcher","_popups","getElementsByTagName","insertAdjacentElement","isAcceptable","hideActive","getActive","dispatcher","setActive","deleteActive","_onHide","_onChangeGroup","oldGroupName","newGroupName","ESLToggleablePlaceholder","$origin","copyAttributesFromOrigin","buildAttrName","allowedAttrs","activators","ESLToggleable","_open","_task","_trackHover","noAutoId","tag","showDelay","GROUP_CHANGED_EVENT","initialParams","bindOutsideEventTracking","track","bindHoverStateTracking","_trackHoverDelay","put","showTask","delay","hideTask","BEFORE_SHOW_EVENT","SHOW_EVENT","cancelable","BEFORE_HIDE_EVENT","HIDE_EVENT","activeClass","bodyClass","isOutsideAction","KeyboardEvent","_onCloseClick","baseParams","trackHoverParams","closeTrigger","ESLTooltip","sharedInstance","focusableElements","firstFocusableElement","lastFocusableElement","disableArrow","_appendArrow","_createArrow","innerText","extraClass","_updateActivatorState","newState","ESLTraversingQuery","PROCESSORS_REGEX","ELEMENT_PROCESSORS","COLLECTION_PROCESSORS","RegExp","selString","sel","collection","processors","findFirst","processor","isCollectionProcessor","processedItem","processCollection","traverseChain","processElement","resultCollection","str","stack","base","scope","found","part","splitQueries","traverseQuery","rootSel","baseCollection","initial","traverse","NaN","ESLTrigger","updateTargetFromSelector","newPopupInstance","_onTargetStateChange","a11yTarget","isTargetIgnored","$ignore","showTarget","hideTarget","toggleTarget","updateState","wasActive","clsTarget","activeClassTarget","originalEvent","CHANGE_EVENT","_onPrimaryEvent","ignoreEsc","hoverShowDelay","hoverHideDelay","that","OBSERVED_EVENTS","Observable","_listeners","args","debounce","fn","wait","thisArg","deferred","debouncedSubject","promise","writable","enumerable","DelayedTask","_fn","run","task","promisifyTimeout","isReject","promisifyEvent","eventCallback","tryUntil","tryCount","check","repeatSequence","createDeferred","rej","PromiseUtils","fromTimeout","fromEvent","fromMarker","marker","arg","afterNextRender","skipOneRender","rafDecorator","lastArgs","attr","propName","serializer","propertyKey","descriptor","TypeError","originalFn","getBound","proto","getPrototypeOf","boolAttr","readOnly","buildConditionalDescriptor","decorate","decorator","decoratedFn","jsonAttr","attrContent","buildJsonAttrDescriptor","listen","superDesc","memoize","hashFn","prop","originalMethod","locks","defineOwnKeySafe","memoizeGetter","memo","memoizeMethod","property","isArray","prototypeConfig","getNodeName","Window","getParentNode","ShadowRoot","assignedSlot","getDocument","hasAttr","getAttr","fallback","setAttr","lockStore","locker","elLocks","classLocks","lock","unlock","CSSClassUtils","tokenString","tokens","splitTokens","isMouseEvent","MouseEvent","isTouchEvent","PASSIVE_EVENTS","isPassiveByDefault","getCompositeTarget","composedPath","getTouchPoint","source","changedTouches","pageX","pageY","getOffsetPoint","props","scrollX","dispatchCustomEvent","composed","CustomEvent","SyntheticEventTarget","minCount","validateEventListenerType","defaultPrevented","getKeyboardFocusableElements","TAB","ENTER","ESC","SPACE","PAUSE","ARROW_LEFT","ARROW_UP","ARROW_RIGHT","ARROW_DOWN","SYSTEM_KEYS","onDocumentReady","Rect","rect1","rect2","incrementX","incrementY","decrementX","decrementY","area","RTLUtils","scrollType","createTextNode","dir","fontSize","createDummyEl","isRtl","sanitizeElAttributes","isDangerousAttribute","removeDangerousAttributes","sanitize","allowedTopLevelTags","DOMParser","parseFromString","scripts","script","removeScripts","childNodes","filterElements","loadScript","async","createAsyncScript","firstScriptTag","insertBefore","getListScrollParents","scrollParent","getScrollParent","isBody","updatedList","overflowX","overflowY","lastLeft","lastTop","isRelativeNode","nodeA","nodeB","createSequenceFinder","includeSelf","predicate","isMatches","matcher","findNext","nextElementSibling","findPrev","previousElementSibling","findParent","findClosest","findHost","getRootNode","findAll","findChildren","findClosestBy","skipSelf","TraversingUtils","isRelative","closestBy","isVisible","getClientRects","opacity","parent","viewport","wndIntersection","isInViewport","getWindowRect","wnd","pageXOffset","innerWidth","innerHeight","userAgent","vendor","platform","navigator","isTrident","isIE","isEdgeHTML","isBlinkEdge","isEdge","isGecko","isFirefox","isOpera","isChrome","isWebkit","isSafari","isBlink","isBot","isAndroid","isMobileIOS13","maxTouchPoints","isMobileIOS","isLegacyMobile","isMobile","isMobileSafari","isTouchDevice","navApi","msMaxTouchPoints","hasHover","TOUCH_EVENTS","DeviceDetector","ExportNs","module","exportNs","declare","createZIndexIframe","iframe","ESLVSizeCSSProxy","updateDebounced","$html","vwProp","viewportWidth","vhProp","viewportHeight","tuple","arr","acc","wrap","uniq","range","n","filler","toKebabCase","unwrapParenthesis","parseString","parseNumber","parseAspectRatio","w","h","evaluate","Function","DEF_FORMAT_MATCHER","format","identity","resolveProperty","memoizeFn","defaultArgsHashFn","cache","isEqual","obj1","obj2","keys1","keys2","isSimilar","deep","arrObj","arrMask","comparer","itm","copyDefinedKeys","copy","deepMerge","objects","toKeyDef","parseKeysPath","path","isIndex","parseKeys","curr","getByPath","isObject","isObjectLike","isPrototype","defined","getPropertyDescriptor","o","getOwnPropertyDescriptor","extractValues","ns","g","sequences","__esl_sequences__","sequentialUID","prefix","uid","randUID","Date","now","round","shimES5Constructor","Class","Reflect","construct","setPrototypeOf","KeyboardEventProto","keyMap","Win","Scroll","Spacebar","Down","Left","Right","Up","Del","Apps","Esc","Multiply","Add","Subtract","Decimal","Divide","DOCUMENT_POSITION_DISCONNECTED","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","getter","__esModule","d","a","definition","globalThis","E"],"sourceRoot":""}