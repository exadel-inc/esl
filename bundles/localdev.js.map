{"version":3,"file":"localdev.js","mappings":"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","sources":["webpack:///./src/esl-media-demo/test-media.ts","webpack:///../src/polyfills/list/dom.element.toggleAttribute.ts","webpack:///../src/polyfills/list/dom.keyboard.key.ts","webpack:///../src/polyfills/list/dom.node.isConnected.ts","webpack:///../src/polyfills/polyfills.validate.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/global","webpack:///../src/polyfills/es5-target-shim.ts","webpack:///../src/modules/esl-utils/environment/export-ns.ts","webpack:///../src/modules/lib.ts","webpack:///../src/modules/esl-media-query/core/common/screen-breakpoint.ts","webpack:///./src/common/breakpoints.ts","webpack:///../src/modules/esl-utils/environment/device-detector.ts","webpack:///../src/modules/esl-utils/async/raf.ts","webpack:///../src/modules/esl-utils/fixes/viewport.ts","webpack:///../src/modules/esl-utils/decorators/bind.ts","webpack:///../src/modules/esl-utils/misc/functions.ts","webpack:///../src/modules/esl-utils/misc/array.ts","webpack:///../src/modules/esl-utils/dom/class.ts","webpack:///../src/modules/esl-utils/misc/object/types.ts","webpack:///../src/modules/esl-utils/misc/object/path.ts","webpack:///../src/modules/esl-utils/misc/format.ts","webpack:///../src/modules/esl-utils/dom/attr.ts","webpack:///../src/modules/esl-base-element/decorators/attr.ts","webpack:///../src/modules/esl-base-element/decorators/bool-attr.ts","webpack:///../src/modules/esl-utils/dom/events.ts","webpack:///../src/modules/esl-base-element/core/esl-base-element.ts","webpack:///../src/modules/esl-utils/abstract/observable.ts","webpack:///../src/modules/esl-utils/misc/memoize.ts","webpack:///../src/modules/esl-utils/misc/object/utils.ts","webpack:///../src/modules/esl-utils/decorators/memoize.ts","webpack:///../src/modules/esl-media-query/core/common/screen-dpr.ts","webpack:///../src/modules/esl-media-query/core/common/env-shortcuts.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-base.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-condition.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-containers.ts","webpack:///../src/modules/esl-media-query/core/esl-media-query.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule.ts","webpack:///../src/modules/esl-image/core/esl-image-iobserver.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule-list.ts","webpack:///../src/modules/esl-utils/dom/traversing.ts","webpack:///../src/modules/esl-traversing-query/core/esl-traversing-query.ts","webpack:///../src/modules/esl-image/core/esl-image-strategies.ts","webpack:///../src/modules/esl-image/core/esl-image.ts","webpack:///../src/modules/esl-utils/async/promise.ts","webpack:///../src/modules/esl-utils/async/debounce.ts","webpack:///../src/modules/esl-utils/dom/keys.ts","webpack:///../src/modules/esl-media/core/esl-media-iobserver.ts","webpack:///../src/modules/esl-media/core/esl-media-provider.ts","webpack:///../src/modules/esl-media/core/esl-media-registry.ts","webpack:///../src/modules/esl-media/core/esl-media-manager.ts","webpack:///../src/modules/esl-media/core/esl-media.ts","webpack:///../src/modules/esl-utils/misc/uid.ts","webpack:///../src/modules/esl-utils/async/delayed-task.ts","webpack:///../src/modules/esl-base-element/decorators/json-attr.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable.ts","webpack:///../src/modules/esl-utils/misc/object/copy.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-dispatcher.ts","webpack:///../src/modules/esl-utils/dom/ready.ts","webpack:///../src/modules/esl-utils/decorators/ready.ts","webpack:///../src/modules/esl-utils/decorators/prop.ts","webpack:///../src/modules/esl-utils/dom/rect.ts","webpack:///../src/modules/esl-utils/dom/rtl.ts","webpack:///../src/modules/esl-utils/dom/api.ts","webpack:///../src/modules/esl-utils/dom/scroll.ts","webpack:///../src/modules/esl-popup/core/esl-popup-position.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-placeholder.ts","webpack:///../src/modules/esl-popup/core/esl-popup-placeholder.ts","webpack:///../src/modules/esl-popup/core/esl-popup.ts","webpack:///../src/modules/esl-utils/dom/window.ts","webpack:///../src/modules/esl-panel/core/esl-panel.ts","webpack:///../src/modules/esl-panel-group/core/esl-panel-group.ts","webpack:///../src/modules/esl-trigger/core/esl-trigger.ts","webpack:///../src/modules/esl-tab/core/esl-tab.ts","webpack:///../src/modules/esl-a11y-group/core/esl-a11y-group.ts","webpack:///../src/modules/esl-tab/core/esl-tabs.ts","webpack:///../src/modules/esl-scrollbar/core/esl-scrollbar.ts","webpack:///../src/modules/esl-alert/core/esl-alert.ts","webpack:///../src/modules/esl-utils/fixes/ie-fixes.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-item.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-wrapper.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-list.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-renderer.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-dropdown.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes-data.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes.ts","webpack:///../src/modules/esl-tooltip/core/esl-tooltip.ts","webpack:///../src/modules/esl-utils/dom/focus.ts","webpack:///../src/modules/esl-footnotes/core/esl-note.ts","webpack:///../src/modules/esl-animate/core/esl-animate-service.ts","webpack:///../src/modules/esl-animate/core/esl-animate.ts","webpack:///../src/modules/esl-media/providers/iframe-provider.ts","webpack:///../src/modules/esl-media/providers/html5/media-provider.ts","webpack:///../src/modules/esl-media/providers/html5/audio-provider.ts","webpack:///../src/modules/esl-utils/dom/script.ts","webpack:///../src/modules/esl-media/providers/html5/video-provider.ts","webpack:///../src/modules/esl-media/providers/youtube-provider.ts","webpack:///../src/modules/esl-media/providers/brightcove-provider.ts","webpack:///../src/modules/esl-utils/misc/object/compare.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel-slide.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/esl-carousel.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-single-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/core/view/esl-multi-carousel-view.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-dots.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-link.plugin.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-touch.plugin.ts","webpack:///../src/modules/draft/esl-carousel/all.ts","webpack:///../src/modules/draft/esl-carousel/plugin/esl-carousel-autoplay.plugin.ts","webpack:///./src/esl-media-demo/test-media-source.ts","webpack:///./src/navigation/sidebar/sidebar.ts","webpack:///./src/search/search-script.ts","webpack:///./src/navigation/header/header-search.ts","webpack:///./src/landing/marquee/marquee.ts","webpack:///./src/search/search.ts","webpack:///./src/localdev.ts"],"sourcesContent":["interface MediaTarget {\n  play(): any;\n  pause(): any;\n  stop(): any;\n}\n\ninterface TestMediaAction {\n  title: string;\n  action: (target: MediaTarget, actionName: string, action: TestMediaAction) => void;\n  render: (actionName: string, action: TestMediaAction) => HTMLElement;\n}\n\nclass TestMediaControls extends HTMLElement {\n\n  public static ACTIONS: Record<string, TestMediaAction> = {\n    play: {\n      title: 'Play',\n      action: (target: any) => target.play(),\n      render: renderButton\n    },\n    pause: {\n      title: 'Pause',\n      action: (target: any) => target.pause(),\n      render: renderButton\n    },\n    stop: {\n      title: 'Stop',\n      action: (target: any) => target.stop(),\n      render: renderButton\n    }\n  };\n  public static ACTIONS_ALL = Object.keys(TestMediaControls.ACTIONS).join(',');\n\n  get target(): HTMLElement[] {\n    const targetSel = this.getAttribute('target');\n    return targetSel ? Array.from(document.querySelectorAll(targetSel)) : [];\n  }\n\n  get actions(): string {\n    return this.getAttribute('actions') || TestMediaControls.ACTIONS_ALL;\n  }\n\n  private render(): void {\n    const actionList = this.actions.split(',');\n\n    this.innerHTML = '';\n    for (const actionName of actionList) {\n      const action: TestMediaAction = TestMediaControls.ACTIONS[actionName];\n      if (!action) return;\n      this.appendChild(action.render(actionName, action));\n    }\n  }\n\n  private onClick(e: Event): void {\n    const target = e.target as HTMLElement;\n    const actionName = target.dataset.action;\n    if (actionName && TestMediaControls.ACTIONS[actionName]) {\n      const actionDesc = TestMediaControls.ACTIONS[actionName];\n      const actionFn = actionDesc.action;\n      this.target.forEach(($el) => actionFn.call($el, $el, actionName, actionDesc));\n    }\n  }\n\n  protected connectedCallback(): void {\n    this.render();\n    this.addEventListener('click', this.onClick.bind(this));\n  }\n}\n\nfunction renderButton(actionName: string, action: TestMediaAction): HTMLButtonElement {\n  const btn = document.createElement('button');\n  btn.className = 'btn btn-sec-blue';\n  btn.dataset.action = actionName;\n  btn.textContent = action.title;\n  return btn;\n}\n\ncustomElements.define('test-media-controls', TestMediaControls);\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`, `Safari < 13`\n * Element.toggleAttribute polyfill\n */\nif (!Element.prototype.toggleAttribute) {\n  Element.prototype.toggleAttribute = function (name: string, force: boolean | undefined): boolean {\n    const has = this.hasAttribute(name);\n    const state = force === void 0 ? !has : !!force;\n\n    if (has !== state) {\n      (state) ? this.setAttribute(name, '') : this.removeAttribute(name);\n    }\n    return state;\n  };\n}\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`\n * KeyboardEvent.prototype.key shim to normalize key values to W3C spec\n * Based on published shim https://www.npmjs.com/package/shim-keyboard-event-key\n */\n(function (KeyboardEventProto): void {\n  const desc = Object.getOwnPropertyDescriptor(KeyboardEventProto, 'key');\n  if (!desc) return;\n\n  const keyMap: Record<string, string> = {\n    Win: 'Meta',\n    Scroll: 'ScrollLock',\n    Spacebar: ' ',\n\n    Down: 'ArrowDown',\n    Left: 'ArrowLeft',\n    Right: 'ArrowRight',\n    Up: 'ArrowUp',\n\n    Del: 'Delete',\n    Apps: 'ContextMenu',\n    Esc: 'Escape',\n\n    Multiply: '*',\n    Add: '+',\n    Subtract: '-',\n    Decimal: '.',\n    Divide: '/',\n  };\n\n  Object.defineProperty(KeyboardEventProto, 'key', {\n    get() {\n      const key = desc.get!.call(this);\n      return Object.prototype.hasOwnProperty.call(keyMap, key) ? keyMap[key] : key;\n    },\n  });\n})(KeyboardEvent.prototype);\n","/**\n * Group: DOM polyfills\n * Target browsers: `IE11`, `Edge <= 18`\n * Node.isConnected polyfill\n */\nif (!('isConnected' in Node.prototype)) {\n  Object.defineProperty(Node.prototype, 'isConnected', {\n    get() {\n      return !this.ownerDocument ||\n        // eslint-disable-next-line no-bitwise\n        !(this.ownerDocument.compareDocumentPosition(this) & this.DOCUMENT_POSITION_DISCONNECTED);\n    }\n  });\n}\n","if (!('customElements' in window)) {\n  throw new Error('Browser is not support customElements, load polyfills before');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","// Shim for modern browsers with ES6 class syntax support\n// Shim based on https://github.com/webcomponents/polyfills/blob/master/packages/custom-elements/ts_src/custom-elements.ts\nexport function shimES5ElementConstructor(BuiltInHTMLElement: typeof HTMLElement): void {\n  if (\n    // No Reflect, no classes, no need for shim because native custom elements require ES2015 classes or Reflect.\n    window.Reflect === undefined || window.customElements === undefined ||\n    // The webcomponentsjs custom elements polyfill doesn't require ES2015-compatible construction (`super()` or `Reflect.construct`).\n    (window.customElements as any).polyfillWrapFlushCallback) {\n    return;\n  }\n\n  Object.defineProperty(window, BuiltInHTMLElement.name, {\n    value: function HTMLElement() {\n      return Reflect.construct(BuiltInHTMLElement, [], this.constructor);\n    }\n  });\n  const Element = (window as any)[BuiltInHTMLElement.name] as typeof HTMLElement;\n  Element.prototype = BuiltInHTMLElement.prototype;\n  Element.prototype.constructor = Element;\n  Object.setPrototypeOf(Element, BuiltInHTMLElement);\n}\n\nshimES5ElementConstructor(HTMLElement);\n","const NS_NAME = 'ESL';\n\n/**\n * Nested declaration helper\n */\nfunction define(root: any, name: string, value: any): void {\n  name.split('.').reduce((obj: any, key, index, parts) => {\n    if (parts.length === index + 1) {\n      return (obj[key] = obj[key] || value);\n    }\n    const type = typeof obj[key];\n    if (type !== 'undefined' && type !== 'object' && type !== 'function') {\n      throw new Error(`Can not define ${value} on ${name}`);\n    }\n    return (obj[key] = obj[key] || {});\n  }, root);\n}\n\n/**\n * Method to manually declare key in library namespace\n * See {@link ExportNs} decorator for details\n */\nexport const exportNs = (name: string, module: any): void => {\n  if (!(NS_NAME in window)) return;\n  define((window as any)[NS_NAME], name, module);\n};\n\n/**\n * Decorator to declare function or class in a global ns\n * @param name - key path to declare in ESL global ns\n * NOTE: path parts should be separated by dots\n * @example\n * ```ts\n * @Export('Package.Component')\n * ```\n * NOTE: in case declaration contains components-packages, their origins will be mixed with declaration in a Runtime\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function ExportNs<T extends Function>(name?: string) {\n  return (module: T): void => exportNs(name || module.name, module);\n}\n\n/** Declare ESL global */\nExportNs.declare = (): void => {\n  if ('ESL' in window) return;\n  Object.defineProperty(window, 'ESL', {value: {}});\n};\n","import {ExportNs} from './esl-utils/environment/export-ns';\n\ndeclare global {\n  interface ESLLibrary {}\n  const ESL: ESLLibrary;\n  export interface Window {\n    ESl: ESLLibrary;\n  }\n}\n\nExportNs.declare();\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst registry = new Map<string, ESLScreenBreakpoint>();\n\n/**\n * ESL Screen Breakpoints registry\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Screen Breakpoint registry is used to provide custom breakpoints for {@link ESLMediaQuery}\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenBreakpoints')\nexport abstract class ESLScreenBreakpoints {\n  protected static readonly BP_REGEXP = /^([+-]?)([a-z]+)/i;\n  protected static readonly BP_NAME_REGEXP = /^[a-z]+/i;\n\n  /**\n   * Add or replace breakpoint shortcut that can be used inside ESLMediaQuery\n   * @param name - name of shortcut\n   * @param minWidth - min width for breakpoint\n   * @param maxWidth - max width for breakpoint\n   */\n  public static add(name: string, minWidth: number, maxWidth: number): ESLScreenBreakpoint | undefined {\n    name = name.toLowerCase();\n    if (ESLScreenBreakpoints.BP_NAME_REGEXP.test(name)) {\n      const current = registry.get(name);\n      registry.set(name, new ESLScreenBreakpoint(name, minWidth, maxWidth));\n      return current;\n    }\n    throw new Error('The shortcut should consist only of Latin characters and be at least one character long.');\n  }\n\n  /** Removes screen breakpoint */\n  public static remove(name: string): boolean {\n    return registry.delete(name.toLowerCase());\n  }\n\n  /** @returns known breakpoint shortcut instance */\n  public static get(name: string): ESLScreenBreakpoint | undefined {\n    return registry.get((name || '').toLowerCase());\n  }\n\n  /** All available breakpoints names */\n  public static get names(): string[] {\n    const keys: string[] = [];\n    registry.forEach((value, key) => keys.push(key));\n    return keys;\n  }\n\n  /** @returns breakpoints shortcut replacement */\n  public static process(term: string): string | undefined {\n    const [, sign, bp] = term.match(ESLScreenBreakpoints.BP_REGEXP) || [];\n    const shortcut = ESLScreenBreakpoints.get(bp);\n    if (!shortcut) return;\n    if (sign === '+') return shortcut.mediaQueryGE;\n    if (sign === '-') return shortcut.mediaQueryLE;\n    return shortcut.mediaQuery;\n  }\n}\n\n/** ESL Screen Breakpoint description */\nexport class ESLScreenBreakpoint {\n  constructor(\n    public readonly name: string,\n    public readonly min: number,\n    public readonly max: number\n  ) {}\n\n  public get mediaQuery(): string {\n    return `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\n  }\n\n  public get mediaQueryGE(): string {\n    return `(min-width: ${this.min}px)`;\n  }\n\n  public get mediaQueryLE(): string {\n    return `(max-width: ${this.max}px)`;\n  }\n\n  public toString(): string {\n    return `[${this.name}]: ${this.min} to ${this.max}`;\n  }\n}\n\n// Defaults\nESLScreenBreakpoints.add('xs', 1, 767);\nESLScreenBreakpoints.add('sm', 768, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenBreakpoints: typeof ESLScreenBreakpoints;\n  }\n}\n","// Config\nimport {ESLScreenBreakpoints} from '../../../src/modules/esl-media-query/core/common/screen-breakpoint';\n\nESLScreenBreakpoints.add('xs', 1, 599);\nESLScreenBreakpoints.add('sm', 600, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n","import {ExportNs} from './export-ns';\n\nconst {userAgent, vendor, platform} = window.navigator;\n\n// IE Detection\nexport const isTrident = /trident/i.test(userAgent);\nexport const isIE = isTrident;\n\n// Edge Detection\nexport const isEdgeHTML = /edg([ea]|ios)/i.test(userAgent);\nexport const isBlinkEdge = /\\sedg\\//i.test(userAgent);\nexport const isEdge = isEdgeHTML || isBlinkEdge;\n\n// Gecko\nexport const isGecko = /gecko/i.test(userAgent) && !/like gecko/i.test(userAgent);\nexport const isFirefox = /firefox|iceweasel|fxios/i.test(userAgent);\n\n// Opera / Chrome\nexport const isOpera = /(?:^opera.+?version|opr)/.test(userAgent);\nexport const isChrome = !isOpera && /google inc/.test(vendor);\n\n// Webkit\nexport const isWebkit = /(apple)?webkit/i.test(userAgent);\n\n// Safari\nexport const isSafari = isWebkit && /^((?!chrome|android).)*safari/i.test(userAgent);\n\n// Blink\nexport const isBlink = isWebkit && !isSafari;\n\n// Bot detection\nexport const isBot = /Chrome-Lighthouse|Google Page Speed Insights/i.test(userAgent);\n\n// Mobile\nexport const isAndroid = /Android/i.test(userAgent);\nexport const isMobileIOS13 = /* iOS 13+ detection */ (platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\nexport const isMobileIOS = /iPad|iPhone|iPod/.test(platform) || isMobileIOS13;\nexport const isLegacyMobile = /webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\nexport const isMobile = isMobileIOS || isAndroid || isLegacyMobile;\nexport const isMobileSafari = isMobileIOS && isWebkit && /CriOS/i.test(userAgent);\n\n// Touch Detection\nexport const isTouchDevice = ((): boolean => {\n  const navApi: any = window.navigator;\n  if (navApi.maxTouchPoints || navApi.msMaxTouchPoints) return true;\n  return ('ontouchstart' in window) || ('DocumentTouch' in window && document instanceof Touch);\n})();\n\n// Hover check\n// Note: always true for IE\nexport const hasHover = !matchMedia('(hover: none)').matches;\n\ntype TouchEventsDefinition = {\n  START: string;\n  MOVE: string;\n  END: string;\n};\n/** @deprecated TODO: needs to be reworked or moved away from device detector */\nexport const TOUCH_EVENTS = ((): TouchEventsDefinition => {\n  const isTouch = isTouchDevice;\n  return {\n    START: isTouch ? 'touchstart' : 'pointerdown',\n    MOVE: isTouch ? 'touchmove' : 'pointermove',\n    END: isTouch ? 'touchend' : 'pointerup'\n  };\n})();\n\n/**\n * Device detection utility\n * @readonly\n */\n@ExportNs('DeviceDetector')\nexport abstract class DeviceDetector {\n  // IE Detection\n  public static readonly isTrident = isTrident;\n  public static readonly isIE = isIE;\n\n  // Edge Detection\n  public static readonly isEdgeHTML = isEdgeHTML;\n  public static readonly isBlinkEdge = isBlinkEdge;\n  public static readonly isEdge = isEdge;\n\n  // Gecko\n  public static readonly isGecko = isGecko;\n  public static readonly isFirefox = isFirefox;\n\n  // Opera / Chrome\n  public static readonly isOpera = isOpera;\n  public static readonly isChrome = isChrome;\n\n  // Webkit\n  public static readonly isWebkit = isWebkit;\n\n  // Safari\n  public static readonly isSafari = isSafari;\n\n  // Blink\n  public static readonly isBlink = isBlink;\n\n  // Bot detection\n  public static readonly isBot = isBot;\n\n  // Mobile\n  public static readonly isAndroid = isAndroid;\n  public static readonly isMobileIOS13 = isMobileIOS13;\n  public static readonly isMobileIOS = isMobileIOS;\n  public static readonly isLegacyMobile = isLegacyMobile;\n\n  public static readonly isMobile = isMobile;\n  public static readonly isMobileSafari = isMobileSafari;\n\n  // Touch Detection\n  public static isTouchDevice = isTouchDevice;\n\n  // Hover check\n  // Note: always true for IE\n  public static hasHover = hasHover;\n\n  /** @deprecated TODO: needs to be reworked or moved away from device detector */\n  static TOUCH_EVENTS = TOUCH_EVENTS;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    DeviceDetector: typeof DeviceDetector;\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Postpone action after next render\n */\nexport const afterNextRender = (callback: () => void): number => requestAnimationFrame(() => requestAnimationFrame(callback));\n\n/**\n * Decorate function to schedule execution after next render\n * @returns decorated function\n */\nexport const rafDecorator = <T extends AnyToVoidFnSignature>(fn: T): T => {\n  let lastArgs: any[] | null = null; // null if no calls requested\n  return function (...args: any[]) {\n    if (lastArgs === null) {\n      requestAnimationFrame(() => {\n        lastArgs && fn.call(this, ...lastArgs);\n        lastArgs = null;\n      });\n    }\n    lastArgs = args;\n  } as T;\n};\n","import {rafDecorator} from '../async/raf';\nimport {DeviceDetector} from '../environment/device-detector';\n\n/**\n * Small utility to provide 100vw and 100vh alternative CSS Variables\n * - vwProp (default: `--100vw`) - scroll independent viewport width value\n * - vhProp (default: `--100vh`) - device independent viewport height value (also known as 100vh iOS fix)\n */\nexport class ESLVSizeCSSProxy {\n  public static vwProp = '--100vw';\n  public static vhProp = '--100vh';\n\n  /** Inits custom CSS variables for viewport sizes and it's observation */\n  public static observe(): void {\n    // IE doesn’t support CSS Variables (hopefully same as 100vh issue :D)\n    if (DeviceDetector.isIE) return;\n\n    this.update();\n    window.addEventListener('resize', this.updateDebounced);\n  }\n  /** Destroys observer */\n  public static destroy(): void {\n    window.removeEventListener('resize', this.updateDebounced);\n  }\n\n  /** Update custom CSS variables with actual viewport sizes */\n  protected static update(): void {\n    const $html = document.documentElement;\n    $html.style.setProperty(this.vwProp, `${this.viewportWidth}px`);\n    $html.style.setProperty(this.vhProp, `${this.viewportHeight}px`);\n  }\n  protected static readonly updateDebounced = rafDecorator(this.update.bind(this));\n\n  /** @returns current viewport width */\n  public static get viewportWidth(): number {\n    return document.documentElement.clientWidth;\n  }\n  /** @returns current viewport height */\n  public static get viewportHeight(): number {\n    return window.innerHeight;\n  }\n}\n","const BINDINGS_STORE_KEY = '__fnBindings__';\n/** Decorator \"bind\" allows to bind prototype method context to class instance */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bind<T extends Function>(target: object,\n                                         propertyKey: string,\n                                         descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n  // Validation check\n  if (!descriptor || (typeof descriptor.value !== 'function')) {\n    throw new TypeError('Only class methods can be decorated via @bind');\n  }\n  // Original function\n  const fn = descriptor.value;\n\n  return {\n    enumerable: descriptor.enumerable,\n    configurable: descriptor.configurable,\n\n    get(): T {\n      // Accessing via prototype returns original function\n      // If the constructor property is in the context then it's not an instance\n      if (!this || this === target || Object.hasOwnProperty.call(this, 'constructor')) {\n        return fn;\n      }\n\n      // Bounded functions store\n      let bindings = this[BINDINGS_STORE_KEY];\n      if (!bindings) {\n        bindings = this[BINDINGS_STORE_KEY] = new WeakMap<T, T>();\n      }\n\n      // Store binding if it does not exist\n      if (!bindings.has(fn)) {\n        bindings.set(fn, fn.bind(this));\n      }\n\n      // Return binding\n      return bindings.get(fn);\n    },\n    set(value: T): void {\n      Object.defineProperty(this, propertyKey, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value\n      });\n    }\n  };\n}\n","/** Function that does nothing */\nexport const noop: AnyToVoidFnSignature = () => undefined;\n\n/** Function that returns the first argument */\nexport const identity = <T>(arg: T): T => arg;\n\nexport type NoopFnSignature = () => void;\n\nexport type AnyToVoidFnSignature = (...args: any[]) => void;\n\nexport type AnyToAnyFnSignature = (...args: any[]) => any;\n\nexport type MethodTypedDecorator<T> = (target: any, property: string, descriptor: TypedPropertyDescriptor<T>) => TypedPropertyDescriptor<T> | void;\n","import {identity} from './functions';\nimport {isArrayLike} from './object';\n\ntype Tuple<T> = [T?, T?];\n\n/** Split array into tuples */\nexport const tuple = <T>(arr: T[]): Tuple<T>[] => arr.reduce((acc: Tuple<T>[], el) => {\n  if (acc.length === 0 || acc[acc.length - 1].length >= 2) acc.push([]);\n  acc[acc.length - 1].push(el);\n  return acc;\n}, []);\n\n/** Flat array - unwraps one level of nested arrays */\nexport const flat = <T>(arr: (null | T | T[])[]): T[] =>\n  arr.reduce((acc: T[], el) => el ? acc.concat(el) : acc, []) as T[];\n\n/** Wraps passed object or primitive to array */\nexport const wrap = <T>(arr: undefined | null | T | T[]): T[] => {\n  if (arr === undefined || arr === null) return [];\n  if (Array.isArray(arr)) return arr;\n  return [arr];\n};\n\n/** Unwraps and returns the first element if passed object is array-like, returns original object otherwise */\nexport function unwrap(value: []): undefined;\nexport function unwrap<T>(value: (ArrayLike<T> & {0: T}) | T): T;\nexport function unwrap<T extends Node>(value: NodeListOf<T>): T | undefined;\nexport function unwrap(value: any): any;\nexport function unwrap(value: any): any {\n  return isArrayLike(value) ? value[0] : value;\n}\n\n/** Makes array values unique */\nexport const uniq = <T> (arr: T[]): T[] => {\n  const result: T[] = [];\n  const set = new Set<T>();\n  arr.forEach((item) => set.add(item));\n  set.forEach((item) => result.push(item));\n  return result;\n};\n\n/** Create an array filled with the range [0,..,N-1] */\nexport function range(n: number): number[];\n/** Create an array filled with values returned by the filler callback */\nexport function range<T>(n: number, filler: (i: number) => T): T[];\nexport function range(n: number, filler: (i: number) => any = identity): any[] {\n  const arr = Array(n);\n  let i = 0;\n  while (i < n) arr[i] = filler(i++);\n  return arr;\n}\n\n/**\n * @returns object with a criteria value as a key and an array of original items that belongs to the current criteria value\n */\nexport const groupBy = <T, V extends string | number>(array: T[], group: (item: T) => V): Record<V, T[]> => {\n  return array.reduce((obj: Record<V, T[]>, el: T) => {\n    const key = group(el);\n    obj[key] ? obj[key].push(el) : obj[key] = [el];\n    return obj;\n  }, {} as Record<V, T[]>);\n};\n","import {wrap} from '../misc/array';\n\n/** Describe locker elements collection per class name */\ntype Locks = Map<string, Set<Element>>;\n/** Store locks for key element classes*/\nconst lockStore = new WeakMap<Element, Locks>();\n\n/** Mange className lock for the element */\nconst lock = (el: Element, className: string, locker: Element): void => {\n  const elLocks: Locks = lockStore.get(el) || new Map();\n  const classLocks: Set<Element> = elLocks.get(className) || new Set();\n  classLocks.add(locker);\n  elLocks.set(className, classLocks);\n  lockStore.set(el, elLocks);\n};\n/**\n * Manage className unlock for the element\n * @returns true if className have no locks\n */\nconst unlock = (el: Element, className: string, locker: Element): boolean => {\n  const elLocks = lockStore.get(el);\n  if (!elLocks) return true;\n  const classLocks = elLocks.get(className);\n  if (!classLocks) return true;\n  classLocks.delete(locker);\n  return !classLocks.size;\n};\n\n/**\n * Add single class to the element.\n * Supports inversion and locker management.\n */\nconst add = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return remove(el, className.substring(1), locker);\n  if (locker) lock(el, className, locker);\n  el.classList.add(className);\n};\n\n/**\n * Remove single class from the element.\n * Supports inversion and locker management.\n */\nconst remove = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return add(el, className.substring(1), locker);\n  if (locker && !unlock(el, className, locker)) return;\n  if (!locker) CSSClassUtils.unlock(el, className);\n  el.classList.remove(className);\n};\n\n/**\n * Check if the element matches passed CSS class.\n * Supports inversion.\n */\nconst has = (el: Element, className: string): boolean => {\n  if (className[0] === '!') return !has(el, className.substring(1));\n  return el.classList.contains(className);\n};\n\n/**\n * CSS class manipulation utilities.\n *\n * Allows manipulating with CSS classes with the following set of sub-features:\n * - JQuery-like enumeration - you can pass multiple tokens separated by space\n * - safe checks - empty or falsy token sting will be ignored without throwing an error\n * - inversion syntax - tokens that start from '!' will be processed with inverted action\n * (e.g. addCls(el, '!class') - will remove 'class' from the element, while removeCls(el, '!class') adds 'class' to the element)\n * - class locks - you can manipulate with classes using `locker` option that takes into account the modification initiator.\n * That means the class added in 'locker' mode will not be removed until all initiators that requested add class have requested its removal.\n * */\nexport abstract class CSSClassUtils {\n  /** Splitting passed token string into CSS class names array. */\n  public static splitTokens(tokenString: string | null | undefined): string[] {\n    return (tokenString || '').split(' ').filter((str) => !!str);\n  }\n\n  /**\n   * Add all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static add(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => add(el, className, locker)));\n  }\n\n  /**\n   * Remove all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static remove(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => remove(el, className, locker)));\n  }\n\n  /**\n   * Toggle all classes from the class token string on the element to the passed state.\n   * @see CSSClassUtils\n   * */\n  public static toggle(els: Element | Element[], cls: string | null | undefined, state: boolean, locker?: Element): void {\n    (state ? CSSClassUtils.add : CSSClassUtils.remove)(els, cls, locker);\n  }\n\n  /**\n   * Check if all class from token string matches to the element or elements.\n   * @see CSSClassUtils\n   * */\n  public static has(els: Element | Element[], cls: string): boolean {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    return wrap(els).every((el) => tokens.every((className) => has(el, className)));\n  }\n\n  /** Remove all lockers for the element or passed element className */\n  public static unlock(els: Element | Element[], className?: string): void {\n    if (className) {\n      wrap(els).forEach((el) => lockStore.get(el)?.delete(className));\n    } else {\n      wrap(els).forEach((el) => lockStore.delete(el));\n    }\n  }\n}\n","/** Checks that passed value is object, but not a callable-object (function) */\nexport const isObject = (obj: any): obj is Record<string, any> => !!obj && typeof obj === 'object';\n/** Checks that passed value is an object or function */\nexport const isObjectLike = (obj: any): boolean => isObject(obj) || typeof obj === 'function';\n/** Checks if the passed value is primitive */\nexport const isPrimitive = (obj: any): obj is string | number | boolean | symbol | undefined | null =>\n  obj === null ||\n  typeof obj === 'undefined' ||\n  typeof obj === 'string' ||\n  typeof obj === 'number' ||\n  typeof obj === 'boolean' ||\n  typeof obj === 'symbol';\n/** Checks that passed object is prototype of some class */\nexport const isPrototype = (obj: any): boolean => Object.hasOwnProperty.call(obj, 'constructor');\n\n/** Array-like type definition */\nexport type ArrayLike<T = any> = {\n  [key: number]: T;\n  length: number;\n};\n/** Checks that passed object is array-like */\nexport const isArrayLike = (value: any): value is ArrayLike => {\n  if (!value || typeof value !== 'object') return false;\n  if (Array.isArray(value)) return true;\n  if (typeof value.length !== 'number' || value.length < 0) return false;\n  return !value.length || Object.hasOwnProperty.call(value, value.length - 1);\n};\n","import {isObjectLike} from './types';\n\n/** Full key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKeyDef = {\n  /** Key name */\n  key: string | number;\n  /** Key represents collection index */\n  isIndex?: boolean;\n  /** Key should produce array if not exists */\n  isIndexed?: boolean;\n};\n/** Key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKey = PathKeyDef | string | number;\n\n/** @returns PathKeyDef from the PathDef */\nconst toKeyDef = (key: PathKey): PathKeyDef => typeof key === 'object' ? key : {key};\n\n/** Parses path to full {@link PathKeyDef} array */\nexport const parseKeys = (path: string | PathKey[]): PathKeyDef[] => {\n  if (Array.isArray(path)) return path.map(toKeyDef);\n  return parseKeysPath(path || '.');\n};\n\n/** Parses string path to full {@link PathKeyDef} array */\nconst parseKeysPath = (path: string): PathKeyDef[] => {\n  let start = 0;\n  const parts: PathKeyDef[] = [];\n\n  while (start < path.length) {\n    let end = start = start + +(path[start] === '.'); // skip initial '.'\n    if (path[start] === '[') { // handle index syntax\n      end = ++start; // start bracket ignored\n      while (end < path.length && path[end] !== ']') ++end;\n      const key = path.substring(start, end);\n      const isIndex = !key || Math.floor(+key) === +key;\n      parts.push({key, isIndex});\n      start = ++end; // skip end bracket\n    } else { // handle simple key\n      while (end < path.length && path[end] !== '[' && path[end] !== '.') ++end;\n      const key = path.substring(start, end);\n      parts.push({key});\n      start = end;\n    }\n  }\n  return parts;\n};\n\n/**\n * Gets object property using \"path\" key\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param data - object\n * @param path - key path. string or {@link PathKey} array\n * @param defaultValue - default\n * @returns specified object property\n */\nexport const getByPath = (data: any, path: string | PathKey[], defaultValue?: any): any => {\n  const keys = parseKeys(path);\n  const result = keys.reduce((curr: any, {key}: PathKeyDef) => {\n    if (isObjectLike(curr)) return curr[key];\n    return undefined;\n  }, data);\n  return typeof result === 'undefined' ? defaultValue : result;\n};\n\n/**\n * Gets object property using \"path\" with a keys separated by `.`\n * @see getByPath\n */\nexport const get = (data: any, path: string, defaultValue?: any): any => getByPath(data, (path || '').split('.'), defaultValue);\n\n/**\n * Sets object property using \"path\" key\n * Creates empty object if sub-key value is not presented.\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax and collection creation):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param target - object\n * @param path - key path. string or {@link PathKey} array\n * @param value - value of property\n * @returns original object\n */\nexport const setByPath = (target: any, path: string | PathKey[], value: any): any => {\n  const keys = parseKeys(path);\n  const depth = keys.length - 1;\n  keys.reduce((cur: any, {key, isIndex, isIndexed}: PathKeyDef, pos: number) => {\n    if (isIndex && !key) key = cur.length || 0; // a[] only\n    if (pos !== depth && isObjectLike(cur[key])) return cur[key]; // key already presented\n    if (isIndexed === undefined && pos !== depth) isIndexed = keys[pos + 1].isIndex;\n    return cur[key] = (pos === depth) ? value : (isIndexed ? [] : {});\n  }, target);\n  return target;\n};\n\n/**\n * Sets object property using \"path\" with a keys separated by `.`\n * @see setByPath\n */\nexport const set = (target: any, path: string, value: any): any => setByPath(target, (path || '').split('.'), value);\n","import {get} from './object';\n\n/** Converts string to kebab-case notation */\nexport const toKebabCase = (str: string): string => {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\n};\n\n/** Converts string to camelCase notation */\nexport const toCamelCase = (str: string): string => {\n  return str.trim().replace(/[\\s-,_]+([a-zA-Z0-9]?)/g, (match: string, word: string) => word.toUpperCase());\n};\n\n/** Makes the first non-indent (space, tab, newline) letter in the string capitalized */\nexport const capitalize = (str: string): string => {\n  let i = 0;\n  while (i < str.length && (str[i] === ' ' || str[i] === '\\t' || str[i] === '\\n')) i++;\n  return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);\n};\n\n/** Unwraps string from parenthesis */\nexport const unwrapParenthesis = (str: string): string => {\n  return str.trim().replace(/^\\((.*)\\)$/, '$1').trim();\n};\n\n/**\n * Parses number with the ability to pass an alternative fallback for NaN.\n * Note: falsy values except 0 are treated as NaN\n */\nexport const parseNumber = (str: string | number, nanValue?: number | undefined): number | undefined => {\n  if (str === 0) return 0;\n  const value = +(str || NaN);\n  return isNaN(value) ? nanValue : value;\n};\n\n/**\n * Common function that returns coefficient aspect ratio\n * Supported formats: w:h, w/h, coefficient\n * @example\n * `16:9`, `16/9`, `1.77`\n * @param str - string to parse\n * @returns aspect ratio coefficient\n */\nexport function parseAspectRatio(str: string): number {\n  const [w, h] = str.split(/[:/]/);\n  if (typeof h !== 'undefined') return +w / +h;\n  return +w || 0;\n}\n\n/** Evaluates passed string or returns `defaultValue` */\nexport function evaluate(str: string, defaultValue?: any): any {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    return str ? (new Function(`return ${str}`))() : defaultValue;\n  } catch (e) {\n    console.warn('Cannot parse value ', str, e);\n    return defaultValue;\n  }\n}\n\n/** Default RegExp to match replacements in the string for the {@link format} function */\nexport const DEF_FORMAT_MATCHER = /{[{%]?([\\w.]+)[%}]?}/g;\n\n/** Replaces `{key}` patterns in the string from the source object */\nexport function format(str: string, source: Record<string, any>, matcher: RegExp = DEF_FORMAT_MATCHER): string {\n  return str.replace(matcher, (match, key) => {\n    const val = get(source, key);\n    return val === undefined ? match : val;\n  });\n}\n","export type AttributeTarget = {$host: Element};\nexport type AttributeDecorator = (target: Element | AttributeTarget, propName: string) => void;\n\n/** @returns attribute or passed fallback value. Identical to getAttribute by default */\nexport function getAttr($el: Element | AttributeTarget, name: string): string | null;\nexport function getAttr<T>($el: Element | AttributeTarget, name: string, fallback: T): string | T;\nexport function getAttr($el: Element | AttributeTarget, name: string, fallback: string | null = null): string | null {\n  if ('$host' in $el) $el = $el.$host;\n  const value = $el.getAttribute(name);\n  return value === null ? fallback : value;\n}\n\n/** Set attribute */\nexport function setAttr($el: Element | AttributeTarget, name: string, value: undefined | null | boolean | string): void {\n  if ('$host' in $el) $el = $el.$host;\n  if (value === undefined || value === null || value === false) {\n    $el.removeAttribute(name);\n  } else {\n    $el.setAttribute(name, value === true ? '' : value);\n  }\n}\n","import {toKebabCase} from '../../esl-utils/misc/format';\nimport {getAttr, setAttr} from '../../esl-utils/dom/attr';\nimport type {AttributeDecorator, AttributeTarget} from '../../esl-utils/dom/attr';\n\n/** HTML attribute mapping configuration */\ntype AttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: string | boolean | null;\n};\n\nfunction buildSimpleDescriptor(attrName: string, readOnly: boolean, defaultValue: string | boolean | null | undefined): PropertyDescriptor {\n  function get(): string | boolean | null | undefined {\n    return getAttr(this, attrName, defaultValue);\n  }\n\n  function set(value: string | boolean | null | undefined): void {\n    setAttr(this, attrName, value);\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value.\n * Maps string type property.\n * @param config - mapping configuration. See {@link AttrDescriptor}\n */\nexport const attr = (config: AttrDescriptor = {}): AttributeDecorator => {\n  config = Object.assign({defaultValue: ''}, config);\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildSimpleDescriptor(attrName, !!config.readonly, config.defaultValue));\n  };\n};\n","import {setAttr} from '../../esl-utils/dom/attr';\nimport {toKebabCase} from '../../esl-utils/misc/format';\nimport type {AttributeDecorator, AttributeTarget} from '../../esl-utils/dom/attr';\n\n/** HTML boolean (marker) attribute mapping configuration */\ntype BoolAttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n};\n\nfunction buildConditionalDescriptor(attrName: string, readOnly: boolean): PropertyDescriptor {\n  function get(): boolean {\n    return this.hasAttribute(attrName);\n  }\n  function set(value: unknown): void {\n    setAttr(this, attrName, !!value);\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element boolean (marker) attribute state.\n * Maps boolean type property.\n * @param config - mapping configuration. See {@link BoolAttrDescriptor}\n */\nexport const boolAttr = (config: BoolAttrDescriptor = {}): AttributeDecorator => {\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildConditionalDescriptor(attrName, !!config.readonly));\n  };\n};\n","export interface Point {\n  x: number;\n  y: number;\n}\n\nexport abstract class EventUtils {\n  /**\n   * Dispatch custom event.\n   * Event bubbles and is cancelable by default, use `eventInit` to override that.\n   * @param el - element target\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public static dispatch(el: EventTarget, eventName: string, eventInit?: CustomEventInit): boolean {\n    const init = Object.assign({\n      bubbles: true,\n      composed: true,\n      cancelable: true\n    }, eventInit || {});\n    return el.dispatchEvent(new CustomEvent(eventName, init));\n  }\n\n  /** Get original CustomEvent source */\n  public static source(e: CustomEvent): EventTarget | null {\n    const targets = (e.composedPath && e.composedPath());\n    return targets ? targets[0] : e.target;\n  }\n\n  /** Check if the passed event is {@link MouseEvent} */\n  public static isMouseEvent(event: Event): event is MouseEvent {\n    return window.MouseEvent && event instanceof MouseEvent;\n  }\n\n  /** Check if the passed event is {@link TouchEvent} */\n  public static isTouchEvent(event: Event): event is TouchEvent {\n    return window.TouchEvent && event instanceof TouchEvent;\n  }\n\n  /** Normalize TouchEvent or PointerEvent */\n  public static normalizeTouchPoint(event: TouchEvent | PointerEvent | MouseEvent): Point {\n    const source = EventUtils.isTouchEvent(event) ? event.changedTouches[0] : event;\n    return {\n      x: source.pageX,\n      y: source.pageY\n    };\n  }\n\n  /** Normalize MouseEvent */\n  public static normalizeCoordinates(event: TouchEvent | PointerEvent | MouseEvent, elem: HTMLElement): Point {\n    const source = EventUtils.isTouchEvent(event) ? event.changedTouches[0] : event;\n    const props = elem.getBoundingClientRect();\n    const top = props.top + window.scrollY;\n    const left = props.left + window.scrollX;\n    return {\n      x: source.pageX - left,\n      y: source.pageY - top\n    };\n  }\n\n  /** Stub method to prevent event from bubbling out of target */\n  public static stopPropagation(e?: Event): void {\n    e?.stopPropagation();\n  }\n\n  /** Stub method to prevent default event behaviour */\n  public static preventDefault(e?: Event): void {\n    e?.preventDefault();\n  }\n}\n","import {setAttr} from '../../esl-utils/dom/attr';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\n/**\n * Base class for ESL custom elements.\n * Allows defining custom element with the optional custom tag name.\n */\nexport abstract class ESLBaseElement extends HTMLElement {\n  /** Custom element tag name */\n  public static is = '';\n\n  protected _connected: boolean = false;\n\n  protected connectedCallback(): void {\n    this._connected = true;\n    this.classList.add((this.constructor as typeof ESLBaseElement).is);\n  }\n  protected disconnectedCallback(): void {\n    this._connected = false;\n  }\n\n  /** Check that the element is connected and `connectedCallback` has been executed */\n  public get connected(): boolean {\n    return this._connected;\n  }\n\n  /**\n   * Gets or sets CSS classes for the current element.\n   * @param cls - CSS classes query {@link CSSClassUtils}\n   * @param value - boolean to set CSS class(es) state or undefined to skip mutation\n   * @returns current classes state or passed state\n   */\n  public $$cls(cls: string, value?: boolean): boolean {\n    if (value === undefined) return CSSClassUtils.has(this, cls);\n    CSSClassUtils.toggle(this, cls, value);\n    return value;\n  }\n\n  /**\n   * Gets or sets an attribute for the current element.\n   * If the `value` param is undefined then skips mutation.\n   * @param name - attribute name\n   * @param value - string attribute value, boolean attribute state or `null` to delete attribute\n   * @returns the current attribute value or previous value for mutation\n   */\n  public $$attr(name: string, value?: null | boolean | string): string | null {\n    const prevValue = this.getAttribute(name);\n    if (value !== undefined) setAttr(this, name, value);\n    return prevValue;\n  }\n\n  /**\n   * Dispatches component custom event.\n   * Uses 'esl:' prefix for event name, overridable to customize event namespaces.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return EventUtils.dispatch(this, 'esl:' + eventName, eventInit);\n  }\n\n  /**\n   * Register component in the {@link customElements} registry\n   * @param tagName - custom tag name to register custom element\n   */\n  public static register(this: typeof ESLBaseElement, tagName?: string): void {\n    tagName = tagName || this.is;\n    if (!tagName) throw new Error('Can not define custom element');\n    const constructor: any = customElements.get(tagName);\n    if (constructor) {\n      if (constructor.is !== tagName) throw new Error('Element declaration tag inconsistency');\n      return;\n    }\n    if (this.is !== tagName) {\n      this.is = tagName;\n    }\n    customElements.define(tagName, this as any as CustomElementConstructor);\n  }\n\n  /** Shortcut for `customElements.whenDefined(currentCustomElement)` */\n  public static get registered(): Promise<CustomElementConstructor> {\n    return customElements.whenDefined(this.is);\n  }\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Abstract Observable implementation\n * @author Yuliya Adamskaya\n */\nexport abstract class Observable <Callback extends AnyToVoidFnSignature = AnyToVoidFnSignature> {\n  protected _listeners = new Set<Callback>();\n\n  public addListener(listener: Callback): void {\n    this._listeners.add(listener);\n  }\n  public removeListener(listener: Callback): void {\n    this._listeners.delete(listener);\n  }\n\n  protected fire(...args: Parameters<Callback>): void {\n    this._listeners.forEach((listener) => {\n      try {\n        listener.apply(this, args);\n      } catch (e) {\n        console.error(e);\n      }\n    });\n  }\n}\n","import type {AnyToAnyFnSignature} from './functions';\n\n/** Memoized function type */\nexport type MemoizedFn<T extends AnyToAnyFnSignature> = T & {\n  /** Cache instance */\n  cache: Map<null | string, ReturnType<T>>;\n  /** Clear memoization cache */\n  clear: () => void;\n  /** Check existence of cache for passed params */\n  has: (...params: Parameters<T>) => boolean;\n};\n\n/**\n * Memoization decorator function. Caches the original function result according to hash generated from arguments.\n * In case the hash function returns `undefined` value will not be memoized.\n * @see MemoHashFn Hash function signature.\n */\nexport function memoizeFn<F extends AnyToAnyFnSignature>(fn: F, hashFn: MemoHashFn<F> = defaultArgsHashFn): MemoizedFn<F> {\n  function memo(...args: Parameters<F>): any {\n    const key = hashFn(...args);\n    if (key !== null && typeof key !== 'string') {\n      console.warn(`Can't cache value for ${fn.name} call.`);\n      return fn.apply(this, args);\n    }\n    if (!memo.cache.has(key)) {\n      memo.cache.set(key, fn.apply(this, args));\n    }\n    return memo.cache.get(key);\n  }\n\n  memo.cache = new Map<null | string, ReturnType<F>>();\n  memo.clear = (): void => memo.cache.clear();\n  memo.has = (...args: Parameters<F>): boolean => {\n    const key = hashFn(...args);\n    return key === undefined ? false : memo.cache.has(key);\n  };\n  return memo as MemoizedFn<F>;\n}\n\n/**\n * Describe abstract memoization hash function. Memoization should have the same or compatible signature as the decorated function.\n * Hash function can return string or null as a hash result. Note: null is correct hash for arguments!\n * If the result is `undefined` - it means that the hash can not be generated.\n */\nexport type MemoHashFn<F extends AnyToAnyFnSignature = AnyToAnyFnSignature> = (...args: Parameters<F>) => undefined | null | string;\n\n/**\n * Default arguments hash function.\n * Supports only 0-1 arguments with a primitive type.\n */\nexport function defaultArgsHashFn(...args: any[]): string | null | undefined {\n  if (args.length === 0) return null;\n  if (args.length > 1) return;\n  if (typeof args[0] !== 'string' && typeof args[0] !== 'number' && typeof args[0] !== 'boolean') return;\n  return String(args[0]);\n}\n","/** @returns first defined param */\nexport function defined<T>(...params: T[]): T | undefined {\n  for (const param of params) {\n    if (param !== undefined) return param;\n  }\n}\n\n/** Finds the closest property descriptor */\nexport function getPropertyDescriptor(o: any, prop: PropertyKey): PropertyDescriptor | undefined {\n  let proto = o;\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc) return desc;\n    proto = Object.getPrototypeOf(proto);\n  }\n}\n","import {defaultArgsHashFn, memoizeFn} from '../misc/memoize';\nimport {isPrototype, getPropertyDescriptor} from '../misc/object';\n\nimport type {MemoHashFn} from '../misc/memoize';\nimport type {MethodTypedDecorator} from '../misc/functions';\n\nexport function memoize(): MethodDecorator;\nexport function memoize<H extends MemoHashFn>(hashFn: H): MethodTypedDecorator<(...args: Parameters<H>) => any>;\n/**\n * Memoization decorator helper.\n * @see memoizeFn Original memoizeFn function decorator.\n */\nexport function memoize(hashFn: MemoHashFn = defaultArgsHashFn) {\n  return function (target: any, prop: string, descriptor: TypedPropertyDescriptor<any>): void {\n    if (!descriptor || typeof (descriptor.value || descriptor.get) !== 'function') {\n      throw new TypeError('Only get accessors or class methods can be decorated via @memoize');\n    }\n\n    if (isPrototype(target)) {\n      // Object members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeGetter(descriptor.get, prop));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeMethod(descriptor.value, prop, hashFn));\n    } else {\n      // Static members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeFn(descriptor.get));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeFn(descriptor.value, hashFn));\n    }\n  };\n}\n\n// Lock storage to prevent cache logic for some key\nconst locks = new WeakMap();\nconst defineOwnKeySafe = (obj: any, prop: string, value: any): void => {\n  locks.set(obj, prop); // IE try to get key with the prototype instance call, so we lock it\n  Object.defineProperty(obj, prop, {value, writable: true, configurable: true});\n  locks.delete(obj); // Free property key\n};\n\n/** Cache getter result as an object own property */\nfunction memoizeGetter(originalMethod: any, prop: string) {\n  return function (): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const value = originalMethod.call(this);\n    defineOwnKeySafe(this, prop, value);\n    return value;\n  };\n}\n\n/** Cache method memo function in the current context on call */\nfunction memoizeMethod(originalMethod: any, prop: string, hashFn: MemoHashFn) {\n  return function (this: any, ...args: any[]): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const memo = memoizeFn(originalMethod, hashFn);\n    defineOwnKeySafe(this, prop, memo);\n    return memo.apply(this, args);\n  };\n}\n\n/**\n * Clear memoization cache for passed target and property.\n * Accepts not own properties.\n * Note: be sure that you targeting memoized property or function.\n * Clear utility has no 100% check to prevent modifying incorrect (not memoized) property keys\n */\nmemoize.clear = function (target: any, property: string): void {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).clear === 'function') return (desc.get as any).clear();\n  if (typeof desc.value === 'function' && typeof desc.value.clear === 'function') return desc.value.clear();\n  if (Object.hasOwnProperty.call(target, property)) delete target[property];\n};\n\n/** Check if property has cache for the passed params */\nmemoize.has = function (target: any, property: string, ...params: any[]): boolean {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return false;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).has === 'function') return (desc.get as any).has(...params);\n  if (typeof desc.value === 'function' && typeof desc.value.has === 'function') return desc.value.has(...params);\n  return Object.hasOwnProperty.call(target, property);\n};\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\n\n/**\n * DPR preprocessor. Used to replace DPR shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenDPR')\nexport class ESLScreenDPR {\n  protected static readonly VALUE_REGEXP = /(\\d(\\.\\d)?)x/;\n\n  /** Option to exclude dpr greater then 2 for bots */\n  public static ignoreBotsDpr = false;\n\n  public static toDPI(dpr: number): string {\n    return (96 * dpr).toFixed(1);\n  }\n\n  public static process(match: string): string | undefined {\n    if (!ESLScreenDPR.VALUE_REGEXP.test(match)) return;\n    const dpr = parseFloat(match);\n    if (dpr < 0 || isNaN(dpr)) return;\n    if (ESLScreenDPR.ignoreBotsDpr && DeviceDetector.isBot && dpr > 1) return 'not all';\n    if (DeviceDetector.isSafari) return `(-webkit-min-device-pixel-ratio: ${dpr})`;\n    return `(min-resolution: ${ESLScreenDPR.toDPI(dpr)}dpi)`;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenDPR: typeof ESLScreenDPR;\n  }\n}\n","import {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst shortcuts = new Map<string, string | boolean>();\n\n/**\n * Static shortcuts preprocessor. Used to store device related shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('EnvShortcuts')\nexport class ESLEnvShortcuts {\n  // For debug purposes\n  private static readonly _shortcuts = shortcuts;\n\n  /**\n   * Add mapping\n   * @param shortcut - term to find in query\n   * @param value - media query string or boolean result (that represents `all` or `not all` conditions)\n   */\n  public static add(shortcut: string, value: string | boolean): void {\n    if (!['boolean', 'string'].includes(typeof value)) value = false;\n    shortcuts.set(shortcut.toLowerCase(), value);\n  }\n\n  /** Remove mapping for passed shortcut term */\n  public static remove(shortcut: string): boolean {\n    return shortcuts.delete(shortcut.toLowerCase());\n  }\n\n  /** Replaces shortcut to registered result */\n  public static process(match: string): string | boolean | undefined {\n    if (shortcuts.has(match)) return shortcuts.get(match);\n  }\n}\n\n// Touch check\nESLEnvShortcuts.add('touch', DeviceDetector.isTouchDevice);\n\n// Basic device type shortcuts\nESLEnvShortcuts.add('bot', DeviceDetector.isBot);\nESLEnvShortcuts.add('mobile', DeviceDetector.isMobile);\nESLEnvShortcuts.add('desktop', !DeviceDetector.isMobile);\nESLEnvShortcuts.add('android', DeviceDetector.isAndroid);\nESLEnvShortcuts.add('ios', DeviceDetector.isMobileIOS);\n\n// Basic browser shortcuts\nESLEnvShortcuts.add('ie', DeviceDetector.isIE);\nESLEnvShortcuts.add('edge', DeviceDetector.isEdgeHTML);\nESLEnvShortcuts.add('gecko', DeviceDetector.isGecko);\nESLEnvShortcuts.add('blink', DeviceDetector.isBlink);\nESLEnvShortcuts.add('safari', DeviceDetector.isSafari);\nESLEnvShortcuts.add('safari-ios', DeviceDetector.isMobileSafari);\n\ndeclare global {\n  export interface ESLLibrary {\n    EnvShortcuts: typeof ESLEnvShortcuts;\n  }\n}\n","export interface IMediaQueryCondition {\n  /** @returns true if current environment satisfies query */\n  matches: boolean;\n  /** Attach listener to wrapped media query list */\n  addListener(cb: VoidFunction): void;\n  /** Detach listener from wrapped media query list */\n  removeListener(cb: VoidFunction): void;\n  /** Optimize condition with nested hierarchy */\n  optimize(): IMediaQueryCondition;\n  /** Stringify condition */\n  toString(): string;\n}\n\n/**\n * Const media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Ignores listeners always return the same result.\n * Have only two instances: {@link ALL} and {@link NOT_ALL}\n */\nclass MediaQueryConstCondition implements IMediaQueryCondition {\n  constructor(private readonly _matches: boolean) {}\n\n  public get matches(): boolean {\n    return this._matches;\n  }\n\n  public addListener(cb: VoidFunction): void {}\n  public removeListener(cb: VoidFunction): void {}\n\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n\n  public toString(): string {\n    return this._matches ? 'all' : 'not all';\n  }\n\n  /** Compare const media condition with the passed query instance or string */\n  public eq(val: IMediaQueryCondition | string): boolean {\n    return val.toString().trim() === this.toString();\n  }\n}\n\nexport const ALL = new MediaQueryConstCondition(true);\nexport const NOT_ALL = new MediaQueryConstCondition(false);\n","import {ALL, NOT_ALL} from './media-query-base';\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Simple media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Wraps matchMedia instance\n */\nexport class MediaQueryCondition implements IMediaQueryCondition {\n  protected readonly _inverted: boolean;\n  protected readonly _mq: MediaQueryList;\n\n  constructor(query: string, inverted = false) {\n    this._inverted = inverted;\n    this._mq = matchMedia(query.trim() || 'all');\n  }\n\n  public get matches(): boolean {\n    return this._inverted ? !this._mq.matches : this._mq.matches;\n  }\n\n  public addListener(listener: VoidFunction): void {\n    if (typeof this._mq.addEventListener === 'function') {\n      this._mq.addEventListener('change', listener);\n    } else {\n      this._mq.addListener(listener);\n    }\n  }\n  public removeListener(listener: VoidFunction): void {\n    if (typeof this._mq.removeEventListener === 'function') {\n      this._mq.removeEventListener('change', listener);\n    } else {\n      this._mq.removeListener(listener);\n    }\n  }\n\n  /** Optimize query. Can simplify query to {@link MediaQueryConstCondition} */\n  public optimize(): IMediaQueryCondition {\n    if (ALL.eq(this)) return this._inverted ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(this)) return this._inverted ? ALL : NOT_ALL;\n    return this;\n  }\n\n  public toString(): string {\n    const query = this._mq.media;\n    const inverted = this._inverted;\n    const complex = inverted && /\\)[\\s\\w]+\\(/.test(query);\n    return (inverted ? 'not ' : '') + (complex ? `(${query})` : query);\n  }\n}\n","import {Observable} from '../../../esl-utils/abstract/observable';\nimport {ALL, NOT_ALL} from './media-query-base';\n\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Abstract multiple media conditions container\n * @author Alexey Stsefanovich (ala'n)\n *\n * Observe all child items. Dispatch changes when the whole condition result is changed\n */\nclass MediaQueryContainer extends Observable<(matches: boolean) => void> implements IMediaQueryCondition {\n  private _matches: boolean;\n\n  constructor(protected readonly items: IMediaQueryCondition[] = []) {\n    super();\n    this._matches = this.matches;\n    this._onChildChange = this._onChildChange.bind(this);\n  }\n\n  public addListener(listener: (matches: boolean) => void): void {\n    super.addListener(listener);\n    if (this._listeners.size > 1) return;\n    this.items.forEach((item) => item.addListener(this._onChildChange));\n  }\n  public removeListener(listener: (matches: boolean) => void): void {\n    super.removeListener(listener);\n    if (this._listeners.size) return;\n    this.items.forEach((item) => item.removeListener(this._onChildChange));\n  }\n\n  public get matches(): boolean {\n    return false;\n  }\n\n  /** Exclude const conditions. Unwrap empty or trivial (with one item) containers */\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n\n  /** Handle query change and dispatch it on top level in case result value is changed */\n  protected _onChildChange(): void {\n    const {matches} = this;\n    if (this._matches ===  matches) return;\n    this.fire(this._matches = matches);\n  }\n}\n\n/** Conjunction (AND) group of media conditions */\nexport class MediaQueryConjunction extends MediaQueryContainer {\n  public get matches(): boolean {\n    return this.items.every((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => NOT_ALL.eq(item))) return NOT_ALL;\n    const items = optimizedItems.filter((item) => !ALL.eq(item));\n    if (items.length === 0) return ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryConjunction(items);\n  }\n\n  public toString(): string {\n    return this.items.join(' and ');\n  }\n}\n\n/** Disjunction (OR) group of media conditions */\nexport class MediaQueryDisjunction extends MediaQueryContainer {\n  public get matches(): boolean {\n    return this.items.some((item) => item.matches);\n  }\n\n  public optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => ALL.eq(item))) return ALL;\n    const items = optimizedItems.filter((item) => !NOT_ALL.eq(item));\n    if (items.length === 0) return NOT_ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryDisjunction(items);\n  }\n\n  public toString(pretty = false): string {\n    return this.items.join(pretty ? ' or ' : ', ');\n  }\n}\n","import {memoize} from '../../esl-utils/decorators/memoize';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\n\nimport {ESLScreenDPR} from './common/screen-dpr';\nimport {ESLScreenBreakpoints} from './common/screen-breakpoint';\nimport {ESLEnvShortcuts} from './common/env-shortcuts';\n\nimport {ALL, NOT_ALL} from './conditions/media-query-base';\nimport {MediaQueryCondition} from './conditions/media-query-condition';\nimport {MediaQueryConjunction, MediaQueryDisjunction} from './conditions/media-query-containers';\n\nimport type {IMediaQueryCondition} from './conditions/media-query-base';\n\nexport interface IMediaQueryPreprocessor {\n  process: (match: string) => string | boolean | undefined;\n}\n\n/**\n * ESL Media Query\n * Provides special media condition syntax - ESLMediaQuery\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n *\n * Utility to support extended MediaQuery features\n * Supports\n * - CSS MediaQuery matching check\n * - DPR display queries (`@x1|@x2|@x3`)\n * - Registered screen default sizes (breakpoints) shortcuts (`@[-|+](XS|SM|MD|LG|XL)`)\n * - Device and browser shortcuts (`@MOBILE|@DESKTOP|@IE`)\n * - Custom static shortcuts and custom query preprocessors\n * - `not` logic operation (can have multiple not operators before any term of the query)\n * - `or` or `,` logical operator (have a lowest priority)\n * - Query matching change listeners\n *\n * Building query process:\n *\n * [Building query logical tree] - [preprocess nodes queries] - [building native MediaQueryList nodes] - [query tree optimization]\n */\n@ExportNs('MediaQuery')\nexport abstract class ESLMediaQuery implements IMediaQueryCondition {\n  /** Always true condition */\n  public static readonly ALL: IMediaQueryCondition = ALL;\n  /** Always false condition */\n  public static readonly NOT_ALL: IMediaQueryCondition = NOT_ALL;\n\n  protected static readonly SHORTCUT_PATTERN = /@([a-z0-9.+-]+)/i;\n  protected static readonly _preprocessors: IMediaQueryPreprocessor[] = [];\n\n  /** Adds {@link IMediaQueryPreprocessor} instance for query preprocessing step */\n  public static use(preprocessor: IMediaQueryPreprocessor): typeof ESLMediaQuery {\n    this._preprocessors.unshift(preprocessor);\n    return this;\n  }\n\n  /** Cached method to create {@link ESLMediaQuery} condition instance from query string */\n  @memoize()\n  public static for(query: string): IMediaQueryCondition {\n    return ESLMediaQuery.from(query);\n  }\n\n  /** Creates {@link ESLMediaQuery} condition instance from query string */\n  public static from(query: string): IMediaQueryCondition {\n    const conjunctions = query.split(/\\sor\\s|,/).map((term) => {\n      const conditions = term.split(/\\sand\\s/).map(ESLMediaQuery.parseSimpleQuery);\n      return new MediaQueryConjunction(conditions);\n    });\n    return new MediaQueryDisjunction(conjunctions).optimize();\n  }\n\n  /** Preprocess simple query term by applying replacers and shortcuts rules */\n  protected static preprocess(term: string): string {\n    if (!this.SHORTCUT_PATTERN.test(term)) return term;\n    const shortcut = term.trim().substring(1).toLowerCase();\n    for (const replacer of this._preprocessors) {\n      const result = replacer.process(shortcut);\n      if (typeof result === 'string') return result;\n      if (typeof result === 'boolean') return result ? 'all' : 'not all';\n    }\n    return term;\n  }\n\n  /** Creates simple {@link ESLMediaQuery} condition */\n  protected static parseSimpleQuery(term: string): IMediaQueryCondition {\n    const query = term.replace(/^\\s*not\\s+/, '');\n    const queryInverted = query !== term;\n    const processedQuery = ESLMediaQuery.preprocess(query);\n    const sanitizedQuery = processedQuery.replace(/^\\s*not\\s+/, '');\n    const resultInverted = processedQuery !== sanitizedQuery;\n    const invert = queryInverted !== resultInverted;\n\n    if (ALL.eq(sanitizedQuery)) return invert ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(sanitizedQuery)) return invert ? ALL : NOT_ALL;\n    return new MediaQueryCondition(sanitizedQuery, invert);\n  }\n\n  // Implements IESLMQCondition to allow use ESLMediaQuery as IESLMQCondition type alias\n  public abstract matches: boolean;\n  public abstract optimize(): IMediaQueryCondition;\n  public abstract addListener(cb: () => void): void;\n  public abstract removeListener(cb: () => void): void;\n  public abstract toString(): string;\n}\n\n// Register otb preprocessors\nESLMediaQuery.use(ESLScreenDPR);\nESLMediaQuery.use(ESLScreenBreakpoints);\nESLMediaQuery.use(ESLEnvShortcuts);\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaQuery: typeof ESLMediaQuery;\n  }\n}\n","import {ESLMediaQuery} from './esl-media-query';\n\nexport type RulePayloadParser<T> = (val: string) => T | undefined;\n\n/**\n * ESL Media Rule\n * @author Yuliya Adamskaya\n *\n * Helper class to wrap {@link ESLMediaQuery} with the payload value\n * @see ESLMediaQuery\n * @see ESLMediaRuleList\n */\nexport class ESLMediaRule<T = any> {\n  private readonly _query: ESLMediaQuery;\n  private readonly _payload: T;\n  private readonly _default: boolean;\n\n  constructor(payload: T, query: string = '') {\n    this._query = ESLMediaQuery.for(query);\n    this._default = !query;\n    this._payload = payload;\n  }\n\n  public toString(): string {\n    return `${this._query} => ${this._payload}`;\n  }\n\n  /** Subscribes on inner {@link ESLMediaQuery} changes */\n  public addListener(listener: () => void): void {\n    this._query.addListener(listener);\n  }\n  /** Unsubscribes from inner {@link ESLMediaQuery} changes */\n  public removeListener(listener: () => void): void {\n    this._query.removeListener(listener);\n  }\n\n  /** @returns if the inner {@link ESLMediaQuery} is matching current device configuration */\n  public get matches(): boolean {\n    return this._query.matches;\n  }\n  /** @returns wrapped payload value */\n  public get payload(): T {\n    return this._payload;\n  }\n  /**\n   * @returns if the rule was created with an empty query\n   * @see ESLMediaRuleList\n   */\n  public get default(): boolean {\n    return this._default;\n  }\n\n  /**\n   * Creates the {@link ESLMediaRule} instance from payload string, query and valueParser.\n   * If the payload parse result is undefined then rule will be undefined.\n   */\n  public static create<U>(payload: string, query: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const payloadValue = parser(payload.trim());\n    if (typeof payloadValue === 'undefined') return undefined;\n    return new ESLMediaRule<U>(payloadValue, query.trim());\n  }\n\n  /** Parses the rule string to the {@link ESLMediaRule} instance */\n  public static parse<U>(lex: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const parts = lex.split('=>');\n    const query = parts.length === 2 ? parts[0] : '';\n    const payload = parts.length === 2 ? parts[1] : parts[0];\n    return ESLMediaRule.create(payload, query, parser);\n  }\n\n  /** Shortcut to create always active {@link ESLMediaRule} with passed value */\n  public static all<U>(payload: U): ESLMediaRule<U> {\n    return new ESLMediaRule<U>(payload, 'all');\n  }\n  /** Shortcut to create condition-less {@link ESLMediaRule} */\n  public static default<U>(payload: U): ESLMediaRule<U> {\n    return new ESLMediaRule<U>(payload);\n  }\n  /** Shortcut to create always inactive {@link ESLMediaRule} */\n  public static empty(): ESLMediaRule<undefined> {\n    return new ESLMediaRule(undefined, 'all');\n  }\n}\n","import {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLImage} from './esl-image';\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Image lazy loading IntersectionObserver instance */\nexport function getIObserver(): IntersectionObserver {\n  if (!iObserver) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [0.01], // 0 + 1 are not correctly handled by all browsers\n      rootMargin: DeviceDetector.isMobile ? '250px' : '500px' // rootMargin value for IntersectionObserver\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const {target: image} = entry;\n  if (!(image instanceof ESLImage)) return;\n\n  // Check that entry is going to appear in the viewport area\n  if (entry.isIntersecting || entry.intersectionRatio > 0) {\n    image.triggerLoad();\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {Observable} from '../../esl-utils/abstract/observable';\nimport {evaluate} from '../../esl-utils/misc/format';\nimport {isPrimitive} from '../../esl-utils/misc/object';\nimport {ESLMediaRule} from './esl-media-rule';\n\nimport type {RulePayloadParser} from './esl-media-rule';\n\nexport type RuleChangedCallback<T> = (rule: ESLMediaRule<T | undefined>, list: ESLMediaRuleList<T>) => void;\n\n/**\n * ESLMediaRuleList - {@link ESLMediaRule} observable collection\n * @author Yuliya Adamskaya\n *\n * Represents observable object that wraps environment to value mapping\n */\n@ExportNs('MediaRuleList')\nexport class ESLMediaRuleList<T = any> extends Observable<RuleChangedCallback<T>> {\n  /** String value parser (default) */\n  public static STRING_PARSER: RulePayloadParser<string> = String;\n  /** Object value parser. Uses {@link evaluate} to parse value */\n  public static OBJECT_PARSER = <U = any>(val: string): U | undefined => evaluate(val);\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Uses exact strings as rule list values\n   * @param query - query string\n   */\n  public static parse(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * @param query - query string\n   * @param parser - value parser function\n   */\n  public static parse<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parse(query: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const rules: ESLMediaRule[] = [];\n    query.split('|').forEach((lex: string) => {\n      const rule = ESLMediaRule.parse(lex, parser);\n      if (!rule) return;\n      rule.default ? rules.unshift(rule) : rules.push(rule);\n    });\n    return new ESLMediaRuleList(rules);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from two strings with a value  and conditions tuple\n   *\n   * @param values - values tuple string (uses '|' as separator)\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('1|2|3|4|5', '@XS|@SM|@MD|@LG|@XL')\n   * ```\n   */\n  public static parseTuple(values: string, mask: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with a value  and conditions tuple\n   *\n   * @param values - values tuple string (uses '|' as separator)\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param parser - value parser function\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('1|2|3|4|5', '@XS|@SM|@MD|@LG|@XL', Number)\n   * ```\n   */\n  public static parseTuple<U>(values: string, mask: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parseTuple(values: string, mask: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const valueList = values.split('|');\n    const conditions = mask.split('|');\n    if (valueList.length !== conditions.length) throw new Error('Value doesn\\'t correspond to mask');\n    const rules: (ESLMediaRule | undefined)[] = conditions.map((query, i) => ESLMediaRule.create(valueList[i], query, parser));\n    const validRules = rules.filter((rule) => !!rule) as ESLMediaRule[];\n    return new ESLMediaRuleList(validRules);\n  }\n\n  private readonly _rules: ESLMediaRule<T>[];\n  private readonly _default: ESLMediaRule<T | undefined> | undefined;\n  private _active: ESLMediaRule<T | undefined>;\n\n  private constructor(rules: ESLMediaRule<T>[]) {\n    super();\n    this._rules = rules;\n    this._default = rules.filter((rule) => rule.default)[0];\n    this._onMatchChanged = this._onMatchChanged.bind(this);\n  }\n\n  /** Subscribes to the instance active rule change */\n  public addListener(listener: RuleChangedCallback<T>): void {\n    super.addListener(listener);\n    if (this._listeners.size > 1) return;\n    this._rules.forEach((rule) => rule.addListener(this._onMatchChanged));\n  }\n\n  /** Unsubscribes from the instance active rule change */\n  public removeListener(listener: RuleChangedCallback<T>): void {\n    super.removeListener(listener);\n    if (this._listeners.size) return;\n    this._rules.forEach((rule) => rule.removeListener(this._onMatchChanged));\n  }\n\n  /** Array of {@link ESLMediaRule}s that forms the current {@link ESLMediaRuleList} */\n  public get rules(): ESLMediaRule<T>[] {\n    return this._rules;\n  }\n\n  /** Cached active {@link ESLMediaRule} */\n  public get active(): ESLMediaRule<T | undefined> {\n    if (!this._active || !this._listeners.size) {\n      this._active = this.activeRule;\n    }\n    return this._active;\n  }\n\n  /** The last active rule in the list */\n  public get activeRule(): ESLMediaRule<T | undefined> {\n    const satisfiedRules = this.rules.filter((rule) => rule.matches);\n    return satisfiedRules.length > 0 ? satisfiedRules[satisfiedRules.length - 1] : ESLMediaRule.empty();\n  }\n\n  /** Active rule payload value */\n  public get activeValue(): T | undefined {\n    const value = this.active.payload;\n    if (isPrimitive(value) || !this.default || isPrimitive(this.default.payload)) return value;\n    return Object.assign({}, this.default.payload || {}, value);\n  }\n\n  /** {@link ESLMediaRule} that is used as a default rule */\n  public get default(): ESLMediaRule<T | undefined> | undefined {\n    return this._default;\n  }\n\n  /** Handles inner rules state change */\n  private _onMatchChanged(): void {\n    const rule = this.activeRule;\n    if (this._active === rule) return;\n    this.fire(this._active = rule, this);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaRuleList: typeof ESLMediaRuleList;\n  }\n}\n","/** Check that `nodeA` and `nodeB` are from the same tree path */\nexport const isRelativeNode = (nodeA: Node | null, nodeB: Node | null): boolean => {\n  return !!(nodeA && nodeB) && (nodeA.contains(nodeB) || nodeB.contains(nodeA));\n};\n\n/** Create function that finds next dom element, that matches selector, in the sequence declared by `next` function */\nexport const createSequenceFinder = (next: (el: Element) => Element | null) => {\n  return function (base: Element, sel: string): Element | null {\n    for (let target: Element | null = next(base); target; target = next(target)) {\n      if (!sel || target.matches(sel)) return target;\n    }\n    return null;\n  };\n};\n\n/** @returns first matching next sibling or null*/\nexport const findNext = createSequenceFinder((el) => el.nextElementSibling);\n/** @returns first matching previous sibling or null*/\nexport const findPrev = createSequenceFinder((el) => el.previousElementSibling);\n/** @returns first matching parent or null*/\nexport const findParent = createSequenceFinder((el) => el.parentElement);\n\n/** @returns Array of all matching elements in subtree or empty array */\nexport const findAll = (base: Element, sel: string): Element[] => {\n  return sel ? Array.from(base.querySelectorAll(sel)) : [base];\n};\n/** @returns Array of all matching children or empty array */\nexport const findChildren = (base: Element, sel: string): Element[] => {\n  return Array.from(base.children).filter((el: Element) => !sel || el.matches(sel));\n};\n\n/**\n * Find closest parent node of `node` by `predicate`.\n * Optional `skipSelf` to skip initial node\n */\nexport const findClosestBy = (node: Node | null, predicate: (node: Node) => boolean, skipSelf = false): Node | null => {\n  let current = skipSelf && node ? node.parentNode : node;\n  while (current) {\n    if (predicate(current)) return current;\n    current = current.parentNode;\n  }\n  return null;\n};\n\n/** @deprecated Cumulative traversing utility set */\nexport abstract class TraversingUtils {\n  static isRelative = isRelativeNode;\n  static closestBy = findClosestBy;\n  static createSequenceFinder = createSequenceFinder;\n\n  static findNext = findNext;\n  static findPrev = findPrev;\n  static findParent = findParent;\n\n  static findAll = findAll;\n  static findChildren = findChildren;\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {tuple, wrap, uniq} from '../../esl-utils/misc/array';\nimport {unwrapParenthesis} from '../../esl-utils/misc/format';\nimport {findAll, findChildren, findNext, findParent, findPrev} from '../../esl-utils/dom/traversing';\n\ntype ProcessorDescriptor = [string?, string?];\ntype ElementProcessor = (base: Element, sel: string) => Element | Element[] | null;\ntype CollectionProcessor = (els: Element[], sel: string) => Element[];\n\n/**\n * Traversing Query utility to find element via extended selector query\n * Extended query supports\n * - plain CSS selectors\n * - relative selectors (selectors that don't start from a plain selector will use passed base Element as a root)\n * - ::next and ::prev sibling pseudo-selectors\n * - ::parent and ::child pseudo-selectors\n * - ::find pseudo-selector\n * - ::first, ::last and :nth(#) limitation pseudo-selectors\n * - ::filter, ::not filtration pseudo-selectors\n *\n * @example\n * - `#id .class [attr]` - find by CSS selector in a current document\n * - ` ` - get current base element\n * - `::next` - get next sibling element\n * - `::prev` - get previous sibling element\n * - `::parent` - get base element parent\n * - `::parent(#id .class [attr])` - find the closest parent matching passed selector\n * - `::child(#id .class [attr])` - find direct child element(s) that match passed selector\n * - `::find(#id .class [attr])` - find child element(s) that match passed selector\n * - `::find(buttons, a)::not([hidden])` - find all buttons and anchors that are not have hidden attribute\n * - `::find(buttons, a)::filter(:first-child)` - find all buttons and anchors that are first child in container\n * - `::parent::child(some-tag)` - find direct child element(s) that match tag 'some-tag' in the parent\n * - `#id .class [attr]::parent` - find parent of element matching selector '#id .class [attr]' in document\n * - `::find(.row)::last::parent` - find parent of the last element matching selector '.row' from the base element subtree\n */\n@ExportNs('TraversingQuery')\nexport class TraversingQuery {\n  private static ELEMENT_PROCESSORS: Record<string, ElementProcessor> = {\n    '::find': findAll,\n    '::next': findNext,\n    '::prev': findPrev,\n    '::child': findChildren,\n    '::parent': findParent\n  };\n  private static COLLECTION_PROCESSORS: Record<string, CollectionProcessor> = {\n    '::first': (list: Element[]) => list.slice(0, 1),\n    '::last': (list: Element[]) => list.slice(-1),\n    '::nth': (list: Element[], sel?: string) => {\n      const index = sel ? +sel : NaN;\n      return wrap(list[index - 1]);\n    },\n    '::not': (list: Element[], sel?: string) => list.filter((el) => !el.matches(sel || '')),\n    '::filter': (list: Element[], sel?: string) => list.filter((el) => el.matches(sel || ''))\n  };\n\n  /**\n   * @returns RegExp that selects all known processors in query string\n   * e.g. /(::parent|::child|::next|::prev)/\n   */\n  private static get PROCESSORS_REGEX(): RegExp {\n    const keys = Object.keys(this.ELEMENT_PROCESSORS).concat(Object.keys(this.COLLECTION_PROCESSORS));\n    return new RegExp(`(${keys.join('|')})`, 'g');\n  }\n\n  private static isCollectionProcessor([name]: ProcessorDescriptor): boolean {\n    return !!name && (name in this.COLLECTION_PROCESSORS);\n  }\n  private static processElement(el: Element, [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.ELEMENT_PROCESSORS)) return [];\n    return wrap(this.ELEMENT_PROCESSORS[name](el, sel));\n  }\n  private static processCollection(els: Element[], [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.COLLECTION_PROCESSORS)) return [];\n    return wrap(this.COLLECTION_PROCESSORS[name](els, sel));\n  }\n\n  private static traverseChain(collection: Element[], processors: ProcessorDescriptor[], findFirst: boolean): Element[] {\n    if (!processors.length || !collection.length) return collection;\n    const [processor, ...rest] = processors;\n    if (this.isCollectionProcessor(processor)) {\n      const processedItem = this.processCollection(collection, processor);\n      return this.traverseChain(processedItem, rest, findFirst);\n    }\n    const result: Element[] = [];\n    for (const target of collection) {\n      const processedItem = this.processElement(target, processor);\n      const resultCollection: Element[] = this.traverseChain(processedItem, rest, findFirst);\n      if (!resultCollection.length) continue;\n      if (findFirst) return resultCollection.slice(0, 1);\n      result.push(...resultCollection);\n    }\n    return uniq(result);\n  }\n\n  static traverse(query: string, findFirst: boolean, base?: Element | null, scope: Element | Document = document): Element[] {\n    const parts = query.split(this.PROCESSORS_REGEX).map((term) => term.trim());\n    const rootSel = parts.shift();\n    const baseCollection = base ? [base] : [];\n    const initial: Element[] = rootSel ? Array.from(scope.querySelectorAll(rootSel)) : baseCollection;\n    return this.traverseChain(initial, tuple(parts), findFirst);\n  }\n\n  /** @returns first matching element reached via {@link TraversingQuery} rules */\n  static first(query: string, base?: Element | null, scope?: Element): Element | null {\n    return TraversingQuery.traverse(query, true, base, scope)[0] || null;\n  }\n  /** @returns Array of all matching elements reached via {@link TraversingQuery} rules */\n  static all(query: string, base?: Element | null, scope?: Element): Element[] {\n    return TraversingQuery.traverse(query, false, base, scope);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    TraversingQuery: typeof TraversingQuery;\n  }\n}\n","import {ESLImage} from './esl-image';\n\n/**\n * Describe mods configurations\n */\nexport interface ESLImageRenderStrategy {\n  /** Apply image from shadow loader */\n  apply: (img: ESLImage, shadowImg: HTMLImageElement) => void;\n  /** Clean strategy specific changes from ESLImage */\n  clear: (img: ESLImage) => void;\n}\n\n/**\n * Describes object that contains strategies mapping\n */\nexport interface ESLImageStrategyMap {\n  [mode: string]: ESLImageRenderStrategy;\n}\n\nexport const STRATEGIES: ESLImageStrategyMap = {\n  'cover': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || ESLImage.isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n    },\n    clear(img): void {\n      img.style.backgroundImage = '';\n    }\n  },\n  'save-ratio': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || ESLImage.isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n      if (shadowImg.width === 0) return;\n      img.style.paddingTop = isEmpty ? '' : `${(shadowImg.height * 100 / shadowImg.width)}%`;\n    },\n    clear(img): void {\n      img.style.paddingTop = '';\n      img.style.backgroundImage = '';\n    }\n  },\n  'fit': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.removeAttribute('width');\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'origin': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.width = shadowImg.width / window.devicePixelRatio;\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'inner-svg': {\n    apply(img, shadowImg): void {\n      const request = new XMLHttpRequest();\n      request.open('GET', shadowImg.src, true);\n      request.onreadystatechange = (): void => {\n        if (request.readyState !== 4 || request.status !== 200) return;\n        const tmp = document.createElement('div');\n        tmp.innerHTML = request.responseText;\n        Array.from(tmp.querySelectorAll('script') || [])\n          .forEach((node: Element) => node.remove());\n        img.innerHTML = tmp.innerHTML;\n      };\n      request.send();\n    },\n    clear(img): void {\n      img.innerHTML = '';\n    }\n  }\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core/esl-traversing-query';\n\nimport {getIObserver} from './esl-image-iobserver';\nimport {STRATEGIES} from './esl-image-strategies';\n\nimport type {ESLImageRenderStrategy, ESLImageStrategyMap} from './esl-image-strategies';\n\ntype LoadState = 'error' | 'loaded' | 'ready';\nconst isLoadState = (state: string): state is LoadState => ['error', 'loaded', 'ready'].includes(state);\n\n/**\n * ESLImage - custom element, that provides flexible ways to include images on web pages.\n * Was originally developed as an alternative to `<picture>` element, but with more features inside.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Image')\nexport class ESLImage extends ESLBaseElement {\n  public static is = 'esl-image';\n\n  // Default container class value\n  public static DEFAULT_CONTAINER_CLS = 'img-container-loaded';\n\n  public static get STRATEGIES(): ESLImageStrategyMap {\n    return STRATEGIES;\n  }\n\n  static get EMPTY_IMAGE(): string {\n    return 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  static get observedAttributes(): string[] {\n    return ['alt', 'role', 'mode', 'aria-label', 'data-src', 'data-src-base', 'lazy-triggered'];\n  }\n\n  @attr() public alt: string;\n  @attr({defaultValue: 'save-ratio'}) public mode: string;\n  @attr({dataAttr: true}) public src: string;\n  @attr({dataAttr: true}) public srcBase: string;\n\n  @attr({defaultValue: 'none'}) public lazy: 'auto' | 'manual' | 'none' | '';\n  @boolAttr() public lazyTriggered: boolean;\n\n  @boolAttr() public refreshOnUpdate: boolean;\n  @attr({defaultValue: 'inner-image'}) public innerImageClass: string;\n\n  @attr({defaultValue: null}) public containerClass: string | null;\n  @attr({defaultValue: '::parent'}) public containerClassTarget: string;\n  @attr({defaultValue: 'ready'}) public containerClassState: string;\n\n  @boolAttr({readonly: true}) public readonly ready: boolean;\n  @boolAttr({readonly: true}) public readonly loaded: boolean;\n  @boolAttr({readonly: true}) public readonly error: boolean;\n\n  private _strategy: ESLImageRenderStrategy | null;\n  private _innerImg: HTMLImageElement | null;\n  private _srcRules: ESLMediaRuleList<string>;\n  private _currentSrc: string;\n  private _detachLazyTrigger: () => void;\n  private _shadowImageElement: HTMLImageElement;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.alt =\n      this.alt || this.getAttribute('aria-label') || this.getAttribute('data-alt') || '';\n    this.updateA11y();\n    this.srcRules.addListener(this._onMediaMatchChange);\n    if (this.lazyObservable) {\n      this.removeAttribute('lazy-triggered');\n      getIObserver().observe(this);\n      this._detachLazyTrigger = function (): void {\n        getIObserver().unobserve(this);\n        this._detachLazyTrigger = null;\n      };\n    }\n    this.refresh();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._detachLazyTrigger && this._detachLazyTrigger();\n    if (this._srcRules) {\n      this._srcRules.removeListener(this._onMediaMatchChange);\n    }\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'aria-label':\n        this.alt = newVal || '';\n        break;\n      case 'alt':\n      case 'role':\n        this.updateA11y();\n        break;\n      case 'data-src':\n        this.srcRules = ESLMediaRuleList.parse(newVal);\n        this.refresh();\n        break;\n      case 'data-src-base':\n        this.refresh();\n        break;\n      case 'mode':\n        this.changeMode(oldVal, newVal);\n        break;\n      case 'lazy-triggered':\n        this.lazyTriggered && this.update();\n        break;\n    }\n  }\n\n  public get srcRules(): ESLMediaRuleList<string> {\n    if (!this._srcRules) {\n      this.srcRules = ESLMediaRuleList.parse(this.src);\n    }\n    return this._srcRules;\n  }\n\n  public set srcRules(rules: ESLMediaRuleList<string>) {\n    if (this._srcRules) {\n      this._srcRules.removeListener(this._onMediaMatchChange);\n    }\n    this._srcRules = rules;\n    this._srcRules.addListener(this._onMediaMatchChange);\n  }\n\n  public get currentSrc(): string {\n    return this._currentSrc;\n  }\n\n  public get empty(): boolean {\n    return !this._currentSrc || ESLImage.isEmptyImage(this._currentSrc);\n  }\n\n  public get canUpdate(): boolean {\n    return this.lazyTriggered || this.lazy === 'none';\n  }\n\n  public get lazyObservable(): boolean {\n    return this.lazy !== 'none' && this.lazy !== 'manual';\n  }\n\n  public get originalWidth(): number {\n    return this._shadowImageElement ? this._shadowImageElement.width : 0;\n  }\n\n  public get originalHeight(): number {\n    return this._shadowImageElement ? this._shadowImageElement.height : 0;\n  }\n\n  public triggerLoad(): void {\n    this.setAttribute('lazy-triggered', '');\n  }\n\n  protected changeMode(oldVal: string, newVal: string): void {\n    oldVal = oldVal || 'save-ratio';\n    newVal = newVal || 'save-ratio';\n    if (oldVal === newVal) return;\n    if (!STRATEGIES[newVal]) {\n      this.mode = oldVal;\n      throw new Error('ESL Image: Unsupported mode: ' + newVal);\n    }\n    this.clearImage();\n    if (this.loaded) this.syncImage();\n  }\n\n  protected update(force: boolean = false): void {\n    if (!this.canUpdate) return;\n\n    const src = this.getPath(this.srcRules.activeValue);\n\n    if (this._currentSrc !== src || !this.ready || force) {\n      this._currentSrc = src;\n      this._shadowImg.src = src;\n\n      if (this.refreshOnUpdate || !this.ready) {\n        this.syncImage();\n      }\n\n      if (this._shadowImg.complete) {\n        this._shadowImgError ? this._onError() : this._onLoad();\n      }\n    }\n\n    this._detachLazyTrigger && this._detachLazyTrigger();\n  }\n\n  protected updateA11y(): void {\n    const role = this.getAttribute('role') || 'img';\n    this.setAttribute('role', role);\n    this.innerImage && (this.innerImage.alt = this.alt);\n    if (role === 'img') this.setAttribute('aria-label', this.alt);\n  }\n\n  protected getPath(src: string | undefined): string {\n    if (!src || src === '0' || src === 'none') {\n      return ESLImage.EMPTY_IMAGE;\n    }\n    return this.srcBase + src;\n  }\n\n  public refresh(): void {\n    this.removeAttribute('loaded');\n    this.removeAttribute('ready');\n    this.updateContainerClasses();\n    this.clearImage();\n    this.update(true);\n  }\n\n  private syncImage(): void {\n    const strategy = STRATEGIES[this.mode];\n    this._strategy = strategy;\n    strategy && strategy.apply(this, this._shadowImg);\n  }\n\n  private clearImage(): void {\n    this._strategy && this._strategy.clear(this);\n    this._strategy = null;\n  }\n\n  public get innerImage(): HTMLImageElement | null {\n    return this._innerImg;\n  }\n\n  public attachInnerImage(): HTMLImageElement {\n    if (!this._innerImg) {\n      this._innerImg = this.querySelector(`img.${this.innerImageClass}`) ||\n        this._shadowImg.cloneNode() as HTMLImageElement;\n      this._innerImg.className = this.innerImageClass;\n    }\n    if (!this._innerImg.parentNode) {\n      this.appendChild(this._innerImg);\n    }\n    this._innerImg.alt = this.alt;\n    return this._innerImg;\n  }\n\n  public removeInnerImage(): void {\n    if (!this.innerImage) return;\n    this.removeChild(this.innerImage);\n    setTimeout(() => {\n      if (this._innerImg && !this._innerImg.parentNode) {\n        this._innerImg = null;\n      }\n    });\n  }\n\n  protected get _shadowImg(): HTMLImageElement {\n    if (!this._shadowImageElement) {\n      this._shadowImageElement = new Image();\n      this._shadowImageElement.onload = this._onLoad;\n      this._shadowImageElement.onerror = this._onError;\n    }\n    return this._shadowImageElement;\n  }\n\n  protected get _shadowImgError(): boolean {\n    if (!this._shadowImg.complete) return false;\n    if (this._shadowImg.src.substr(-4) === '.svg') return false;\n    return this._shadowImg.naturalHeight <= 0;\n  }\n\n  @bind\n  private _onLoad(): void {\n    this.syncImage();\n    this._onReadyState(true);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onError(): void {\n    this._onReadyState(false);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onMediaMatchChange(): void {\n    this.update();\n  }\n\n  private _onReadyState(successful: boolean): void {\n    if (this.ready) return;\n    this.toggleAttribute('loaded', successful);\n    this.toggleAttribute('error', !successful);\n    this.toggleAttribute('ready', true);\n    this.$$fire(successful ? 'load' : 'error');\n    this.$$fire('ready');\n  }\n\n  public updateContainerClasses(): void {\n    if (this.containerClass === null) return;\n    const cls = this.containerClass || (this.constructor as typeof ESLImage).DEFAULT_CONTAINER_CLS;\n    const state = isLoadState(this.containerClassState) && this[this.containerClassState];\n\n    const targetEl = TraversingQuery.first(this.containerClassTarget, this) as HTMLElement;\n    targetEl && CSSClassUtils.toggle(targetEl, cls, state);\n  }\n\n  public $$fire(eventName: string, eventInit: CustomEventInit = {bubbles: false}): boolean {\n    return EventUtils.dispatch(this, eventName, eventInit);\n  }\n\n  public static isEmptyImage(src: string): boolean {\n    return src === ESLImage.EMPTY_IMAGE;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Image: typeof ESLImage;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-image': ESLImage;\n  }\n}\n","import type {AnyToAnyFnSignature} from '../misc/functions';\n\n/**\n * @returns Promise that will be resolved or rejected in `timeout` with an optional `payload`\n * If `isReject` is `true` the result promise will be rejected, otherwise (by default) the result promise will be resolved\n */\nexport function promisifyTimeout<T>(timeout: number, payload?: T, isReject?: boolean): Promise<T> {\n  return new Promise<T>((resolve, reject) =>\n    setTimeout((isReject ? reject : resolve).bind(null, payload), timeout)\n  );\n}\n\n/** Interface to describe abstract listenable target */\nexport type ListenableTarget = {\n  addEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n  removeEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n};\n\n/**\n * @returns Promise that will be resolved by dispatching `event` on `target`\n * Or it will be rejected in `timeout` if it's specified\n * Optional `options` for addEventListener can be also specified\n */\nexport function promisifyEvent(\n  target: ListenableTarget,\n  event: string,\n  timeout?: number | null | undefined,\n  options?: boolean | AddEventListenerOptions\n): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    function eventCallback(e: Event): void {\n      target.removeEventListener(event, eventCallback, options);\n      resolve(e);\n    }\n\n    target.addEventListener(event, eventCallback, options);\n    if (typeof timeout === 'number' && timeout >= 0) {\n      setTimeout(() => reject(new Error('Rejected by timeout')), timeout);\n    }\n  });\n}\n\n/**\n * Short helper to make Promise from element state marker\n * @returns Promise that will be resolved if the target `marker` property is truthful or `event` is dispatched\n * @example\n * `const imgReady = promisifyMarker(eslImage, 'ready');`\n */\nexport function promisifyMarker(target: HTMLElement, marker: string, event: string = marker): Promise<HTMLElement> {\n  if ((target as any)[marker]) return Promise.resolve(target);\n  return promisifyEvent(target, event).then(() => target);\n}\n\n/**\n * Call `callback` limited by `tryCount` amount of times with interval in `timeout` ms\n * @returns Promise that will be resolved as soon as callback returns truthy value, or reject it by limit.\n */\nexport function tryUntil<T>(callback: () => T, tryCount = 2, timeout = 100): Promise<T> {\n  return new Promise((resolve, reject) => {\n    (function check(): void {\n      let result: T | undefined;\n      try {\n        result = callback();\n      } catch {\n        result = undefined;\n      }\n\n      if (result || (tryCount--) < 0) {\n        result ? resolve(result) : reject(new Error('Rejected by limit of tries'));\n      } else {\n        setTimeout(check, timeout);\n      }\n    })();\n  });\n}\n\n/**\n * Call async callback in a sequence passed number of times\n * Initial call starts as a microtask\n * @param callback - async chain function\n * @param count - count o calls\n * @returns sequence end promise\n */\nexport function repeatSequence<T>(callback: () => Promise<T>, count = 1): Promise<T> {\n  if (count < 1) return Promise.reject();\n  if (count === 1) return Promise.resolve().then(callback);\n  return repeatSequence(callback, count - 1).then(callback);\n}\n\n/** Deferred object represents promise with it's resolve/reject methods */\nexport type Deferred<T> = {\n  /** Wrapped promise */\n  promise: Promise<T>;\n  /** Function that resolves wrapped promise */\n  resolve: (arg: T) => void;\n  /** Function that rejects wrapped promise */\n  reject: (arg?: any) => void;\n};\n\n/**\n * Create Deferred Object that wraps promise and its resolve and reject callbacks\n */\nexport function createDeferred<T>(): Deferred<T> {\n  let reject: any;\n  let resolve: any;\n  // Both reject and resolve will be assigned anyway while the Promise constructing.\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {promise, resolve, reject};\n}\n\n/** Creates function type with the same signature but with the result type wrapped into promise */\nexport type PromisifyResultFn<F extends AnyToAnyFnSignature> =\n  ((...args: Parameters<F>) => Promise<ReturnType<F> | void>);\n\n/**\n * Safe wrap for Promise.resolve to use in Promise chain\n * @example\n * `const resolvedPromise = rejectedPromise.catch(resolvePromise);`\n */\nexport function resolvePromise<T>(arg: T | PromiseLike<T>): Promise<T> {\n  return Promise.resolve(arg);\n}\n\n/**\n * Safe wrap for Promise.reject to use in Promise chain\n * @example\n * `const rejectedPromise = resolvedPromise.then(rejectPromise);`\n */\nexport function rejectPromise<T = never>(arg?: T | PromiseLike<T>): Promise<T> {\n  return Promise.reject(arg);\n}\n\n/**\n * Promise utils helper class\n * Note: use individual methods in case you need correct \"tree shaking\"\n */\nexport abstract class PromiseUtils {\n  static fromTimeout = promisifyTimeout;\n  static fromEvent = promisifyEvent;\n  static fromMarker = promisifyMarker;\n\n  static repeat = repeatSequence;\n  static tryUntil = tryUntil;\n\n  static deferred = createDeferred;\n  static resolve = resolvePromise;\n  static reject = rejectPromise;\n}\n","import {createDeferred} from './promise';\n\nimport type {AnyToAnyFnSignature} from '../misc/functions';\nimport type {Deferred} from './promise';\n\n/** Debounced<F> is a function wrapper type for a function decorated via debounce */\nexport interface Debounced<F extends AnyToAnyFnSignature> {\n  /** Debounced method signature */\n  (...args: Parameters<F>): void;\n  /** Promise of deferred function call */\n  promise: Promise<ReturnType<F> | void>;\n  /** Cancel debounced call */\n  cancel(): void;\n}\n\n/**\n * Creates a debounced function that implements {@link Debounced}.\n * Debounced function delays invoking func until after wait milliseconds have elapsed\n * since the last time the debounced function was invoked.\n * The func is invoked with the last arguments provided to the debounced function.\n * @param fn - function to decorate\n * @param wait - time to debounce\n * @param thisArg - optional context to call original function, use debounced method call context if not defined\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function debounce<F extends AnyToAnyFnSignature>(fn: F, wait = 10, thisArg?: object): Debounced<F> {\n  let timeout: number | null = null;\n  let deferred: Deferred<ReturnType<F>> | null = null;\n\n  function debouncedSubject(...args: any[]): void {\n    deferred = deferred || createDeferred();\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = window.setTimeout(() => {\n      timeout = null;\n      // fn.apply to save call context\n      deferred!.resolve(fn.apply(thisArg || this, args));\n      deferred = null;\n    }, wait);\n  }\n  function cancel(): void {\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = null;\n    deferred?.reject();\n    deferred = null;\n  }\n\n  Object.defineProperty(debouncedSubject, 'promise', {\n    get: () => deferred ? deferred.promise : Promise.resolve()\n  });\n  Object.defineProperty(debouncedSubject, 'cancel', {\n    writable: false,\n    enumerable: false,\n    value: cancel\n  });\n\n  return debouncedSubject as Debounced<F>;\n}\n","export const TAB = 'Tab';\nexport const ENTER = 'Enter';\nexport const ESC = 'Escape';\nexport const SPACE = ' ';\nexport const BACKSPACE = 'Backspace';\n\nexport const ALT = 'Alt';\nexport const SHIFT = 'Shift';\nexport const CONTROL = 'Control';\n\nexport const PAUSE = 'Pause';\nexport const END = 'End';\nexport const HOME = 'Home';\nexport const DELETE = 'Delete';\n\nexport const PAGE_UP = 'PageUp';\nexport const PAGE_DOWN = 'PageDown';\n\nexport const ARROW_LEFT = 'ArrowLeft';\nexport const ARROW_UP = 'ArrowUp';\nexport const ARROW_RIGHT = 'ArrowRight';\nexport const ARROW_DOWN = 'ArrowDown';\n\nexport const SYSTEM_KEYS = [TAB, ALT, SHIFT, CONTROL, PAGE_UP, PAGE_DOWN, ARROW_LEFT, ARROW_UP, ARROW_RIGHT, ARROW_DOWN];\n","import {ESLMedia} from './esl-media';\n\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable, at least global\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable, at least global\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Media Play-In-Viewport IntersectionObserver instance */\nexport function getIObserver(lazy: boolean = false): IntersectionObserver {\n  if (!iObserver && !lazy) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const {target: video} = entry;\n  if (!(video instanceof ESLMedia)) return;\n\n  // Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\n  if (video.active && entry.intersectionRatio <= RATIO_TO_DEACTIVATE) {\n    video.pause();\n  }\n  // Play should starts only for inactive and background(muted) videos that are visible more then on RATIO_TO_ACTIVATE\n  if (!video.active && video.autoplay && entry.intersectionRatio >= RATIO_TO_ACTIVATE) {\n    video.play();\n  }\n}\n","import {ESLMediaProviderRegistry} from './esl-media-registry';\n\nimport type {ESLMedia} from './esl-media';\n\nexport enum PlayerStates {\n  BUFFERING = 3,\n  ENDED = 0,\n  PAUSED = 2,\n  PLAYING = 1,\n  UNSTARTED = -1,\n  VIDEO_CUED = 5,\n  UNINITIALIZED = -2\n}\n\nexport interface MediaProviderConfig {\n  mediaSrc?: string;\n  mediaId?: string;\n  loop: boolean;\n  muted: boolean;\n  controls: boolean;\n  autoplay: boolean;\n  title: string;\n  preload?: 'none' | 'metadata' | 'auto' | '';\n  playsinline?: boolean;\n}\n\nexport type ProviderType = (new(component: ESLMedia, config: MediaProviderConfig) => BaseProvider) & typeof BaseProvider;\n\nexport type ProviderObservedParams = 'loop' | 'muted' | 'controls';\n\n/**\n * BaseProvider class for media API providers\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n */\nexport abstract class BaseProvider {\n  static readonly providerName: string;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    return null;\n  }\n  static parseConfig(component: ESLMedia): MediaProviderConfig {\n    const {loop, muted, controls, autoplay, title, preload, playsinline, mediaId, mediaSrc} = component;\n    const config = {loop, muted, controls, autoplay, title, preload, playsinline};\n    if (mediaId) Object.assign(config, {mediaId});\n    if (mediaSrc) Object.assign(config, {mediaSrc});\n    return config;\n  }\n\n  protected config: MediaProviderConfig;\n  protected component: ESLMedia;\n  protected _el: HTMLElement;\n  protected _ready: Promise<any>;\n\n  public constructor(component: ESLMedia, config: MediaProviderConfig) {\n    this.config = config;\n    this.component = component;\n  }\n\n  /** Wraps _ready promise */\n  get ready(): Promise<any> {\n    if (!this._ready) {\n      const res = Promise.reject('Not Initialized');\n      res.catch((e) => console.log('Rejected Media Operation: ', e));\n      return res;\n    }\n    return this._ready;\n  }\n\n  /** Bind the provider instance to the component */\n  public abstract bind(): void;\n\n  /** Unbind the provider instance from the component */\n  public unbind(): void {\n    Array.from(this.component.querySelectorAll('.esl-media-inner'))\n      .forEach((el: Node) => el.parentNode && el.parentNode.removeChild(el));\n  }\n\n  /** Provider name */\n  public get name(): string {\n    return (this.constructor as typeof BaseProvider).providerName;\n  }\n\n  /** @returns current state of the player */\n  public abstract get state(): PlayerStates;\n\n  /** @returns recommended aspect ratio */\n  public abstract get defaultAspectRatio(): number;\n\n  /** @returns resource duration */\n  public abstract get duration(): number;\n\n  /** @returns resource current time */\n  public abstract get currentTime(): number;\n\n  /** Low-level provider 'seek to' method implementation */\n  protected abstract seekTo(pos?: number): void | Promise<any>;\n\n  /** Low-level provider 'play' method implementation */\n  protected abstract play(): void | Promise<any>;\n\n  /** Low-level provider 'pause' method implementation */\n  protected abstract pause(): void | Promise<any>;\n\n  /** Low-level provider 'stop' method implementation */\n  protected abstract stop(): void | Promise<any>;\n\n  /** Set focus to the inner content */\n  public focus(): void {\n    this._el?.focus();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.config[param] = value;\n  }\n\n  /** Set size for inner content */\n  public setSize(width: number | 'auto', height: number | 'auto'): void {\n    if (!this._el) return;\n    this._el.style.setProperty('width', width === 'auto' ? null : `${width}px`);\n    this._el.style.setProperty('height', height === 'auto' ? null : `${height}px`);\n  }\n\n  /**\n   * Executes toggle action:\n   * If the player is PAUSED then it starts playing otherwise it pause playing\n   */\n  protected toggle(): void | Promise<any> {\n    if ([PlayerStates.PAUSED, PlayerStates.UNSTARTED, PlayerStates.VIDEO_CUED].includes(this.state)) {\n      return this.play();\n    } else {\n      return this.pause();\n    }\n  }\n\n  /** Executes onConfigChange action when api is ready */\n  public onSafeConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.ready.then(() => this.onConfigChange(param, value));\n  }\n\n  /** Executes seekTo action when api is ready */\n  public safeSeekTo(pos: number): Promise<void> {\n    return this.ready.then(() => this.seekTo(pos));\n  }\n\n  /** Executes play when api is ready */\n  public safePlay(): Promise<void> {\n    return this.ready.then(() => this.play());\n  }\n\n  /** Executes pause when api is ready */\n  public safePause(): Promise<void> {\n    return this.ready.then(() => this.pause());\n  }\n\n  /**\n   * Executes stop when api is ready\n   * @returns Promise\n   */\n  public safeStop(): Promise<void> {\n    return this.ready.then(() => this.stop());\n  }\n\n  /**\n   * Executes toggle when api is ready\n   * @returns Promise\n   */\n  public safeToggle(): Promise<void> {\n    return this.ready.then(() => this.toggle());\n  }\n\n  /**\n   * Register current provider.\n   * Can be used as a decorator.\n   */\n  public static register(this: ProviderType): void;\n  public static register(this: unknown, provider?: ProviderType): void;\n  public static register(this: any, provider?: ProviderType): void {\n    provider = provider || this;\n    if (provider === BaseProvider) throw new Error('`BaseProvider` can\\'t be registered.');\n    if (!(provider?.prototype instanceof BaseProvider)) throw new Error('Provider should be instanceof `BaseProvider`');\n    ESLMediaProviderRegistry.instance.register(provider);\n  }\n}\n","import {Observable} from '../../esl-utils/abstract/observable';\nimport type {BaseProvider, ProviderType} from './esl-media-provider';\n\nimport type {ESLMedia} from './esl-media';\n\nlet evRegistryInstance: ESLMediaProviderRegistry | null = null;\n/**\n * ESLMediaProviderRegistry class to store media API providers\n * @author Yuliya Adamskaya, Natallia Harshunova\n */\nexport class ESLMediaProviderRegistry extends Observable<(name: string, provider: ProviderType) => void> {\n  private providersMap: Map<string, ProviderType> = new Map();\n\n  public static get instance(): ESLMediaProviderRegistry {\n    if (!evRegistryInstance) {\n      evRegistryInstance = new ESLMediaProviderRegistry();\n    }\n    return evRegistryInstance;\n  }\n\n  /** List of registered providers */\n  public get providers(): ProviderType[] {\n    const list: ProviderType[] = [];\n    this.providersMap.forEach((provider) => list.push(provider));\n    return list;\n  }\n\n  /** Register provider */\n  public register(provider: ProviderType): void {\n    if (!provider.providerName) throw new Error('Provider should have a name');\n    this.providersMap.set(provider.providerName, provider);\n    this.fire(provider.providerName, provider);\n  }\n\n  /** Check that provider is registered for passed name */\n  public has(name: string): boolean {\n    return this.providersMap.has(name);\n  }\n\n  /** Find provider by name */\n  public findByName(name: string): ProviderType | null {\n    if (!name || name === 'auto') return null;\n    return this.providersMap.get(name.toLowerCase()) || null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance */\n  public createFor(media: ESLMedia): BaseProvider | null {\n    return this.createByType(media) || this.createBySrc(media);\n  }\n\n  /** Create provider instance for passed ESLMedia instance via provider name */\n  private createByType(media: ESLMedia): BaseProvider | null {\n    const provider = this.findByName(media.mediaType);\n    return provider ? ESLMediaProviderRegistry._create(provider, media) : null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance via url */\n  private createBySrc(media: ESLMedia): BaseProvider | null {\n    for (const provider of this.providers.reverse()) {\n      const cfg = provider.parseUrl(media.mediaSrc);\n      if (cfg) return ESLMediaProviderRegistry._create(provider, media, cfg);\n    }\n    return null;\n  }\n\n  /** Create provider instance for passed configuration */\n  private static _create(provider: ProviderType, media: ESLMedia, cfg = provider.parseUrl(media.mediaSrc)): BaseProvider {\n    const config = Object.assign({}, cfg || {}, provider.parseConfig(media));\n    return new provider(media, config);\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst managerMap = new Map<string, ESLMedia>();\n\n/**\n * Group restriction manager for {@link ESLMedia}\n * Only one media in group can be played\n * Empty group is ignored\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\nexport class MediaGroupRestrictionManager {\n  /** @internal */\n  static get managerMap(): Map<string, ESLMedia> {\n    return managerMap;\n  }\n\n  /** Register instance play state in group */\n  public static registerPlay(instance: ESLMedia): void {\n    if (instance.group) {\n      const current = managerMap.get(instance.group);\n      managerMap.set(instance.group, instance);\n      if (!current || current === instance || !current.active) return;\n      if (current.$$fire('mangedpause')) {\n        current.pause();\n      }\n    }\n  }\n\n  /** Unregister instance */\n  public static unregister(instance: ESLMedia): void {\n    if (instance.group) {\n      const reg = managerMap.get(instance.group);\n      if (reg === instance) managerMap.delete(instance.group);\n    }\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {parseAspectRatio} from '../../esl-utils/misc/format';\n\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\n\nimport {SPACE, PAUSE} from '../../esl-utils/dom/keys';\nimport {getIObserver} from './esl-media-iobserver';\nimport {PlayerStates} from './esl-media-provider';\nimport {ESLMediaProviderRegistry} from './esl-media-registry';\nimport {MediaGroupRestrictionManager} from './esl-media-manager';\n\nimport type {BaseProvider} from './esl-media-provider';\n\nexport type ESLMediaFillMode = 'cover' | 'inscribe' | '';\n\n/**\n * ESLMedia - custom element, that provides an ability to add and configure media (video / audio)\n * using a single tag as well as work with external providers using simple native-like API.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Media')\nexport class ESLMedia extends ESLBaseElement {\n  public static is = 'esl-media';\n  public static eventNs = 'esl:media:';\n\n  /** Media resource identifier */\n  @attr() public mediaId: string;\n  /** Media resource src/url path */\n  @attr() public mediaSrc: string;\n  /** Media resource type. 'auto' (auto detection from src) by default */\n  @attr() public mediaType: string;\n\n  /** Media elements group name */\n  @attr() public group: string;\n  /** Media resource rendering strategy relative to the element area: 'cover', 'inscribe' or not defined */\n  @attr() public fillMode: ESLMediaFillMode;\n  /** Strict aspect ratio definition */\n  @attr() public aspectRatio: string;\n\n\n  /** Disabled marker to prevent rendering */\n  @boolAttr() public disabled: boolean;\n  /** Autoplay resource marker */\n  @boolAttr() public autoplay: boolean;\n  /** Autofocus on play marker */\n  @boolAttr() public autofocus: boolean;\n  /** Mute resource marker */\n  @boolAttr() public muted: boolean;\n  /** Loop resource play */\n  @boolAttr() public loop: boolean;\n  /** Marker to show controls for resource player */\n  @boolAttr() public controls: boolean;\n  /** Allow media to play inline (see HTML video/audio spec) */\n  @boolAttr() public playsinline: boolean;\n  /** Allows play resource only in viewport area */\n  @boolAttr() public playInViewport: boolean;\n\n  /** Preload resource */\n  @attr({defaultValue: 'auto'}) public preload: 'none' | 'metadata' | 'auto' | '';\n\n  /** Ready state class/classes */\n  @attr() public readyClass: string;\n  /** Ready state class/classes target */\n  @attr() public readyClassTarget: string;\n\n  /** Class / classes to add when media is accepted */\n  @attr() public loadClsAccepted: string;\n  /** Class / classes to add when media is declined */\n  @attr() public loadClsDeclined: string;\n  /** Condition {@link ESLMediaQuery} to allow load of media resource. Default: `all` */\n  @attr({defaultValue: 'all'}) public loadCondition: string;\n  /** Target element {@link TraversingQuery} select to add accepted/declined classes */\n  @attr({defaultValue: '::parent'}) public loadClsTarget: string;\n\n  /** @readonly Ready state marker */\n  @boolAttr({readonly: true}) public ready: boolean;\n  /** @readonly Active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n  /** @readonly Resource played marker */\n  @boolAttr({readonly: true}) public played: boolean;\n  /** @readonly Error state marker */\n  @boolAttr({readonly: true}) public error: boolean;\n\n  private _provider: BaseProvider | null;\n\n  private deferredResize = rafDecorator(() => this._onResize());\n  private deferredReinitialize = debounce(() => this.reinitInstance());\n\n  /**\n   * Map object with possible Player States, values:\n   * BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\n   */\n  static get PLAYER_STATES(): typeof PlayerStates {\n    return PlayerStates;\n  }\n\n  static get observedAttributes(): string[] {\n    return [\n      'disabled',\n      'load-condition',\n      'media-type',\n      'media-id',\n      'media-src',\n      'fill-mode',\n      'aspect-ratio',\n      'play-in-viewport',\n      'muted',\n      'loop',\n      'controls'\n    ];\n  }\n\n  static supports(name: string): boolean {\n    return ESLMediaProviderRegistry.instance.has(name);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'application');\n    }\n    this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\n    this.bindEvents();\n    this.attachViewportConstraint();\n    this.deferredReinitialize();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this.detachViewportConstraint();\n    this._provider && this._provider.unbind();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'disabled':\n      case 'media-id':\n      case 'media-src':\n      case 'media-type':\n        this.deferredReinitialize();\n        break;\n      case 'loop':\n      case 'muted':\n      case 'controls':\n        this._provider && this._provider.onSafeConfigChange(attrName, newVal !== null);\n        break;\n      case 'fill-mode':\n      case 'aspect-ratio':\n        this.deferredResize();\n        break;\n      case 'play-in-viewport':\n        this.playInViewport ?\n          this.attachViewportConstraint() :\n          this.detachViewportConstraint();\n        break;\n      case 'load-condition':\n        ESLMediaQuery.for(oldVal).removeListener(this.deferredReinitialize);\n        ESLMediaQuery.for(newVal).addListener(this.deferredReinitialize);\n        this.deferredReinitialize();\n        break;\n    }\n  }\n\n  protected bindEvents(): void {\n    ESLMediaProviderRegistry.instance.addListener(this._onRegistryStateChange);\n    this.conditionQuery.addListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.addEventListener('resize', this.deferredResize);\n    }\n    window.addEventListener('esl:refresh', this._onRefresh);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents(): void {\n    ESLMediaProviderRegistry.instance.removeListener(this._onRegistryStateChange);\n    this.conditionQuery.removeListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.removeEventListener('resize', this.deferredResize);\n    }\n    window.removeEventListener('esl:refresh', this._onRefresh);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  public canActivate(): boolean {\n    if (this.disabled) return false;\n    return this.conditionQuery.matches;\n  }\n\n  private reinitInstance(): void {\n    console.debug('[ESL] Media reinitialize ', this);\n    this._provider && this._provider.unbind();\n    this._provider = null;\n\n    if (this.canActivate()) {\n      this._provider = ESLMediaProviderRegistry.instance.createFor(this);\n      if (this._provider) {\n        this._provider.bind();\n        console.debug('[ESL] Media provider bound', this._provider);\n      } else {\n        this._onError();\n      }\n    }\n\n    this.updateContainerMarkers();\n  }\n\n  public updateContainerMarkers(): void {\n    const targetEl = TraversingQuery.first(this.loadClsTarget, this) as HTMLElement;\n    if (!targetEl) return;\n\n    const active = this.canActivate();\n    CSSClassUtils.toggle(targetEl, this.loadClsAccepted, active);\n    CSSClassUtils.toggle(targetEl, this.loadClsDeclined, !active);\n  }\n\n  /** Seek to given position of media */\n  public seekTo(pos: number): Promise<void> | null {\n    return this._provider && this._provider.safeSeekTo(pos);\n  }\n\n  /**\n   * Start playing media\n   * @param allowActivate - allows to remove disabled marker\n   */\n  public play(allowActivate: boolean = false): Promise<void> | null {\n    if (this.disabled && allowActivate) {\n      this.disabled = false;\n      this.deferredReinitialize.cancel();\n      this.reinitInstance();\n    }\n    if (!this.canActivate()) return null;\n    return this._provider && this._provider.safePlay();\n  }\n\n  /** Pause playing media */\n  public pause(): Promise<void> | null {\n    return this._provider && this._provider.safePause();\n  }\n\n  /** Stop playing media */\n  public stop(): Promise<void> | null {\n    return this._provider && this._provider.safeStop();\n  }\n\n  /** Toggle play/pause state of the media */\n  public toggle(): Promise<void> | null {\n    return this._provider && this._provider.safeToggle();\n  }\n\n  /** Focus inner player **/\n  public focusPlayer(): void {\n    this._provider && this._provider.focus();\n  }\n\n  // media live-cycle handlers\n  public _onReady(): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', false);\n    this.updateReadyClass();\n    this.deferredResize();\n    this.$$fire('ready');\n  }\n\n  public _onError(detail?: any, setReadyState = true): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', true);\n    this.$$fire('error', {detail});\n    setReadyState && this.$$fire('ready');\n  }\n\n  public _onDetach(): void {\n    this.removeAttribute('active');\n    this.removeAttribute('ready');\n    this.removeAttribute('played');\n    this.updateReadyClass();\n    this.$$fire('detach');\n  }\n\n  public _onPlay(): void {\n    if (this.autofocus) this.focus();\n    this.deferredResize();\n    this.setAttribute('active', '');\n    this.setAttribute('played', '');\n    this.$$fire('play');\n    MediaGroupRestrictionManager.registerPlay(this);\n  }\n\n  public _onPaused(): void {\n    this.removeAttribute('active');\n    this.$$fire('paused');\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onEnded(): void {\n    this.removeAttribute('active');\n    this.$$fire('ended');\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onResize(): void {\n    if (!this._provider) return;\n    if (this.fillModeEnabled && this.actualAspectRatio > 0) {\n      let stretchVertically = this.offsetWidth / this.offsetHeight < this.actualAspectRatio;\n      if (this.fillMode === 'inscribe') stretchVertically = !stretchVertically; // Inscribe behaves inversely\n      stretchVertically ?\n        this._provider.setSize(this.actualAspectRatio * this.offsetHeight, this.offsetHeight) : // h\n        this._provider.setSize(this.offsetWidth, this.offsetWidth / this.actualAspectRatio);   // w\n    } else {\n      this._provider.setSize('auto', 'auto');\n    }\n  }\n\n  @bind\n  protected _onRefresh(e: Event): void {\n    const {target} = e;\n    if (target instanceof HTMLElement && target.contains(this)) {\n      this._onResize();\n    }\n  }\n\n  @bind\n  protected _onRegistryStateChange(name: string): void {\n    const type = this.mediaType.toLowerCase() || 'auto';\n    if (name === type || (!this.providerType && type === 'auto')) {\n      this.reinitInstance();\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    if (e.target !== this) return;\n    if ([SPACE, PAUSE].includes(e.key)) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.toggle();\n    }\n  }\n\n  /** Update ready class state */\n  protected updateReadyClass(): void {\n    const target = TraversingQuery.first(this.readyClassTarget, this) as HTMLElement;\n    target && CSSClassUtils.toggle(target, this.readyClass, this.ready);\n  }\n\n  /** Applied provider */\n  public get providerType(): string {\n    return this._provider ? this._provider.name : '';\n  }\n\n  /** Current player state, see {@link ESLMedia.PLAYER_STATES} values */\n  public get state(): PlayerStates {\n    return this._provider ? this._provider.state : PlayerStates.UNINITIALIZED;\n  }\n\n  /** Duration of the media resource */\n  public get duration(): number {\n    return this._provider ? this._provider.duration : 0;\n  }\n\n  /** Current time of media resource */\n  public get currentTime(): number {\n    return this._provider ? this._provider.currentTime : 0;\n  }\n\n  /** Set current time of media resource */\n  public set currentTime(time: number) {\n    (this._provider) && this._provider.safeSeekTo(time);\n  }\n\n  /** ESLMediaQuery to limit ESLMedia loading */\n  public get conditionQuery(): ESLMediaQuery {\n    return ESLMediaQuery.for(this.loadCondition);\n  }\n\n  /** Fill mode should be handled for element */\n  public get fillModeEnabled(): boolean {\n    return this.fillMode === 'cover' || this.fillMode === 'inscribe';\n  }\n\n  /** Used resource aspect ratio forced by attribute or returned by provider */\n  public get actualAspectRatio(): number {\n    if (this.aspectRatio && this.aspectRatio !== 'auto') return parseAspectRatio(this.aspectRatio);\n    return this._provider ? this._provider.defaultAspectRatio : 0;\n  }\n\n  protected attachViewportConstraint(): void {\n    if (this.playInViewport) {\n      getIObserver().observe(this);\n    }\n  }\n  protected detachViewportConstraint(): void {\n    const observer = getIObserver(true);\n    observer && observer.unobserve(this);\n  }\n\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    const ns = (this.constructor as typeof ESLMedia).eventNs;\n    return EventUtils.dispatch(this, ns + eventName, eventInit);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Media: typeof ESLMedia;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-media': ESLMedia;\n  }\n}\n","const ns = window || global;\nconst sequences = ns.__esl_sequences__ || new Map<string, number>();\nns.__esl_sequences__ = sequences;\n\ndeclare global {\n  interface Window {\n    __esl_sequences__: Map<string, number>;\n  }\n}\n\n/** Create and return sequential id */\nexport const sequentialUID = (name: string, prefix: string = name): string => {\n  const uid = (sequences.get(name) || 0) + 1;\n  sequences.set(name, uid);\n  return prefix + uid;\n};\n\n/** Return random unique identifier */\nexport const randUID = (prefix: string = ''): string => {\n  const time = Date.now().toString(32);\n  const rand = Math.round(Math.random() * 1024 * 1024).toString(32);\n  return prefix + time + '-' + rand;\n};\n\n/**\n * Generate unique id\n * @deprecated Alias for {@link randUID}\n */\nexport const generateUId = randUID;\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Task placeholder with a single place for executing deferred task.\n * Only one task can be planed per DelayedTask instance.\n * @see put DelayedTask.put behaviour description.\n */\nexport class DelayedTask {\n  protected _fn: AnyToVoidFnSignature | null = null;\n  protected _timeout: number | null = null;\n\n  /** Execute deferred task immediately */\n  protected run = (): void => {\n    this._timeout = null;\n    this._fn && this._fn();\n  };\n\n  /** @returns Function of currently deferred (planned) task */\n  public get fn(): AnyToVoidFnSignature | null {\n    return this._fn;\n  }\n\n  /**\n   * Cancel deferred task and planning passed\n   * @param task - task function\n   * @param delay - time to delay task execution\n   *  - pass negative or false to execute task immediately\n   *  - pass 0 to plan task to the macrotask\n   *  - pass positive number x to delay task on x ms.\n   * */\n  public put(task: AnyToVoidFnSignature, delay: number | string | boolean = false): AnyToVoidFnSignature | null {\n    const prev = this.cancel();\n    if (typeof task === 'function') {\n      if (delay && typeof delay === 'string') delay = +delay;\n      if (typeof delay === 'number' && delay >= 0) {\n        this._fn = task;\n        this._timeout = window.setTimeout(this.run, delay);\n      } else {\n        task();\n      }\n    }\n    return prev;\n  }\n\n  /** Cancel deferred (planned) task */\n  public cancel(): AnyToVoidFnSignature | null {\n    const prev = this._fn;\n    (typeof this._timeout === 'number') && clearTimeout(this._timeout);\n    this._fn = this._timeout = null;\n    return prev;\n  }\n}\n","import {getAttr, setAttr} from '../../esl-utils/dom/attr';\nimport {toKebabCase, evaluate} from '../../esl-utils/misc/format';\nimport type {AttributeDecorator, AttributeTarget} from '../../esl-utils/dom/attr';\n\n/** HTML attribute to object property mapping configuration */\ninterface JsonAttrDescriptor<T> {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n}\n\nfunction buildJsonAttrDescriptor<T>(attrName: string, readOnly: boolean, defaultValue: T | null): PropertyDescriptor {\n  function get(): T | null {\n    const attrContent = getAttr(this, attrName, '').trim();\n    return evaluate(attrContent, defaultValue);\n  }\n\n  function set(value: any): void {\n    try {\n      if (typeof value !== 'object') throw Error('value should be object');\n      setAttr(this, attrName, value ? JSON.stringify(value) : false);\n    } catch (e) {\n      console.error('[ESL] jsonAttr: Can not set json value ', e);\n    }\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value using JSON (de-)serialization rules.\n * Maps object type property.\n * @param config - mapping configuration. See {@link JsonAttrDescriptor}\n */\nexport const jsonAttr = <T>(config: JsonAttrDescriptor<T> = {}): AttributeDecorator => {\n  config = Object.assign({defaultValue: {}}, config);\n  return (target: Element | AttributeTarget, propName: string): void => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildJsonAttrDescriptor(attrName, !!config.readonly, config.defaultValue));\n  };\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESC, SYSTEM_KEYS} from '../../esl-utils/dom/keys';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {defined, copyDefinedKeys} from '../../esl-utils/misc/object';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {DelayedTask} from '../../esl-utils/async/delayed-task';\nimport {ESLBaseElement, attr, jsonAttr, boolAttr} from '../../esl-base-element/core';\n\n/** Default Toggleable action params type definition */\nexport interface ToggleableActionParams {\n  /** Initiator string identifier */\n  initiator?: string;\n  /** Delay timeout for both show and hide actions */\n  delay?: number;\n  /** Show delay timeout */\n  showDelay?: number;\n  /** Hide delay timeout */\n  hideDelay?: number;\n  /** Force action independently of current state of the Toggleable */\n  force?: boolean;\n  /** Do not throw events on action */\n  silent?: boolean;\n  /** Activate hover tracking to hide Toggleable */\n  trackHover?: boolean;\n  /** Element activator of the action */\n  activator?: HTMLElement | null;\n  /** Event that initiates the action */\n  event?: Event;\n\n  /** Custom user data */\n  [key: string]: any;\n}\n\nconst activators: WeakMap<ESLToggleable, HTMLElement | undefined> = new WeakMap();\n\n/**\n * ESLToggleable component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleable - a custom element, that is used as a base for \"Popup-like\" components creation\n */\n@ExportNs('Toggleable')\nexport class ESLToggleable extends ESLBaseElement {\n  static is = 'esl-toggleable';\n  static get observedAttributes(): string[] {\n    return ['open', 'group'];\n  }\n\n  /** CSS class to add on the body element */\n  @attr() public bodyClass: string;\n  /** CSS class to add when the Toggleable is active */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n\n  /** Toggleable group meta information to organize groups */\n  @attr({name: 'group'}) public groupName: string;\n  /** Selector to mark inner close triggers */\n  @attr({name: 'close-on'}) public closeTrigger: string;\n\n  /** Disallow automatic id creation when it's empty */\n  @boolAttr() public noAutoId: boolean;\n  /** Close the Toggleable on ESC keyboard event */\n  @boolAttr() public closeOnEsc: boolean;\n  /** Close the Toggleable on a click/tap outside */\n  @boolAttr() public closeOnOutsideAction: boolean;\n\n  /** Initial params to pass to show/hide action on the start */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: ToggleableActionParams;\n  /** Default params to merge into passed action params */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {}})\n  public defaultParams: ToggleableActionParams;\n  /** Hover params to pass from track hover listener */\n  @jsonAttr<ToggleableActionParams>({defaultValue: {}})\n  public trackHoverParams: ToggleableActionParams;\n\n  /** Marker of initially opened toggleable instance */\n  public initiallyOpened: boolean;\n\n  /** Inner state */\n  private _open: boolean = false;\n\n  /** Inner show/hide task manager instance */\n  protected _task: DelayedTask = new DelayedTask();\n  /** Marker for current hover listener state */\n  protected _trackHover: boolean = false;\n  /** Delay for track hover listeners actions */\n  protected _trackHoverDelay: number | undefined;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.id && !this.noAutoId) {\n      const tag = (this.constructor as typeof ESLToggleable).is;\n      this.id = sequentialUID(tag, tag + '-');\n    }\n    this.initiallyOpened = this.hasAttribute('open');\n    this.bindEvents();\n    this.setInitialState();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    activators.delete(this);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    switch (attrName) {\n      case 'open':\n        if (this.open === this.hasAttribute('open')) return;\n        this.toggle(this.open, {initiator: 'attribute', showDelay: 0, hideDelay: 0});\n        break;\n      case 'group':\n        this.$$fire('change:group',  {\n          detail: {oldGroupName: oldVal, newGroupName: newVal}\n        });\n        break;\n    }\n  }\n\n  /** Set initial state of the Toggleable */\n  protected setInitialState(): void {\n    if (this.initialParams) {\n      this.toggle(this.initiallyOpened, this.initialParams);\n    }\n  }\n\n  protected bindEvents(): void {\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeyboardEvent);\n    this.addEventListener('esl:show:request', this._onShowRequest);\n  }\n\n  protected unbindEvents(): void {\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeyboardEvent);\n    this.removeEventListener('esl:show:request', this._onShowRequest);\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(false);\n  }\n\n  /** Bind outside action event listeners */\n  protected bindOutsideEventTracking(track: boolean): void {\n    document.body.removeEventListener('keydown', this._onOutsideAction, true);\n    document.body.removeEventListener('mouseup', this._onOutsideAction, true);\n    document.body.removeEventListener('touchend', this._onOutsideAction, true);\n    if (track) {\n      document.body.addEventListener('keydown', this._onOutsideAction, true);\n      document.body.addEventListener('mouseup', this._onOutsideAction, true);\n      document.body.addEventListener('touchend', this._onOutsideAction, true);\n    }\n  }\n  /** Bind hover events listeners for the Toggleable itself */\n  protected bindHoverStateTracking(track: boolean, hideDelay?: number | string): void {\n    if (!DeviceDetector.hasHover) return;\n    this._trackHoverDelay = track && hideDelay !== undefined ? +hideDelay : undefined;\n    if (this._trackHover === track) return;\n    this._trackHover = track;\n\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n    if (this._trackHover) {\n      this.addEventListener('mouseenter', this._onMouseEnter);\n      this.addEventListener('mouseleave', this._onMouseLeave);\n    }\n  }\n\n  /** Function to merge the result action params */\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    return Object.assign({}, this.defaultParams, copyDefinedKeys(params));\n  }\n\n  /** Toggle the element state */\n  public toggle(state: boolean = !this.open, params?: ToggleableActionParams): ESLToggleable {\n    return state ? this.show(params) : this.hide(params);\n  }\n\n  /** Change the element state to active */\n  public show(params?: ToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.showTask.bind(this, params), defined(params.showDelay, params.delay));\n    this.bindOutsideEventTracking(this.closeOnOutsideAction);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n  /** Change the element state to inactive */\n  public hide(params?: ToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.hideTask.bind(this, params), defined(params.hideDelay, params.delay));\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n\n  /** Actual show task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected showTask(params: ToggleableActionParams): void {\n    if (!params.force && this.open) return;\n    if (!params.silent && !this.$$fire('before:show', {detail: {params}})) return;\n    this.activator = params.activator;\n    this.open = true;\n    this.onShow(params);\n    if (!params.silent) this.$$fire('show', {detail: {params}, cancelable: false});\n  }\n  /** Actual hide task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected hideTask(params: ToggleableActionParams): void {\n    if (!params.force && !this.open) return;\n    if (!params.silent && !this.$$fire('before:hide', {detail: {params}})) return;\n    this.open = false;\n    this.onHide(params);\n    this.bindOutsideEventTracking(false);\n    if (!params.silent) this.$$fire('hide', {detail: {params}, cancelable: false});\n  }\n\n  /**\n   * Actions to execute on show toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire esl:refresh event by default.\n   */\n  protected onShow(params: ToggleableActionParams): void {\n    CSSClassUtils.add(this, this.activeClass);\n    CSSClassUtils.add(document.body, this.bodyClass, this);\n    this.updateA11y();\n    this.$$fire('refresh'); // To notify other components about content change\n  }\n\n  /**\n   * Actions to execute on hide toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and update a11y by default.\n   */\n  protected onHide(params: ToggleableActionParams): void {\n    CSSClassUtils.remove(this, this.activeClass);\n    CSSClassUtils.remove(document.body, this.bodyClass, this);\n    this.updateA11y();\n  }\n\n  /** Active state marker */\n  public get open(): boolean {\n    return this._open;\n  }\n  public set open(value: boolean) {\n    this.toggleAttribute('open', this._open = value);\n  }\n\n  /** Last component that has activated the element. Uses {@link ToggleableActionParams.activator}*/\n  public get activator(): HTMLElement | null | undefined {\n    return activators.get(this);\n  }\n  public set activator(el: HTMLElement | null | undefined) {\n    el ? activators.set(this, el) : activators.delete(this);\n  }\n\n  /** Returns the element to apply a11y attributes */\n  protected get $a11yTarget(): HTMLElement | null {\n    const target = this.getAttribute('a11y-target');\n    if (target === 'none') return null;\n    return target ? this.querySelector(target) : this;\n  }\n\n  /** Called on show and on hide actions to update a11y state accordingly */\n  protected updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-hidden', String(!this._open));\n  }\n\n  /** @returns if the passed event should trigger hide action */\n  public isOutsideAction(e: Event): boolean {\n    const target = e.target as HTMLElement;\n    // target is inside current toggleable\n    if (this.contains(target)) return false;\n    // target is inside last activator\n    if (this.activator && this.activator.contains(target)) return false;\n    // Event is not a system command key\n    return !(e instanceof KeyboardEvent && SYSTEM_KEYS.includes(e.key));\n  }\n\n  @bind\n  protected _onClick(e: MouseEvent): void {\n    const target = e.target as HTMLElement;\n    if (this.closeTrigger && target.closest(this.closeTrigger)) {\n      this.hide({initiator: 'close', activator: target, event: e});\n    }\n  }\n\n  @bind\n  protected _onOutsideAction(e: Event): void {\n    if (!this.isOutsideAction(e)) return;\n    // Used 0 delay to decrease priority of the request\n    this.hide({initiator: 'outsideaction', hideDelay: 0, event: e});\n  }\n\n  @bind\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    if (this.closeOnEsc && e.key === ESC) {\n      this.hide({initiator: 'keyboard', event: e});\n    }\n  }\n\n  @bind\n  protected _onMouseEnter(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ToggleableActionParams = {initiator: 'mouseenter', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.show(Object.assign(baseParams, this.trackHoverParams));\n  }\n  @bind\n  protected _onMouseLeave(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ToggleableActionParams = {initiator: 'mouseleave', trackHover: true, activator: this.activator, event: e, hideDelay};\n    this.hide(Object.assign(baseParams, this.trackHoverParams));\n  }\n\n  /** Actions to execute on show request */\n  @bind\n  protected _onShowRequest(): void {\n    this.show();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Toggleable: typeof ESLToggleable;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable': ESLToggleable;\n  }\n}\n","export type CopyPredicate = (key: string, value: any) => boolean;\n\n/** Makes a plain copy of obj with properties satisfying the predicate\n * If no predicate provided copies all own properties */\nexport function copy<T>(obj: T, predicate: CopyPredicate = (): boolean => true): Partial<T> {\n  const result: any = Object.assign({}, obj || {});\n  Object.keys(result).forEach((key) => {\n    (!predicate(key, result[key])) && delete result[key];\n  });\n  return result;\n}\n\n/** Makes a flat copy without undefined keys */\nexport function copyDefinedKeys<T>(obj?: T): Partial<T> {\n  return copy(obj || {}, (key, value) => value !== void 0);\n}\n\n/** Omits copying provided properties from object */\nexport function omit<T>(obj: T, keys: string[]): Partial<T> {\n  return copy(obj, key => !keys.includes(key));\n}\n","import {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleable} from './esl-toggleable';\n\n/**\n * ESLToggleableDispatcher\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleableDispatcher - plugin component, that prevents activation of multiple ESLToggleable instances in bounds of managed container.\n */\n@ExportNs('ToggleableDispatcher')\nexport class ESLToggleableDispatcher extends ESLBaseElement {\n  public static readonly is = 'esl-toggleable-dispatcher';\n\n  /**\n   * Initialize ToggleableGroupDispatcher\n   * Uses esl-toggleable-dispatcher tag and document body root by default\n   */\n  public static init(root: HTMLElement = document.body, tagName: string = this.is): void {\n    if (!root) throw new Error('Root element should be specified');\n    const instances = root.getElementsByTagName(tagName);\n    if (instances.length) return;\n    this.register(tagName);\n    root.insertAdjacentElement('afterbegin', document.createElement(tagName));\n  }\n\n  protected _root: HTMLElement | null;\n  protected _popups: Map<string, ESLToggleable> = new Map<string, ESLToggleable>();\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.root = this.parentElement;\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.root = null;\n  }\n\n  protected bindEvents(): void {\n    if (!this.root) return;\n    this.root.addEventListener('esl:before:show', this._onBeforeShow);\n    this.root.addEventListener('esl:show', this._onShow);\n    this.root.addEventListener('esl:hide', this._onHide);\n    this.root.addEventListener('esl:change:group', this._onChangeGroup);\n  }\n  protected unbindEvents(): void {\n    if (!this.root) return;\n    this.root.removeEventListener('esl:before:show', this._onBeforeShow);\n    this.root.removeEventListener('esl:show', this._onShow);\n    this.root.removeEventListener('esl:hide', this._onHide);\n    this.root.removeEventListener('esl:change:group', this._onChangeGroup);\n  }\n\n  /** Observed element */\n  public get root(): HTMLElement | null {\n    return this._root;\n  }\n  public set root(root: HTMLElement | null) {\n    this.unbindEvents();\n    this._root = root;\n    this.bindEvents();\n  }\n\n  /** Guard-condition for targets */\n  protected isAcceptable(target: any): target is ESLToggleable {\n    if (!(target instanceof ESLToggleable)) return false;\n    return !!target.groupName && target.groupName !== 'none';\n  }\n\n  /** Hide active element in group */\n  public hideActive(groupName: string, activator?: HTMLElement): void {\n    const active = this.getActive(groupName);\n    if (!active || active === activator) return;\n    active.hide({\n      initiator: 'dispatcher',\n      dispatcher: this,\n      activator\n    });\n  }\n\n  /** Set active element in group */\n  public setActive(groupName: string, popup: ESLToggleable): void {\n    if (!groupName) return;\n    this.hideActive(groupName, popup);\n    this._popups.set(groupName, popup);\n  }\n\n  /** Get active element in group or undefined if group doesn't exist */\n  public getActive(groupName: string): ESLToggleable | undefined {\n    return this._popups.get(groupName);\n  }\n\n  /** Delete element from the group if passed element is currently active */\n  public deleteActive(groupName: string, popup: ESLToggleable): void {\n    if (this.getActive(groupName) !== popup) return;\n    this._popups.delete(groupName);\n  }\n\n  /** Hide active element before e.target will be shown */\n  @bind\n  protected _onBeforeShow(e: CustomEvent): void {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n    this.hideActive(target.groupName, target);\n  }\n\n  /** Update active element after a new element is shown */\n  @bind\n  protected _onShow(e: CustomEvent): void {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.setActive(target.groupName, target);\n  }\n\n  /** Update group state after active element is hidden */\n  @bind\n  protected _onHide(e: CustomEvent): void {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.deleteActive(target.groupName, target);\n  }\n\n  /** Update active elements */\n  @bind\n  protected _onChangeGroup(e: CustomEvent): void {\n    const target = EventUtils.source(e);\n    if (!this.isAcceptable(target)) return;\n\n    const {oldGroupName, newGroupName} = e.detail;\n    this.deleteActive(oldGroupName, target);\n    this.setActive(newGroupName, target);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleableDispatcher: typeof ESLToggleableDispatcher;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-dispatcher': ESLToggleableDispatcher;\n  }\n}\n","/**\n * Execute callback in bounds of the next task with dom ready state precondition\n */\nexport function onDocumentReady(callback: () => void): void {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      setTimeout(() => callback());\n    });\n  } else {\n    setTimeout(() => callback());\n  }\n}\n","import {onDocumentReady} from '../dom/ready';\nimport type {AnyToVoidFnSignature} from '../misc/functions';\n\n/** Defer method execution to the next task with dom ready state precondition */\nexport function ready<T extends AnyToVoidFnSignature>(target: any,\n                                                      propertyKey: string,\n                                                      descriptor: TypedPropertyDescriptor<T>): void {\n  if (!descriptor || typeof descriptor.value !== 'function') {\n    throw new TypeError('Only class methods can be decorated via document ready decorator');\n  }\n  const fn = descriptor.value;\n  descriptor.value = function (...arg: any[]) {\n    onDocumentReady(() => fn.call(this, ...arg));\n  } as T;\n}\n","/** Property configuration */\nexport type OverrideDecoratorConfig = {\n  /** Value to set in the prototype */\n  value?: any;\n  /** To define mutable property */\n  readonly?: false;\n} | {\n  /** Value to set in the prototype */\n  value: any;\n  /** To define readonly property */\n  readonly: true;\n};\n\n/**\n * `@prop` is auxiliary decorator to define a field on the prototype level.\n *` @prop` can be used to override decorated property from the parent level\n *\n * You can also use an @override decorator in combination with ECMA Script class property definition:\n * `@prop() public field: any = initial value;`\n *\n * The class property initial value is a part of object creation, so it goes to the object itself,\n * while the @override value is defined on the prototype level.\n *\n * @param prototypeConfig - prototype property configuration\n */\nexport function prop(prototypeConfig: OverrideDecoratorConfig = {}) {\n  return function (obj: any, name: string): void {\n    if (Object.hasOwnProperty.call(obj, name)) {\n      throw new TypeError('Can\\'t override own property');\n    }\n    Object.defineProperty(obj, name, {\n      value: prototypeConfig.value,\n      writable: !prototypeConfig.readonly,\n      enumerable: true,\n      configurable: true\n    });\n  };\n}\n","/**\n * A Rect describes the size and position of a rectangle.\n */\nexport class Rect {\n  /** The X coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public x = 0;\n  /** The Y coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public y = 0;\n  /** The width of the Rect. */\n  public width = 0;\n  /** The height of the Rect. */\n  public height = 0;\n\n  /**\n   * The static method creates a new Rect instance from a rect-like object.\n   * @param rect - rect-like object\n   */\n  public static from(rect: {x?: number, left?: number, y?: number, top?: number, width?: number, height?: number} = {}): Rect {\n    return new this(rect.x || rect.left, rect.y || rect.top, rect.width, rect.height);\n  }\n\n  /**\n   * The static method checks the equality of the two Rect instances.\n   * @param rect1 - first instance of Rect\n   * @param rect2 - second instance of Rect\n   */\n  public static isEqual(rect1: Rect, rect2: Rect): boolean {\n    return rect1.x === rect2.x && rect1.y === rect2.y && rect1.width === rect2.width && rect1.height === rect2.height;\n  }\n\n  public constructor(x?: number, y?: number, width?: number, height?: number) {\n    this.x = x || 0;\n    this.y = y || 0;\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n\n  /**\n   * Get the top coordinate value of the Rect (has the same value as y).\n   */\n  public get top(): number {\n    return this.y;\n  }\n\n  /**\n   * Get the left coordinate value of the Rect (has the same value as x).\n   */\n  public get left(): number {\n    return this.x;\n  }\n\n  /**\n   * Get the right coordinate value of the DOMRect.\n   */\n  public get right(): number {\n    return this.x + this.width;\n  }\n\n  /**\n   * Get the bottom coordinate value of the Rect.\n   */\n  public get bottom(): number {\n    return this.y + this.height;\n  }\n\n  /**\n   * Get the center X coordinate value of the Rect.\n   */\n  public get cx(): number {\n    return this.x + this.width / 2;\n  }\n\n  /**\n   * Get the center Y coordinate value of the Rect.\n   */\n  public get cy(): number {\n    return this.y + this.height / 2;\n  }\n\n  /**\n   * Grow the Rect by the specified increment in pixels.\n   * It increases the size of the Rect by moving each point on the edge of the Rect to a certain distance further away from the center of the Rect.\n   * @param increment - distance to grow in pixels\n   */\n  public grow(increment: number): Rect {\n    this.y -= increment;\n    this.x -= increment;\n    this.height += 2 * increment;\n    this.width += 2 * increment;\n    return this;\n  }\n\n  /**\n   * Shrink the Rect by the specified decrement in pixels.\n   * It reduces the size of the Rect by moving each point on the edge of the Rect to a certain distance closer to the center of the Rect.\n   * @param decrement - distance to shrink in pixels\n   */\n  public shrink(decrement: number): Rect {\n    return this.grow(-decrement);\n  }\n}\n","import {memoize} from '../decorators/memoize';\n\nexport type ScrollType = 'default' | 'negative' | 'reverse';\n\n// TODO: functional\nexport abstract class RTLUtils {\n  /** Check if the element in a RTL direction context */\n  static isRtl(el?: HTMLElement | null): boolean {\n    return getComputedStyle(el || document.body).direction === 'rtl';\n  }\n\n  /**\n   * @returns RTL scroll type (lazy, memoized)\n   */\n  @memoize()\n  static get scrollType(): ScrollType {\n    let scrollType: ScrollType = 'default';\n    const el = createDummyEl();\n    document.body.appendChild(el);\n    if (el.scrollLeft <= 0) {\n      el.scrollLeft = 2;\n      scrollType = el.scrollLeft < 2 ? 'negative' : 'reverse';\n    }\n    document.body.removeChild(el);\n    return scrollType;\n  }\n\n  static normalizeScrollLeft(el: HTMLElement, value: number | null = null, isRtl: boolean = RTLUtils.isRtl(el)): number {\n    value = (value === null) ? el.scrollLeft : value;\n    switch (isRtl ? RTLUtils.scrollType : '') {\n      case 'negative':\n        return el.scrollWidth - el.clientWidth + value;\n      case 'reverse':\n        return el.scrollWidth - el.clientWidth - value;\n      default:\n        return value;\n    }\n  }\n}\n\n/** Creates the dummy test element with a horizontal scroll presented */\nfunction createDummyEl(): HTMLElement {\n  const el = document.createElement('div');\n  el.appendChild(document.createTextNode('ESL!'));\n  el.dir = 'rtl';\n  Object.assign(el.style, {\n    position: 'absolute',\n    top: '-1000px',\n    width: '4px',\n    height: '1px',\n    fontSize: '14px',\n    overflow: 'scroll'\n  });\n  return el;\n}\n","/**\n * Get the Element that is the root element of the document.\n * @param element - element for which to get the document element\n * */\nexport const getDocument = (element: Element | Window = window): Element => {\n  return (element instanceof Window ? element.document : element.ownerDocument).documentElement;\n};\n\n/**\n * Get the name of node.\n * @param element - element for which to get the name\n */\nexport const getNodeName = (element?: Node | Window): string  => {\n  return element && !(element instanceof Window) ? (element.nodeName).toLowerCase() : '';\n};\n\n/**\n * Get the parent of the specified element in the DOM tree.\n * @param element - element for which to get the parent\n */\nexport const getParentNode = (element: Element | ShadowRoot): Node => {\n  if (getNodeName(element) === 'html') return element;\n  return (window.ShadowRoot\n    ? element instanceof ShadowRoot\n      ? element.host\n      : element.assignedSlot || element.parentNode\n    : element.parentNode) || getDocument(element as Element);\n};\n","import {tryUntil} from '../async/promise';\nimport {getNodeName, getParentNode} from './api';\n\nexport type ScrollStrategy = 'none' | 'native' | 'pseudo';\n\nconst $html = document.documentElement;\nconst initiatorSet = new Set();\n\n// TODO: functional\nexport abstract class ScrollUtils {\n  /** Check vertical scroll based on content height */\n  static hasVerticalScroll(target = $html): boolean {\n    return target.scrollHeight > target.clientHeight;\n  }\n\n  /**\n   * Disable scroll on the page.\n   * @param strategy - to make scroll visually disabled\n   * */\n  public static lock(strategy?: ScrollStrategy): void {\n    const hasScroll = ScrollUtils.hasVerticalScroll();\n    if (strategy && strategy !== 'none' && hasScroll) {\n      $html.classList.add(`esl-${strategy}-scroll`);\n    }\n    $html.classList.add('esl-disable-scroll');\n  }\n\n  /**\n   * Enable scroll on the page.\n   * */\n  public static unlock(): void {\n    $html.classList.remove('esl-disable-scroll', 'esl-pseudo-scroll', 'esl-native-scroll');\n  }\n\n  /**\n   * Disable scroll on the page.\n   * @param initiator - object to associate request with\n   * @param strategy - to make scroll visually disabled\n   *\n   * TODO: currently requests with different strategy is not taken into account\n   * */\n  public static requestLock(initiator: any, strategy?: ScrollStrategy): void {\n    initiator && initiatorSet.add(initiator);\n    (initiatorSet.size > 0) && ScrollUtils.lock(strategy);\n  }\n\n  /**\n   * Enable scroll on the page in case it was requested with given initiator.\n   * @param initiator - object to associate request with\n   * @param strategy - to make scroll visually disabled\n   */\n  public static requestUnlock(initiator: any, strategy?: ScrollStrategy): void {\n    initiator && initiatorSet.delete(initiator);\n    (initiatorSet.size === 0) && ScrollUtils.unlock();\n  }\n}\n\n/**\n * Get the list of all scroll parents, up the list of ancestors until we get to the top window object.\n * @param element - element for which you want to get the list of all scroll parents\n * @param list - array of elements to concatenate with the list of all scroll parents of element (optional)\n */\nexport function getListScrollParents(element: Node, list: Element[] = []): Element[] {\n  const scrollParent = getScrollParent(element);\n  const isBody = scrollParent === element.ownerDocument?.body;\n  const target = isBody\n    ? isScrollParent(scrollParent) ? scrollParent : []\n    : scrollParent;\n\n  const updatedList = list.concat(target);\n  return isBody\n    ? updatedList\n    : updatedList.concat(getListScrollParents(getParentNode(scrollParent)));\n}\n\n/**\n * Get the scroll parent of the specified element in the DOM tree.\n * @param node - element for which to get the scroll parent\n */\nexport function getScrollParent(node: Node): Element {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    return node.ownerDocument?.body as Element;\n  }\n\n  if (node instanceof HTMLElement && isScrollParent(node as Element)) {\n    return node as Element;\n  }\n\n  return getScrollParent(getParentNode(node as Element));\n}\n\n/**\n * Check that element is scroll parent.\n * @param element - element for checking\n * */\nexport function isScrollParent(element: Element): boolean {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  const {overflow, overflowX, overflowY} = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\n\n/**\n * This is a promise-based version of scrollIntoView().\n * Method scrolls the element's parent container such that the element on which\n * scrollIntoView() is called is visible to the user. The promise is resolved when\n * the element became visible to the user and scrolling stops.\n *\n * Note: Please, use the native element.scrollIntoView() if you don't need a promise\n * to detect the moment when the scroll is finished or you don't use smooth behavior.\n * @param element - element to be made visible to the user\n * @param options - scrollIntoView options\n */\nexport function scrollIntoView(element: Element, options?: boolean | ScrollIntoViewOptions | undefined): Promise<boolean> {\n  let same = 0;\n  let lastLeft: number;\n  let lastTop: number;\n  const check = (): boolean => {\n    const {top, left} = element.getBoundingClientRect();\n\n    if (top !== lastTop || left !== lastLeft) {\n      same = 0;\n      lastTop = top;\n      lastLeft = left;\n    }\n    return same++ > 2;\n  };\n\n  element.scrollIntoView(options);\n  return tryUntil(check, 333, 30); // will check top position every 30ms, but not more than 250 times (10s)\n}\n","import {Rect} from '../../esl-utils/dom/rect';\n\nexport type PositionType = 'top' | 'bottom' | 'left' | 'right';\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport interface PopupPositionValue {\n  placedAt: PositionType;\n  popup: Rect;\n  arrow: Point;\n}\n\nexport interface IntersectionRatioRect {\n  top?: number;\n  left?: number;\n  right?: number;\n  bottom?: number;\n}\n\nexport interface PopupPositionConfig {\n  position: PositionType;\n  behavior: string;\n  marginArrow: number;\n  offsetArrowRatio: number;\n  intersectionRatio: IntersectionRatioRect;\n  arrow: DOMRect | Rect;\n  element: DOMRect;\n  inner: Rect;\n  outer: Rect;\n  trigger: Rect;\n}\n\n/**\n * Checks that the position along the horizontal axis\n * @param position - name of position\n */\nexport function isMajorAxisHorizontal(position: PositionType): boolean {\n  return ['left', 'right'].includes(position);\n}\n\n/**\n * Calculates the position of the popup on the minor axis\n * @param cfg - popup position config\n * @param centerPosition - position of the center of the trigger on the minor axis\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcPopupPositionByMinorAxis(cfg: PopupPositionConfig, centerPosition: number, dimensionName: 'height' | 'width'): number {\n  return centerPosition - cfg.arrow[dimensionName] / 2 - cfg.marginArrow - calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * TODO: optimize switch\n * Calculates Rect for given popup position config.\n * @param cfg - popup position config\n * */\nfunction calcPopupBasicRect(cfg: PopupPositionConfig): Rect {\n  let x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n  let y = cfg.inner.y - cfg.element.height;\n  switch (cfg.position) {\n    case 'left':\n      x = cfg.inner.x - cfg.element.width;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'right':\n      x = cfg.inner.right;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'bottom':\n      x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n      y = cfg.inner.bottom;\n      break;\n  }\n\n  return new Rect(x, y, cfg.element.width, cfg.element.height);\n}\n\n/**\n * Gets opposite position.\n * @param position - name of position\n * */\nfunction getOppositePosition(position: PositionType): PositionType {\n  return ({\n    top: 'bottom',\n    left: 'right',\n    right: 'left',\n    bottom: 'top'\n  }[position] || position) as PositionType;\n}\n\n/**\n * TODO: move the actionsToFit definition outside the function and optimize\n * Updates popup and arrow positions to fit on major axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMajorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): PositionType {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-major') return cfg.position;\n\n  let isMirrored = false;\n  const actionsToFit: Record<PositionType, () => void> = {\n    'bottom': () => {\n      if (cfg.intersectionRatio.bottom || cfg.outer.bottom < rect.bottom) {\n        rect.y = cfg.inner.y - cfg.element.height;\n        isMirrored = true;\n      }\n    },\n    'left': () => {\n      if (cfg.intersectionRatio.left || rect.x < cfg.outer.x) {\n        rect.x = cfg.inner.right;\n        isMirrored = true;\n      }\n    },\n    'right': () => {\n      if (cfg.intersectionRatio.right || cfg.outer.right < rect.right) {\n        rect.x = cfg.inner.x - cfg.element.width;\n        isMirrored = true;\n      }\n    },\n    'top': () => {\n      if (cfg.intersectionRatio.top || rect.y < cfg.outer.y) {\n        rect.y = cfg.inner.bottom;\n        isMirrored = true;\n      }\n    }\n  };\n  actionsToFit[cfg.position]();\n\n  return isMirrored ? getOppositePosition(cfg.position) : cfg.position;\n}\n\n/**\n * Calculates adjust for popup position to fit container bounds\n * @param elCoord - coordinate of the popup\n * @param outerCoord - coordinate of the outer border element\n * @param arrowCoord - coordinate of the arrow\n * @param arrowLimit - the limit value of the arrow coordinate\n * @param startingSide - is it starting side?\n * @returns adjustment value for the coordinates of the arrow and the popup\n */\nfunction adjustAlignmentBySide(elCoord: number, outerCoord: number, arrowCoord: number, arrowLimit: number, isStartingSide: boolean): number {\n  let arrowAdjust = 0;\n\n  if (isStartingSide ? elCoord < outerCoord : elCoord > outerCoord) {\n    arrowAdjust = elCoord - outerCoord;\n    const newCoord = arrowCoord + arrowAdjust;\n    if (isStartingSide ? newCoord < arrowLimit : newCoord > arrowLimit) {\n      arrowAdjust = 0;\n    }\n    /** It was decided that if the relative positions of the trigger and container\n     *  do not allow the popup to be displayed correctly together with the arrow,\n     *  the popup should be displayed as-is without adjusting the position of the minor axis\n     *\n     *  The following code adheres to a different strategy - maximum position adaptation,\n     *  with the popup having minimal overhang outside the container.\n     *  Perhaps in the future, we should allow the user to choose the strategy.\n     *\n     * const func = isStartingSide ? Math.max : Math.min;\n     * arrowAdjust = func(elCoord - outerCoord, arrowLimit - arrowCoord);\n     */\n  }\n\n  return arrowAdjust;\n}\n\n/**\n * Updates popup and arrow positions to fit on minor axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMinorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): void {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-minor') return;\n\n  const isHorizontal = isMajorAxisHorizontal(cfg.position);\n  const start = isHorizontal ? 'y' : 'x';\n  const end = isHorizontal ? 'bottom' : 'right';\n  const dimension = isHorizontal ? 'height' : 'width';\n\n  if (cfg.outer[dimension] < cfg.element[dimension] ||  // cancel fit mode if the popup size is greater than the outer limiter size\n      cfg.trigger[start] < cfg.outer[start] ||          // or the trigger is outside the outer limiting element\n      cfg.trigger[end] > cfg.outer[end]\n  ) return;\n\n  let coordAdjust = 0;\n  // check the starting side of the axis\n  let arrowLimit = cfg.marginArrow;\n  coordAdjust = adjustAlignmentBySide(rect[start], cfg.outer[start], arrow[start], arrowLimit, true);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n  // check the final side of the axis\n  arrowLimit += calcUsableSizeForArrow(cfg, dimension);\n  coordAdjust = adjustAlignmentBySide(rect[end], cfg.outer[end], arrow[start], arrowLimit, false);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n}\n\n/**\n * Calculates the usable size available for the arrow\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcUsableSizeForArrow(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.element[dimensionName] - cfg.arrow[dimensionName] - 2 * cfg.marginArrow;\n}\n\n/**\n * Calculates the position of the arrow on the minor axis\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcArrowPosition(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.marginArrow + calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * Calculates popup and arrow popup positions.\n * @param cfg - popup position config\n * */\nexport function calcPopupPosition(cfg: PopupPositionConfig): PopupPositionValue {\n  const popup = calcPopupBasicRect(cfg);\n  const arrow = {\n    x: calcArrowPosition(cfg, 'width'),\n    y: calcArrowPosition(cfg, 'height'),\n    position: cfg.position\n  };\n\n  const placedAt = fitOnMajorAxis(cfg, popup, arrow);\n  fitOnMinorAxis(cfg, popup, arrow);\n\n  return {\n    popup,\n    placedAt,\n    arrow\n  };\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\n\nimport type {ESLToggleable} from '../../esl-toggleable/core';\n\n@ExportNs('ToggleablePlaceholder')\nexport class ESLToggleablePlaceholder extends ESLBaseElement {\n  public static is = 'esl-toggleable-placeholder';\n\n  /** List of attributes allowed to copy from origin to this element */\n  public static readonly allowedAttrs: string[] = ['id', 'class'];\n\n  public $origin: ESLToggleable | null;\n\n  /** Сreates a placeholder for a given element of the toggleable's descendant */\n  public static from<T extends typeof ESLToggleablePlaceholder>(this: T, $el: ESLToggleable): InstanceType<T> {\n    const $placeholder = document.createElement(this.is) as InstanceType<T>;\n    $placeholder.$origin = $el;\n    return $placeholder;\n  }\n\n  public connectedCallback(): void {\n    this.copyAttributesFromOrigin();\n    super.connectedCallback();\n  }\n\n  /** Builds attribute name for copy */\n  protected buildAttrName(name: string): string {\n    return name === 'id' ? 'original-id' : name;\n  }\n\n  /** Copies allowed attributes from origin to this element */\n  protected copyAttributesFromOrigin(): void {\n    const {$origin} = this;\n    if (!$origin) return;\n\n    (this.constructor as typeof ESLToggleablePlaceholder).allowedAttrs.forEach((name) => {\n      const value = $origin.getAttribute(name);\n      if (value) {\n        this.setAttribute(this.buildAttrName(name), value);\n      }\n    });\n\n    // sanitize class list of placeholder from the tag name of origin's element\n    this.classList.remove(($origin.constructor as typeof ESLBaseElement).is);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleablePlaceholder: typeof ESLToggleablePlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-placeholder': ESLToggleablePlaceholder;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLPopup} from './esl-popup';\n\n@ExportNs('PopupPlaceholder')\nexport class ESLPopupPlaceholder extends ESLToggleablePlaceholder {\n  public static is = 'esl-popup-placeholder';\n\n  public $origin: ESLPopup | null;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PopupPlaceholder: typeof ESLPopupPlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup-placeholder': ESLPopupPlaceholder;\n  }\n}\n","import {range} from '../../esl-utils/misc/array';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr, jsonAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {prop} from '../../esl-utils/decorators/prop';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {afterNextRender, rafDecorator} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {Rect} from '../../esl-utils/dom/rect';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\nimport {getListScrollParents} from '../../esl-utils/dom/scroll';\nimport {getWindowRect} from '../../esl-utils/dom/window';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {calcPopupPosition, isMajorAxisHorizontal} from './esl-popup-position';\nimport {ESLPopupPlaceholder} from './esl-popup-placeholder';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\nimport type {PositionType, IntersectionRatioRect} from './esl-popup-position';\n\nconst INTERSECTION_LIMIT_FOR_ADJACENT_AXIS = 0.7;\nconst DEFAULT_OFFSET_ARROW = 50;\nconst scrollOptions = {passive: true} as EventListenerOptions;\n\nconst parsePercent = (value: string | number, nanValue: number = 0): number => {\n  const rawValue = parseNumber(value, nanValue);\n  return Math.max(0, Math.min(rawValue !== undefined ? rawValue : nanValue, 100));\n};\n\nexport interface PopupActionParams extends ToggleableActionParams {\n  /** popup position relative to trigger */\n  position?: PositionType;\n  /** popup behavior if it does not fit in the window */\n  behavior?: string;\n  /** Disable hiding the popup depending on the visibility of the activator */\n  disableActivatorObservation?: boolean;\n  /** Margins on the edges of the arrow. */\n  marginArrow?: string;\n  /** offset of the arrow as a percentage of the popup edge (0% - at the left edge, 100% - at the right edge, for RTL it is vice versa) */\n  offsetArrow?: string;\n  /** offset in pixels from trigger element */\n  offsetTrigger?: number;\n  /** offset in pixels from the edges of the container (or window if the container is not defined) */\n  offsetContainer?: number;\n  /** Target to container element to define bounds of popups visibility */\n  container?: string;\n  /** Container element that defines bounds of popups visibility (is not taken into account if the container attr is set on popup) */\n  containerEl?: HTMLElement;\n}\n\nexport interface ActivatorObserver {\n  unsubscribers?: (() => void)[];\n  observer?: IntersectionObserver;\n}\n\n@ExportNs('Popup')\nexport class ESLPopup extends ESLToggleable {\n  public static is = 'esl-popup';\n\n  public $arrow: HTMLElement | null;\n  public $placeholder: ESLPopupPlaceholder | null;\n\n  protected _containerEl?: HTMLElement;\n  protected _offsetTrigger: number;\n  protected _offsetContainer: number;\n  protected _deferredUpdatePosition = rafDecorator(() => this._updatePosition());\n  protected _activatorObserver: ActivatorObserver;\n  protected _intersectionRatio: IntersectionRatioRect = {};\n  protected _updateLoopID: number;\n\n  /**\n   * Popup position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public position: PositionType;\n\n  /** Popup behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Disable hiding the popup depending on the visibility of the activator */\n  @boolAttr() public disableActivatorObservation: boolean;\n  /**\n   * Margins on the edges of the arrow.\n   * This is the value in pixels that will be between the edge of the popup and\n   * the arrow at extreme positions of the arrow (when offsetArrow is set to 0 or 100)\n   */\n  @attr({defaultValue: '5'}) public marginArrow: string;\n\n  /**\n   * Offset of the arrow as a percentage of the popup edge\n   * (0% - at the left edge,\n   *  100% - at the right edge,\n   *  for RTL it is vice versa) */\n  @attr({defaultValue: `${DEFAULT_OFFSET_ARROW}`}) public offsetArrow: string;\n\n  /** Target to container element {@link TraversingQuery} to define bounds of popups visibility (window by default) */\n  @attr() public container: string;\n\n  /** Default params to merge into passed action params */\n  @jsonAttr<PopupActionParams>({defaultValue: {\n    offsetTrigger: 3,\n    offsetContainer: 15\n  }})\n  public defaultParams: PopupActionParams;\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  /** Container element that define bounds of popups visibility */\n  @memoize()\n  protected get $container(): HTMLElement | undefined {\n    return this.container ? TraversingQuery.first(this.container, this) as HTMLElement : this._containerEl;\n  }\n\n  /** Get the size and position of the container */\n  protected get containerRect(): Rect {\n    const {$container} = this;\n    if (!$container) return getWindowRect();\n    const containerRect = $container.getBoundingClientRect();\n    return new Rect(containerRect.left, containerRect.top + window.pageYOffset, containerRect.width, containerRect.height);\n  }\n\n  @ready\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this.$arrow = this.querySelector('span.esl-popup-arrow');\n    this.moveToBody();\n  }\n\n  /** Checks that the position along the horizontal axis */\n  @memoize()\n  protected get _isMajorAxisHorizontal(): boolean {\n    return isMajorAxisHorizontal(this.position);\n  }\n\n  /** Checks that the position along the vertical axis */\n  @memoize()\n  protected get _isMajorAxisVertical(): boolean {\n    return !isMajorAxisHorizontal(this.position);\n  }\n\n  /** Get offsets arrow ratio */\n  @memoize()\n  protected get _offsetArrowRatio(): number {\n    const ratio = parsePercent(this.offsetArrow, DEFAULT_OFFSET_ARROW) / 100;\n    return RTLUtils.isRtl(this) ? 1 - ratio : ratio;\n  }\n\n  /** Moves popup into document.body */\n  protected moveToBody(): void {\n    const {parentNode, $placeholder} = this;\n    if (!parentNode || parentNode === document.body) return;\n\n    // to be safe and prevent leaks\n    $placeholder && $placeholder.parentNode?.removeChild($placeholder);\n\n    // replace this with placeholder element\n    this.$placeholder = ESLPopupPlaceholder.from(this);\n    parentNode.replaceChild(this.$placeholder, this);\n    document.body.appendChild(this);\n  }\n\n  /**\n   * Actions to execute on show popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire esl:refresh event by default.\n   */\n  public onShow(params: PopupActionParams): void {\n    super.onShow(params);\n\n    if (params.position) {\n      this.position = params.position;\n    }\n    if (params.behavior) {\n      this.behavior = params.behavior;\n    }\n    if (params.disableActivatorObservation) {\n      this.disableActivatorObservation = params.disableActivatorObservation;\n    }\n    if (params.marginArrow) {\n      this.marginArrow = params.marginArrow;\n    }\n    if (params.offsetArrow) {\n      this.offsetArrow = params.offsetArrow;\n    }\n    if (params.container) {\n      this.container = params.container;\n    }\n    this._containerEl = params.containerEl;\n    this._offsetTrigger = params.offsetTrigger || 0;\n    this._offsetContainer = params.offsetContainer || 0;\n\n    this.style.visibility = 'hidden'; // eliminates the blinking of the popup at the previous position\n\n    afterNextRender(() => this.afterOnShow()); // running as a separate task solves the problem with incorrect positioning on the first showing\n  }\n\n  /**\n   * Actions to execute on hide popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and updates a11y by default.\n   */\n  public onHide(params: PopupActionParams): void {\n    this.beforeOnHide();\n    super.onHide(params);\n\n    this._stopUpdateLoop();\n    this.activator && this._removeActivatorObserver(this.activator);\n\n    // clear all memoize data\n    memoize.clear(this, '_isMajorAxisHorizontal');\n    memoize.clear(this, '_isMajorAxisVertical');\n    memoize.clear(this, '_offsetArrowRatio');\n    memoize.clear(this, '$container');\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected afterOnShow(): void {\n    this._updatePosition();\n    this.style.visibility = 'visible';\n    this.activator && this._addActivatorObserver(this.activator);\n    this._startUpdateLoop();\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected beforeOnHide(): void {}\n\n  /**\n   * Checks activator intersection for adjacent axis.\n   * Hides the popup if the intersection ratio exceeds the limit.\n   */\n  protected _checkIntersectionForAdjacentAxis(isAdjacentAxis: boolean, intersectionRatio: number): void {\n    if (isAdjacentAxis && intersectionRatio < INTERSECTION_LIMIT_FOR_ADJACENT_AXIS) {\n      this.hide();\n    }\n  }\n\n  /** Actions to execute on activator intersection event. */\n  @bind\n  protected onActivatorIntersection(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void {\n    const entry = entries[0];\n    this._intersectionRatio = {};\n    if (!entry.isIntersecting) {\n      this.hide();\n      return;\n    }\n\n    if (entry.intersectionRect.y !== entry.boundingClientRect.y) {\n      this._intersectionRatio.top = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.top);\n    }\n    if (entry.intersectionRect.bottom !== entry.boundingClientRect.bottom) {\n      this._intersectionRatio.bottom = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.bottom);\n    }\n    if (entry.intersectionRect.x !== entry.boundingClientRect.x) {\n      this._intersectionRatio.left = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.left);\n    }\n    if (entry.intersectionRect.right !== entry.boundingClientRect.right) {\n      this._intersectionRatio.right = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.right);\n    }\n  }\n\n  /** Actions to execute on activator scroll event. */\n  @bind\n  protected onActivatorScroll(e: Event): void {\n    if (this._updateLoopID) return;\n    this._updatePosition();\n  }\n\n  /** Creates listeners and observers to observe activator after showing popup */\n  protected _addActivatorObserver(target: HTMLElement): void {\n    const scrollParents = getListScrollParents(target);\n\n    this._activatorObserver = {\n      unsubscribers: scrollParents.map(($root) => {\n        $root.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        return (): void => {\n          $root && $root.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        };\n      })\n    };\n\n    if (!this.disableActivatorObservation) {\n      const options = {\n        rootMargin: '0px',\n        threshold: range(9, (x) => x / 8)\n      } as IntersectionObserverInit;\n\n      const observer = new IntersectionObserver(this.onActivatorIntersection, options);\n      observer.observe(target);\n\n      this._activatorObserver.observer = observer;\n    }\n\n    window.addEventListener('resize', this._deferredUpdatePosition);\n    window.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    document.body.addEventListener('transitionstart', this._startUpdateLoop);\n  }\n\n  /** Removes activator listeners and observers after hiding popup */\n  protected _removeActivatorObserver(target: HTMLElement): void {\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n    window.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    this._activatorObserver.observer?.disconnect();\n    this._activatorObserver.observer = undefined;\n    this._activatorObserver.unsubscribers?.forEach((cb) => cb());\n    this._activatorObserver.unsubscribers = [];\n\n    document.body.removeEventListener('transitionstart', this._startUpdateLoop);\n  }\n\n  /**\n   * Starts loop for update position of popup.\n   * The loop ends when the position and size of the activator have not changed\n   * for the last 2 frames of the animation.\n   */\n  @bind\n  protected _startUpdateLoop(): void {\n    if (this._updateLoopID) return;\n\n    let same = 0;\n    let lastRect = new Rect();\n    const updateLoop = (): void => {\n      if (!this.activator) {\n        this._stopUpdateLoop();\n        return;\n      }\n\n      const newRect = Rect.from(this.activator.getBoundingClientRect());\n      if (!Rect.isEqual(lastRect, newRect)) {\n        same = 0;\n        lastRect = newRect;\n      }\n\n      if (same++ > 2) {\n        this._stopUpdateLoop();\n        return;\n      }\n      this._updatePosition();\n      this._updateLoopID = requestAnimationFrame(updateLoop);\n    };\n\n    this._updateLoopID = requestAnimationFrame(updateLoop);\n  }\n\n  /**\n   * Stops loop for update position of popup.\n   * Also cancels the animation frame request.\n   */\n  @bind\n  protected _stopUpdateLoop(): void {\n    if (!this._updateLoopID) return;\n    cancelAnimationFrame(this._updateLoopID);\n    this._updateLoopID = 0;\n  }\n\n  /** Updates position of popup and its arrow */\n  protected _updatePosition(): void {\n    if (!this.activator) return;\n\n    const triggerRect = this.activator.getBoundingClientRect();\n    const popupRect = this.getBoundingClientRect();\n    const arrowRect = this.$arrow ? this.$arrow.getBoundingClientRect() : new Rect();\n    const trigger = new Rect(triggerRect.left, triggerRect.top + window.pageYOffset, triggerRect.width, triggerRect.height);\n    const innerMargin = this._offsetTrigger + arrowRect.width / 2;\n\n    const config = {\n      position: this.position,\n      behavior: this.behavior,\n      marginArrow: +this.marginArrow,\n      offsetArrowRatio: this._offsetArrowRatio,\n      intersectionRatio: this._intersectionRatio,\n      arrow: arrowRect,\n      element: popupRect,\n      trigger,\n      inner: Rect.from(trigger).grow(innerMargin),\n      outer: this.containerRect.shrink(this._offsetContainer)\n    };\n\n    const {placedAt, popup, arrow} = calcPopupPosition(config);\n\n    this.setAttribute('placed-at', placedAt);\n    // set popup position\n    this.style.left = `${popup.x}px`;\n    this.style.top = `${popup.y}px`;\n    // set arrow position\n    if (this.$arrow) {\n      this.$arrow.style.left = this._isMajorAxisVertical ? `${arrow.x}px` : '';\n      this.$arrow.style.top = this._isMajorAxisHorizontal ? `${arrow.y}px` : '';\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Popup: typeof ESLPopup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup': ESLPopup;\n  }\n}\n","import {Rect} from './rect';\n\n/**\n * Get the window object associated with a document of the specified element.\n * @param node - element for which to get window\n * */\nexport function getWindow(node: Node | Window): Window {\n  if (node === null) return window;\n  if (node instanceof Window) return node;\n  const ownerDocument = node.ownerDocument;\n  return ownerDocument ? ownerDocument.defaultView || window : window;\n}\n\n/**\n * Get the size and position of the window.\n * @returns\n */\nexport function getWindowRect(wnd: Window = window): Rect {\n  return Rect.from({\n    x: wnd.scrollX || wnd.pageXOffset,\n    y: wnd.scrollY || wnd.pageYOffset,\n    width: wnd.innerWidth || wnd.document.documentElement.clientWidth,\n    height: wnd.innerHeight || wnd.document.documentElement.clientHeight\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {attr, boolAttr, jsonAttr} from '../../esl-base-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {ESLPanelGroup} from '../../esl-panel-group/core';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\n\n/** {@link ESLPanel} action params interface */\nexport interface PanelActionParams extends ToggleableActionParams {\n  /** Prevents collapsing/expanding animation */\n  noCollapse?: boolean;\n}\n\n/**\n * ESLPanel component\n * @author Julia Murashko\n *\n * ESLPanel is a custom element that is used as a wrapper for content that can be shown or hidden.\n * Can use collapsing/expanding animation (smooth height change).\n * Can be used in conjunction with {@link ESLPanelGroup} to control a group of ESLPopups\n */\n@ExportNs('Panel')\nexport class ESLPanel extends ESLToggleable {\n  public static is = 'esl-panel';\n\n  /** Class(es) to be added for active state ('open' by default) */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animateClass: string;\n  /** Class(es) to be added during animation after next render ('post-animate' by default) */\n  @attr({defaultValue: 'post-animate'}) public postAnimateClass: string;\n\n  /** Initial params for current ESLPanel instance */\n  @jsonAttr<PanelActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: PanelActionParams;\n\n  /** Active while animation in progress */\n  @boolAttr({readonly: true}) public animating: boolean;\n\n  /** Inner height state that updates after show/hide actions but before show/hide events triggered */\n  protected _initialHeight: number = 0;\n\n  /** @returns Previous active panel height at the start of the animation */\n  public get initialHeight(): number {\n    return this._initialHeight;\n  }\n\n  /** @returns Closest panel group or null if not presented */\n  public get $group(): ESLPanelGroup | null {\n    if (this.groupName === 'none' || this.groupName) return null;\n    return this.closest(ESLPanelGroup.is);\n  }\n\n  protected bindEvents(): void {\n    super.bindEvents();\n    this.addEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  protected unbindEvents(): void {\n    super.unbindEvents();\n    this.removeEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  /** Process show action */\n  protected onShow(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onShow(params);\n\n    this.beforeAnimate();\n    if (params.noCollapse) {\n      afterNextRender(() => this.afterAnimate());\n    } else {\n      this.onAnimate(0, this._initialHeight);\n    }\n  }\n\n  /** Process hide action */\n  protected onHide(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onHide(params);\n\n    this.beforeAnimate();\n    if (params.noCollapse) {\n      afterNextRender(() => this.afterAnimate());\n    } else {\n      this.onAnimate(this._initialHeight, 0);\n    }\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    this.toggleAttribute('animating', true);\n    CSSClassUtils.add(this, this.animateClass);\n    this.postAnimateClass && afterNextRender(() => CSSClassUtils.add(this, this.postAnimateClass));\n  }\n\n  /** Process animation */\n  protected onAnimate(from: number, to: number): void {\n    // set initial height\n    this.style.setProperty('max-height', `${from}px`);\n    // make sure that browser applies initial height for animation\n    afterNextRender(() => {\n      this.style.setProperty('max-height', `${to}px`);\n      this.fallbackAnimate();\n    });\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented*/\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.maxHeight) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(): void {\n    const {animating} = this;\n    this.clearAnimation();\n    // Prevent fallback calls from being tracked\n    if (!animating) return;\n    this.$$fire(this.open ? 'after:show' : 'after:hide');\n  }\n\n  /** Clear animation properties */\n  protected clearAnimation(): void {\n    this.toggleAttribute('animating', false);\n    this.style.removeProperty('max-height');\n    CSSClassUtils.remove(this, this.animateClass);\n    CSSClassUtils.remove(this, this.postAnimateClass);\n  }\n\n  /** Catching CSS transition end event to start post-animate processing */\n  @bind\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'max-height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Merge params that are used by panel group for actions */\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    const stackConfig = this.$group?.panelConfig || {};\n    return Object.assign({}, stackConfig, this.defaultParams, params || {});\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Panel: typeof ESLPanel;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-panel': ESLPanel;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, jsonAttr, ESLBaseElement} from '../../esl-base-element/core';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {format} from '../../esl-utils/misc/format';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLPanel} from '../../esl-panel/core';\n\nimport type {PanelActionParams} from '../../esl-panel/core';\n\n/**\n * ESLPanelGroup component\n * @author Julia Murashko\n *\n * ESLPanelGroup is a custom element that is used as a container for a group of {@link ESLPanel}s\n */\n@ExportNs('PanelGroup')\nexport class ESLPanelGroup extends ESLBaseElement {\n  public static is = 'esl-panel-group';\n  /** List of supported modes */\n  public static supportedModes = ['tabs', 'accordion', 'open'];\n\n  /** Rendering mode of the component (takes values from the list of supported modes; 'accordion' by default) */\n  @attr({defaultValue: 'accordion'}) public mode: string;\n  /** Rendering mode class pattern. Uses {@link format} syntax for `mode` placeholder */\n  @attr({defaultValue: 'esl-{mode}-view'}) public modeCls: string;\n  /** Element {@link TraversingQuery} selector to add class that identifies the rendering mode (ESLPanelGroup itself by default) */\n  @attr({defaultValue: ''}) public modeClsTarget: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animationClass: string;\n  /** List of comma-separated \"modes\" to disable collapse/expand animation (for both Group and Panel animations) */\n  @attr() public noCollapse: string;\n  /**\n   * Define accordion behavior\n   * `single` allows only one Panel to be open.\n   * `multiple` allows any number of open Panels.\n   * */\n  @attr({defaultValue: 'single'}) public accordionGroup: string;\n  /** Action params to pass into panels when executing reset action (happens when mode is changed) */\n  @jsonAttr({defaultValue: {noCollapse: true}}) public transformParams: PanelActionParams;\n\n\n  /** Height of previous active panel */\n  protected _previousHeight: number = 0;\n\n  static get observedAttributes(): string[] {\n    return ['mode', 'accordion-group'];\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.bindEvents();\n\n    this.modeRules.addListener(this._onModeChange);\n    this.updateMode();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.modeRules.removeListener(this._onModeChange);\n\n    this.unbindEvents();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'mode') {\n      this.modeRules.removeListener(this._onModeChange);\n      memoize.clear(this, 'modeRules');\n      this.modeRules.addListener(this._onModeChange);\n      this.updateMode();\n    }\n    if (attrName === 'accordion-group') {\n      if (newVal !== 'single' && newVal !== 'multiple') {\n        this.accordionGroup = oldVal;\n        return;\n      }\n      this.reset();\n    }\n  }\n\n  protected bindEvents(): void {\n    this.addEventListener('esl:before:show', this._onBeforeShow);\n    this.addEventListener('esl:show', this._onShow);\n    this.addEventListener('esl:before:hide', this._onBeforeHide);\n\n    this.addEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  protected unbindEvents(): void {\n    this.removeEventListener('esl:before:show', this._onBeforeShow);\n    this.removeEventListener('esl:show', this._onShow);\n    this.removeEventListener('esl:before:hide', this._onBeforeHide);\n\n    this.removeEventListener('transitionend', this._onTransitionEnd);\n  }\n\n  /** Updates element state according to current mode */\n  protected updateMode(): void {\n    const prevMode = this.getAttribute('current-mode');\n    const currentMode = this.currentMode;\n    this.setAttribute('current-mode', currentMode);\n    // TODO: @deprecated will be removed with the 4th esl version\n    this.setAttribute('view', currentMode);\n\n    this.updateModeCls();\n    this.reset();\n\n    if (prevMode !== currentMode) {\n      this.$$fire('change:mode', {detail: {prevMode, currentMode}});\n    }\n  }\n\n  /** Updates mode class marker */\n  protected updateModeCls(): void {\n    const {modeCls, currentMode} = this;\n    if (!modeCls) return;\n    const $target = TraversingQuery.first(this.modeClsTarget, this);\n    if (!$target) return;\n    ESLPanelGroup.supportedModes.forEach((mode) => {\n      const className = format(modeCls, {mode});\n      $target.classList.toggle(className, currentMode === mode);\n    });\n  }\n\n  /** @returns ESLMediaRuleList instance of the mode mapping */\n  @memoize()\n  public get modeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.mode);\n  }\n\n  /** @returns current mode */\n  public get currentMode(): string {\n    return this.modeRules.activeValue || '';\n  }\n\n  /** @returns panels that are processed by the current panel group */\n  public get $panels(): ESLPanel[] {\n    const els = Array.from(this.querySelectorAll(ESLPanel.is));\n    return els.filter((el) => this.includesPanel(el)) as ESLPanel[];\n  }\n\n  /** @returns panels that are active */\n  public get $activePanels(): ESLPanel[] {\n    return this.$panels.filter((el: ESLPanel) => el.open);\n  }\n\n  /** @returns whether the collapse/expand animation should be handheld by the group */\n  public get shouldCollapse(): boolean {\n    const noCollapseModes = this.noCollapse.split(',').map((mode) => mode.trim());\n    return !noCollapseModes.includes('all') && !noCollapseModes.includes(this.currentMode);\n  }\n\n  /** @returns action params config that's used (inherited) by controlled {@link ESLPanel}s */\n  public get panelConfig(): PanelActionParams {\n    return {\n      noCollapse: !this.shouldCollapse || (this.currentMode === 'tabs')\n    };\n  }\n\n  /** @returns merged panel action params for show/hide requests from the group */\n  protected mergeActionParams(...params: PanelActionParams[]): PanelActionParams {\n    return Object.assign({initiator: 'group', activator: this}, ...params);\n  }\n\n  /** Condition-guard to check if the passed target is a Panel that should be controlled by the Group */\n  public includesPanel(target: any): target is ESLPanel {\n    if (!(target instanceof ESLPanel)) return false;\n    return target.$group === this;\n  }\n\n  /** Shows all panels besides excluded ones */\n  public showAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$panels.forEach((el) => !excluded.includes(el) && el.show(this.mergeActionParams(params)));\n  }\n  /** Hides all active panels besides excluded ones */\n  public hideAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$activePanels.forEach((el) => !excluded.includes(el) && el.hide(this.mergeActionParams(params)));\n  }\n  /** Toggles all panels by predicate */\n  public toggleAllBy(shouldOpen: (panel: ESLPanel) => boolean, params: PanelActionParams = {}): void {\n    this.$panels.forEach((panel) => panel.toggle(shouldOpen(panel), this.mergeActionParams(params)));\n  }\n\n  /** Resets to default state applicable to the current mode */\n  public reset(): void {\n    ESLPanel.registered.then(() => {\n      if (this.currentMode === 'open') this.toggleAllBy(() => true, this.transformParams);\n      if (this.currentMode === 'tabs' || (this.currentMode === 'accordion' && this.accordionGroup === 'single')) {\n        const $activePanel = this.$panels.find((panel) => panel.initiallyOpened);\n        this.toggleAllBy((panel) => panel === $activePanel, this.transformParams);\n      }\n      if (this.currentMode === 'accordion' && this.accordionGroup === 'multiple') {\n        this.toggleAllBy((panel) => panel.initiallyOpened, this.transformParams);\n      }\n    });\n  }\n\n  /** Animates the height of the component */\n  protected onAnimate(from: number, to: number): void {\n    const hasCurrent = this.style.height && this.style.height !== 'auto';\n    if (hasCurrent) {\n      this.style.height = `${to}px`;\n      this.fallbackAnimate();\n    } else {\n      // set initial height\n      this.style.height = `${from}px`;\n      // make sure that browser applies initial height to animate\n      afterNextRender(() => {\n        this.style.height = `${to}px`;\n        this.fallbackAnimate();\n      });\n    }\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented */\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.height) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    CSSClassUtils.add(this, this.animationClass);\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(): void {\n    this.style.removeProperty('height');\n    CSSClassUtils.remove(this, this.animationClass);\n  }\n\n  /** Process {@link ESLPanel} pre-show event */\n  @bind\n  protected _onBeforeShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode === 'accordion' && this.accordionGroup === 'multiple') return;\n    this.hideAll([panel]);\n  }\n\n  /** Process {@link ESLPanel} show event */\n  @bind\n  protected _onShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode !== 'tabs') return;\n\n    this.beforeAnimate();\n    if (this.shouldCollapse) {\n      this.onAnimate(this._previousHeight, panel.initialHeight);\n    } else {\n      afterNextRender(() => this.afterAnimate());\n    }\n  }\n\n  /** Process {@link ESLPanel} pre-hide event */\n  @bind\n  protected _onBeforeHide(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode === 'open') {\n      // TODO: refactor\n      e.preventDefault();\n      return;\n    }\n    this._previousHeight = this.clientHeight;\n  }\n\n  /** Catches CSS transition end event to start post-animate processing */\n  @bind\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Handles mode change */\n  @bind\n  protected _onModeChange(): void {\n    this.updateMode();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PanelGroup: typeof ESLPanelGroup;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-panel-group': ESLPanelGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr, ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLToggleable, ToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n@ExportNs('Trigger')\nexport class ESLTrigger extends ESLBaseElement {\n  public static is = 'esl-trigger';\n\n  static get observedAttributes(): string[] {\n    return ['target'];\n  }\n\n  /** @readonly Observed Toggleable active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n\n  /** CSS classes to set on active state */\n  @attr({defaultValue: ''}) public activeClass: string;\n  /** Target element {@link TraversingQuery} selector to set `activeClass` */\n  @attr({defaultValue: ''}) public activeClassTarget: string;\n\n  /** Selector for ignored inner elements */\n  @attr({defaultValue: 'a[href]'}) public ignore: string;\n\n  /** Target Toggleable {@link TraversingQuery} selector. `::next` by default */\n  @attr({defaultValue: '::next'}) public target: string;\n  /** Action to pass to the Toggleable. Supports `show`, `hide` and `toggle` values. `toggle` by default */\n  @attr({defaultValue: 'toggle'}) public mode: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `none` */\n  @attr({defaultValue: 'not all'}) public trackHover: string;\n\n  /** Selector of inner target element to place aria attributes. Uses trigger itself if blank */\n  @attr({defaultValue: ''}) public a11yTarget: string;\n\n  /** Show delay value */\n  @attr({defaultValue: 'none'}) public showDelay: string;\n  /** Hide delay value */\n  @attr({defaultValue: 'none'}) public hideDelay: string;\n\n  /**\n   * Show delay value override for hover.\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverShowDelay: string;\n  /**\n   * Hide delay value override for hover\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverHideDelay: string;\n\n  protected _$target: ESLToggleable | null;\n\n  protected attributeChangedCallback(attrName: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') return this.updateTargetFromSelector();\n  }\n\n  /** Target observable Toggleable */\n  public get $target(): ESLToggleable | null {\n    return this._$target;\n  }\n  public set $target(newPopupInstance: ESLToggleable | null) {\n    this.unbindEvents();\n    this._$target = newPopupInstance;\n    this.bindEvents();\n    this._onTargetStateChange();\n  }\n\n  /** Element target to setup aria attributes */\n  public get $a11yTarget(): HTMLElement | null {\n    return this.a11yTarget ? this.querySelector(this.a11yTarget) : this;\n  }\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.updateTargetFromSelector();\n    this.initA11y();\n  }\n  @ready\n  protected disconnectedCallback(): void {\n    this.unbindEvents();\n  }\n\n  protected bindEvents(): void {\n    if (!this.$target) return;\n    this.$target.addEventListener('esl:show', this._onTargetStateChange);\n    this.$target.addEventListener('esl:hide', this._onTargetStateChange);\n\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('mouseenter', this._onMouseEnter);\n    this.addEventListener('mouseleave', this._onMouseLeave);\n  }\n  protected unbindEvents(): void {\n    if (!this.$target) return;\n    this.$target.removeEventListener('esl:show', this._onTargetStateChange);\n    this.$target.removeEventListener('esl:hide', this._onTargetStateChange);\n\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n  }\n\n  /** Update `$target` Toggleable  from `target` selector */\n  protected updateTargetFromSelector(): void {\n    if (!this.target) return;\n    this.$target = TraversingQuery.first(this.target, this) as ESLToggleable;\n\n    if (this.$target instanceof ESLToggleablePlaceholder && this.$target.$origin) {\n      // change target if it is an instance of the placeholder element\n      this.$target = this.$target.$origin;\n    }\n  }\n\n  /** Check if the event target should be ignored */\n  protected isTargetIgnored(target: EventTarget | null): boolean {\n    if (!target || !(target instanceof HTMLElement) || !this.ignore) return false;\n    const $ignore = target.closest(this.ignore);\n    // Ignore only inner elements (but do not ignore the trigger itself)\n    return !!$ignore && $ignore !== this && this.contains($ignore);\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLTrigger, ...params: ToggleableActionParams[]): ToggleableActionParams {\n    return Object.assign({\n      initiator: 'trigger',\n      activator: this\n    }, ...params);\n  }\n\n  /** Show target toggleable with passed params */\n  public showTarget(params: ToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.showDelay)\n    }, params);\n    if (this.$target && typeof this.$target.show === 'function') {\n      this.$target.show(actionParams);\n    }\n  }\n  /** Hide target toggleable with passed params */\n  public hideTarget(params: ToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.hideDelay)\n    }, params);\n    if (this.$target && typeof this.$target.hide === 'function') {\n      this.$target.hide(actionParams);\n    }\n  }\n  /** Toggles target toggleable with passed params */\n  public toggleTarget(params: ToggleableActionParams = {}, state: boolean = !this.active): void {\n    state ? this.showTarget(params) : this.hideTarget(params);\n  }\n\n  /**\n   * Updates trigger state according to toggleable state\n   * Does not produce `esl:change:active` event\n   */\n  public updateState(): boolean {\n    const isActive = !!this.$target?.open;\n    const wasActive = this.active;\n\n    this.toggleAttribute('active', isActive);\n    const clsTarget = TraversingQuery.first(this.activeClassTarget, this) as HTMLElement;\n    clsTarget && CSSClassUtils.toggle(clsTarget, this.activeClass, isActive);\n\n    this.updateA11y();\n\n    return isActive !== wasActive;\n  }\n\n  /** Handles ESLToggleable state change */\n  @bind\n  protected _onTargetStateChange(originalEvent?: Event): void {\n    if (!this.updateState()) return;\n    const detail = {active: this.active, originalEvent};\n    this.$$fire('change:active', {detail});\n  }\n\n  /** Handles `click` event */\n  @bind\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles `keydown` event */\n  @bind\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE].includes(event.key) || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles hover `mouseenter` event */\n  @bind\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    const delay = parseNumber(this.hoverShowDelay);\n    this.toggleTarget({event, delay}, this.mode !== 'hide');\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @bind\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    if (this.mode === 'show' || this.mode === 'hide') return;\n    const delay = parseNumber(this.hoverHideDelay);\n    this.hideTarget({event, delay, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Set initial a11y attributes. Do nothing if trigger contains actionable element */\n  public initA11y(): void {\n    if (this.$a11yTarget !== this) return;\n    if (!this.hasAttribute('role')) this.setAttribute('role', 'button');\n    if (this.getAttribute('role') === 'button' && !this.hasAttribute('tabindex')) {\n      this.setAttribute('tabindex', '0');\n    }\n  }\n\n  /** Update aria attributes */\n  public updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    target.setAttribute('aria-expanded', String(this.active));\n    if (this.$target && this.$target.id) {\n      target.setAttribute('aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Trigger: typeof ESLTrigger;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-trigger': ESLTrigger;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLTrigger} from '../../esl-trigger/core';\nimport {attr} from '../../esl-base-element/decorators/attr';\n\n/**\n * ESlTab component\n * @author Julia Murashko\n *\n * Tab trigger item, usually used in conjunction with a {@link ESLTabs}.\n * Can control any {@link ESLToggleable} instance but is usually used in conjunction with {@link ESLPanel}\n */\n@ExportNs('Tab')\nexport class ESLTab extends ESLTrigger {\n  public static is = 'esl-tab';\n\n  @attr({defaultValue: 'show'}) public mode: string;\n  @attr({defaultValue: 'active'}) public activeClass: string;\n\n  public initA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    if (target.hasAttribute('role')) return;\n    target.setAttribute('role', 'tab');\n  }\n\n  public updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    target.setAttribute('aria-selected', String(this.active));\n    target.setAttribute('tabindex', this.active ? '0' : '-1');\n\n    if (this.$target && this.$target.id) {\n      this.setAttribute('aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tab: typeof ESLTab;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tab': ESLTab;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ARROW_DOWN, ARROW_LEFT, ARROW_RIGHT, ARROW_UP} from '../../esl-utils/dom/keys';\n\n/** Relative targeting type definition */\nexport type GroupTarget = 'next' | 'prev' | 'current';\n\n/**\n * ESLA11yGroup component\n * @author Julia Murashko\n *\n * ESLA11yGroup - helper custom element that adds a11y group behavior to targets.\n */\n@ExportNs('A11yGroup')\nexport class ESLA11yGroup extends ESLBaseElement {\n  public static is = 'esl-a11y-group';\n\n  /** Target elements multiple selector ({@link TraversingQuery} syntax) */\n  @attr({defaultValue: '::child'}) public targets: string;\n\n  /** Activates target (via click event) on selection */\n  @boolAttr({}) public activateSelected: boolean;\n  /** Prevents scroll when target receives focus */\n  @boolAttr({}) public preventScroll: boolean;\n\n  /** @returns HTMLElement root element of the group */\n  public get $root(): HTMLElement | null {\n    return this.parentElement;\n  }\n  /** @returns HTMLElement[] targets of the group */\n  public get $targets(): HTMLElement[] {\n    if (!this.$root) return [];\n    return TraversingQuery.all(this.targets, this.$root) as HTMLElement[];\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.bindEvents();\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n  }\n\n  protected bindEvents(): void {\n    this.$root?.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents(): void {\n    this.$root?.removeEventListener('keydown', this._onKeydown);\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n\n    if (!this.$targets.includes(target)) return;\n\n    if ([ARROW_UP, ARROW_LEFT].includes(e.key)) {\n      this.goTo('prev', target);\n      e.preventDefault();\n    }\n\n    if ([ARROW_DOWN, ARROW_RIGHT].includes(e.key)) {\n      this.goTo('next', target);\n      e.preventDefault();\n    }\n  }\n\n  /** Go to the target from the passed element or currently focused target by default */\n  public goTo(target: GroupTarget, from: HTMLElement | null = this.current()): void {\n    if (!from) return;\n    const targetEl = this[target](from);\n    if (!targetEl) return;\n    targetEl.focus({preventScroll: this.preventScroll});\n    this.activateSelected && targetEl.click();\n  }\n\n  /** @returns HTMLElement next target fot trigger */\n  public next(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index + 1) % triggers.length];\n  }\n\n  /** @returns HTMLElement previous target fot trigger */\n  public prev(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index - 1 + triggers.length) % triggers.length];\n  }\n\n  /** @returns HTMLElement currently focused element from targets */\n  public current(): HTMLElement | null {\n    const $active = document.activeElement as HTMLElement;\n    return this.$targets.includes($active) ? $active : null;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    A11yGroup: typeof ESLA11yGroup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-a11y-group': ESLA11yGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr} from '../../esl-base-element/core';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaRuleList} from '../../esl-media-query/core/esl-media-rule-list';\nimport {ESLTab} from './esl-tab';\n\n/**\n * ESlTabs component\n * @author Julia Murashko\n *\n * Tabs container component for Tabs trigger group.\n * Uses {@link ESLTab} as an item.\n * Each individual {@link ESLTab} can control {@link ESLToggleable} or, usually, {@link ESLPanel}\n */\n@ExportNs('Tabs')\nexport class ESLTabs extends ESLBaseElement {\n  public static is = 'esl-tabs';\n\n  /** List of supported scrollable types */\n  public static supportedScrollableTypes = ['disabled', 'side', 'center'];\n\n  /**\n   * Scrollable mode.\n   * Supported types for different breakpoints ('disabled' by default):\n   * - 'disabled' or not defined -  scroll behavior is disabled;\n   * - 'center' - scroll behavior is enabled, tab is center-aligned;\n   * - 'side' - scroll behavior is enabled, tab is side-aligned;\n   * - empty or unsupported value - scroll behavior is enabled, tab is side-aligned;\n   */\n  @attr({defaultValue: 'disabled'}) public scrollable: string;\n\n  /** Inner element to contain {@link ESLTab} collection. Will be scrolled in a scrollable mode */\n  @attr({defaultValue: '.esl-tab-container'}) public scrollableTarget: string;\n\n  protected _deferredUpdateArrows = debounce(this.updateArrows, 100, this);\n  protected _deferredFitToViewport = debounce(this.fitToViewport, 100, this);\n\n  static get observedAttributes(): string[] {\n    return ['scrollable'];\n  }\n\n  /** ESLMediaRuleList instance of the scrollable type mapping */\n  @memoize()\n  public get scrollableTypeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.scrollable);\n  }\n\n  /** @returns current scrollable type */\n  public get currentScrollableType(): string {\n    return this.scrollableTypeRules.activeValue || '';\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.scrollableTypeRules.addListener(this._onScrollableTypeChange);\n    this.updateScrollableType();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.scrollableTypeRules.removeListener(this._onScrollableTypeChange);\n    this.unbindScrollableEvents();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'scrollable') {\n      this.scrollableTypeRules.removeListener(this._onScrollableTypeChange);\n      memoize.clear(this, 'scrollableTypeRules');\n      this.scrollableTypeRules.addListener(this._onScrollableTypeChange);\n      this.updateScrollableType();\n    }\n  }\n\n  protected bindScrollableEvents(): void {\n    this.addEventListener('esl:change:active', this._onTriggerStateChange);\n    this.addEventListener('click', this._onClick, false);\n    this.addEventListener('focusin', this._onFocus);\n    this.$scrollableTarget?.addEventListener('scroll', this._onScroll, {passive: true});\n\n    window.addEventListener('resize', this._onResize);\n  }\n  protected unbindScrollableEvents(): void {\n    this.removeEventListener('esl:change:active', this._onTriggerStateChange);\n    this.removeEventListener('click', this._onClick, false);\n    this.removeEventListener('focusin', this._onFocus);\n    this.$scrollableTarget?.removeEventListener('scroll', this._onScroll);\n\n    window.removeEventListener('resize', this._onResize);\n  }\n\n  /** Collection of inner {@link ESLTab} items */\n  public get $tabs(): ESLTab[] {\n    const els = this.querySelectorAll(ESLTab.is);\n    return els ? Array.from(els) as ESLTab[] : [];\n  }\n\n  /** Active {@link ESLTab} item */\n  public get $current(): ESLTab | null {\n    return this.$tabs.find((el) => el.active) || null;\n  }\n\n  /** Container element to scroll */\n  public get $scrollableTarget(): HTMLElement | null {\n    return this.querySelector(this.scrollableTarget);\n  }\n\n  /** Is the scrollable mode enabled ? */\n  public get isScrollable(): boolean {\n    return this.currentScrollableType !== 'disabled';\n  }\n\n  /** Move scroll to the next/previous item */\n  public moveTo(direction: string, behavior: ScrollBehavior = 'smooth'): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n    let left = $scrollableTarget.offsetWidth;\n    left = RTLUtils.isRtl(this) && RTLUtils.scrollType !== 'reverse' ? -left : left;\n    left = direction === 'left' ? -left : left;\n\n    $scrollableTarget.scrollBy({left, behavior});\n  }\n\n  /** Scroll tab to the view */\n  protected fitToViewport($trigger: ESLTab | null, behavior: ScrollBehavior = 'smooth'): void {\n    this.updateMarkers();\n\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget || !$trigger) return;\n\n    const areaRect = $scrollableTarget.getBoundingClientRect();\n    const itemRect = $trigger.getBoundingClientRect();\n\n    $scrollableTarget.scrollBy({\n      left: this.calcScrollOffset(itemRect, areaRect),\n      behavior\n    });\n\n    this.updateArrows();\n  }\n\n  /** Get scroll offset position from the selected item rectangle */\n  protected calcScrollOffset(itemRect: DOMRect, areaRect: DOMRect): number | undefined {\n    const isReversedRTL = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'reverse';\n\n    if (this.currentScrollableType === 'center') {\n      const shift = itemRect.left + itemRect.width / 2 - (areaRect.left + areaRect.width / 2);\n      return isReversedRTL ? -shift : shift;\n    }\n\n    // item is out of area from the right side\n    // else item out is of area from the left side\n    if (itemRect.right > areaRect.right) {\n      return isReversedRTL ? Math.floor(areaRect.right - itemRect.right) : Math.ceil(itemRect.right - areaRect.right);\n    } else if (itemRect.left < areaRect.left) {\n      return isReversedRTL ? Math.ceil(areaRect.left - itemRect.left) : Math.floor(itemRect.left - areaRect.left);\n    }\n  }\n\n  protected updateArrows(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const swapSides = RTLUtils.isRtl(this) && RTLUtils.scrollType === 'default';\n    const scrollStart = Math.abs($scrollableTarget.scrollLeft) > 1;\n    const scrollEnd = Math.abs($scrollableTarget.scrollLeft) + $scrollableTarget.clientWidth + 1 < $scrollableTarget.scrollWidth;\n\n    const $rightArrow = this.querySelector('[data-tab-direction=\"right\"]');\n    const $leftArrow = this.querySelector('[data-tab-direction=\"left\"]');\n\n    $leftArrow && $leftArrow.toggleAttribute('disabled', !(swapSides ? scrollEnd : scrollStart));\n    $rightArrow && $rightArrow.toggleAttribute('disabled', !(swapSides ? scrollStart : scrollEnd));\n  }\n\n  protected updateMarkers(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const hasScroll = this.isScrollable && ($scrollableTarget.scrollWidth > this.clientWidth);\n    this.toggleAttribute('has-scroll', hasScroll);\n  }\n\n  /** Update element state according to scrollable type */\n  protected updateScrollableType(): void {\n    ESLTabs.supportedScrollableTypes.forEach((type) => {\n      CSSClassUtils.toggle(this, `${type}-alignment`, this.currentScrollableType === type);\n    });\n\n    this._deferredFitToViewport(this.$current);\n\n    if (this.currentScrollableType === 'disabled') {\n      this.unbindScrollableEvents();\n    } else {\n      this.bindScrollableEvents();\n    }\n  }\n\n  @bind\n  protected _onTriggerStateChange({detail}: CustomEvent): void {\n    if (!detail.active) return;\n    this._deferredFitToViewport(this.$current);\n  }\n\n  @bind\n  protected _onClick(event: Event): void {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const target: HTMLElement | null = eventTarget.closest('[data-tab-direction]');\n    const direction = target && target.dataset.tabDirection;\n\n    if (!direction) return;\n    this.moveTo(direction);\n  }\n\n  @bind\n  protected _onFocus(e: FocusEvent): void {\n    const target = e.target;\n    if (target instanceof ESLTab) this._deferredFitToViewport(target);\n  }\n\n  @bind\n  protected _onScroll(): void {\n    this._deferredUpdateArrows();\n  }\n\n  // TODO: is the raf decorator needed?\n  protected _onResize = rafDecorator(() => this._deferredFitToViewport(this.$current, 'auto'));\n\n  /** Handles scrollable type change */\n  @bind\n  protected _onScrollableTypeChange(): void {\n    this.updateScrollableType();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tabs: typeof ESLTabs;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-tabs': ESLTabs;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr, boolAttr} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {isRelativeNode} from '../../esl-utils/dom/traversing';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {RTLUtils} from '../../esl-utils/dom/rtl';\n\n/**\n * ESLScrollbar is a reusable web component that replaces the browser's default scrollbar with\n * a custom scrollbar implementation.\n *\n * @author Yuliya Adamskaya\n */\n@ExportNs('Scrollbar')\nexport class ESLScrollbar extends ESLBaseElement {\n  public static is = 'esl-scrollbar';\n\n  /** Horizontal scroll orientation marker */\n  @boolAttr() public horizontal: boolean;\n  /** Disable continuous scroll when the mouse pressed on scrollbar */\n  @boolAttr() public noContinuousScroll: boolean;\n\n  /** Target element {@link TraversingQuery} selector. Parent element by default */\n  @attr({defaultValue: '::parent'}) public target: string;\n  /** Custom class for thumb element. 'scrollbar-thumb' by default */\n  @attr({defaultValue: 'scrollbar-thumb'}) public thumbClass: string;\n  /** Custom class for track element area. 'scrollbar-track' by default */\n  @attr({defaultValue: 'scrollbar-track'}) public trackClass: string;\n\n  /** @readonly Dragging state marker */\n  @boolAttr({readonly: true}) public dragging: boolean;\n  /** @readonly Inactive state marker */\n  @boolAttr({readonly: true}) public inactive: boolean;\n\n  /** @readonly Indicates that the scroll is at the beginning */\n  @boolAttr({readonly: true}) public atStart: boolean;\n  /** @readonly Indicates that the scroll is at the end */\n  @boolAttr({readonly: true}) public atEnd: boolean;\n\n  protected $scrollbarThumb: HTMLElement;\n  protected $scrollbarTrack: HTMLElement;\n\n  protected _$target: HTMLElement | null;\n  protected _pointerPosition: number;\n  protected _initialPosition: number;\n  protected _initialMousePosition: number;\n\n  protected _deferredDrag = rafDecorator((e) => this._onPointerDrag(e));\n  protected _deferredRefresh = rafDecorator(() => this.refresh());\n  protected _scrollTimer: number = 0;\n  protected _resizeObserver = new ResizeObserver(this._deferredRefresh);\n  protected _mutationObserver = new MutationObserver((rec) => this.updateContentObserve(rec));\n\n  static get observedAttributes(): string[] {\n    return ['target', 'horizontal'];\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.findTarget();\n    this.render();\n    this.bindEvents();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    this.unbindEvents();\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected && oldVal === newVal) return;\n    if (attrName === 'target') this.findTarget();\n    if (attrName === 'horizontal') this.refresh();\n  }\n\n  protected findTarget(): void {\n    this.$target = this.target ?\n      TraversingQuery.first(this.target, this) as HTMLElement :\n      null;\n  }\n\n  /** Target element to observe and scroll */\n  public get $target(): HTMLElement | null {\n    return this._$target || null;\n  }\n\n  public set $target(content: HTMLElement | null) {\n    this.unbindTargetEvents();\n    this._$target = content;\n    this.bindTargetEvents();\n    this._deferredRefresh();\n  }\n\n  protected render(): void {\n    this.innerHTML = '';\n    this.$scrollbarTrack = document.createElement('div');\n    this.$scrollbarTrack.className = this.trackClass;\n    this.$scrollbarThumb = document.createElement('div');\n    this.$scrollbarThumb.className = this.thumbClass;\n\n    this.$scrollbarTrack.appendChild(this.$scrollbarThumb);\n    this.appendChild(this.$scrollbarTrack);\n  }\n\n  protected bindEvents(): void {\n    window.MouseEvent && this.addEventListener('mousedown', this._onPointerDown);\n    window.TouchEvent && this.addEventListener('touchstart', this._onPointerDown);\n    window.addEventListener('esl:refresh', this._onRefresh);\n  }\n\n  protected bindTargetEvents(): void {\n    if (!this.$target) return;\n    if (document.documentElement === this.$target) {\n      window.addEventListener('resize', this._onRefresh, {passive: true});\n      window.addEventListener('scroll', this._onRefresh, {passive: true});\n    } else {\n      this._resizeObserver.observe(this.$target);\n      this._mutationObserver.observe(this.$target, {childList: true});\n      Array.from(this.$target.children).forEach((el) => this._resizeObserver.observe(el));\n      this.$target.addEventListener('scroll', this._onRefresh, {passive: true});\n    }\n  }\n\n  protected updateContentObserve(recs: MutationRecord[] = []): void {\n    if (!this.$target) return;\n    const contentChanges = recs.filter((rec) => rec.type === 'childList');\n    contentChanges.forEach((rec) => {\n      Array.from(rec.addedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.observe(el));\n      Array.from(rec.removedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.unobserve(el));\n    });\n    if (contentChanges.length) this._deferredRefresh();\n  }\n\n  protected unbindEvents(): void {\n    window.MouseEvent && this.removeEventListener('mousedown', this._onPointerDown);\n    window.TouchEvent && this.removeEventListener('touchstart', this._onPointerDown);\n    this.unbindTargetEvents();\n    window.removeEventListener('esl:refresh', this._onRefresh);\n  }\n\n  protected unbindTargetEvents(): void {\n    if (!this.$target) return;\n    if (document.documentElement === this.$target) {\n      window.removeEventListener('resize', this._onRefresh);\n      window.removeEventListener('scroll', this._onRefresh);\n    } else {\n      this._resizeObserver.disconnect();\n      this._mutationObserver.disconnect();\n      this.$target.removeEventListener('scroll', this._onRefresh);\n    }\n  }\n\n  /** @readonly Scrollable distance size value (px) */\n  public get scrollableSize(): number {\n    if (!this.$target) return 0;\n    return this.horizontal ?\n      this.$target.scrollWidth - this.$target.clientWidth :\n      this.$target.scrollHeight - this.$target.clientHeight;\n  }\n\n  /** @readonly Track size value (px) */\n  public get trackOffset(): number {\n    return this.horizontal ? this.$scrollbarTrack.offsetWidth : this.$scrollbarTrack.offsetHeight;\n  }\n\n  /** @readonly Thumb size value (px) */\n  public get thumbOffset(): number {\n    return this.horizontal ? this.$scrollbarThumb.offsetWidth : this.$scrollbarThumb.offsetHeight;\n  }\n\n  /** @readonly Relative thumb size value (between 0.0 and 1.0) */\n  public get thumbSize(): number {\n    // behave as native scroll\n    if (!this.$target || !this.$target.scrollWidth || !this.$target.scrollHeight) return 1;\n    const areaSize = this.horizontal ? this.$target.clientWidth : this.$target.clientHeight;\n    const scrollSize = this.horizontal ? this.$target.scrollWidth : this.$target.scrollHeight;\n    return Math.min((areaSize + 1) / scrollSize, 1);\n  }\n\n  /** Relative position value (between 0.0 and 1.0) */\n  public get position(): number {\n    if (!this.$target) return 0;\n    const scrollOffset = this.horizontal ? RTLUtils.normalizeScrollLeft(this.$target) : this.$target.scrollTop;\n    return this.scrollableSize ? (scrollOffset / this.scrollableSize) : 0;\n  }\n\n  public set position(position: number) {\n    this.scrollTargetTo(this.scrollableSize * this.normalizePosition(position));\n    this.update();\n  }\n\n  /** Normalizes position value (between 0.0 and 1.0) */\n  protected normalizePosition(position: number): number {\n    const relativePosition = Math.min(1, Math.max(0, position));\n    if (!RTLUtils.isRtl(this.$target) || !this.horizontal) return relativePosition;\n    return RTLUtils.scrollType === 'negative' ? (relativePosition - 1) : (1 - relativePosition);\n  }\n\n  /** Scrolls target element to passed position */\n  protected scrollTargetTo(pos: number): void {\n    if (!this.$target) return;\n    this.$target.scrollTo({\n      [this.horizontal ? 'left' : 'top']: pos,\n      behavior: this.dragging ? 'auto' : 'smooth'\n    });\n  }\n\n  /** Updates thumb size and position */\n  public update(): void {\n    this.$$fire('change:scroll', {bubbles: false});\n    if (!this.$scrollbarThumb || !this.$scrollbarTrack) return;\n    const thumbSize = this.trackOffset * this.thumbSize;\n    const thumbPosition = (this.trackOffset - thumbSize) * this.position;\n    const style = {\n      [this.horizontal ? 'left' : 'top']: `${thumbPosition}px`,\n      [this.horizontal ? 'width' : 'height']: `${thumbSize}px`\n    };\n    Object.assign(this.$scrollbarThumb.style, style);\n  }\n\n  /** Updates auxiliary markers */\n  public updateMarkers(): void {\n    const {position, thumbSize} =  this;\n    this.toggleAttribute('at-start', thumbSize < 1 && position <= 0);\n    this.toggleAttribute('at-end', thumbSize < 1 && position >= 1);\n    this.toggleAttribute('inactive', thumbSize >= 1);\n  }\n\n  /** Refreshes scroll state and position */\n  public refresh(): void {\n    this.update();\n    this.updateMarkers();\n  }\n\n  /** Returns position from MouseEvent coordinates (not normalized) */\n  public toPosition(event: MouseEvent | TouchEvent): number {\n    const {horizontal, thumbOffset, trackOffset} = this;\n    const point = EventUtils.normalizeCoordinates(event, this.$scrollbarTrack);\n    const pointPosition = horizontal ? point.x : point.y;\n    const freeTrackArea = trackOffset - thumbOffset; // size of free track px\n    const clickPositionNoOffset = pointPosition - thumbOffset / 2;\n    return clickPositionNoOffset / freeTrackArea;\n  }\n\n  // Event listeners\n  /** Handles `mousedown` / `touchstart` event to manage thumb drag start and scroll clicks */\n  @bind\n  protected _onPointerDown(event: MouseEvent | TouchEvent): void {\n    this._initialPosition = this.position;\n    this._pointerPosition = this.toPosition(event);\n    const point = EventUtils.normalizeTouchPoint(event);\n    this._initialMousePosition = this.horizontal ? point.x : point.y;\n\n    if (event.target === this.$scrollbarThumb) {\n      this._onThumbPointerDown(event); // Drag start handler\n    } else {\n      this._onPointerDownTick(true); // Continuous scroll and click handler\n    }\n\n    // Subscribe inverse handlers\n    EventUtils.isMouseEvent(event) && window.addEventListener('mouseup', this._onPointerUp);\n    EventUtils.isTouchEvent(event) && window.addEventListener('touchend', this._onPointerUp, {passive: false});\n\n    // Prevents default text selection, etc.\n    event.preventDefault();\n  }\n\n  /** Handles a scroll click / continuous scroll*/\n  @bind\n  protected _onPointerDownTick(first: boolean): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n\n    const position = this.position;\n    const allowedOffset = (first ? 1 : 1.5) * this.thumbSize;\n    this.position = Math.min(position + allowedOffset, Math.max(position - allowedOffset, this._pointerPosition));\n\n    if (this.position === this._pointerPosition || this.noContinuousScroll) return;\n    this._scrollTimer = window.setTimeout(this._onPointerDownTick, 400);\n  }\n\n  /** Handles thumb drag start */\n  @bind\n  protected _onThumbPointerDown(event: MouseEvent | TouchEvent): void {\n    this.toggleAttribute('dragging', true);\n    this.$target?.style.setProperty('scroll-behavior', 'auto');\n    // Attach drag listeners\n    window.addEventListener('click', this._onBodyClick, {capture: true});\n    EventUtils.isMouseEvent(event) && window.addEventListener('mousemove', this._onPointerMove);\n    EventUtils.isTouchEvent(event) && window.addEventListener('touchmove', this._onPointerMove, {passive: false});\n  }\n\n  /** Sets position on drag */\n  protected _onPointerDrag(event: MouseEvent | TouchEvent): void {\n    const point = EventUtils.normalizeTouchPoint(event);\n    const mousePosition = this.horizontal ? point.x : point.y;\n    const positionChange = mousePosition - this._initialMousePosition;\n    const scrollableAreaHeight = this.trackOffset - this.thumbOffset;\n    const absChange = scrollableAreaHeight ? (positionChange / scrollableAreaHeight) : 0;\n    this.position = this._initialPosition + absChange;\n\n    this.updateMarkers();\n  }\n\n  /** `mousemove` document handler for thumb drag event. Active only if drag action is active */\n  @bind\n  protected _onPointerMove(event: MouseEvent | TouchEvent): void {\n    if (!this.dragging) return;\n    // Request position update\n    this._deferredDrag(event);\n    // Prevents default text selection, etc.\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /** `mouseup` short-time document handler for drag end action */\n  @bind\n  protected _onPointerUp(event: MouseEvent | TouchEvent): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n    this.toggleAttribute('dragging', false);\n    this.$target?.style.removeProperty('scroll-behavior');\n\n    // Unbind drag listeners\n    if (EventUtils.isMouseEvent(event)) {\n      window.removeEventListener('mousemove', this._onPointerMove);\n      window.removeEventListener('mouseup', this._onPointerUp);\n    }\n    if (EventUtils.isTouchEvent(event)) {\n      window.removeEventListener('touchmove', this._onPointerMove);\n      window.removeEventListener('touchend', this._onPointerUp);\n    }\n  }\n\n  /** Body `click` short-time handler to prevent clicks event on thumb drag. Handles capture phase */\n  @bind\n  protected _onBodyClick(event: MouseEvent): void {\n    event.stopImmediatePropagation();\n\n    window.removeEventListener('click', this._onBodyClick, {capture: true});\n  }\n\n  /**\n   * Handler for refresh events to update the scroll.\n   * @param event - instance of 'resize' or 'scroll' or 'esl:refresh' event.\n   */\n  @bind\n  protected _onRefresh(event: Event): void {\n    const target = event.target as HTMLElement;\n    if (event.type === 'scroll' && this.dragging) return;\n    if (event.type === 'esl:refresh' && !isRelativeNode(target.parentNode, this.$target)) return;\n    this._deferredRefresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Scrollbar: typeof ESLScrollbar;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-scrollbar': ESLScrollbar;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {attr, jsonAttr} from '../../esl-base-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {createZIndexIframe} from '../../esl-utils/fixes/ie-fixes';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ToggleableActionParams} from '../../esl-toggleable/core';\n\nexport interface AlertActionParams extends ToggleableActionParams {\n  /** text to be shown; passes empty string or null to hide */\n  text?: string;\n  /** html content */\n  html?: string;\n  /** classes to add to alert element */\n  cls?: string;\n  /** timeout to clear classes */\n  hideTime?: number;\n}\n\n/**\n * ESLAlert component\n *\n * @author Julia Murashko\n *\n * ESLAlert is a component to show small notifications on your pages. ESLAlert can have multiple instances on the page.\n */\n@ExportNs('Alert')\nexport class ESLAlert extends ESLToggleable {\n  static is = 'esl-alert';\n  static eventNs = 'esl:alert';\n\n  static get observedAttributes(): string[] {\n    return ['target'];\n  }\n\n  /** Default show/hide params for all ESLAlert instances */\n  static defaultConfig: AlertActionParams = {\n    hideTime: 300,\n    hideDelay: 2500\n  };\n\n  /**\n   * Defines the scope (using {@link TraversingQuery} syntax) element to listen for an activation event.\n   * Parent element by default\n   */\n  @attr({defaultValue: '::parent'}) public target: string;\n\n  /** Default show/hide params for current ESLAlert instance */\n  @jsonAttr<AlertActionParams>()\n  public defaultParams: AlertActionParams;\n\n  protected $content: HTMLElement;\n  protected activeCls?: string;\n\n  private _$target: EventTarget;\n  private _clearTimeout: number;\n\n  /** Creates global alert instance (using body element as a base) */\n  public static init(options?: Partial<ESLAlert>): ESLAlert {\n    let alert: ESLAlert = document.querySelector(`body > ${ESLAlert.is}`)!;\n    if (!alert) {\n      alert = document.createElement(ESLAlert.is) as ESLAlert;\n      options && Object.assign(alert, options);\n      document.body.appendChild(alert);\n    }\n    return alert;\n  }\n\n  protected mergeDefaultParams(params?: ToggleableActionParams): ToggleableActionParams {\n    const type = this.constructor as typeof ESLAlert;\n    return Object.assign({}, type.defaultConfig, this.defaultParams || {}, params || {});\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') {\n      this.$target = TraversingQuery.first(this.target) as EventTarget;\n    }\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.setAttribute('role', this.getAttribute('role') || 'alert');\n    this.$content = document.createElement('div');\n    this.$content.className = 'esl-alert-content';\n    this.innerHTML = '';\n    this.appendChild(this.$content);\n    if (DeviceDetector.isIE) this.appendChild(createZIndexIframe());\n    if (this.target) {\n      this.$target = TraversingQuery.first(this.target, this) as EventTarget;\n    }\n  }\n\n  protected unbindEvents(): void {\n    super.unbindEvents();\n    this.unbindTargetEvents();\n  }\n\n  /** Target element to listen to activation events */\n  public get $target(): EventTarget {\n    return this._$target;\n  }\n  public set $target($el: EventTarget) {\n    this.unbindTargetEvents();\n    this._$target = $el;\n    this.bindTargetEvents();\n  }\n\n  protected bindTargetEvents(): void {\n    if (!this.$target || !this.connected) return;\n    this.$target.addEventListener(`${ESLAlert.eventNs}:show`, this._onTargetEvent);\n    this.$target.addEventListener(`${ESLAlert.eventNs}:hide`, this._onTargetEvent);\n  }\n  protected unbindTargetEvents(): void {\n    if (!this.$target) return;\n    this.$target.removeEventListener(`${ESLAlert.eventNs}:show`, this._onTargetEvent);\n    this.$target.removeEventListener(`${ESLAlert.eventNs}:hide`, this._onTargetEvent);\n  }\n\n  protected onShow(params: AlertActionParams): void {\n    if (this._clearTimeout) window.clearTimeout(this._clearTimeout);\n    if (params.html || params.text) {\n      this.render(params);\n      super.onShow(params);\n    }\n    this.hide(params);\n  }\n  protected onHide(params: AlertActionParams): void {\n    super.onHide(params);\n    this._clearTimeout = window.setTimeout(() => this.clear(), params.hideTime);\n  }\n\n  protected render({text, html, cls}: AlertActionParams): void {\n    CSSClassUtils.remove(this, this.activeCls);\n    CSSClassUtils.add(this, this.activeCls = cls);\n    if (html) this.$content.innerHTML = html;\n    if (text) this.$content.textContent = text;\n  }\n  protected clear(): void {\n    this.$content.innerHTML = '';\n    CSSClassUtils.remove(this, this.activeCls);\n  }\n\n  @bind\n  protected _onTargetEvent(e: CustomEvent): void {\n    if (e.type === `${ESLAlert.eventNs}:show`) {\n      const params = Object.assign({}, e.detail, {force: true});\n      this.show(params);\n    }\n    if (e.type === `${ESLAlert.eventNs}:hide`) {\n      const params = Object.assign({}, {hideDelay: 0}, e.detail, {force: true});\n      this.hide(params);\n    }\n    e.stopPropagation();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Alert: typeof ESLAlert;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-alert': ESLAlert;\n  }\n}\n","/** Fix IE browser to allow to display alert under iframe */\nexport function createZIndexIframe(): HTMLElement {\n  const iframe = document.createElement('iframe');\n  iframe.className = 'ie-zindex-fix';\n  iframe.src = 'about:blank';\n  return iframe;\n}\n","import {attr, boolAttr, ESLBaseElement} from '../../../esl-base-element/core';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nimport type {ESLSelectOption} from './esl-select-wrapper';\n\n/**\n * ESLSelectItem component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectItem - inner component to render an option\n */\n@ExportNs('SelectItem')\nexport class ESLSelectItem extends ESLBaseElement {\n  public static readonly is: string = 'esl-select-item';\n\n  public static get observedAttributes(): string[] {\n    return ['selected', 'disabled'];\n  }\n\n  /** Option value */\n  @attr() public value: string;\n  /** Selected state marker */\n  @boolAttr() public selected: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n\n  /** Original option */\n  public original: ESLSelectOption;\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.tabIndex = 0;\n    this.setAttribute('role', 'checkbox');\n    this.setAttribute('aria-selected', String(this.selected));\n  }\n\n  protected attributeChangedCallback(attrName: string): void {\n    if (attrName === 'selected') {\n      this.setAttribute('aria-selected', String(this.selected));\n    }\n    if (attrName === 'disabled') {\n      this.setAttribute('aria-disabled', String(this.disabled));\n    }\n  }\n\n  public update(option?: ESLSelectOption): void {\n    if (option) this.original = option;\n    this.value = this.original.value;\n    this.disabled = this.original.disabled;\n    this.selected = this.original.selected;\n    this.textContent = this.original.text;\n  }\n\n  /** Helper to create an option item */\n  public static build(option: ESLSelectOption): ESLSelectItem {\n    const item = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    item.update(option);\n    return item;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectItem: typeof ESLSelectItem;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-item': ESLSelectItem;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {EventUtils} from '../../../esl-utils/dom/events';\nimport {bind} from '../../../esl-utils/decorators/bind';\n\n/** Interface for option definition */\nexport interface ESLSelectOption {\n  /** Label text of the option */\n  text: string;\n  /** Value of the option */\n  value: string;\n  /** Disabled marker */\n  disabled: boolean;\n  /** Selected marker */\n  selected: boolean;\n  /** Initially selected marker */\n  defaultSelected: boolean;\n}\n\n/** Interface to declare options source for select components */\nexport interface ESLSelectModel {\n  /** Allow multiple items */\n  multiple: boolean;\n  /** Get list of options */\n  options: ESLSelectOption[];\n  /** Get list of selected options */\n  selectedOptions: ESLSelectOption[];\n\n  /** Toggle option with passed value to the state */\n  setSelected(value: string, state: boolean): void;\n  /** Check selected state*/\n  isSelected(value: string): boolean;\n  /** Has selected options */\n  hasSelected(): boolean;\n\n  /** Check that all options are selected */\n  isAllSelected(): boolean;\n  /** Toggle all options to the state */\n  setAllSelected(state: boolean): void;\n}\n\n/**\n * Base class for {@link HTMLSelectElement} wrapper element, implements {@link ESLSelectModel} options source\n */\nexport abstract class ESLSelectWrapper extends ESLBaseElement implements ESLSelectModel {\n  protected static observationConfig: MutationObserverInit = {\n    subtree: true,\n    attributes: true,\n    attributeFilter: ['value', 'selected', 'disabled'],\n    childList: true,\n    characterData: true\n  };\n\n  private _$select: HTMLSelectElement;\n  private _mutationObserver = new MutationObserver(this._onTargetMutation.bind(this));\n\n  /** Native select that is wrapped */\n  public get $select(): HTMLSelectElement {\n    return this._$select;\n  }\n  public set $select(select: HTMLSelectElement) {\n    const prev = this._$select;\n    this._$select = select;\n    this._onTargetChange(select, prev);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.ownerDocument.addEventListener('reset', this._onReset);\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.ownerDocument.removeEventListener('reset', this._onReset);\n    this._mutationObserver.disconnect();\n    this._$select && this._$select.removeEventListener('change', this._onChange);\n  }\n\n  protected _onChange(event?: Event): void {}\n  protected _onListChange(): void {}\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined,\n                            oldTarget: HTMLSelectElement | undefined): void {\n    if (oldTarget) oldTarget.removeEventListener('change', this._onChange);\n    if (newTarget) newTarget.addEventListener('change', this._onChange);\n    this._mutationObserver.disconnect();\n    const type = (this.constructor as typeof ESLSelectWrapper);\n    if (newTarget) this._mutationObserver.observe(newTarget, type.observationConfig);\n  }\n  protected _onTargetMutation(changes: MutationRecord[]): void {\n    const isListChange = (change: MutationRecord): boolean => change.addedNodes.length + change.removedNodes.length > 0;\n    changes.some(isListChange) ? this._onListChange() : this._onChange();\n  }\n\n  @bind\n  protected _onReset(event: Event): void {\n    if (!event.target || event.target !== this.form) return;\n    setTimeout(() => this._onChange(event));\n  }\n\n  public get multiple(): boolean {\n    return this.$select && this.$select.multiple;\n  }\n\n  public get options(): ESLSelectOption[] {\n    return this.$select ? Array.from(this.$select.options) : [];\n  }\n  public get selectedOptions(): ESLSelectOption[] {\n    return this.options.filter((item) => item.selected);\n  }\n\n  protected getOption(value: string): ESLSelectOption | undefined {\n    return this.options.find((item) => item.value === value);\n  }\n\n  public setSelected(value: string, state: boolean): void {\n    const option = this.getOption(value);\n    option && (option.selected = state);\n    EventUtils.dispatch(this.$select, 'change');\n  }\n  public isSelected(value: string): boolean {\n    const opt = this.getOption(value);\n    return !!opt && opt.selected;\n  }\n  public hasSelected(): boolean {\n    return this.options.some((item) => item.selected);\n  }\n\n  public isAllSelected(): boolean {\n    return this.options.every((item) => item.selected || item.disabled);\n  }\n\n  public setAllSelected(state: boolean): void {\n    if (!this.multiple) return;\n    this.options.forEach((item: HTMLOptionElement) => item.selected = !item.disabled && state);\n    EventUtils.dispatch(this.$select, 'change');\n  }\n\n  // Proxy select methods and values\n  public get value(): string | undefined {\n    return this.$select?.value;\n  }\n  public get values(): string[] {\n    return this.selectedOptions.map((item: HTMLOptionElement) => item.value);\n  }\n\n  public get form(): HTMLFormElement | null {\n    return this.$select?.form;\n  }\n\n  public get name(): string {\n    return this.$select?.name;\n  }\n  public set name(name: string) {\n    this.$select && (this.$select.name = name);\n  }\n\n  public get required(): boolean {\n    return this.$select?.required;\n  }\n  public set required(required: boolean) {\n    this.$select && (this.$select.required = required);\n  }\n\n  // Validation API values\n  public get validity(): ValidityState {\n    return this.$select?.validity;\n  }\n  public get validationMessage(): string {\n    return this.$select?.validationMessage;\n  }\n  public get willValidate(): boolean {\n    return this.$select?.willValidate;\n  }\n\n  // Validation API methods\n  public checkValidity(): boolean {\n    return this.$select?.checkValidity();\n  }\n  public reportValidity(): boolean {\n    return this.$select?.reportValidity();\n  }\n  public setCustomValidity(error: string): void {\n    this.$select?.setCustomValidity(error);\n  }\n}\n","import {attr, boolAttr} from '../../../esl-base-element/core';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {ARROW_DOWN, ARROW_UP, ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLScrollbar} from '../../../esl-scrollbar/core';\nimport {ESLSelectItem} from './esl-select-item';\nimport {ESLSelectWrapper} from './esl-select-wrapper';\n\n/**\n * ESLSelectList component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectList is a component to show selectable list of items. Decorates native HTMLSelectElement\n */\n@ExportNs('SelectList')\nexport class ESLSelectList extends ESLSelectWrapper {\n  public static readonly is = 'esl-select-list';\n  public static get observedAttributes(): string[] {\n    return ['select-all-label', 'disabled'];\n  }\n\n  public static register(): void {\n    ESLSelectItem.register();\n    super.register();\n  }\n\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the list */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $items: ESLSelectItem[];\n  protected $list: HTMLDivElement;\n  protected $scroll: ESLScrollbar;\n  protected $selectAll: ESLSelectItem;\n\n  constructor() {\n    super();\n    this.$list = document.createElement('div');\n    this.$list.setAttribute('role', 'list');\n    this.$list.classList.add('esl-scrollable-content');\n    this.$list.classList.add('esl-select-list-container');\n    this.$scroll = document.createElement(ESLScrollbar.is) as ESLScrollbar;\n    this.$scroll.target = '::prev';\n    this.$selectAll = document.createElement(ESLSelectItem.is) as ESLSelectItem;\n    this.$selectAll.classList.add('esl-select-all-item');\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    if (attrName === 'select-all-label') {\n      this.$selectAll.textContent = newVal;\n    }\n    if (attrName === 'disabled') {\n      this._updateDisabled();\n    }\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.bindSelect();\n    this.bindEvents();\n\n    this._updateDisabled();\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.unbindEvents();\n  }\n\n  protected bindSelect(): void {\n    const target = this.querySelector('[esl-select-target]');\n    if (!target || !(target instanceof HTMLSelectElement)) return;\n    this.$select = target;\n  }\n\n  public bindEvents(): void {\n    if (!this.$select) return;\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  public unbindEvents(): void {\n    if (!this.$select) return;\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  protected _renderItems(): void {\n    if (!this.$select) return;\n    this.$list.innerHTML = '';\n    this.$items = this.options.map(ESLSelectItem.build);\n    if (this.pinSelected) {\n      this._renderGroup(this.$items.filter((option) => option.selected));\n      this._renderGroup(this.$items.filter((option) => !option.selected));\n    } else {\n      this._renderGroup(this.$items);\n    }\n    this.toggleAttribute('multiple', this.multiple);\n  }\n  protected _renderGroup(items: ESLSelectItem[]): void {\n    items.forEach((item) => this.$list.appendChild(item));\n    const [last] = items.slice(-1);\n    last && last.classList.add('last-in-group');\n  }\n\n  protected _updateSelectAll(): void {\n    if (!this.multiple) {\n      this.$selectAll.removeAttribute('tabindex');\n      return;\n    }\n    this.$selectAll.tabIndex = 0;\n    this.$selectAll.selected = this.isAllSelected();\n    this.$selectAll.textContent = this.selectAllLabel;\n  }\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n  }\n\n  @bind\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined, oldTarget: HTMLSelectElement | undefined): void {\n    super._onTargetChange(newTarget, oldTarget);\n    this._updateSelectAll();\n    this._renderItems();\n\n    this.bindEvents();\n  }\n\n  @bind\n  public _onChange(): void {\n    this._updateSelectAll();\n    this.$items.forEach((item) => item.update());\n  }\n\n  @bind\n  public _onListChange(): void {\n    this._renderItems();\n  }\n\n  @bind\n  protected _onClick(e: MouseEvent | KeyboardEvent): void {\n    if (this.disabled) return;\n    const target = e.target;\n    if (!target || !(target instanceof ESLSelectItem)) return;\n    if (target.classList.contains('esl-select-all-item')) {\n      this.setAllSelected(!target.selected);\n    } else {\n      this.setSelected(target.value, !target.selected);\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this._onClick(e);\n      e.preventDefault();\n    }\n    if ([ARROW_UP, ARROW_DOWN].includes(e.key)) {\n      const index = this.$items.indexOf(document.activeElement as ESLSelectItem);\n      const count = this.$items.length;\n      const increment = e.key === ARROW_UP ? -1 : 1;\n      if (index === -1) return;\n      this.$items[(index + increment + count) % count].focus();\n      e.preventDefault();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectList: typeof ESLSelectList;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-list': ESLSelectList;\n  }\n}\n","import {attr, boolAttr, ESLBaseElement} from '../../../esl-base-element/core';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {format} from '../../../esl-utils/misc/format';\n\nimport {ESLSelect} from './esl-select';\n\n/**\n * ESLSelectRenderer component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom element to render {@link ESLSelect} inline field\n */\nexport class ESLSelectRenderer extends ESLBaseElement {\n  public static readonly is = 'esl-select-renderer';\n\n  /** Attribute for empty text value */\n  @attr() public emptyText: string;\n  /** Attribute for more label format */\n  @attr() public moreLabelFormat: string;\n  /** Marker attribute to reflect filled state */\n  @boolAttr() public hasValue: boolean;\n\n  protected $container: HTMLDivElement;\n  protected $rest: HTMLElement;\n  protected $text: HTMLElement;\n  protected $remove: HTMLButtonElement;\n\n  protected _deferredRerender = rafDecorator(() => this.render());\n\n  constructor() {\n    super();\n\n    this.$remove = document.createElement('button');\n    this.$remove.type = 'button';\n    this.$remove.setAttribute('aria-label', 'Clear');\n    this.$remove.classList.add('esl-select-clear-btn');\n    this.$remove.classList.add('icon-nav-close-menu');\n\n    this.$container = document.createElement('div');\n    this.$container.classList.add('esl-select-text-container');\n    this.$text = document.createElement('span');\n    this.$text.classList.add('esl-select-text');\n    this.$container.appendChild(this.$text);\n    this.$rest = document.createElement('span');\n    this.$rest.classList.add('esl-select-text');\n    this.$container.appendChild(this.$rest);\n  }\n\n  /** ESLSelect owner */\n  get owner(): ESLSelect | null {\n    return this.parentElement instanceof ESLSelect ? this.parentElement : null;\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$container);\n    this.appendChild(this.$remove);\n    this.bindEvents();\n\n    customElements.whenDefined(ESLSelectRenderer.is).then(() => this.render());\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$container);\n    this.removeChild(this.$remove);\n    this.unbindEvents();\n  }\n\n  protected bindEvents(): void {\n    if (!this.owner) return;\n    this.owner.addEventListener('esl:change:value', this.render);\n    this.$remove.addEventListener('click', this._onClear);\n    window.addEventListener('resize', this._deferredRerender);\n  }\n  protected unbindEvents(): void {\n    if (!this.owner) return;\n    this.owner.removeEventListener('esl:change:value', this.render);\n    this.$remove.removeEventListener('click', this._onClear);\n    window.removeEventListener('resize', this._deferredRerender);\n  }\n\n  /** Rerender component with markers */\n  @bind\n  public render(): void {\n    if (!this.owner) return;\n    const selected = this.owner.selectedOptions;\n    this.hasValue = !!selected.length;\n    this.toggleAttribute('multiple', this.owner.multiple);\n    this.applyItems(selected.map((item) => item.text));\n  }\n\n  /** Render item with a visible items limit */\n  protected apply(items: string[], limit: number): void {\n    const length = items.length;\n    const rest = length - limit;\n    const options = {rest, length, limit};\n    this.$text.textContent = items.slice(0, limit).join(', ');\n    if (rest > 0) {\n      this.$rest.textContent = format(this.moreLabelFormat || '', options);\n    } else {\n      this.$rest.textContent = '';\n    }\n  }\n  /** Render items using adaptive algorithm */\n  protected applyItems(items: string[]): void {\n    let size = 0;\n    do {\n      this.apply(items, ++size); // Render with extended limit while it not fits to the container\n    } while (size <= items.length && this.$container.scrollWidth <= this.$container.clientWidth);\n    this.apply(items, size - 1); // Render last limit that fits\n  }\n\n  /** Handle clear button click */\n  @bind\n  protected _onClear(e: MouseEvent): void {\n    if (!this.owner) return;\n    this.owner.setAllSelected(false);\n    e.stopPropagation();\n    e.preventDefault();\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-renderer': ESLSelectRenderer;\n  }\n}\n","import {ESLToggleable} from '../../../esl-toggleable/core/esl-toggleable';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {prop} from '../../../esl-utils/decorators/prop';\nimport {TAB} from '../../../esl-utils/dom/keys';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {ESLSelectList} from '../../esl-select-list/core';\n\nimport type {ESLSelect} from './esl-select';\nimport type {ToggleableActionParams} from '../../../esl-toggleable/core/esl-toggleable';\n\n/**\n * ESLSelectDropdown component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom component to render {@link ESLSelect} dropdown section\n * Uses {@link ESLSelectList} to render the content\n */\nexport class ESLSelectDropdown extends ESLToggleable {\n  public static readonly is = 'esl-select-dropdown';\n  public static register(): void {\n    ESLSelectList.register();\n    super.register();\n  }\n\n  /** Owner ESLSelect instance */\n  public $owner: ESLSelect;\n\n  /** Inner ESLSelectList component */\n  protected $list: ESLSelectList;\n  protected _disposeTimeout: number;\n  protected _deferredUpdatePosition = rafDecorator(() => this.updatePosition());\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  constructor() {\n    super();\n    this.$list = document.createElement(ESLSelectList.is);\n  }\n\n  protected setInitialState(): void {}\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$list);\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$list);\n  }\n\n  protected bindEvents(): void {\n    super.bindEvents();\n    window.addEventListener('resize', this._deferredUpdatePosition);\n  }\n  protected unbindEvents(): void {\n    super.unbindEvents();\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n  }\n\n  protected onShow(params: ToggleableActionParams): void {\n    document.body.appendChild(this);\n    this._disposeTimeout && window.clearTimeout(this._disposeTimeout);\n\n    this.$list.pinSelected = this.$owner.pinSelected;\n    this.$list.selectAllLabel = this.$owner.selectAllLabel;\n    this.$list.$select = this.$owner.$select;\n\n    super.onShow(params);\n    const focusable: HTMLElement | null = this.querySelector('[tabindex]');\n    focusable?.focus({preventScroll: true});\n    this.updatePosition();\n  }\n  protected onHide(params: ToggleableActionParams): void {\n    const select = this.activator;\n    super.onHide(params);\n    this._disposeTimeout = window.setTimeout(() => {\n      if (this.parentNode !== document.body) return;\n      document.body.removeChild(this);\n    }, 1000);\n    select && setTimeout(() => select.focus({preventScroll: true}), 0);\n  }\n\n  @bind\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    const els = this.querySelectorAll('[tabindex]');\n    const first = els[0] as HTMLElement;\n    const last = els[els.length - 1] as HTMLElement;\n    if (first && e.target === last && !e.shiftKey) first.focus();\n    if (last && e.target === first && e.shiftKey) last.focus();\n  }\n\n  @bind\n  public updatePosition(): void {\n    if (!this.activator) return;\n    const windowY = window.scrollY || window.pageYOffset;\n    const rect = this.activator.getBoundingClientRect();\n\n    this.style.top = `${windowY + rect.top + rect.height}px`;\n    this.style.left = `${rect.left}px`;\n    this.style.width = `${rect.width}px`;\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-dropdown': ESLSelectDropdown;\n  }\n}\n","import {attr, boolAttr} from '../../../esl-base-element/core';\nimport {bind} from '../../../esl-utils/decorators/bind';\nimport {CSSClassUtils} from '../../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {EventUtils} from '../../../esl-utils/dom/events';\n\nimport {ESLSelectWrapper} from '../../esl-select-list/core/esl-select-wrapper';\nimport {ESLSelectRenderer} from './esl-select-renderer';\nimport {ESLSelectDropdown} from './esl-select-dropdown';\n\n/**\n * ESLSelect component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelect is a component on top of native select that brings more customization features.\n * Uses \"select with dropdown\" view. Supports both single and multiple selection.\n */\n@ExportNs('Select')\nexport class ESLSelect extends ESLSelectWrapper {\n  public static readonly is = 'esl-select';\n  public static get observedAttributes(): string[] {\n    return ['disabled'];\n  }\n  public static register(): void {\n    ESLSelectDropdown.register();\n    ESLSelectRenderer.register();\n    super.register();\n  }\n\n  /** Placeholder text property */\n  @attr() public placeholder: string;\n  /** Class(es) to mark not empty state */\n  @attr() public hasValueClass: string;\n  /** Class(es) for focused state. Select is also focused if the dropdown list is opened */\n  @attr() public hasFocusClass: string;\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /**\n   * Text to add when there is not enough space to show all selected options inline,\n   * Supports `{rest}`, `{length}` and `{limit}` placeholders\n   */\n  @attr({defaultValue: '+ {rest} more...'}) public moreLabelFormat: string;\n\n  /** Dropdown open marker */\n  @boolAttr() public open: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the dropdown */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $renderer: ESLSelectRenderer;\n  protected $dropdown: ESLSelectDropdown;\n\n  constructor() {\n    super();\n\n    this.$renderer = document.createElement(ESLSelectRenderer.is);\n    this.$dropdown = document.createElement(ESLSelectDropdown.is);\n  }\n\n  protected attributeChangedCallback(attrName: string): void {\n    if (attrName === 'disabled') this._updateDisabled();\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this.$select = this.querySelector('[esl-select-target]')!;\n    if (!this.$select) return;\n\n    this._prepare();\n    this._updateDisabled();\n    this.bindEvents();\n    this._onUpdate();\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this._dispose();\n  }\n\n  /** Catches the focus */\n  public focus(options?: FocusOptions): void {\n    this.$select.focus(options);\n  }\n  /** Updates select component */\n  public update(valueChanged = true): void {\n    this._onUpdate();\n    if (!valueChanged) return;\n    // TODO: silent updates\n    EventUtils.dispatch(this, 'esl:change:value', {detail: {event: null}});\n  }\n\n  protected bindEvents(): void {\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('focusout', this._onUpdate);\n    this.$dropdown.addEventListener('esl:show', this._onPopupStateChange);\n    this.$dropdown.addEventListener('esl:hide', this._onPopupStateChange);\n  }\n  protected unbindEvents(): void {\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('focusout', this._onUpdate);\n    this.$dropdown.removeEventListener('esl:show', this._onPopupStateChange);\n    this.$dropdown.removeEventListener('esl:hide', this._onPopupStateChange);\n  }\n\n  protected _prepare(): void {\n    this.$renderer.className = this.$select.className;\n    this.$renderer.emptyText = this.placeholder;\n    this.$renderer.moreLabelFormat = this.moreLabelFormat;\n    this.$dropdown.$owner = this;\n    this.appendChild(this.$renderer);\n  }\n  protected _dispose(): void {\n    this.$select.className = this.$renderer.className;\n    this.removeChild(this.$renderer);\n  }\n\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n    if (this.disabled && this.open) this.$dropdown.hide();\n  }\n\n  @bind\n  protected _onChange(event: Event): void {\n    this._onUpdate();\n    EventUtils.dispatch(this, 'esl:change:value', {detail: {event}});\n  }\n\n  @bind\n  protected _onUpdate(): void {\n    const hasValue = this.hasSelected();\n    this.toggleAttribute('has-value', hasValue);\n    CSSClassUtils.toggle(this, this.hasValueClass, hasValue);\n\n    const focusEl = document.activeElement;\n    const hasFocus = this.open || (focusEl && this.contains(focusEl));\n    CSSClassUtils.toggle(this, this.hasFocusClass, !!hasFocus);\n  }\n\n  @bind\n  protected _onClick(): void {\n    if (this.disabled) return;\n    this.$dropdown.toggle(!this.$dropdown.open, {\n      activator: this,\n      initiator: 'select'\n    });\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this.click();\n      e.preventDefault();\n    }\n  }\n\n  @bind\n  protected _onPopupStateChange(e: CustomEvent): void {\n    if (e.target !== this.$dropdown) return;\n    this.open = this.$dropdown.open;\n    this._onUpdate();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Select: typeof ESLSelect;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select': ESLSelect;\n  }\n}\n","import type {ESLNote} from './esl-note';\n\nexport interface FootnotesItem {\n  index: string[];\n  renderedIndex: string[];\n  text: string;\n}\n\n/** Converts notes list to footnotes items list */\nfunction convertNotesToFootnotesList(notes: ESLNote[]): FootnotesItem[] {\n  return notes.map(({index, renderedIndex, html}) => ({\n    index: [`${index}`],\n    renderedIndex: [renderedIndex],\n    text: html\n  }));\n}\n\n/** Compiles footnotes non-grouped list */\nexport function compileFootnotesNongroupedList(notes: ESLNote[]): FootnotesItem[] {\n  return convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes));\n}\n\n/** Compiles footnotes grouped list */\nexport function compileFootnotesGroupedList(notes: ESLNote[]): FootnotesItem[] {\n  const map = new Map() ;\n  convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes)).forEach((note) => {\n    const {index, renderedIndex, text} = note;\n    map.has(text) ? map.set(text, {\n      index: [...map.get(text).index, ...index],\n      renderedIndex: [...map.get(text).renderedIndex, ...renderedIndex],\n      text\n    }) : map.set(text, note);\n  });\n  const groupedList: FootnotesItem[] = [];\n  map.forEach((note, text) => groupedList.push(note));\n  return groupedList;\n}\n\n/** Sorts notes list */\nexport function sortFootnotes(notes: ESLNote[]): ESLNote[] {\n  return notes.sort((note1: ESLNote, note2: ESLNote): number => {\n    if (note1 === note2) return 0;\n    // eslint-disable-next-line no-bitwise\n    if (note1.compareDocumentPosition(note2) & Node.DOCUMENT_POSITION_PRECEDING) {\n      // note2 comes before note1\n      return 1;\n    }\n    return -1;\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {ESLBaseElement, attr} from '../../esl-base-element/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {compileFootnotesGroupedList, compileFootnotesNongroupedList, sortFootnotes} from './esl-footnotes-data';\n\nimport type {ESLNote} from './esl-note';\nimport type {FootnotesItem} from './esl-footnotes-data';\n\n@ExportNs('Footnotes')\nexport class ESLFootnotes extends ESLBaseElement {\n  static is = 'esl-footnotes';\n  static eventNs = 'esl:footnotes';\n\n  /** Target element {@link TraversingQuery} to define scope */\n  @attr({defaultValue: '::parent'}) public scopeTarget: string;\n\n  /** Grouping note instances with identical content enable/disable */\n  @attr({defaultValue: 'enable'}) public grouping: string;\n\n  /** Label for 'return to note' button title */\n  @attr({defaultValue: 'Back to note'}) public backToNoteLabel: string;\n\n  protected _notes: ESLNote[] = [];\n  protected deferredOnUpdate = debounce(() => this._onUpdate(), 150);\n\n  /** Scope element */\n  @memoize()\n  protected get scopeEl(): HTMLElement {\n    return TraversingQuery.first(this.scopeTarget, this) as HTMLElement;\n  }\n\n  /** Notes that are allowed to be processed by footnotes */\n  public get notes(): ESLNote[] {\n    return this._notes.filter((note) => note.allowFootnotes);\n  }\n\n  /** List of notes to show */\n  protected get footnotesList(): FootnotesItem[] {\n    this.reindex();\n    return this.grouping !== 'enable'\n      ? compileFootnotesNongroupedList(this._notes)\n      : compileFootnotesGroupedList(this._notes);\n  }\n\n  protected connectedCallback(): void {\n    super.connectedCallback();\n\n    this.bindEvents();\n    this._notifyNotes();\n  }\n\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this.unbindEvents();\n    this._notes.forEach((el) => el.unlink());\n    this._notes = [];\n  }\n\n  protected bindEvents(): void {\n    if (this.scopeEl) {\n      this.scopeEl.addEventListener(`${ESLFootnotes.eventNs}:response`, this._onNoteSubscribe);\n    }\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents(): void {\n    if (this.scopeEl) {\n      this.scopeEl.removeEventListener(`${ESLFootnotes.eventNs}:response`, this._onNoteSubscribe);\n    }\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  /** Adds the note to the footnotes list */\n  public linkNote(note: ESLNote): void {\n    if (this._notes.includes(note)) return;\n    this._notes.push(note);\n    const index = +sequentialUID(ESLFootnotes.is, '');\n    note.link(this, index);\n  }\n\n  /** Reindexes the list of notes */\n  public reindex(): void {\n    this._sortNotes();\n    this.notes.forEach((note, index) => note.index = index + 1);\n  }\n\n  /** Removes the note from the footnotes list */\n  public unlinkNote(note: ESLNote): void {\n    this._notes = this._notes.filter((el) => el !== note);\n    this.deferredOnUpdate();\n  }\n\n  /** Updates the content of footnotes */\n  public update(): void {\n    this.deferredOnUpdate();\n  }\n\n  /** Sorts list of notes */\n  protected _sortNotes(): void {\n    this._notes = sortFootnotes(this._notes);\n  }\n\n  /** Builds content of footnotes */\n  protected buildItems(): string {\n    const items = this.footnotesList.map((footnote) => this.buildItem(footnote)).join('');\n    return `<ul class=\"esl-footnotes-items\">${items}</ul>`;\n  }\n\n  /** Builds one item from footnotes list */\n  protected buildItem(footnote: FootnotesItem): string {\n    const item = `${this.buildItemIndex(footnote)}${this.buildItemText(footnote)}${this.buildItemBack(footnote)}`;\n    return `<li class=\"esl-footnotes-item\" data-order=\"${footnote.index}\">${item}</li>`;\n  }\n\n  /** Builds item index */\n  protected buildItemIndex(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-index\">${footnote.renderedIndex.join(', ')}</span>`;\n  }\n\n  /** Builds item text */\n  protected buildItemText(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-text\">${footnote.text}</span>`;\n  }\n\n  /** Builds item back-to-note button */\n  protected buildItemBack(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-back-to-note\" tabindex=\"0\" title=\"${this.backToNoteLabel}\"></span>`;\n  }\n\n  /** Actions on update footnotes */\n  @bind\n  protected _onUpdate(): void {\n    this.innerHTML = this.buildItems();\n  }\n\n  /** Handles `response` event from note */\n  @bind\n  protected _onNoteSubscribe(e: CustomEvent): void {\n    const note = e.target as ESLNote;\n    this.linkNote(note);\n    this.deferredOnUpdate();\n\n    e.stopImmediatePropagation();\n  }\n\n  /** Handles `click` event */\n  @bind\n  protected _onClick(e: MouseEvent | KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n    if (target && target.classList.contains('esl-footnotes-back-to-note')) {\n      const orderAttr = target.closest('.esl-footnotes-item')?.getAttribute('data-order');\n      const order = orderAttr?.split(',').map((item) => +item);\n      order && this._onBackToNote(order);\n    }\n  }\n\n  /** Handles `keydown` event */\n  @bind\n  protected _onKeydown(event: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(event.key)) this._onClick(event);\n  }\n\n  /** Actions on back-to-note click  */\n  protected _onBackToNote(order: number[]): void {\n    const index = order[order.length - 1];\n    this.notes.forEach((note) => {\n      note.highlight(order.includes(note.index));\n      if (note.index === index) {\n        note.activate();\n      }\n    });\n  }\n\n  /** Turns off highlight for notes with the same text */\n  public turnOffHighlight(note: ESLNote): void {\n    this._notes\n      .filter((item) => note.html === item.html)\n      .forEach((item) => item.highlight(false));\n  }\n\n  /**\n   * Sends a request to all notes, expecting to get a response from\n   * the unlinked ones and link up with them */\n  protected _notifyNotes(): void {\n    EventUtils.dispatch(this, `${ESLFootnotes.eventNs}:request`);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Footnotes: typeof ESLFootnotes;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-footnotes': ESLFootnotes;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr} from '../../esl-base-element/core';\nimport {ESLPopup} from '../../esl-popup/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {TAB} from '../../esl-utils/dom/keys';\nimport {getKeyboardFocusableElements} from '../../esl-utils/dom/focus';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {PopupActionParams} from '../../esl-popup/core';\nimport type {PositionType} from '../../esl-popup/core/esl-popup-position';\n\nexport interface TooltipActionParams extends PopupActionParams {\n  /** text to be shown */\n  text?: string;\n  /** html content to be shown */\n  html?: string;\n  /** tooltip without arrow */\n  disableArrow?: boolean;\n}\n\n@ExportNs('Tooltip')\nexport class ESLTooltip extends ESLPopup {\n  static is = 'esl-tooltip';\n\n  /**\n   * Tooltip position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public position: PositionType;\n\n  /** Tooltip behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Disable arrow at Tooltip */\n  @boolAttr() public disableArrow: boolean;\n\n  /** Shared instanse of Tooltip */\n  @memoize()\n  public static get sharedInstance(): ESLTooltip {\n    return document.createElement('esl-tooltip');\n  }\n\n  /** List of all focusable elements inside Tooltip */\n  public get focusableElements(): Element[] {\n    return getKeyboardFocusableElements(this);\n  }\n\n  /** First focusable element inside Tooltip */\n  public get firstFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[0] : null;\n  }\n\n  /** Last focusable element inside Tooltip */\n  public get lastFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[els.length - 1] : null;\n  }\n\n  /** Active state marker */\n  public static get open(): boolean {\n    return this.sharedInstance.open;\n  }\n\n  /** Changes the element state to active */\n  public static show(params: TooltipActionParams = {}): void {\n    this.sharedInstance.show(params);\n  }\n\n  /** Changes the element state to inactive */\n  public static hide(params: TooltipActionParams = {}): void {\n    this.sharedInstance.hide(params);\n  }\n\n  public connectedCallback(): void {\n    if (!this.disableArrow) {\n      this._appendArrow();\n    }\n    super.connectedCallback();\n    this.classList.add(ESLPopup.is);\n    this.tabIndex = 0;\n  }\n\n  /** Sets initial state of the Tooltip */\n  protected setInitialState(): void {}\n\n  /** Creates arrow at Tooltip */\n  @memoize()\n  protected _createArrow(): HTMLElement {\n    const arrow = document.createElement('span');\n    arrow.className = 'esl-popup-arrow';\n    return arrow;\n  }\n\n  /** Appends arrow to Tooltip */\n  protected _appendArrow(): void {\n    this.$arrow = this._createArrow();\n    this.appendChild(this.$arrow);\n  }\n\n  /** Actions to execute on show Tooltip. */\n  public onShow(params: TooltipActionParams): void {\n    if (params.disableArrow) {\n      this.disableArrow = params.disableArrow;\n    }\n    if (params.text) {\n      this.innerText = params.text;\n    }\n    if (params.html) {\n      this.innerHTML = params.html;\n    }\n    if (params.extraClass) {\n      CSSClassUtils.add(this, params.extraClass);\n    }\n    document.body.appendChild(this);\n    super.onShow(params);\n    this._updateActivatorState(true);\n  }\n\n  /** Actions to execute on Tooltip hiding. */\n  public onHide(params: TooltipActionParams): void {\n    this._updateActivatorState(false);\n    super.onHide(params);\n    document.body.removeChild(this);\n    if (params.extraClass) {\n      CSSClassUtils.remove(this, params.extraClass);\n    }\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected afterOnShow(): void {\n    super.afterOnShow();\n    this.focus({preventScroll: true});\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected beforeOnHide(): void {\n    this.activator?.focus({preventScroll: true});\n  }\n\n  @bind\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    if (!this.activator) return;\n    const {firstFocusableElement, lastFocusableElement} = this;\n    if (\n      !lastFocusableElement ||\n      e.target === lastFocusableElement && !e.shiftKey ||\n      e.target === firstFocusableElement && e.shiftKey\n    ) {\n      this.activator.focus();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  protected _updateActivatorState(newState: boolean): void {\n    this.activator?.toggleAttribute('tooltip-shown', newState);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tooltip: typeof ESLTooltip;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tooltip': ESLTooltip;\n  }\n}\n","import {TAB} from './keys';\n\n/**\n * Chain focus order between passed elements.\n * Passive (should be called inside keyboard event handler)\n */\nexport const handleFocusChain = (e: KeyboardEvent, first: HTMLElement, last: HTMLElement): boolean | undefined => {\n  if (e.key !== TAB) return;\n  if (last && e.target === first && e.shiftKey) {\n    last.focus();\n    e.preventDefault();\n    return true;\n  }\n  if (first && e.target === last && !e.shiftKey) {\n    first.focus();\n    e.preventDefault();\n    return true;\n  }\n};\n\n/**\n * TODO: add visibility check\n * Gets keyboard-focusable elements within a specified root element\n * @param root - root element\n */\nexport const getKeyboardFocusableElements = (root: HTMLElement | Document = document): Element[] => {\n  return Array.from(root.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])'))\n    .filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, boolAttr, ESLBaseElement} from '../../esl-base-element/core';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {ESLTooltip} from '../../esl-tooltip/core';\nimport {promisifyTimeout, repeatSequence} from '../../esl-utils/async/promise';\nimport {EventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {scrollIntoView} from '../../esl-utils/dom/scroll';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLFootnotes} from './esl-footnotes';\n\nimport type {TooltipActionParams} from '../../esl-tooltip/core/esl-tooltip';\nimport type {IMediaQueryCondition} from '../../esl-media-query/core/conditions/media-query-base';\n\n@ExportNs('Note')\nexport class ESLNote extends ESLBaseElement {\n  static is = 'esl-note';\n\n  /** Timeout before activating note (to have time to show content with this note) */\n  static readonly activateTimeout = 100;\n\n  static get observedAttributes(): string[] {\n    return ['tooltip-shown', 'ignore'];\n  }\n\n  /** Linked state marker */\n  @boolAttr() public linked: boolean;\n  /** Standalone state marker */\n  @boolAttr() public standalone: boolean;\n  /** Tooltip state marker */\n  @boolAttr() public tooltipShown: boolean;\n\n  /** Media query to specify that footnotes must ignore this note. Default: `not all` */\n  @attr({defaultValue: 'not all'}) public ignore: string;\n\n  /** Tooltip content */\n  @attr() public html: string;\n  /**\n   * Note label in stand-alone mode (detached from footnotes),\n   * in the connected state it is a numeric index that is calculated automatically\n   */\n  @attr({defaultValue: '*'}) public standaloneLabel: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackHover: string;\n\n  /** Target to container element {@link TraversingQuery} to define bounds of tooltip visibility (window by default) */\n  @attr() public container: string;\n\n  protected _$footnotes: ESLFootnotes | null;\n  protected _index: number;\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  /** Marker to allow footnotes to pick up this note */\n  public get allowFootnotes(): boolean {\n    return !this.queryToIgnore.matches;\n  }\n\n  /** Note index in the scope content */\n  public get index(): number {\n    return this._index;\n  }\n  public set index(value: number) {\n    this._index = value;\n    this.innerHTML = this.renderedIndex;\n  }\n\n  /** Note index in the displayed list of footnotes */\n  public get renderedIndex(): string {\n    return this.allowFootnotes ? `${this._index}` : this.standaloneLabel;\n  }\n\n  /** Query to describe conditions to ignore note by footnotes  */\n  @memoize()\n  public get queryToIgnore(): IMediaQueryCondition {\n    const ignore = this.getClosestRelatedAttr('ignore') || this.ignore;\n    return ESLMediaQuery.for(ignore);\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    this.init();\n    super.connectedCallback();\n    this.bindEvents();\n    this._sendResponseToFootnote();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this._$footnotes?.unlinkNote(this);\n    this.restore();\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'tooltip-shown' && newVal === null) {\n      this._$footnotes?.turnOffHighlight(this);\n    }\n    if (attrName === 'ignore') {\n      this.updateQueryToIgnore();\n      this._onBPChange();\n    }\n  }\n\n  protected bindEvents(): void {\n    document.body.addEventListener(`${ESLFootnotes.eventNs}:request`, this._onFootnotesReady);\n    this.addEventListener('click', this._onClick);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('mouseenter', this._onMouseEnter);\n    this.addEventListener('mouseleave', this._onMouseLeave);\n  }\n  protected unbindEvents(): void {\n    document.body.removeEventListener(`${ESLFootnotes.eventNs}:request`, this._onFootnotesReady);\n    this.removeEventListener('click', this._onClick);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('mouseenter', this._onMouseEnter);\n    this.removeEventListener('mouseleave', this._onMouseLeave);\n  }\n\n  /** Gets attribute value from the closest element with group behavior settings */\n  protected getClosestRelatedAttr(attrName: string): string | null {\n    const tagName = (this.constructor as typeof ESLBaseElement).is;\n    const relatedAttrName = `${tagName}-${attrName}`;\n    const $closest = this.closest(`[${relatedAttrName}]`);\n    return $closest ? $closest.getAttribute(relatedAttrName) : null;\n  }\n\n  /** Activates note */\n  public activate(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    EventUtils.dispatch(this, 'esl:show:request');\n    // TODO: replace timeout with a more reliable mechanism to have time to show content with this note\n    repeatSequence(() => {\n      return promisifyTimeout((this.constructor as typeof ESLNote).activateTimeout)\n        .then(() => scrollIntoView(this, {behavior: 'smooth', block: 'center'}))\n        .then(() => ESLTooltip.open || this.showTooltip());\n    }, 3);\n  }\n\n  /** Highlights note */\n  public highlight(enable: boolean = true): void {\n    this.classList.toggle('highlight', enable);\n  }\n\n  /** Links note with footnotes */\n  public link(footnotes: ESLFootnotes, index: number): void {\n    this.linked = true;\n    this._$footnotes = footnotes;\n    this.index = index;\n    this.tabIndex = 0;\n    this.update();\n  }\n\n  /** Unlinks note from footnotes */\n  public unlink(): void {\n    this.restore();\n    this.update();\n    this._sendResponseToFootnote();\n  }\n\n  /** Updates note state */\n  public update(): void {\n    this.standalone = !(this.linked && this.allowFootnotes);\n  }\n\n  /** Brings up to date ignore query */\n  public updateQueryToIgnore(): void {\n    this.queryToIgnore.removeListener(this._onBPChange);\n    memoize.clear(this, 'queryToIgnore');\n    this.queryToIgnore.addListener(this._onBPChange);\n  }\n\n  /** Initial initialization of the element during the connection to DOM */\n  protected init(): void {\n    if (!this.html) {\n      this.html = this.innerHTML;\n    }\n    this.updateQueryToIgnore();\n    this.index = 0;\n    this.linked = false;\n    this.update();\n  }\n\n  /** Restores original note content after unlinking */\n  protected restore(): void {\n    this.linked = false;\n    this._$footnotes = null;\n    this.index = 0;\n    this.tabIndex = -1;\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLNote, ...params: TooltipActionParams[]): TooltipActionParams {\n    const container = this.getClosestRelatedAttr('container') || this.container;\n    const containerEl = container ? TraversingQuery.first(container, this) as HTMLElement : undefined;\n    return Object.assign({\n      initiator: 'note',\n      activator: this,\n      containerEl,\n      html: this.html\n    }, ...params);\n  }\n\n  /** Shows tooltip with passed params */\n  public showTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    ESLTooltip.show(actionParams);\n    this.highlight();\n  }\n  /** Hides tooltip with passed params */\n  public hideTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    ESLTooltip.hide(actionParams);\n  }\n  /** Toggles tooltip with passed params */\n  public toggleTooltip(params: TooltipActionParams = {}, state: boolean = !this.tooltipShown): void {\n    state ? this.showTooltip(params) : this.hideTooltip(params);\n  }\n\n  /** Handles `click` event */\n  @bind\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles `keydown` event */\n  @bind\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE].includes(event.key)) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles hover `mouseenter` event */\n  @bind\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.showTooltip({event});\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @bind\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.hideTooltip({event, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Actions on breakpoint changing */\n  @bind\n  protected _onBPChange(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    this.innerHTML = this.renderedIndex;\n    this.update();\n    this._$footnotes?.update();\n  }\n\n  /** Handles footnotes request event */\n  @bind\n  protected _onFootnotesReady(e: CustomEvent): void {\n    if (this.linked) return;\n    this._sendResponseToFootnote();\n  }\n\n  /** Sends the response to footnotes */\n  protected _sendResponseToFootnote(): void {\n    EventUtils.dispatch(this, `${ESLFootnotes.eventNs}:response`);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Note: typeof ESLNote;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-note': ESLNote;\n  }\n}\n","import {wrap} from '../../esl-utils/misc/array';\nimport {bind} from '../../esl-utils/decorators/bind';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\n/** ESLAnimateService animation options */\nexport interface ESLAnimateConfig {\n  /** Class(es) to mark element animated */\n  cls?: string;\n\n  /** Animate if class already presented */\n  force?: boolean;\n\n  /** Animate items in group one by one, using groupDelay */\n  group?: boolean;\n\n  /** Delay to display element(s) after previous one. Used when group animation is enabled. Default: 100ms */\n  groupDelay?: number;\n\n  /** Do not unsubscribe after animate and repeat animation on each viewport intersection */\n  repeat?: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   * Default: 0.4 (40%)\n   */\n  ratio?: number;\n}\n\n/** ESLAnimateService animation inner options. Contains system animation properties */\ninterface ESLAnimateConfigInner extends Required<ESLAnimateConfig> {\n  /** (private) animation requested */\n  _timeout?: number;\n  /** (private) marker to unobserve */\n  _unsubscribe?: boolean;\n}\n\n/** Service to animate elements on viewport intersection */\n@ExportNs('AnimateService')\nexport class ESLAnimateService {\n\n  /** ESLAnimateService default animation configuration */\n  protected static DEFAULT_CONFIG: ESLAnimateConfig = {cls: 'in', groupDelay: 100, ratio: 0.4};\n  /** ESLAnimationService IntersectionObserver properties */\n  protected static OPTIONS_OBSERVER: IntersectionObserverInit = {threshold: [0.001, 0.2, 0.4, 0.6, 0.8]};\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param target - element(s) or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public static observe(target: Element | Element[], config: ESLAnimateConfig = {}): void {\n    wrap(target).forEach((item: Element) => this.instance.observe(item, config));\n  }\n\n  /** Unobserve element or elements */\n  public static unobserve(target: Element | Element[]): void {\n    wrap(target).forEach((item: Element) => this.instance.unobserve(item));\n  }\n\n  /** @returns if service observing target */\n  public static isObserved(target: Element): boolean {\n    return !!this.instance.getConfigFor(target);\n  }\n\n  @memoize()\n  private static get instance(): ESLAnimateService {\n    return new ESLAnimateService();\n  }\n\n  protected _io = new IntersectionObserver(this.onIntersect, ESLAnimateService.OPTIONS_OBSERVER);\n  protected _entries: Set<Element> = new Set();\n  protected _configMap = new WeakMap<Element, ESLAnimateConfigInner>();\n\n  protected deferredOnAnimate = debounce(() => this.onAnimate(), 100);\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param el - element or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public observe(el: Element, config: ESLAnimateConfig = {}): void {\n    const cfg = this.setConfigFor(el, config);\n    cfg.force && CSSClassUtils.remove(el, cfg.cls);\n    this._io.observe(el);\n  }\n\n  /** Unobserve element or elements */\n  public unobserve(el: Element): void {\n    this._io.unobserve(el);\n    this._configMap.delete(el);\n  }\n\n  /** Intersection observable callback */\n  @bind\n  protected onIntersect(entries: IntersectionObserverEntry[]): void {\n    entries.forEach(({target, intersectionRatio, isIntersecting}: IntersectionObserverEntry) => {\n      const config = this.getConfigFor(target);\n      if (!config) return;\n\n      // Item will be marked as visible in case it intersecting to the viewport with a ratio grater then passed visibleRatio\n      if (isIntersecting && intersectionRatio >= config.ratio) {\n        this._entries.add(target);\n      }\n\n      // Item considered as invisible in case it is going to be intersected less then 1% of it's area\n      if (!isIntersecting && intersectionRatio <= 0.01) {\n        this._entries.delete(target);\n\n        if (config.repeat) {\n          CSSClassUtils.remove(target, config.cls);\n          config._timeout && clearTimeout(config._timeout);\n        }\n      }\n    });\n    this.deferredOnAnimate();\n  }\n\n  /** Process animation query */\n  protected onAnimate(): void {\n    let time = -1;\n    this._entries.forEach((target) => {\n      const config = this.getConfigFor(target);\n      if (!config) return;\n\n      if (config._timeout) window.clearTimeout(config._timeout);\n      if (config.group) {\n        time = time === -1 ? 0 : (time + config.groupDelay);\n        config._timeout = window.setTimeout(() => this.onAnimateItem(target), time);\n      } else {\n        this.onAnimateItem(target);\n      }\n      config._unsubscribe = !config.repeat;\n    });\n  }\n\n  /** Animates passed item */\n  protected onAnimateItem(item: Element): void {\n    const config = this.getConfigFor(item);\n    if (!config) return;\n\n    CSSClassUtils.add(item, config.cls);\n    this._entries.delete(item);\n\n    if (config._unsubscribe) {\n      this._io.unobserve(item);\n      this._configMap.delete(item);\n    }\n  }\n\n  /** Returns config */\n  protected getConfigFor(el: Element): ESLAnimateConfigInner | undefined {\n    return this._configMap.get(el);\n  }\n  /** Returns config */\n  protected setConfigFor(el: Element, config: ESLAnimateConfig): ESLAnimateConfigInner {\n    const cfg = Object.assign({}, ESLAnimateService.DEFAULT_CONFIG, config) as ESLAnimateConfigInner;\n    this._configMap.set(el, cfg);\n    return cfg;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ready} from '../../esl-utils/decorators/ready';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {TraversingQuery} from '../../esl-traversing-query/core';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {attr, boolAttr, ESLBaseElement} from '../../esl-base-element/core';\n\nimport {ESLAnimateService} from './esl-animate-service';\n\n/**\n * ESLAnimate - custom element for quick {@link ESLAnimateService} attaching\n *\n * Have two types of usage:\n * - trough the target-s definition, then esl-animate (without it's own content) became invisible plugin-component\n * `<esl-animate target=\"::next\"></esl-animate><div>Content</div>`\n * - trough the content wrapping\n * `<esl-animate>Content</esl-animate>`\n */\n@ExportNs('Animate')\nexport class ESLAnimate extends ESLBaseElement {\n  static is = 'esl-animate';\n\n  /**\n   * Class(es) to add on viewport intersection\n   * @see ESLAnimateConfig.cls\n   */\n  @attr({defaultValue: 'in'}) public cls: string;\n\n  /**\n   * Enable group animation for targets\n   * @see ESLAnimateConfig.group\n   */\n  @boolAttr() public group: boolean;\n\n  /**\n   * Delay to start animation from previous item in group\n   * @see ESLAnimateConfig.groupDelay\n   */\n  @attr({defaultValue: '100'}) public groupDelay: string;\n\n  /**\n   * Re-animate item after its getting hidden\n   * @see ESLAnimateConfig.repeat\n   */\n  @boolAttr() public repeat: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   */\n  @attr() public ratio: string;\n\n  /**\n   * Define target(s) to observe and animate\n   * Uses {@link TraversingQuery} with multiple targets support\n   * Default: ` ` - current element, `<esl-animate>` behave as a wrapper\n   */\n  @attr() public target: string;\n\n  static get observedAttributes(): string[] {\n    return ['group', 'repeat', 'target'];\n  }\n\n  /** Elements-targets found by target query */\n  @memoize()\n  public get $targets(): HTMLElement[] {\n    return TraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected attributeChangedCallback(): void {\n    if (!this.connected) return;\n    this.reanimate();\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    this.reanimate();\n  }\n\n  @ready\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    ESLAnimateService.unobserve(this.$targets);\n  }\n\n  /** Reinitialize {@link ESLAnimateService} for targets */\n  public reanimate(): void {\n    ESLAnimateService.unobserve(this.$targets);\n    memoize.clear(this, '$targets');\n    ESLAnimateService.observe(this.$targets, {\n      force: true,\n      cls: this.cls,\n      ratio: parseNumber(this.ratio, 0.4),\n      repeat: this.repeat,\n      group: this.group,\n      groupDelay: parseNumber(this.groupDelay, 0)\n    });\n  }\n}\n","import {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {MediaProviderConfig} from '../core/esl-media-provider';\n\n/**\n * Simple Basic Iframe provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class IframeBasicProvider extends BaseProvider {\n  static readonly providerName: string = 'iframe';\n\n  private _state: PlayerStates = PlayerStates.UNINITIALIZED;\n  protected _el: HTMLIFrameElement;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    try {\n      if (!url) return null;\n      const {protocol} = new URL(url);\n      if (protocol !== 'http:' && protocol !== 'https:') return null;\n      return {mediaSrc: url};\n    } catch {\n      return null;\n    }\n  }\n\n  protected buildIframe(): HTMLIFrameElement {\n    const el = document.createElement('iframe');\n    el.id = 'esl-media-iframe-' + randUID();\n    el.className = 'esl-media-inner esl-media-iframe';\n    el.title = this.config.title;\n    el.setAttribute('aria-label', this.config.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('scrolling', 'no');\n    el.setAttribute('allowfullscreen', 'yes');\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public bind(): void {\n    if (this._state !== PlayerStates.UNINITIALIZED) return;\n    this._ready = new Promise((resolve, reject) => {\n      this._el = this.buildIframe();\n      this._el.onload = (): void => resolve(this);\n      this._el.onerror = (e): void => reject(e);\n      this._state = PlayerStates.UNSTARTED;\n      this.component.appendChild(this._el);\n    });\n    this._ready.then(() => {\n      this._state = PlayerStates.PLAYING;\n      this.component._onReady();\n      this.component._onPlay();\n    });\n    this._ready.catch((e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._state = PlayerStates.UNINITIALIZED;\n    super.unbind();\n  }\n\n  get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public focus(): void {\n    if (this._el && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    return this._state;\n  }\n\n  public get duration(): number {\n    return 0;\n  }\n\n  public get currentTime(): number {\n    return 0;\n  }\n\n  get defaultAspectRatio(): number {\n    return 0;\n  }\n\n  public seekTo(pos: number): void {\n    console.error('[ESLMedia] Unsupported action: can not execute seekTo on abstract iframe provider');\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.UNINITIALIZED) {\n      this.bind();\n    }\n  }\n\n  public pause(): void {\n    this.unbind();\n  }\n\n  public stop(): void {\n    this.unbind();\n  }\n}\n","import {BaseProvider, PlayerStates} from '../../core/esl-media-provider';\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../../core/esl-media-provider';\n\n/**\n * Simple Native Media API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n */\nexport abstract class HTMLMediaProvider extends BaseProvider {\n  static readonly urlPattern: RegExp;\n\n  static parseUrl(mediaSrc: string): Partial<MediaProviderConfig> | null {\n    if (this.urlPattern.test(mediaSrc)) {\n      return {mediaSrc};\n    }\n    return null;\n  }\n\n  protected _el: HTMLMediaElement;\n\n  protected static applyElementSettings(el: HTMLMediaElement, cfg: MediaProviderConfig): HTMLMediaElement {\n    el.classList.add('esl-media-inner');\n    el.autoplay = cfg.autoplay;\n    el.preload = cfg.preload || 'auto' ;\n    el.loop = cfg.loop;\n    el.muted = cfg.muted;\n    el.controls = cfg.controls;\n    el.tabIndex = 0;\n    el.toggleAttribute('playsinline', cfg.playsinline);\n    return el;\n  }\n\n  protected abstract createElement(): HTMLMediaElement;\n\n  public onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n  }\n\n  public bind(): void {\n    this._el = this.createElement();\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n    this.component.appendChild(this._el);\n    this.bindListeners();\n  }\n\n  protected bindListeners(): void {\n    this._el.addEventListener('loadedmetadata', () => this.component._onReady());\n    this._el.addEventListener('play', () => this.component._onPlay());\n    this._el.addEventListener('pause', () => this.component._onPaused());\n    this._el.addEventListener('ended', () => this.component._onEnded());\n    this._el.addEventListener('error', (e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    super.unbind();\n  }\n\n  get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public get state(): PlayerStates {\n    if (!this._el) return PlayerStates.UNINITIALIZED;\n    if (this._el.ended) return PlayerStates.ENDED;\n    if (!this._el.played || !this._el.played.length) return PlayerStates.UNSTARTED;\n    if (this._el.paused) return PlayerStates.PAUSED;\n    return PlayerStates.PLAYING;\n  }\n\n  public get duration(): number {\n    return this._el ? this._el.duration : 0;\n  }\n\n  public get currentTime(): number {\n    return this._el ? this._el.currentTime : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._el.currentTime = pos;\n  }\n\n  public play(): Promise<any> {\n    return this._el.play();\n  }\n\n  public pause(): void {\n    this._el.pause();\n  }\n\n  public stop(): void {\n    this._el.pause();\n    this._el.currentTime = 0;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Audio API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class AudioProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'audio';\n  static readonly urlPattern = /\\.(mp3|wav|aac)(\\?|$)/;\n\n  protected _el: HTMLAudioElement;\n\n  protected createElement(): HTMLAudioElement {\n    const el = document.createElement('audio');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public get defaultAspectRatio(): number {\n    return 0;\n  }\n}\n","/**\n * Creates new async script tag by id and src\n */\nconst createAsyncScript = (id: string, src: string): HTMLScriptElement => {\n  const script = document.createElement('script');\n  script.id = id;\n  script.async = true;\n  script.src = src;\n  return script;\n};\n\n/**\n * Common function that loads script async\n * @param id - unique script id that is used as a marker to prevent future load\n * @param src - script src (url) to load\n */\nexport function loadScript(id: string, src: string): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    const script: HTMLScriptElement =\n      (document.getElementById(id) || createAsyncScript(id, src)) as HTMLScriptElement;\n    const state = script.getAttribute('state');\n\n    switch (state) {\n      case 'success': resolve(new Event('load')); break;\n      case 'error': reject(new Event('error')); break;\n      default:\n        script.addEventListener('load', (e: Event) => {\n          script.setAttribute('state', 'success');\n          resolve(e);\n        });\n        script.addEventListener('error', (e: Event) => {\n          script.setAttribute('state', 'error');\n          reject(e);\n        });\n    }\n    if (!script.parentNode) {\n      const firstScriptTag =\n        document.querySelector('script') || document.querySelector('head title');\n      if (firstScriptTag && firstScriptTag.parentNode) {\n        firstScriptTag.parentNode.insertBefore(script, firstScriptTag);\n      } else {\n        reject('Page document structure is incorrect');\n      }\n    }\n  });\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Video API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class VideoProvider extends HTMLMediaProvider {\n  static readonly providerName: string = 'video';\n  static readonly urlPattern = /\\.(mp4|webm|ogv|mov)(\\?|$)/;\n\n  protected _el: HTMLVideoElement;\n\n  protected createElement(): HTMLVideoElement {\n    const el = document.createElement('video');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  get defaultAspectRatio(): number {\n    return this._el.videoWidth / this._el.videoHeight;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\nimport PlayerVars = YT.PlayerVars;\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../core/esl-media-provider';\n\nconst DEFAULT_ASPECT_RATIO = 16 / 9;\n\n/**\n * Youtube API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class YouTubeProvider extends BaseProvider {\n  static readonly providerName: string = 'youtube';\n  static readonly idRegexp = /(?:v\\/|v=|vi=|vi\\/|e\\/|embed\\/|user\\/.*\\/u\\/\\d+\\/)([_0-9a-zA-Z-]+)/i;\n  static readonly providerRegexp = /^\\s*(?:http(?:s)?:\\/\\/)?(?:www\\.)?(?:youtu\\.be|youtube(-nocookie)?\\.com)/i;\n\n  protected _el: HTMLDivElement | HTMLIFrameElement;\n  protected _api: YT.Player;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    if (this.providerRegexp.test(url)) {\n      const [, id] = url.match(this.idRegexp) || [];\n      return id ? {mediaId: id} : null;\n    }\n    return null;\n  }\n\n  private static _coreApiPromise: Promise<void>;\n  protected static getCoreApi(): Promise<void> {\n    if (!YouTubeProvider._coreApiPromise) {\n      YouTubeProvider._coreApiPromise = new Promise((resolve) => {\n        if (window.YT && window.YT.Player) return resolve(window.YT);\n        loadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\n        const cbOrigin = window.onYouTubeIframeAPIReady;\n        window.onYouTubeIframeAPIReady = (): void => {\n          try {\n            (typeof cbOrigin === 'function') && cbOrigin.apply(window);\n          } catch (err) { // eslint-disable-line\n            // Do Nothing\n          }\n          return resolve(window.YT);\n        };\n      });\n    }\n    return YouTubeProvider._coreApiPromise;\n  }\n\n  protected static mapOptions(cfg: MediaProviderConfig): PlayerVars {\n    return {\n      enablejsapi: 1,\n      origin: location.origin,\n      rel: 0,\n      showinfo: 0,\n      iv_load_policy: 0, // eslint-disable-line\n      autoplay: Number(cfg.autoplay),\n      controls: Number(cfg.controls),\n      playsinline: Number(cfg.playsinline),\n      disablekb: Number(!cfg.controls), // TODO: criteria\n      autohide: Number(!cfg.controls) // TODO: criteria\n    };\n  }\n\n  protected static buildIframe(sm: MediaProviderConfig): HTMLDivElement | HTMLIFrameElement {\n    const el = document.createElement('div');\n    el.id = 'esl-media-yt-' + randUID();\n    el.className = 'esl-media-inner esl-media-youtube';\n    el.title = sm.title;\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('allowfullscreen', 'yes');\n    return el;\n  }\n\n  public bind(): void {\n    this._el = YouTubeProvider.buildIframe(this.config);\n    this.component.appendChild(this._el);\n    this._ready = YouTubeProvider.getCoreApi()\n      .then(() => this.onCoreApiReady())\n      .then(() => this.onPlayerReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  /** Init YT.Player on target element */\n  protected onCoreApiReady(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      console.debug('[ESL]: Media Youtube Player initialization for ', this);\n      this._api = new YT.Player(this._el.id, {\n        videoId: this.config.mediaId,\n        events: {\n          onError: (e): void => reject(e),\n          onReady: (): void => resolve(this),\n          onStateChange: (e): void => this._onStateChange(e)\n        },\n        playerVars: YouTubeProvider.mapOptions(this.config)\n      });\n    });\n  }\n  /** Post YT.Player init actions */\n  protected onPlayerReady(): void {\n    console.debug('[ESL]: Media Youtube Player ready ', this);\n    this._el = this._api.getIframe();\n    if (this.config.muted) {\n      this._api.mute();\n    }\n    this.component._onReady();\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.destroy();\n    super.unbind();\n  }\n\n  private _onStateChange(event: YT.OnStateChangeEvent): void {\n    switch (+event.data) {\n      case PlayerStates.PLAYING:\n        this.component._onPlay();\n        break;\n      case PlayerStates.PAUSED:\n        this.component._onPaused();\n        break;\n      case PlayerStates.ENDED:\n        if (this.config.loop) {\n          this._api.playVideo();\n        } else {\n          this.component._onEnded();\n        }\n        break;\n    }\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (param === 'muted') {\n      value ? this._api.mute() : this._api.unMute();\n    }\n  }\n\n  public focus(): void {\n    if (this._el instanceof HTMLIFrameElement && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    if (this._api && typeof this._api.getPlayerState === 'function') {\n      return this._api.getPlayerState() as number as PlayerStates;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.getDuration() : 0;\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.getCurrentTime() : 0;\n  }\n\n  public get defaultAspectRatio(): number {\n    return DEFAULT_ASPECT_RATIO;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.seekTo(pos, false);\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.ENDED) {\n      this._api.seekTo(0, false);\n    }\n    this._api.playVideo();\n  }\n\n  public pause(): void {\n    this._api.pauseVideo();\n  }\n\n  public stop(): void {\n    this._api.stopVideo();\n  }\n}\n\n// typings\ndeclare global {\n  interface YT extends Promise<void> {\n    Player: YT.Player;\n  }\n\n  interface Window {\n    YT?: YT;\n    onYouTubeIframeAPIReady?: () => void;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {ESLMedia} from '../core/esl-media';\nimport type {ProviderObservedParams} from '../core/esl-media-provider';\nimport type {VideoJsPlayer} from 'video.js';\n\nconst API_SCRIPT_ID = 'BC_API_SOURCE';\n\nexport interface BCPlayerAccount {\n  playerId: string | null;\n  accountId: string | null;\n}\n\n/**\n * Brightcove API provider for {@link ESLMedia}\n * @author Julia Murashko\n */\n@BaseProvider.register\nexport class BrightcoveProvider extends BaseProvider {\n  static readonly providerName: string = 'brightcove';\n\n  protected videojsClasses = 'video-js vjs-default-skin video-js-brightcove';\n\n  protected _api: VideoJsPlayer;\n  protected _account: BCPlayerAccount;\n  protected _autoplay: boolean;\n\n  /**\n   * @returns settings, get from element by default\n   */\n  protected static getAccount(el: ESLMedia): BCPlayerAccount {\n    return {\n      playerId: el.getAttribute('player-id'),\n      accountId: el.getAttribute('player-account')\n    };\n  }\n\n  /** Loads player API according defined settings */\n  protected static loadAPI(account: BCPlayerAccount): Promise<Event> {\n    const apiSrc =\n      `//players.brightcove.net/${account.accountId}/${account.playerId}_default/index.min.js`;\n    const apiScript = document.getElementById(API_SCRIPT_ID);\n    if (apiScript && apiScript.parentNode && apiScript.getAttribute('src') !== apiSrc) {\n      apiScript.parentNode.removeChild(apiScript);\n    }\n    return loadScript(API_SCRIPT_ID, apiSrc);\n  }\n\n  /** Build video brightcove element */\n  protected buildVideo(): HTMLElement {\n    const el = document.createElement('video-js');\n    el.id = 'esl-media-brightcove-' + randUID();\n    el.className = 'esl-media-inner esl-media-brightcove ' + this.videojsClasses;\n    el.title = this.config.title;\n    el.toggleAttribute('loop', this.config.loop);\n    el.toggleAttribute('muted', this.config.muted);\n    el.toggleAttribute('controls', this.config.controls);\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('data-embed', 'default');\n    el.setAttribute('data-video-id', `ref:${this.config.mediaId}`);\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    this._account.playerId && el.setAttribute('data-player', this._account.playerId);\n    this._account.accountId && el.setAttribute('data-account', this._account.accountId);\n    return el;\n  }\n\n  /** Utility method to convert api event to promise */\n  protected $$fromEvent(eventName: string): Promise<void> {\n    if (!this._api) return Promise.reject();\n    return new Promise((resolve, reject) => this._api ? this._api.one(eventName, resolve) : reject());\n  }\n\n  /**\n   * Executes as soon as api script detected or loaded.\n   * @returns promise with provided API\n   */\n  protected onAPILoaded(): Promise<void> | void {\n    if (typeof window.bc !== 'function' || typeof window.videojs !== 'function') {\n      throw new Error('Brightcove API is not in the global scope');\n    }\n    console.debug('ESL Media: Brightcove API init for ', this);\n    this._api = window.bc(this._el);\n    return new Promise((resolve, reject) => this._api ? this._api.ready(resolve) : reject());\n  }\n\n  /**\n   * Executes after API ready state resolved\n   * Basic onAPIReady should be called to subscribe to API state\n   */\n  protected onAPIReady(): Promise<void> | void {\n    console.debug('ESL Media: Brightcove API is ready ', this);\n    // Set autoplay though js because BC is unresponsive while processing it natively\n    this._api.autoplay(this._autoplay || this.config.autoplay);\n\n    // Listeners to control player state\n    this._api.on('play', () => this.component._onPlay());\n    this._api.on('pause', () => this.component._onPaused());\n    this._api.on('ended', () => this.component._onEnded());\n    this.component._onReady();\n\n    // Can handle query only when loadedmetadata have happened\n    return this.$$fromEvent('loadedmetadata');\n  }\n\n  public bind(): void {\n    const Provider = (this.constructor as typeof BrightcoveProvider);\n    this._account = Provider.getAccount(this.component);\n    this._el = this.buildVideo();\n    this.component.appendChild(this._el);\n\n    this._ready = Provider.loadAPI(this._account)\n      .then(() => this.onAPILoaded())\n      .then(() => this.onAPIReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  public unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.dispose();\n    super.unbind();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (typeof this._api[param] === 'function') {\n      this._api[param](value);\n    }\n  }\n\n  public focus(): void {\n    this._api && this._api.focus();\n  }\n\n  public get state(): PlayerStates {\n    if (this._api) {\n      if (this._api.ended()) return PlayerStates.ENDED;\n      if (this._api.paused()) return PlayerStates.PAUSED;\n      if (!this._api.played()) return PlayerStates.UNSTARTED;\n      return PlayerStates.PLAYING;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get defaultAspectRatio(): number {\n    if (!this._api) return 0;\n    return this._api.videoWidth() / this._api.videoHeight();\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.currentTime() : 0;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.duration() : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.currentTime(pos);\n  }\n\n  public play(): void {\n    this._api.play();\n  }\n\n  public pause(): void {\n    this._api.pause();\n  }\n\n  public stop(): void {\n    this._api.currentTime(0);\n    this._api.pause();\n  }\n\n  // Overrides to set tech autoplay marker\n  public safePlay(): Promise<any> {\n    this._autoplay = true;\n    return super.safePlay();\n  }\n  public safeStop(): Promise<any> {\n    this._autoplay = true;\n    return super.safeStop();\n  }\n}\n\n// root typing\ndeclare global {\n  interface Window {\n    bc?: (el: HTMLElement, ...args: any[]) => VideoJsPlayer;\n  }\n}\n","import {isObject} from './types';\n\n/** Deep object compare */\nexport function deepCompare(obj1: any, obj2: any): boolean {\n  if (Object.is(obj1, obj2)) return true;\n  if (typeof obj1 !== typeof obj2) return false;\n  if (isObject(obj1) && isObject(obj2)) {\n    const keys1 = Object.keys(obj1);\n    const keys2 = Object.keys(obj2);\n    if (keys1.length !== keys2.length) return false;\n    return !keys1.some((key) => !deepCompare(obj1[key], obj2[key]));\n  }\n  return false;\n}\n","/**\n * Slide controller\n * @author Julia Murashko\n */\nimport {ESLBaseElement} from '../../../esl-base-element/core';\n\nexport class ESLCarouselSlide extends ESLBaseElement {\n  // TODO: refactor (check type of Element)\n  public get index(): number {\n    if (!this.parentNode) return -1;\n    return Array.prototype.indexOf.call(this.parentNode.children, this);\n  }\n\n  public get active(): boolean {\n    return this.hasAttribute('active');\n  }\n  public _setActive(active: boolean) {\n    this.toggleAttribute('active', active);\n  }\n\n  public get first(): boolean {\n    return this.hasAttribute('first');\n  }\n  public _setFirst(first: boolean) {\n    this.toggleAttribute('first', first);\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-slide': ESLCarouselSlide;\n  }\n}\n","import {Observable} from '../../../../esl-utils/abstract/observable';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nexport abstract class ESLCarouselView {\n  protected readonly carousel: ESLCarousel;\n\n  protected constructor(carousel: ESLCarousel) {\n    this.carousel = carousel; // TODO: unsafe while lifecycle is not clear\n  }\n\n  public abstract bind(): void;\n\n  public abstract draw(): void;\n\n  public abstract goTo(nextIndex: number, direction: string): void;\n\n  public abstract unbind(): void;\n}\n\nexport type ESLCarouselViewConstructor = new(carousel: ESLCarousel) => ESLCarouselView;\n\nlet eslRegistryInstance: ESLCarouselViewRegistry | null = null;\nexport class ESLCarouselViewRegistry extends Observable<(name: string, view: ESLCarouselViewConstructor) => void> {\n  private registry = new Map<string, ESLCarouselViewConstructor>();\n\n  public static get instance() {\n    if (eslRegistryInstance === null) {\n      eslRegistryInstance = new ESLCarouselViewRegistry();\n    }\n    return eslRegistryInstance;\n  }\n\n  public createViewInstance(name: string, carousel: ESLCarousel): ESLCarouselView | null {\n    const View = this.registry.get(name);\n    return View ? new View(carousel) : null;\n  }\n\n  public registerView(name: string, view: ESLCarouselViewConstructor) {\n    if (this.registry.has(name)) {\n      throw new Error(`View with name ${name} already defined`);\n    }\n    this.registry.set(name, view);\n    this.fire(name, view);\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, attr} from '../../../esl-base-element/core';\nimport {deepCompare} from '../../../esl-utils/misc/object';\nimport {ESLMediaRuleList} from '../../../esl-media-query/core';\nimport {ESLCarouselSlide} from './esl-carousel-slide';\nimport {ESLCarouselViewRegistry} from './view/esl-carousel-view';\n\nimport type {ESLCarouselView} from './view/esl-carousel-view';\nimport type {ESLCarouselPlugin} from '../plugin/esl-carousel-plugin';\n\ninterface CarouselConfig { // Registry\n  view?: string;\n  count?: number;\n  className?: string;\n}\n\n// TODO: add ability to choose the number of an active slide\n@ExportNs('Carousel')\nexport class ESLCarousel extends ESLBaseElement {\n  public static Slide = ESLCarouselSlide;\n\n  public static is = 'esl-carousel';\n\n  static get observedAttributes() {\n    return ['config'];\n  }\n\n  @attr() public config: string;\n\n  private _configRules: ESLMediaRuleList<CarouselConfig | null>;\n  private _currentConfig: CarouselConfig = {};\n  private _view: ESLCarouselView | null;\n  private readonly _plugins = new Map<string, ESLCarouselPlugin>();\n\n  private readonly _onMatchChange: () => void;\n\n  constructor() {\n    super();\n    this._onMatchChange = this.update.bind(this, false);\n    this._onRegistryChange = this._onRegistryChange.bind(this);\n  }\n\n  get $slidesArea(): HTMLElement | null {\n    return this.querySelector('[data-slides-area]');\n  }\n\n  get $slides(): ESLCarouselSlide[] {\n    // TODO cache\n    const els = this.$slidesArea && this.$slidesArea.querySelectorAll(ESLCarouselSlide.is);\n    return els ? Array.from(els) as ESLCarouselSlide[] : [];\n  }\n\n  get count(): number {\n    return this.$slides.length || 0;\n  }\n\n  get activeIndexes(): number[] {\n    return this.$slides.reduce((activeIndexes: number[], el, index) => {\n      if (el.active) {\n        activeIndexes.push(index);\n      }\n      return activeIndexes;\n    }, []);\n  }\n\n  get activeCount(): number {\n    return this.activeConfig.count || 0;\n  }\n\n  /**\n   * @returns number first active index\n   */\n  get firstIndex(): number {\n    const index = this.$slides.findIndex((slide) => {\n      return slide.first;\n    });\n    return Math.max(index, 0);\n  }\n\n  get activeConfig(): CarouselConfig {\n    return this._currentConfig;\n  }\n\n  set activeConfig(config) {\n    this._currentConfig = Object.assign({}, config);\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction?: string, force: boolean = false) {\n    if (this.dataset.isAnimated) {\n      return;\n    }\n\n    if (nextIndex < 0) {\n      nextIndex = 0;\n    }\n\n    if (this.firstIndex === nextIndex && !force) {\n      return;\n    }\n\n    if (!direction) {\n      // calculate and compare how much slides we have to go due to direction (left or right)\n      // choose less\n      // TODO: optimize\n      if (nextIndex > this.firstIndex) {\n        direction = nextIndex - this.firstIndex > (this.firstIndex - nextIndex + this.count) % this.count ? 'left' : 'right';\n      } else {\n        direction = this.firstIndex - nextIndex >= (nextIndex - this.firstIndex - nextIndex + this.count) % this.count ? 'right' : 'left';\n      }\n    }\n\n    const eventDetails = { // Todo change info\n      bubbles: true,\n      detail: {\n        direction\n      }\n    };\n\n    const approved = this.$$fire('slide:change', eventDetails);\n\n    if (this._view && approved && this.firstIndex !== nextIndex) {\n      this._view.goTo(nextIndex, direction);\n    }\n    if (this._view && approved) {\n      let i = 0;\n      this.$slides.forEach((el, index) => {\n        el._setActive(((nextIndex + this.count) % this.count <= index) && (index < (nextIndex + this.activeCount + this.count) % this.count));\n      });\n\n      while (i < this.activeCount) {\n        const computedIndex = (nextIndex + i + this.count) % this.count;\n        this.$slides[computedIndex]._setActive(true);\n        ++i;\n      }\n\n      if (this.activeConfig.view === 'multiple') {\n        this.$slides[this.firstIndex]._setFirst(false);\n        this.$slides[nextIndex]._setFirst(true);\n      }\n    }\n\n    this.$$fire('slide:changed', eventDetails);\n  }\n\n  public prev() {\n    // const nextGroup = this.getNextGroup(-1);\n    this.goTo((this.firstIndex - this.activeCount + this.count) % this.count, 'left');\n  }\n\n  public next() {\n    // const nextGroup = this.getNextGroup(1);\n    this.goTo((this.firstIndex + this.activeCount + this.count) % this.count, 'right');\n  }\n\n  protected connectedCallback() {\n    super.connectedCallback();\n\n    this.update(true);\n    this.goTo(this.firstIndex, '', true);\n    this._bindEvents();\n\n    ESLCarouselViewRegistry.instance.addListener(this._onRegistryChange);\n  }\n\n  protected disconnectedCallback() {\n    super.disconnectedCallback();\n    this._unbindEvents();\n\n    ESLCarouselViewRegistry.instance.removeListener(this._onRegistryChange);\n  }\n\n  private attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    // TODO: change observed attributes\n    if (attrName === 'config') {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n      this.update(true);\n    }\n  }\n\n  protected _bindEvents() {\n    this.addEventListener('click', this._onClick, false);\n  }\n\n  protected _unbindEvents() {\n    this.removeEventListener('click', this._onClick, false);\n  }\n\n  get configRules() {\n    if (!this._configRules) {\n      this.configRules = ESLMediaRuleList.parse<CarouselConfig>(this.config, ESLMediaRuleList.OBJECT_PARSER);\n    }\n    return this._configRules;\n  }\n\n  set configRules(rules: ESLMediaRuleList<CarouselConfig | null>) {\n    if (this._configRules) {\n      this._configRules.removeListener(this._onMatchChange);\n    }\n    this._configRules = rules;\n    this._configRules.addListener(this._onMatchChange);\n  }\n\n  private update(force: boolean = false) {\n    const config: CarouselConfig = Object.assign(\n      {view: 'multiple', count: 1},\n      this.configRules.activeValue\n    );\n\n    if (!force && deepCompare(this.activeConfig, config)) {\n      return;\n    }\n    this.activeConfig = config;\n\n    const viewType = this.activeConfig.view;\n    if (!viewType) return;\n\n    // TODO: somehow compare active view & selected view\n    // this._view && this._view.unbind();\n    this._view = ESLCarouselViewRegistry.instance.createViewInstance(viewType, this);\n    // this._view && this._view.bind();\n\n    if (force || this.activeIndexes.length !== this.activeConfig.count) {\n      this._view && this._view.draw();\n      // this.goTo(this.firstIndex, '', true);\n    }\n  }\n\n  private getNextGroup(shiftGroupsCount: number) {\n    // get number of group of current active slides by last index of this group\n    const lastIndex = this.activeIndexes.length - 1;\n    const currentGroup = Math.floor(this.activeIndexes[lastIndex] / this.activeCount);\n    // get count of groups of slides\n    const countGroups = Math.ceil(this.count / this.activeCount);\n    // get number of group of next active slides\n    return (currentGroup + shiftGroupsCount + countGroups) % countGroups;\n  }\n\n  // move to core plugin\n  protected _onClick(event: MouseEvent) {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const markedTarget: HTMLElement | null = eventTarget.closest('[data-slide-target]');\n    if (markedTarget && markedTarget.dataset.slideTarget) {\n      const target = markedTarget.dataset.slideTarget;\n      if ('prev' === target) {\n        this.prev();\n      } else if ('next' === target) {\n        this.next();\n      } else if ('g' === target[0]) {\n        const group = +(target.substr(1)) - 1;\n        const lastGroup = Math.floor(this.count / this.activeCount);\n        this.goTo(group === lastGroup ? this.count - this.activeCount : this.activeCount * group);\n      } else {\n        this.goTo(+target - 1);\n      }\n    }\n  }\n\n  protected _onRegistryChange() {\n    if (!this._view) this.update(true);\n  }\n\n  // Plugin management\n  public addPlugin(plugin: ESLCarouselPlugin) {\n    if (plugin.carousel) return;\n    this.appendChild(plugin);\n  }\n\n  public removePlugin(plugin: ESLCarouselPlugin | string | undefined) {\n    if (typeof plugin === 'string') plugin = this._plugins.get(plugin);\n    if (!plugin || plugin.carousel !== this) return;\n    plugin.parentNode && plugin.parentNode.removeChild(plugin);\n  }\n\n  public _addPlugin(plugin: ESLCarouselPlugin) {\n    if (this._plugins.has(plugin.key)) return;\n    this._plugins.set(plugin.key, plugin);\n    if (this.isConnected) plugin.bind();\n  }\n\n  public _removePlugin(plugin: ESLCarouselPlugin) {\n    if (!this._plugins.has(plugin.key)) return;\n    plugin.unbind();\n    this._plugins.delete(plugin.key);\n  }\n\n  public static register(tagName?: string) {\n    ESLCarouselSlide.register((tagName || ESLCarousel.is) + '-slide');\n    customElements.whenDefined(ESLCarouselSlide.is).then(() => super.register.call(this, tagName));\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {}\n  export interface ESLLibrary {\n    Carousel: typeof ESLCarousel;\n    CarouselPlugin: typeof ESLCarouselPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel': ESLCarousel;\n  }\n}\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLSingleCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  public bind() {}\n\n  // TODO: check\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = -(parseFloat(slidesAreaStyles.width) / this.carousel.firstIndex);\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  public goTo(nextIndex: number, direction: string) {\n    if (this.carousel.firstIndex === nextIndex) {\n      return;\n    }\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n    this.carousel.setAttribute('direction', direction);\n\n    const activeSlide = this.carousel.$slides[this.carousel.firstIndex];\n    const nextSlide = this.carousel.$slides[nextIndex];\n\n    activeSlide.classList.add(direction);\n    nextSlide.classList.add(direction);\n\n    activeSlide.classList.add('prev');\n\n    activeSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n    nextSlide.addEventListener('animationend', (e) => this._cleanAnimation(e));\n  }\n\n  private _cleanAnimation(event: Event) {\n    const target = event.target as HTMLElement;\n    const direction = this.carousel.getAttribute('direction');\n\n    direction && target.classList.remove(direction);\n    target.classList.remove('prev');\n\n    this.carousel.removeAttribute('data-is-animated');\n  }\n\n  // tslint:disable-next-line:no-empty\n  public unbind() {\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('single', ESLSingleCarouselView);\n","import {ESLCarouselView, ESLCarouselViewRegistry} from './esl-carousel-view';\n\nimport type {ESLCarousel} from '../esl-carousel';\n\nclass ESLMultiCarouselView extends ESLCarouselView {\n\n  public constructor(carousel: ESLCarousel) {\n    super(carousel);\n  }\n\n  // tslint:disable-next-line:no-empty\n  public bind() {\n  }\n\n  public draw() {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n\n    const slideStyles = getComputedStyle($slides[this.carousel.firstIndex]);\n    const currentTrans = slideStyles.transform !== 'none' ? parseFloat(slideStyles.transform.split(',')[4]) : 0;\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n\n    const slideWidth = parseFloat(slidesAreaStyles.width) / this.carousel.activeCount\n      - parseFloat(slideStyles.marginLeft) - parseFloat(slideStyles.marginRight);\n    const computedLeft = this.carousel.firstIndex === 0 ?\n      -currentTrans :\n      -(parseFloat(slidesAreaStyles.width) / this.carousel.activeCount * this.carousel.firstIndex) - currentTrans;\n\n\n    $slides.forEach((slide) => {\n      slide.style.minWidth = slideWidth + 'px';\n      slide.style.left = computedLeft + 'px';\n    });\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public goTo(nextIndex: number, direction: string) {\n    const slideIndex = direction === 'right' ? this.carousel.activeIndexes[0] : this.carousel.firstIndex;\n    const slideStyles = getComputedStyle(this.carousel.$slides[slideIndex]);\n    const slideWidth = parseFloat(slideStyles.width) +\n      parseFloat(slideStyles.marginLeft) +\n      parseFloat(slideStyles.marginRight);\n    const areaWidth = slideWidth * this.carousel.$slides.length;\n\n    const transitionDuration = parseFloat(slideStyles.transitionDuration) * 1000; // ms\n    const currentLeft = parseFloat(slideStyles.left);\n    const currentTrans = parseFloat(slideStyles.transform.split(',')[4]) || 0;\n\n    if (this.carousel.firstIndex === nextIndex) {\n      return 0;\n    }\n\n    let shiftCount = 0;\n    if (direction === 'left') {\n      shiftCount = (this.carousel.firstIndex - nextIndex + this.carousel.count) % this.carousel.count;\n    } else if (direction === 'right') {\n      shiftCount = (this.carousel.count - this.carousel.firstIndex + nextIndex) % this.carousel.count;\n    }\n    const direct = direction === 'left' ? -1 : 1;\n    const trans = currentTrans - (shiftCount * slideWidth) * direct;\n\n    const nextActiveIndexes: number[] = [];\n    for (let i = 0; i < this.carousel.activeCount; ++i) {\n      nextActiveIndexes.push((nextIndex + i + this.carousel.count) % this.carousel.count);\n    }\n\n    const intersectionIndexes = nextActiveIndexes.filter(\n      (index: number) => this.carousel.activeIndexes.includes(index)\n    );\n\n    let left = 0;\n    const animatedCount = shiftCount < this.carousel.activeCount ? this.carousel.activeCount : shiftCount;\n    for (let i = 0; i < animatedCount; ++i) {\n      const computedIndex = (nextIndex + i + this.carousel.count) % this.carousel.count;\n      const minActive = Math.min(...this.carousel.activeIndexes);\n      // make next active slides be in one line\n      if (computedIndex >= this.carousel.firstIndex && direction === 'left') {\n        left = currentLeft - areaWidth;\n      } else if (computedIndex <= minActive && direction === 'right') {\n        left = currentLeft + areaWidth;\n      } else {\n        left = currentLeft;\n      }\n\n      // exclude slides that are active now and have to be active then\n      if (!intersectionIndexes.includes(computedIndex)) {\n        this.carousel.$slides[computedIndex].style.left = left + 'px';\n      }\n\n      // handle slides that are active now and have to be active then\n      if (intersectionIndexes.includes(computedIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(computedIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        const copyLeft = left;\n        setTimeout(() => {\n          this.carousel.$slides[computedIndex].style.left = copyLeft + 'px';\n        }, time);\n      }\n\n    }\n\n    this.carousel.$slides.forEach((slide) => {\n      // exclude slides that are active now and have to be active then\n\n      slide.style.transform = `translateX(${trans}px)`;\n\n      // handle slides that are active now and have to be active then\n      const sIndex = slide.index;\n      if (intersectionIndexes.includes(sIndex)) {\n        const orderIndex = nextActiveIndexes.indexOf(sIndex);\n        const time = (direction === 'right') ?\n          (transitionDuration / this.carousel.activeCount) * orderIndex :\n          (transitionDuration / this.carousel.activeCount) * (this.carousel.activeCount - orderIndex - 1);\n        setTimeout(() => {\n          this.carousel.$slides[sIndex].style.transform = `translateX(${trans}px)`;\n        }, time);\n      }\n    });\n\n    this.carousel.setAttribute('data-is-animated', 'true');\n\n    setTimeout(() => {\n      this.carousel.removeAttribute('data-is-animated');\n    }, transitionDuration);\n\n  }\n\n  public unbind() {\n    this.carousel.$slides.forEach((el) => {\n      el.style.transform = 'none';\n      el.style.left = 'none';\n    });\n  }\n}\n\nESLCarouselViewRegistry.instance.registerView('multiple', ESLMultiCarouselView);\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {ESLCarousel} from '../core/esl-carousel';\n\n/**\n * {@link ESLCarousel} Plugin base class.\n * The ESL Carousel Plugin should have the dom representation so it's extends {@link ESLBaseElement}\n * Use the attributes to path the plugin options, the same as with any custom elements.\n */\nexport abstract class ESLCarouselPlugin extends ESLBaseElement {\n  /**\n   * Marker to define the restriction for the plugin placement.\n   * If freePlacement is false - plugin element should be child of ESLCarousel element.\n   * If freePlacement is true - plugin can be placed anywhere inside of carousel.\n   */\n  public static freePlacement = false;\n\n  /**\n   * @returns carousel owner of the plugin\n   */\n  protected findCarouselOwner(): ESLCarousel | null {\n    if ((this.constructor as typeof ESLCarouselPlugin).freePlacement) {\n      return this.closest(ESLCarousel.is);\n    } else {\n      return this.parentNode as ESLCarousel;\n    }\n  }\n\n  private _carousel?: ESLCarousel;\n\n  /**\n   * @returns plugin unique key, ESLCarousel can not own more then one plugin with the same key\n   */\n  public get key() {\n    return this.nodeName.toLowerCase();\n  }\n  /**\n   * @returns owner of plugin\n   */\n  public get carousel(): ESLCarousel {\n    return this._carousel!;\n  }\n\n  protected connectedCallback() {\n    const carousel = this.findCarouselOwner();\n    if (carousel instanceof ESLCarousel) {\n      this._carousel = carousel;\n      this._carousel._addPlugin(this);\n    } else {\n      throw new Error('Invalid esl-carousel-plugin placement: plugin element should be placed under the esl-carousel node');\n    }\n  }\n  protected disconnectedCallback() {\n    if (this.carousel) {\n      this.carousel._removePlugin(this);\n      delete this._carousel;\n    }\n  }\n\n  /**\n   * Define the plugin bind lifecycle hook.\n   * Unlike {@link connectedCallback}, bind is called by owner ESL Carousel when the plugin can be attached.\n   */\n  public abstract bind(): void;\n\n  /**\n   * Define the plugin unbind lifecycle hook.\n   * Unlike {@link disconnectedCallback}, unbind is called by owner ESL Carousel when the plugin should be detached.\n   */\n  public abstract unbind(): void;\n\n  public static register(tagName?: string) {\n    customElements.whenDefined(ESLCarousel.is).then(() => super.register.call(this, tagName));\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Dots plugin\n * Dots plugin renders carousel dots navigation\n *\n * @author Julia Murashko\n */\n@ExportNs('CarouselPlugins.Dots')\nexport class ESLCarouselDotsPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-dots';\n  public static freePlacement = true;\n\n  private _onUpdate = () => this.rerender();\n\n  public bind() {\n    this.rerender();\n    this.carousel.addEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public unbind() {\n    this.innerHTML = '';\n    this.carousel.removeEventListener('esl:slide:changed', this._onUpdate);\n  }\n\n  public rerender() {\n    let html = '';\n    const activeDot = Math.floor(this.carousel.activeIndexes[this.carousel.activeCount - 1] / this.carousel.activeCount);\n    for (let i = 0; i < Math.ceil(this.carousel.count / this.carousel.activeCount); ++i) {\n      html += this.buildDot(i, i === activeDot);\n    }\n    this.innerHTML = html;\n  }\n\n  public buildDot(index: number, isActive: boolean) {\n    return `<button role=\"button\" class=\"carousel-dot ${isActive ? 'active-dot' : ''}\" data-slide-target=\"g${index + 1}\"></button>`;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Dots: typeof ESLCarouselDotsPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-dots': ESLCarouselDotsPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-base-element/core';\nimport {ESLCarousel} from '../core/esl-carousel';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Link plugin. Allows to bind carousel positions.\n */\n@ExportNs('CarouselPlugins.Link')\nexport class ESLCarouselLinkPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-link-plugin';\n\n  public static get observedAttributes() {\n    return ['to', 'direction'];\n  }\n\n  @attr() public to: string;\n  @attr({defaultValue: 'both'}) public direction: string;\n\n  private _target: ESLCarousel | null;\n\n  constructor() {\n    super();\n    this._onSlideChange = this._onSlideChange.bind(this);\n  }\n\n  public bind() {\n    if (!this.target) {\n      this.target = document.querySelector(this.to);\n    }\n    if (!(this.target instanceof ESLCarousel)) return;\n\n    if (this.direction === 'both' || this.direction === 'reverse') {\n      this.target.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n    if (this.direction === 'both' || this.direction === 'target') {\n      this.carousel.addEventListener('esl:slide:changed', this._onSlideChange);\n    }\n  }\n\n  public unbind() {\n    this.target && this.target.removeEventListener('esl:slide:changed', this._onSlideChange);\n    this.carousel && this.carousel.removeEventListener('esl:slide:changed', this._onSlideChange);\n  }\n\n  protected _onSlideChange(e: CustomEvent) {\n    if (!this.target || !this.carousel) return;\n    const $target = e.target === this.carousel ? this.target : this.carousel;\n    const $source = e.target === this.carousel ? this.carousel : this.target;\n    $target.goTo($source.firstIndex, e.detail.direction);\n  }\n\n  protected attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (this.carousel && oldVal !== newVal) {\n      this.unbind();\n      if (attrName === 'to') {\n        this._target = null;\n      }\n      this.bind();\n    }\n  }\n\n  get target() {\n    return this._target;\n  }\n  set target(target) {\n    this._target = target;\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Link: typeof ESLCarouselLinkPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-link-plugin': ESLCarouselLinkPlugin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {EventUtils} from '../../../esl-utils/dom/events';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\nimport type {Point} from '../../../esl-utils/dom/events';\n\n/**\n * Slide Carousel Touch plugin\n */\n@ExportNs('CarouselPlugins.Touch')\nexport class ESLCarouselTouchPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-touch-plugin';\n\n  private isTouchStarted = false;\n  private startPoint: Point = {x: 0, y: 0};\n\n  public bind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.addEventListener(events.START, this.onTouchStart);\n    this.carousel.addEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.addEventListener(events.END, this.onTouchEnd);\n  }\n\n  public unbind() {\n    const events = DeviceDetector.TOUCH_EVENTS;\n\n    this.carousel.removeEventListener(events.START, this.onTouchStart);\n    this.carousel.removeEventListener(events.MOVE, this.onTouchMove);\n    this.carousel.removeEventListener(events.END, this.onTouchEnd);\n  }\n\n  onTouchStart = (event: TouchEvent | PointerEvent) => {\n    // TODO: precondition for focused element ?\n    if ((event instanceof TouchEvent && event.touches.length !== 1) ||\n      (event instanceof PointerEvent && event.pointerType !== 'touch')) {\n      this.isTouchStarted = false;\n      return;\n    }\n    this.isTouchStarted = true;\n    this.startPoint = EventUtils.normalizeTouchPoint(event);\n  };\n\n  onTouchMove = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    // const point = EventUtils.normalizeTouchPoint(event);\n    // const offset = {\n    // \tx: point.x - this.startPoint.x,\n    // \ty: point.y - this.startPoint.y\n    // };\n  };\n\n  onTouchEnd = (event: TouchEvent | PointerEvent) => {\n    if (!this.isTouchStarted) return;\n    const point = EventUtils.normalizeTouchPoint(event);\n    const offset = {\n      x: point.x - this.startPoint.x,\n      y: point.y - this.startPoint.y\n    };\n    this.isTouchStarted = false;\n\n    // TODO: temporary, update according final implementation\n    if (Math.abs(offset.x) < Math.abs(offset.y)) return; // Direction\n    if (Math.abs(offset.x) < 100) return; // Tolerance\n\n    // Swipe gesture example\n    if (offset.x < 0) {\n      this.carousel.next();\n    } else {\n      this.carousel.prev();\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  };\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Touch: typeof ESLCarouselTouchPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-touch-plugin': ESLCarouselTouchPlugin;\n  }\n}\n","// Views\nimport './core/view/esl-single-carousel-view';\nimport './core/view/esl-multi-carousel-view';\n\nexport * from './core/esl-carousel';\n\n// Plugins\nimport {ESLCarouselDotsPlugin} from './plugin/esl-carousel-dots.plugin';\nimport {ESLCarouselLinkPlugin} from './plugin/esl-carousel-link.plugin';\nimport {ESLCarouselTouchPlugin} from './plugin/esl-carousel-touch.plugin';\nimport {ESLCarouselAutoplayPlugin} from './plugin/esl-carousel-autoplay.plugin';\n\n// TODO: ??\nexport const ESLCarouselPlugins = {\n  Dots: ESLCarouselDotsPlugin,\n  Link: ESLCarouselLinkPlugin,\n  Touch: ESLCarouselTouchPlugin,\n  Autoplay: ESLCarouselAutoplayPlugin\n};\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr} from '../../../esl-base-element/core';\nimport {ESLCarouselPlugin} from './esl-carousel-plugin';\n\n/**\n * Slide Carousel Autoplay (Auto-Advance) plugin\n * Automatically switch slides by timeout\n *\n * @author Alexey Stsefanovich (ala'n)\n */\n@ExportNs('CarouselPlugins.Autoplay')\nexport class ESLCarouselAutoplayPlugin extends ESLCarouselPlugin {\n  public static is = 'esl-carousel-autoplay-plugin';\n\n  @attr({defaultValue: 'next'}) public direction: string;\n  @attr({defaultValue: '5000'}) public timeout: number;\n\n  private _active: boolean;\n  private _timeout: number | null = null;\n\n  constructor() {\n    super();\n    this._onInterval = this._onInterval.bind(this);\n    this._onInteract = this._onInteract.bind(this);\n  }\n\n  public get active() {\n    return this._active;\n  }\n\n  public bind(): void {\n    this.carousel.addEventListener('mouseover', this._onInteract);\n    this.carousel.addEventListener('mouseout', this._onInteract);\n    this.carousel.addEventListener('focusin', this._onInteract);\n    this.carousel.addEventListener('focusout', this._onInteract);\n    this.carousel.addEventListener('esl:slide:changed', this._onInteract);\n    this.start();\n    // console.log('Auto-advance plugin attached successfully to ', this.carousel);\n  }\n  public unbind(): void {\n    this.carousel.removeEventListener('mouseover', this._onInteract);\n    this.carousel.removeEventListener('mouseout', this._onInteract);\n    this.carousel.removeEventListener('focusin', this._onInteract);\n    this.carousel.removeEventListener('focusout', this._onInteract);\n    this.carousel.removeEventListener('esl:slide:changed', this._onInteract);\n    this.stop();\n    // console.log('Auto-advance plugin detached successfully from ', this.carousel);\n  }\n\n  public start() {\n    this._active = true;\n    this.reset();\n  }\n  public stop() {\n    this._active = false;\n    this.reset();\n  }\n\n  public reset() {\n    if (typeof this._timeout === 'number') clearTimeout(this._timeout);\n    this._timeout = this._active ? window.setTimeout(this._onInterval, this.timeout) : null;\n  }\n\n  protected _onInterval() {\n    if (!this._active) return;\n    switch (this.direction) {\n      case 'next':\n        this.carousel.next();\n        return;\n      case 'prev':\n        this.carousel.prev();\n        return;\n    }\n    this.reset();\n  }\n\n  protected _onInteract(e: Event) {\n    switch (e.type) {\n      case 'mouseover':\n      case 'focusin':\n        this.stop();\n        return;\n      case 'mouseout':\n      case 'focusout':\n        this.start();\n        return;\n      case 'esl:slide:changed':\n        this.reset();\n        return;\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselPlugins {\n    Autoplay: typeof ESLCarouselAutoplayPlugin;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-autoplay-plugin': ESLCarouselAutoplayPlugin;\n  }\n}\n","import {debounce} from '../../../src/modules/esl-utils/async/debounce';\n\nclass TestMediaSource extends HTMLElement {\n  get target(): HTMLElement | null {\n    const targetSel = this.getAttribute('target');\n    return document.querySelector(targetSel || '');\n  }\n\n  private render(): void {\n    const form = document.createElement('form');\n    form.innerHTML = `\n      <fieldset>\n        <legend>Video Settings:</legend>\n          <div class=\"input-group mb-2\">\n          <select class=\"form-control\" name=\"media-type\">\n            <option value=\"auto\">- Auto -</option>\n            <option value=\"audio\">HTML Audio</option>\n            <option value=\"video\">HTML Video</option>\n            <option value=\"youtube\">Youtube</option>\n            <option value=\"brightcove\">Brightcove</option>\n            <option value=\"iframe\">Iframe</option>\n          </select>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media src\" name=\"media-src\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media id\" name=\"media-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player id\" name=\"player-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player account\" name=\"player-account\" autocomplete=\"on\"/>\n        </div>\n\n        <div class=\"form-group\">\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"muted\" class=\"form-check-input\"/> Muted</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"autoplay\" class=\"form-check-input\"/> Autoplay</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"disabled\" class=\"form-check-input\"/> Disabled</label>\n          </div>\n        </div>\n      </fieldset>\n    `;\n    form.action = 'javascript: void 0;';\n    this.innerHTML = '';\n    this.appendChild(form);\n  }\n\n  private onChange(): void {\n    const target = this.target;\n    const inputs = this.querySelectorAll('input[name], select[name]');\n    Array.from(inputs).forEach((input: HTMLInputElement | HTMLSelectElement) => {\n      if (!target) return;\n      if (input instanceof HTMLInputElement && input.type === 'checkbox') {\n        target.toggleAttribute(input.name, input.checked);\n      } else {\n        target.setAttribute(input.name, input.value);\n      }\n    });\n  }\n\n  protected connectedCallback(): void {\n    this.render();\n    this.addEventListener('change', debounce(() => this.onChange(), 750));\n    this.onChange();\n  }\n}\n\ncustomElements.define('test-media-source', TestMediaSource);\n","import {prop} from '../../../../src/modules/esl-utils/decorators/prop';\nimport {bind} from '../../../../src/modules/esl-utils/decorators/bind';\nimport {ready} from '../../../../src/modules/esl-utils/decorators/ready';\nimport {attr} from '../../../../src/modules/esl-base-element/decorators/attr';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\nimport {ESLMediaQuery} from '../../../../src/modules/esl-media-query/core/esl-media-query';\n\nimport type {ToggleableActionParams} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\n\ninterface SidebarActionParams extends ToggleableActionParams {\n  /** Change state without animation */\n  immediate: boolean;\n}\n\nexport class ESLDemoSidebar extends ESLToggleable {\n  static is = 'esl-d-sidebar';\n\n  @prop() public closeOnEsc = true;\n  @prop() public closeOnOutsideAction = true;\n\n  @prop() public submenus: string = '.sidebar-nav-secondary';\n  @prop() public activeMenuAttr: string = 'data-open';\n\n  @attr({name: 'animation'}) protected _animation: boolean;\n\n  public get $submenus(): ESLToggleable[] {\n    return Array.from(this.querySelectorAll(this.submenus));\n  }\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    ESLMediaQuery.for('@+MD').addListener(this.onBreakpointChange);\n  }\n  protected disconnectedCallback(): void {\n    super.disconnectedCallback();\n    ESLMediaQuery.for('@+MD').removeListener(this.onBreakpointChange);\n  }\n\n  protected storeState(): void {\n    this.open ? localStorage.removeItem('sidebar-collapsed') : localStorage.setItem('sidebar-collapsed', 'true');\n  }\n\n  protected setInitialState(): void {\n    const isDesktop = ESLMediaQuery.for('@+MD').matches;\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'init', immediate: true});\n  }\n\n  public collapseAll(): void {\n    this.$submenus.forEach((menu) => menu.hide({activator: this}));\n  }\n\n  public expandActive(noCollapse: boolean = false): void {\n    this.$submenus\n      .filter((menu) => menu.hasAttribute('data-open'))\n      .forEach((menu) => menu.show({noCollapse, activator: this}));\n  }\n\n  protected updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-expanded', String(this.open));\n  }\n\n  protected onShow(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onShow(params);\n    this.expandActive(params.initiator === 'init');\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n  protected onHide(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onHide(params);\n    this.collapseAll();\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n\n  @bind\n  protected onBreakpointChange(): void {\n    const isDesktop = ESLMediaQuery.for('@+MD').matches;\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'bpchange', immediate: !isDesktop});\n  }\n\n  @bind\n  protected _onOutsideAction(e: Event): void {\n    if (ESLMediaQuery.for('@+MD').matches) return;\n    super._onOutsideAction(e);\n  }\n}\n","import {loadScript} from '../../../src/modules/esl-utils/dom/script';\nimport {memoizeFn} from '../../../src/modules/esl-utils/misc/memoize';\n\nfunction loadSearchScript(): Promise<Event> {\n  return loadScript('gss', 'https://cse.google.com/cse.js?cx=3171f866738b34f02');\n}\n\nconst onGSSReady = (): Promise<void> => {\n  return new Promise((resolve) => {\n    (window as any).__gcse = {\n      parsetags: 'onload',\n      initializationCallback: (): void => resolve()\n    };\n  });\n};\n\nexport const requestGss = memoizeFn(() => loadSearchScript().then(onGSSReady));\n","import {prop} from '../../../../src/modules/esl-utils/decorators/prop';\nimport {CSSClassUtils} from '../../../../src/modules/esl-utils/dom/class';\nimport {afterNextRender} from '../../../../src/modules/esl-utils/async/raf';\nimport {parseNumber} from '../../../../src/modules/esl-utils/misc/format';\nimport {attr, boolAttr} from '../../../../src/modules/esl-base-element/core';\nimport {TraversingQuery} from '../../../../src/modules/esl-traversing-query/core';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core';\nimport {requestGss} from '../../search/search-script';\n\nimport type {ToggleableActionParams} from '../../../../src/modules/esl-toggleable/core';\n\nexport class ESLDemoSearchBox extends ESLToggleable {\n  static is = 'esl-d-search-box';\n\n  @attr() public postCls: string;\n  @attr() public postClsDelay: string;\n  @attr({defaultValue: '::find(input)'}) public firstFocusable: string;\n\n  @boolAttr() public autofocus: boolean;\n\n  @prop() public closeOnOutsideAction = true;\n\n  public onShow(params: ToggleableActionParams): void {\n    CSSClassUtils.add(this, this.postCls);\n    requestGss().then(() => this.showSearchElements(params));\n  }\n\n  private showSearchElements(params: ToggleableActionParams): void {\n    afterNextRender(() => super.onShow(params));\n    if (this.autofocus) {\n      const $focusEl = TraversingQuery.first(this.firstFocusable, this) as HTMLElement;\n      $focusEl && window.setTimeout(() => $focusEl.focus(), parseNumber(this.postClsDelay));\n    }\n\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n\n  public onHide(params: ToggleableActionParams): void {\n    super.onHide(params);\n    window.setTimeout(() => {\n      CSSClassUtils.remove(this, this.postCls);\n      this.activator?.focus({preventScroll: true});\n    }, parseNumber(this.postClsDelay));\n  }\n}\n","import {ESLBaseElement, attr} from '../../../../src/modules/esl-base-element/core';\nimport {bind} from '../../../../src/modules/esl-utils/decorators/bind';\nimport {ready} from '../../../../src/modules/esl-utils/decorators/ready';\nimport {range} from '../../../../src/modules/esl-utils/misc/array';\nimport {memoize} from '../../../../src/modules/esl-utils/decorators/memoize';\nimport {isIE} from '../../../../src/modules/esl-utils/environment/device-detector';\n\nexport class ESLDemoMarquee extends ESLBaseElement {\n  static is = 'esl-d-marquee';\n  static STARS_SEL = [\n    '#esl-logo-shield-stars > path',\n    '#esl-logo-border-inner-stars > path',\n    '#esl-logo-border-outer-stars > path',\n    '#esl-logo-wrench-left-stars > path',\n    '#esl-logo-wrench-right-stars > path'\n  ].join(',');\n\n  @attr({defaultValue: '4'}) public targetsNumber: string;\n  @attr({defaultValue: '3000'}) public iterationTime: string;\n\n  private _$active: HTMLElement[] = [];\n  private _animateTimer: number = 0;\n\n  @ready\n  protected connectedCallback(): void {\n    super.connectedCallback();\n    if (isIE) return;\n    this.startAnimation();\n  }\n  protected disconnectedCallback(): void {\n    this.stopAnimation();\n    super.disconnectedCallback();\n  }\n\n  @memoize()\n  public get $stars(): HTMLElement[] {\n    return Array.from(document.querySelectorAll((this.constructor as typeof ESLDemoMarquee).STARS_SEL));\n  }\n  public get $randomStar(): HTMLElement {\n    const index = Math.floor(Math.random() * this.$stars.length);\n    return this.$stars[index];\n  }\n\n  public startAnimation(): void {\n    memoize.clear(this, '$stars');\n    this.stopAnimation();\n    if (this.$stars.length < 2) return;\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n  public stopAnimation(): void {\n    this._animateTimer && window.clearTimeout(this._animateTimer);\n  }\n\n  @bind\n  protected _onIteration(): void {\n    const $candidates = range(+this.targetsNumber, () => this.$randomStar);\n    this._$active.forEach((star) => star.classList.remove('animate'));\n    $candidates.forEach((star) => star.classList.add('animate'));\n    this._$active = $candidates;\n\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n}\n","import {ESLBaseElement} from '../../../src/modules/esl-base-element/core';\nimport {CSSClassUtils} from '../../../src/modules/esl-utils/dom/class';\nimport {ready} from '../../../src/modules/esl-utils/decorators/ready';\nimport {requestGss} from './search-script';\n\nexport class ESLDemoSearchPageWrapper extends ESLBaseElement {\n  static is = 'esl-d-search-page-wrapper';\n\n  @ready\n  protected connectedCallback(): void {\n    requestGss().then(() => this.afterSearchScriptLoad());\n  }\n\n  private afterSearchScriptLoad(): void {\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n}\n","// Support for ES5 bundle target\nimport '../../src/polyfills/es5-target-shim';\n// Builtin polyfills\nimport '../../src/polyfills/polyfills.es6';\n// Validate environment\nimport '../../src/polyfills/polyfills.validate';\n\n// With Namespace\nimport '../../src/modules/lib';\n// Config\nimport './common/breakpoints';\n\nimport {\n  ESLVSizeCSSProxy,\n  ESLImage,\n  ESLMedia,\n  ESLToggleable,\n  ESLPopup,\n  ESLPopupPlaceholder,\n  ESLPanel,\n  ESLPanelGroup,\n  ESLTrigger,\n  ESLA11yGroup,\n  ESLTabs,\n  ESLTab,\n  ESLScrollbar,\n  ESLAlert,\n  ESLToggleableDispatcher,\n  ESLSelect,\n  ESLSelectList,\n  ESLNote,\n  ESLFootnotes,\n  ESLTooltip,\n  ESLAnimate\n} from '../../src/modules/all';\n\nimport '../../src/modules/esl-media/providers/iframe-provider';\nimport '../../src/modules/esl-media/providers/html5/audio-provider';\nimport '../../src/modules/esl-media/providers/html5/video-provider';\nimport '../../src/modules/esl-media/providers/youtube-provider';\nimport '../../src/modules/esl-media/providers/brightcove-provider';\n\nimport {\n  ESLCarousel,\n  ESLCarouselPlugins\n} from '../../src/modules/draft/all';\n\nimport './esl-media-demo/test-media';\nimport './esl-media-demo/test-media-source';\n\nimport {ESLDemoSidebar} from './navigation/navigation';\nimport {ESLDemoMarquee} from './landing/landing';\nimport {ESLDemoSearchBox} from './navigation/header/header-search';\nimport {ESLDemoSearchPageWrapper} from './search/search';\n\nESLVSizeCSSProxy.observe();\n\n// Register Demo components\nESLDemoSidebar.register();\nESLDemoMarquee.register();\nESLDemoSearchBox.register();\nESLDemoSearchPageWrapper.register();\n\n// Register ESL Components\n\nESLImage.register();\nESLMedia.register();\n\nESLToggleableDispatcher.init();\nESLToggleable.register();\nESLPopup.register();\nESLPopupPlaceholder.register();\n\nESLPanelGroup.register();\nESLPanel.register();\n\nESLTrigger.register();\nESLTab.register();\n\nESLA11yGroup.register();\nESLTabs.register();\n\nESLScrollbar.register();\n\nESLAlert.register();\nESLAlert.init({\n  closeOnOutsideAction: true\n});\n\nESLSelectList.register();\nESLSelect.register();\n\nESLFootnotes.register();\nESLNote.register();\nESLTooltip.register();\n\nESLAnimate.register();\n\nESLCarousel.register();\nESLCarouselPlugins.Dots.register();\nESLCarouselPlugins.Link.register();\nESLCarouselPlugins.Touch.register();\nESLCarouselPlugins.Autoplay.register();\n"],"names":["targetSel","this","getAttribute","Array","from","document","querySelectorAll","TestMediaControls","ACTIONS_ALL","render","actionList","actions","split","innerHTML","actionName","action","ACTIONS","appendChild","onClick","e","target","dataset","forEach","$el","call","connectedCallback","addEventListener","bind","play","title","renderButton","pause","stop","Object","keys","join","HTMLElement","btn","createElement","className","textContent","customElements","define","Element","prototype","toggleAttribute","name","force","has","hasAttribute","state","setAttribute","removeAttribute","KeyboardEventProto","desc","getOwnPropertyDescriptor","keyMap","Win","Scroll","Spacebar","Down","Left","Right","Up","Del","Apps","Esc","Multiply","Add","Subtract","Decimal","Divide","defineProperty","get","key","hasOwnProperty","KeyboardEvent","Node","ownerDocument","compareDocumentPosition","DOCUMENT_POSITION_DISCONNECTED","window","Error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","g","globalThis","Function","BuiltInHTMLElement","Reflect","polyfillWrapFlushCallback","value","construct","constructor","setPrototypeOf","shimES5ElementConstructor","ExportNs","root","reduce","obj","index","parts","length","type","exportNs","declare","registry","Map","ESLScreenBreakpoints","add","minWidth","maxWidth","toLowerCase","BP_NAME_REGEXP","test","current","set","ESLScreenBreakpoint","remove","delete","push","process","term","match","BP_REGEXP","sign","bp","shortcut","mediaQueryGE","mediaQueryLE","mediaQuery","min","max","toString","navApi","afterNextRender","callback","requestAnimationFrame","rafDecorator","fn","lastArgs","args","navigator","userAgent","vendor","platform","isTrident","isIE","isEdgeHTML","isBlinkEdge","isEdge","isGecko","isFirefox","isOpera","isChrome","isWebkit","isSafari","isBlink","isBot","isAndroid","isMobileIOS13","maxTouchPoints","isMobileIOS","isLegacyMobile","isMobile","isMobileSafari","isTouchDevice","msMaxTouchPoints","Touch","hasHover","matchMedia","matches","TOUCH_EVENTS","START","MOVE","END","DeviceDetector","observe","update","updateDebounced","destroy","removeEventListener","$html","documentElement","style","setProperty","vwProp","viewportWidth","vhProp","viewportHeight","clientWidth","innerHeight","propertyKey","descriptor","TypeError","enumerable","configurable","bindings","WeakMap","writable","identity","arg","wrap","arr","isArray","range","n","filler","i","lockStore","el","locker","substring","elLocks","classLocks","Set","lock","classList","size","unlock","CSSClassUtils","contains","splitTokens","tokenString","filter","str","els","cls","tokens","toggle","every","isObject","isPrimitive","toKeyDef","parseKeysPath","path","start","end","isIndex","Math","floor","getByPath","data","defaultValue","result","map","parseKeys","curr","toKebabCase","replace","unwrapParenthesis","trim","parseNumber","nanValue","NaN","isNaN","evaluate","console","warn","DEF_FORMAT_MATCHER","format","source","matcher","val","getAttr","fallback","$host","setAttr","attr","config","assign","propName","attrName","dataAttr","buildAttrName","readOnly","buildSimpleDescriptor","readonly","boolAttr","buildConditionalDescriptor","dispatch","eventName","eventInit","init","bubbles","composed","cancelable","dispatchEvent","CustomEvent","targets","composedPath","isMouseEvent","event","MouseEvent","isTouchEvent","TouchEvent","normalizeTouchPoint","EventUtils","changedTouches","x","pageX","y","pageY","normalizeCoordinates","elem","props","getBoundingClientRect","top","scrollY","left","scrollX","stopPropagation","preventDefault","_connected","is","disconnectedCallback","$$cls","$$attr","prevValue","$$fire","register","tagName","whenDefined","_listeners","addListener","listener","removeListener","fire","apply","error","memoizeFn","hashFn","memo","cache","clear","defaultArgsHashFn","String","defined","params","param","getPropertyDescriptor","o","prop","proto","getPrototypeOf","memoize","originalMethod","locks","defineOwnKeySafe","memoizeGetter","memoizeMethod","property","ESLScreenDPR","toDPI","dpr","toFixed","VALUE_REGEXP","parseFloat","ignoreBotsDpr","shortcuts","includes","_shortcuts","ESLEnvShortcuts","_matches","cb","optimize","eq","ALL","MediaQueryConstCondition","NOT_ALL","query","inverted","_inverted","_mq","media","items","_onChildChange","item","Observable","optimizedItems","some","MediaQueryConjunction","MediaQueryContainer","MediaQueryDisjunction","pretty","ESLMediaQuery","use","preprocessor","_preprocessors","unshift","for","conjunctions","conditions","parseSimpleQuery","preprocess","SHORTCUT_PATTERN","queryInverted","processedQuery","sanitizedQuery","invert","MediaQueryCondition","iObserver","payload","_query","_default","_payload","create","parser","payloadValue","ESLMediaRule","parse","lex","all","default","empty","rules","_rules","rule","_onMatchChanged","ESLMediaRuleList","parseTuple","values","mask","valueList","validRules","_active","activeRule","satisfiedRules","active","STRING_PARSER","OBJECT_PARSER","isRelativeNode","nodeA","nodeB","createSequenceFinder","next","base","sel","findNext","nextElementSibling","findPrev","previousElementSibling","findParent","parentElement","findAll","findChildren","children","findClosestBy","node","predicate","skipSelf","parentNode","isRelative","closestBy","TraversingQuery","ELEMENT_PROCESSORS","concat","COLLECTION_PROCESSORS","RegExp","isCollectionProcessor","processElement","selString","processCollection","traverseChain","collection","processors","findFirst","processor","rest","processedItem","resultCollection","slice","uniq","traverse","scope","PROCESSORS_REGEX","rootSel","shift","baseCollection","initial","acc","first","list","getIObserver","IntersectionObserver","entries","handleViewport","threshold","rootMargin","entry","image","ESLImage","isIntersecting","intersectionRatio","triggerLoad","STRATEGIES","img","shadowImg","src","isEmpty","isEmptyImage","backgroundImage","width","paddingTop","height","innerImg","attachInnerImage","removeInnerImage","devicePixelRatio","request","XMLHttpRequest","open","onreadystatechange","readyState","status","tmp","responseText","send","alt","updateA11y","srcRules","_onMediaMatchChange","lazyObservable","_detachLazyTrigger","unobserve","refresh","_srcRules","attributeChangedCallback","oldVal","newVal","connected","changeMode","lazyTriggered","_currentSrc","lazy","_shadowImageElement","mode","clearImage","loaded","syncImage","canUpdate","getPath","activeValue","ready","_shadowImg","refreshOnUpdate","complete","_shadowImgError","_onError","_onLoad","role","innerImage","srcBase","EMPTY_IMAGE","updateContainerClasses","strategy","_strategy","_innerImg","querySelector","innerImageClass","cloneNode","removeChild","setTimeout","Image","onload","onerror","substr","naturalHeight","_onReadyState","successful","containerClass","DEFAULT_CONTAINER_CLS","isLoadState","containerClassState","targetEl","containerClassTarget","ESLBaseElement","promisifyTimeout","timeout","isReject","Promise","resolve","reject","promisifyEvent","options","eventCallback","promisifyMarker","marker","then","tryUntil","tryCount","check","repeatSequence","count","createDeferred","promise","res","rej","resolvePromise","rejectPromise","debounce","wait","thisArg","deferred","debouncedSubject","clearTimeout","fromTimeout","fromEvent","fromMarker","repeat","ENTER","SPACE","PAUSE","ARROW_LEFT","ARROW_UP","ARROW_RIGHT","ARROW_DOWN","SYSTEM_KEYS","video","ESLMedia","autoplay","PlayerStates","evRegistryInstance","providersMap","ESLMediaProviderRegistry","provider","providerName","findByName","createFor","createByType","createBySrc","mediaType","_create","providers","reverse","cfg","parseUrl","mediaSrc","parseConfig","component","url","loop","muted","controls","preload","playsinline","mediaId","_ready","catch","log","unbind","focus","_el","onConfigChange","setSize","PAUSED","UNSTARTED","VIDEO_CUED","onSafeConfigChange","safeSeekTo","pos","seekTo","safePlay","safePause","safeStop","safeToggle","BaseProvider","instance","managerMap","registerPlay","group","unregister","deferredResize","_onResize","deferredReinitialize","reinitInstance","supports","bindEvents","attachViewportConstraint","unbindEvents","detachViewportConstraint","_provider","playInViewport","_onRegistryStateChange","conditionQuery","fillModeEnabled","_onRefresh","_onKeydown","canActivate","disabled","debug","updateContainerMarkers","loadClsTarget","loadClsAccepted","loadClsDeclined","allowActivate","cancel","focusPlayer","_onReady","updateReadyClass","detail","setReadyState","_onDetach","_onPlay","autofocus","MediaGroupRestrictionManager","_onPaused","_onEnded","actualAspectRatio","stretchVertically","offsetWidth","offsetHeight","fillMode","providerType","readyClassTarget","readyClass","UNINITIALIZED","duration","currentTime","time","loadCondition","aspectRatio","w","h","parseAspectRatio","defaultAspectRatio","observer","ns","eventNs","sequences","__esl_sequences__","sequentialUID","prefix","uid","randUID","Date","now","round","random","_fn","_timeout","run","put","task","delay","prev","jsonAttr","JSON","stringify","buildJsonAttrDescriptor","activators","_open","_task","DelayedTask","_trackHover","id","noAutoId","tag","initiallyOpened","setInitialState","initiator","showDelay","hideDelay","oldGroupName","newGroupName","initialParams","_onClick","_onKeyboardEvent","_onShowRequest","bindOutsideEventTracking","bindHoverStateTracking","track","body","_onOutsideAction","_trackHoverDelay","_onMouseEnter","_onMouseLeave","mergeDefaultParams","defaultParams","copy","show","hide","showTask","closeOnOutsideAction","trackHover","hideTask","silent","activator","onShow","onHide","activeClass","bodyClass","$a11yTarget","isOutsideAction","closeTrigger","closest","closeOnEsc","baseParams","trackHoverParams","ESLToggleable","_popups","getElementsByTagName","insertAdjacentElement","_onBeforeShow","_onShow","_onHide","_onChangeGroup","_root","isAcceptable","groupName","hideActive","getActive","dispatcher","setActive","popup","deleteActive","ESLToggleableDispatcher","onDocumentReady","prototypeConfig","rect","isEqual","rect1","rect2","grow","increment","shrink","decrement","isRtl","getComputedStyle","direction","scrollType","createTextNode","dir","position","fontSize","overflow","createDummyEl","scrollLeft","normalizeScrollLeft","RTLUtils","scrollWidth","getNodeName","element","Window","getParentNode","ShadowRoot","host","assignedSlot","getDocument","initiatorSet","getListScrollParents","scrollParent","getScrollParent","isBody","isScrollParent","updatedList","indexOf","overflowX","overflowY","isMajorAxisHorizontal","calcPopupPositionByMinorAxis","centerPosition","dimensionName","arrow","marginArrow","calcUsableSizeForArrow","offsetArrowRatio","adjustAlignmentBySide","elCoord","outerCoord","arrowCoord","arrowLimit","isStartingSide","arrowAdjust","newCoord","calcArrowPosition","hasVerticalScroll","scrollHeight","clientHeight","hasScroll","ScrollUtils","requestLock","requestUnlock","$placeholder","$origin","copyAttributesFromOrigin","allowedAttrs","ESLToggleablePlaceholder","ESLPopupPlaceholder","scrollOptions","passive","_deferredUpdatePosition","_updatePosition","_intersectionRatio","container","_containerEl","wnd","$container","Rect","pageXOffset","pageYOffset","innerWidth","containerRect","$arrow","moveToBody","ratio","rawValue","parsePercent","offsetArrow","replaceChild","behavior","disableActivatorObservation","containerEl","_offsetTrigger","offsetTrigger","_offsetContainer","offsetContainer","visibility","afterOnShow","beforeOnHide","_stopUpdateLoop","_removeActivatorObserver","_addActivatorObserver","_startUpdateLoop","_checkIntersectionForAdjacentAxis","isAdjacentAxis","onActivatorIntersection","intersectionRect","boundingClientRect","_isMajorAxisHorizontal","bottom","_isMajorAxisVertical","right","onActivatorScroll","_updateLoopID","scrollParents","_activatorObserver","unsubscribers","$root","disconnect","same","lastRect","updateLoop","newRect","cancelAnimationFrame","triggerRect","popupRect","arrowRect","trigger","innerMargin","inner","cx","cy","calcPopupBasicRect","placedAt","isMirrored","outer","fitOnMajorAxis","isHorizontal","dimension","coordAdjust","fitOnMinorAxis","calcPopupPosition","_offsetArrowRatio","ESLPopup","_initialHeight","ESLPanelGroup","_onTransitionEnd","beforeAnimate","noCollapse","afterAnimate","onAnimate","animateClass","postAnimateClass","to","fallbackAnimate","distance","maxHeight","abs","animating","clearAnimation","removeProperty","propertyName","stackConfig","$group","panelConfig","ESLPanel","_previousHeight","modeRules","_onModeChange","updateMode","accordionGroup","reset","_onBeforeHide","prevMode","currentMode","updateModeCls","modeCls","$target","modeClsTarget","supportedModes","includesPanel","$panels","noCollapseModes","shouldCollapse","mergeActionParams","showAll","excluded","hideAll","$activePanels","toggleAllBy","shouldOpen","panel","registered","transformParams","find","animationClass","initialHeight","updateTargetFromSelector","_$target","newPopupInstance","_onTargetStateChange","a11yTarget","trackClick","initA11y","isTargetIgnored","ignore","$ignore","mergeToggleableParams","showTarget","actionParams","hideTarget","toggleTarget","updateState","isActive","wasActive","clsTarget","activeClassTarget","originalEvent","allowClick","allowHover","hoverShowDelay","hoverHideDelay","ESLTrigger","ESLTab","$targets","goTo","preventScroll","activateSelected","click","triggers","$active","activeElement","ESLA11yGroup","_deferredUpdateArrows","updateArrows","_deferredFitToViewport","fitToViewport","$current","ESLTabs","scrollable","scrollableTypeRules","_onScrollableTypeChange","updateScrollableType","unbindScrollableEvents","bindScrollableEvents","_onTriggerStateChange","_onFocus","$scrollableTarget","_onScroll","$tabs","scrollableTarget","currentScrollableType","moveTo","scrollBy","$trigger","updateMarkers","areaRect","itemRect","calcScrollOffset","isReversedRTL","ceil","swapSides","scrollStart","scrollEnd","$rightArrow","$leftArrow","isScrollable","supportedScrollableTypes","tabDirection","_deferredDrag","_onPointerDrag","_deferredRefresh","_scrollTimer","_resizeObserver","ResizeObserver","_mutationObserver","MutationObserver","rec","updateContentObserve","findTarget","content","unbindTargetEvents","bindTargetEvents","$scrollbarTrack","trackClass","$scrollbarThumb","thumbClass","_onPointerDown","childList","recs","contentChanges","addedNodes","removedNodes","horizontal","areaSize","scrollSize","scrollOffset","scrollTop","scrollableSize","scrollTargetTo","normalizePosition","relativePosition","scrollTo","dragging","thumbSize","trackOffset","thumbPosition","toPosition","thumbOffset","point","_initialPosition","_pointerPosition","_initialMousePosition","_onThumbPointerDown","_onPointerDownTick","_onPointerUp","allowedOffset","noContinuousScroll","_onBodyClick","capture","_onPointerMove","positionChange","scrollableAreaHeight","absChange","stopImmediatePropagation","ESLScrollbar","ESLAlert","alert","defaultConfig","iframe","$content","_onTargetEvent","_clearTimeout","html","text","hideTime","activeCls","ESLSelectItem","tabIndex","selected","option","original","build","_onTargetMutation","_$select","select","_onTargetChange","_onReset","_onChange","_onListChange","newTarget","oldTarget","observationConfig","changes","change","form","$select","multiple","getOption","setSelected","isSelected","opt","hasSelected","isAllSelected","setAllSelected","selectedOptions","required","validity","validationMessage","willValidate","checkValidity","reportValidity","setCustomValidity","subtree","attributes","attributeFilter","characterData","$list","$scroll","$selectAll","_updateDisabled","bindSelect","HTMLSelectElement","_renderItems","$items","pinSelected","_renderGroup","last","_updateSelectAll","selectAllLabel","ESLSelectList","ESLSelectWrapper","_deferredRerender","$remove","$text","$rest","ESLSelect","ESLSelectRenderer","owner","_onClear","hasValue","applyItems","limit","moreLabelFormat","updatePosition","_disposeTimeout","$owner","focusable","_onTabKey","shiftKey","windowY","$renderer","$dropdown","ESLSelectDropdown","_prepare","_onUpdate","_dispose","valueChanged","_onPopupStateChange","emptyText","placeholder","hasValueClass","focusEl","hasFocus","hasFocusClass","convertNotesToFootnotesList","notes","renderedIndex","_notes","deferredOnUpdate","ESLFootnotes","scopeTarget","note","allowFootnotes","reindex","grouping","groupedList","compileFootnotesGroupedList","_notifyNotes","unlink","scopeEl","_onNoteSubscribe","linkNote","link","_sortNotes","unlinkNote","sort","note1","note2","DOCUMENT_POSITION_PRECEDING","buildItems","footnotesList","footnote","buildItem","buildItemIndex","buildItemText","buildItemBack","backToNoteLabel","orderAttr","order","_onBackToNote","highlight","activate","turnOffHighlight","focusableElements","sharedInstance","disableArrow","_appendArrow","_createArrow","innerText","extraClass","_updateActivatorState","firstFocusableElement","lastFocusableElement","newState","ESLTooltip","queryToIgnore","_index","standaloneLabel","getClosestRelatedAttr","_sendResponseToFootnote","_$footnotes","restore","updateQueryToIgnore","_onBPChange","_onFootnotesReady","relatedAttrName","$closest","hideTooltip","activateTimeout","block","scrollIntoView","lastTop","lastLeft","showTooltip","enable","footnotes","linked","standalone","toggleTooltip","tooltipShown","ESLNote","_io","onIntersect","OPTIONS_OBSERVER","_entries","_configMap","deferredOnAnimate","ESLAnimateService","isObserved","getConfigFor","setConfigFor","groupDelay","onAnimateItem","_unsubscribe","DEFAULT_CONFIG","reanimate","ESLAnimate","_state","protocol","URL","buildIframe","PLAYING","contentWindow","IframeBasicProvider","urlPattern","applyElementSettings","HTMLMediaProvider","bindListeners","ended","ENDED","played","paused","AudioProvider","loadScript","script","getElementById","async","createAsyncScript","Event","firstScriptTag","insertBefore","videoWidth","videoHeight","VideoProvider","YouTubeProvider","providerRegexp","idRegexp","getCoreApi","_coreApiPromise","YT","Player","cbOrigin","onYouTubeIframeAPIReady","err","mapOptions","enablejsapi","origin","location","rel","showinfo","iv_load_policy","Number","disablekb","autohide","sm","onCoreApiReady","onPlayerReady","_api","videoId","events","onError","onReady","onStateChange","_onStateChange","playerVars","getIframe","mute","playVideo","unMute","HTMLIFrameElement","getPlayerState","getDuration","getCurrentTime","pauseVideo","stopVideo","API_SCRIPT_ID","deepCompare","obj1","obj2","keys1","keys2","videojsClasses","getAccount","playerId","accountId","loadAPI","account","apiSrc","apiScript","buildVideo","_account","$$fromEvent","one","onAPILoaded","bc","videojs","onAPIReady","_autoplay","on","Provider","dispose","BrightcoveProvider","_setActive","_setFirst","carousel","eslRegistryInstance","ESLCarouselViewRegistry","createViewInstance","View","registerView","view","_currentConfig","_plugins","_onMatchChange","_onRegistryChange","ESLCarousel","$slidesArea","ESLCarouselSlide","$slides","activeIndexes","activeConfig","findIndex","slide","nextIndex","isAnimated","firstIndex","eventDetails","approved","_view","activeCount","computedIndex","_bindEvents","_unbindEvents","configRules","_configRules","viewType","draw","getNextGroup","shiftGroupsCount","lastIndex","currentGroup","countGroups","markedTarget","slideTarget","lastGroup","addPlugin","plugin","removePlugin","_addPlugin","isConnected","_removePlugin","Slide","slideStyles","slidesAreaStyles","slideWidth","marginLeft","marginRight","computedLeft","activeSlide","nextSlide","_cleanAnimation","ESLCarouselView","ESLSingleCarouselView","currentTrans","transform","slideIndex","areaWidth","transitionDuration","currentLeft","shiftCount","trans","nextActiveIndexes","intersectionIndexes","animatedCount","minActive","orderIndex","sIndex","ESLMultiCarouselView","findCarouselOwner","freePlacement","nodeName","_carousel","rerender","activeDot","buildDot","ESLCarouselDotsPlugin","ESLCarouselPlugin","_onSlideChange","$source","_target","ESLCarouselLinkPlugin","isTouchStarted","startPoint","onTouchStart","touches","PointerEvent","pointerType","onTouchMove","onTouchEnd","offset","ESLCarouselTouchPlugin","ESLCarouselPlugins","Dots","Link","Autoplay","_onInterval","_onInteract","ESLCarouselAutoplayPlugin","onChange","inputs","input","HTMLInputElement","checked","TestMediaSource","submenus","activeMenuAttr","onBreakpointChange","storeState","localStorage","removeItem","setItem","isDesktop","isStoredOpen","getItem","immediate","collapseAll","$submenus","menu","expandActive","_animation","onGSSReady","__gcse","parsetags","initializationCallback","requestGss","postCls","showSearchElements","firstFocusable","postClsDelay","loadingAnimationEL","_$active","_animateTimer","startAnimation","stopAnimation","STARS_SEL","$stars","_onIteration","iterationTime","$candidates","targetsNumber","$randomStar","star","afterSearchScriptLoad","ESLVSizeCSSProxy","ESLDemoSidebar","ESLDemoMarquee","ESLDemoSearchBox","ESLDemoSearchPageWrapper"],"sourceRoot":""}