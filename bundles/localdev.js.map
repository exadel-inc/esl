{"version":3,"file":"localdev.js","mappings":"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","sources":["webpack:///./src/anchor/anchor-link.ts","webpack:///./src/back-link/back-link.ts","webpack:///./src/banner/banner.ts","webpack:///./src/common/breakpoints.ts","webpack:///./src/esl-media-demo/test-media-source.ts","webpack:///./src/esl-media-demo/test-media.ts","webpack:///./src/landing/marquee/marquee.ts","webpack:///./src/navigation/header/header-search.ts","webpack:///./src/navigation/sidebar/sidebar.ts","webpack:///./src/search/search-script.ts","webpack:///./src/search/search.ts","webpack:///../src/modules/esl-a11y-group/core/esl-a11y-group.ts","webpack:///../src/modules/esl-alert/core/esl-alert.ts","webpack:///../src/modules/esl-animate/core/esl-animate-mixin.ts","webpack:///../src/modules/esl-animate/core/esl-animate-service.ts","webpack:///../src/modules/esl-animate/core/esl-animate.ts","webpack:///../src/modules/esl-base-element/core/esl-base-element.ts","webpack:///../src/modules/esl-carousel/core/esl-carousel.events.ts","webpack:///../src/modules/esl-carousel/core/esl-carousel.renderer.ts","webpack:///../src/modules/esl-carousel/core/esl-carousel.slide.ts","webpack:///../src/modules/esl-carousel/core/esl-carousel.ts","webpack:///../src/modules/esl-carousel/core/nav/esl-carousel.nav.utils.ts","webpack:///../src/modules/esl-carousel/plugin/autoplay/esl-carousel.autoplay.mixin.ts","webpack:///../src/modules/esl-carousel/plugin/esl-carousel.plugin.ts","webpack:///../src/modules/esl-carousel/plugin/keyboard/esl-carousel.keyboard.mixin.ts","webpack:///../src/modules/esl-carousel/plugin/nav/esl-carousel.nav.dots.ts","webpack:///../src/modules/esl-carousel/plugin/nav/esl-carousel.nav.mixin.ts","webpack:///../src/modules/esl-carousel/plugin/relation/esl-carousel.relation.mixin.ts","webpack:///../src/modules/esl-carousel/plugin/touch/esl-carousel.touch.mixin.ts","webpack:///../src/modules/esl-carousel/renderers/multi/esl-multi-carousel.ts","webpack:///../src/modules/esl-event-listener/core/api.ts","webpack:///../src/modules/esl-event-listener/core/descriptors.ts","webpack:///../src/modules/esl-event-listener/core/listener.ts","webpack:///../src/modules/esl-event-listener/core/targets/resize.adapter.event.ts","webpack:///../src/modules/esl-event-listener/core/targets/resize.adapter.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes-data.ts","webpack:///../src/modules/esl-footnotes/core/esl-footnotes.ts","webpack:///../src/modules/esl-footnotes/core/esl-note-ignore.ts","webpack:///../src/modules/esl-footnotes/core/esl-note.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-item.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-list.ts","webpack:///../src/modules/esl-forms/esl-select-list/core/esl-select-wrapper.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-dropdown.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select-renderer.ts","webpack:///../src/modules/esl-forms/esl-select/core/esl-select.ts","webpack:///../src/modules/esl-image/core/esl-image-iobserver.ts","webpack:///../src/modules/esl-image/core/esl-image-strategies.ts","webpack:///../src/modules/esl-image/core/esl-image.ts","webpack:///../src/modules/esl-media-query/core/common/env-shortcuts.ts","webpack:///../src/modules/esl-media-query/core/common/screen-breakpoint.ts","webpack:///../src/modules/esl-media-query/core/common/screen-dpr.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-base.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-condition.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-const.ts","webpack:///../src/modules/esl-media-query/core/conditions/media-query-containers.ts","webpack:///../src/modules/esl-media-query/core/esl-media-query.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule-list.ts","webpack:///../src/modules/esl-media-query/core/esl-media-rule.ts","webpack:///../src/modules/esl-media/core/esl-media-iobserver.ts","webpack:///../src/modules/esl-media/core/esl-media-manager.ts","webpack:///../src/modules/esl-media/core/esl-media-provider.ts","webpack:///../src/modules/esl-media/core/esl-media-registry.ts","webpack:///../src/modules/esl-media/core/esl-media.ts","webpack:///../src/modules/esl-media/providers/brightcove-provider.ts","webpack:///../src/modules/esl-media/providers/html5/audio-provider.ts","webpack:///../src/modules/esl-media/providers/html5/media-provider.ts","webpack:///../src/modules/esl-media/providers/html5/video-provider.ts","webpack:///../src/modules/esl-media/providers/iframe-provider.ts","webpack:///../src/modules/esl-media/providers/youtube-provider.ts","webpack:///../src/modules/esl-mixin-element/ui/esl-mixin-attr.ts","webpack:///../src/modules/esl-mixin-element/ui/esl-mixin-element.ts","webpack:///../src/modules/esl-mixin-element/ui/esl-mixin-registry.ts","webpack:///../src/modules/esl-panel-group/core/esl-panel-group.ts","webpack:///../src/modules/esl-panel/core/esl-panel.ts","webpack:///../src/modules/esl-popup/core/esl-popup-placeholder.ts","webpack:///../src/modules/esl-popup/core/esl-popup-position.ts","webpack:///../src/modules/esl-popup/core/esl-popup.ts","webpack:///../src/modules/esl-related-target/core/esl-related-target.ts","webpack:///../src/modules/esl-scrollbar/core/esl-scrollbar.ts","webpack:///../src/modules/esl-share/actions/copy-action.ts","webpack:///../src/modules/esl-share/actions/external-action.ts","webpack:///../src/modules/esl-share/actions/media-action.ts","webpack:///../src/modules/esl-share/actions/native-action.ts","webpack:///../src/modules/esl-share/actions/print-action.ts","webpack:///../src/modules/esl-share/actions/url-generic-action.ts","webpack:///../src/modules/esl-share/core/esl-share-action-registry.ts","webpack:///../src/modules/esl-share/core/esl-share-action.ts","webpack:///../src/modules/esl-share/core/esl-share-button.ts","webpack:///../src/modules/esl-share/core/esl-share-config.ts","webpack:///../src/modules/esl-share/core/esl-share-trigger.ts","webpack:///../src/modules/esl-share/core/esl-share.ts","webpack:///../src/modules/esl-tab/core/esl-tab.ts","webpack:///../src/modules/esl-tab/core/esl-tabs.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-dispatcher.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable-placeholder.ts","webpack:///../src/modules/esl-toggleable/core/esl-toggleable.ts","webpack:///../src/modules/esl-tooltip/core/esl-tooltip.ts","webpack:///../src/modules/esl-traversing-query/core/esl-traversing-query.ts","webpack:///../src/modules/esl-trigger/core/esl-trigger.ts","webpack:///../src/modules/esl-utils/abstract/dom-target.ts","webpack:///../src/modules/esl-utils/abstract/observable.ts","webpack:///../src/modules/esl-utils/async/debounce.ts","webpack:///../src/modules/esl-utils/async/delayed-task.ts","webpack:///../src/modules/esl-utils/async/microtask.ts","webpack:///../src/modules/esl-utils/async/promise.ts","webpack:///../src/modules/esl-utils/async/promise/animation.ts","webpack:///../src/modules/esl-utils/async/promise/defered.ts","webpack:///../src/modules/esl-utils/async/promise/event.ts","webpack:///../src/modules/esl-utils/async/promise/timeout.ts","webpack:///../src/modules/esl-utils/async/promise/try-until.ts","webpack:///../src/modules/esl-utils/async/raf.ts","webpack:///../src/modules/esl-utils/decorators/attr.ts","webpack:///../src/modules/esl-utils/decorators/bind.ts","webpack:///../src/modules/esl-utils/decorators/bool-attr.ts","webpack:///../src/modules/esl-utils/decorators/decorate.ts","webpack:///../src/modules/esl-utils/decorators/json-attr.ts","webpack:///../src/modules/esl-utils/decorators/listen.ts","webpack:///../src/modules/esl-utils/decorators/memoize.ts","webpack:///../src/modules/esl-utils/decorators/prop.ts","webpack:///../src/modules/esl-utils/decorators/ready.ts","webpack:///../src/modules/esl-utils/dom/api.ts","webpack:///../src/modules/esl-utils/dom/attr.ts","webpack:///../src/modules/esl-utils/dom/class.ts","webpack:///../src/modules/esl-utils/dom/events/misc.ts","webpack:///../src/modules/esl-utils/dom/events/target.ts","webpack:///../src/modules/esl-utils/dom/focus.ts","webpack:///../src/modules/esl-utils/dom/keys.ts","webpack:///../src/modules/esl-utils/dom/ready.ts","webpack:///../src/modules/esl-utils/dom/rect.ts","webpack:///../src/modules/esl-utils/dom/rtl.ts","webpack:///../src/modules/esl-utils/dom/sanitize.ts","webpack:///../src/modules/esl-utils/dom/script.ts","webpack:///../src/modules/esl-utils/dom/scroll/parent.ts","webpack:///../src/modules/esl-utils/dom/scroll/scroll-into-view.ts","webpack:///../src/modules/esl-utils/dom/traversing.ts","webpack:///../src/modules/esl-utils/dom/visible.ts","webpack:///../src/modules/esl-utils/dom/window.ts","webpack:///../src/modules/esl-utils/environment/device-detector.ts","webpack:///../src/modules/esl-utils/environment/export-ns.ts","webpack:///../src/modules/esl-utils/fixes/ie-fixes.ts","webpack:///../src/modules/esl-utils/fixes/viewport.ts","webpack:///../src/modules/esl-utils/misc/array.ts","webpack:///../src/modules/esl-utils/misc/format.ts","webpack:///../src/modules/esl-utils/misc/functions.ts","webpack:///../src/modules/esl-utils/misc/memoize.ts","webpack:///../src/modules/esl-utils/misc/object/compare.ts","webpack:///../src/modules/esl-utils/misc/object/copy.ts","webpack:///../src/modules/esl-utils/misc/object/merge.ts","webpack:///../src/modules/esl-utils/misc/object/path.ts","webpack:///../src/modules/esl-utils/misc/object/types.ts","webpack:///../src/modules/esl-utils/misc/object/utils.ts","webpack:///../src/modules/esl-utils/misc/uid.ts","webpack:///../src/modules/esl-utils/misc/url.ts","webpack:///../src/modules/lib.ts","webpack:///../src/polyfills/es5-target-shim.ts","webpack:///../src/polyfills/list/dom.element.toggleAttribute.ts","webpack:///../src/polyfills/list/dom.keyboard.key.ts","webpack:///../src/polyfills/list/dom.node.isConnected.ts","webpack:///../src/polyfills/polyfills.validate.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///./src/localdev.ts"],"sourcesContent":["import {ESLMixinElement} from '../../../src/modules/esl-mixin-element/ui/esl-mixin-element';\nimport {listen, memoize} from '../../../src/modules/esl-utils/decorators';\nimport {afterNextRender} from '../../../src/modules/esl-utils/async/raf';\nimport {ESLEventUtils} from '../../../src/modules/esl-utils/dom/events';\n\n/**\n * Demo sample of anchor mixin\n */\nexport class ESLDemoAnchorLink extends ESLMixinElement {\n  static override is = 'esl-d-anchor';\n\n  @memoize()\n  public get anchorHref(): string | null {\n    if (this.$host instanceof HTMLAnchorElement) {\n      const url = new URL(this.$host.href);\n      return url.hash ? url.hash.substring(1) : null;\n    }\n    return null;\n  }\n  @memoize()\n  public get anchorTarget(): Element | null {\n    return this.anchorHref ? document.getElementById(this.anchorHref) : null;\n  }\n\n  public moveToTarget(): void {\n    const $target = this.anchorTarget;\n    if (!$target) return console.warn('No anchor target found');\n\n    ESLEventUtils.dispatch($target, 'esl:show:request');\n    afterNextRender(() => {\n      // TODO: replace with scroll ext version\n      // scrollIntoView($target, {behavior: 'smooth'})\n      //   .then(() => console.log('Scroll to successful: ', $target));\n      $target.scrollIntoView({behavior: 'smooth'});\n    });\n  }\n\n  @listen('click')\n  protected onClick(e: PointerEvent): void {\n    e.preventDefault();\n    if (this.anchorHref) {\n      history.pushState(null, '', '#' + this.anchorHref);\n    }\n    this.moveToTarget();\n  }\n}\n","import {ESLMixinElement} from '../../../src/modules/esl-mixin-element/core';\n\nexport class ESLDemoBackLink extends ESLMixinElement {\n  static override is = 'esl-d-back-link';\n\n  public override connectedCallback(): void {\n    super.connectedCallback();\n    if (!document.referrer) return;\n    const refUrl = new URL(document.referrer);\n    if (refUrl.host !== window.location.host) return;\n    this.$$attr('href', document.referrer);\n    this.$$attr(ESLDemoBackLink.is, false);\n  }\n}\n","import {ESLToggleable} from '../../../src/modules/esl-toggleable/core/esl-toggleable';\nimport {attr, memoize, prop} from '../../../src/modules/esl-utils/decorators';\n\nimport type {ESLToggleableActionParams} from '../../../src/modules/esl-toggleable/core/esl-toggleable';\n\nexport class ESLDemoBanner extends ESLToggleable {\n  public static override is = 'esl-d-banner';\n\n  @attr({parser: (str) => str && encodeURIComponent(str).trim()})\n  public cookieName: string;\n  @attr({defaultValue: 14, parser: parseInt})\n  public cookieTime: number;\n\n  @prop({initiator: 'initial', showDelay: 8000})\n  public override initialParams: ESLToggleableActionParams;\n\n  @prop(true) public override closeOnEsc: boolean;\n\n  protected _$focusBefore: HTMLElement | null = null;\n\n  /** Check if the coolie {@link cookieName} is active */\n  public get hasCookie(): boolean {\n    const {cookieName} = this;\n    return !!cookieName && document.cookie.indexOf(`${cookieName}=true`) !== -1;\n  }\n\n  @memoize()\n  public get $focusable(): HTMLElement | undefined {\n    return this.querySelector('.banner') as HTMLElement | undefined;\n  }\n\n  /** Store cookie {@link cookieName} for {@link cookieTime} period */\n  public registerCookie(expireDays: number = this.cookieTime): void {\n    const {cookieName} = this;\n    if (cookieName) {\n      const expires = new Date(Date.now() + expireDays * 864e5).toUTCString();\n      document.cookie = `${cookieName}=true; expires=${expires};`;\n    }\n  }\n\n  protected override setInitialState(): void {\n    this.toggle(!this.hasCookie, this.initialParams);\n  }\n\n  protected override onShow(params: ESLToggleableActionParams): void {\n    super.onShow(params);\n    this._$focusBefore = document.activeElement as HTMLElement;\n    this.$focusable && this.$focusable.focus();\n    if (params.initiator !== 'initial') this.registerCookie(-1);\n  }\n  protected override onHide(params: ESLToggleableActionParams): void {\n    super.onHide(params);\n    this._$focusBefore && this._$focusBefore.focus();\n    if (params.initiator !== 'initial') this.registerCookie();\n  }\n}\n","// Config\nimport {ESLScreenBreakpoints} from '../../../src/modules/esl-media-query/core/common/screen-breakpoint';\n\nESLScreenBreakpoints.add('xs', 1, 599);\nESLScreenBreakpoints.add('sm', 600, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n","import {attr, listen, decorate} from '../../../src/modules/esl-utils/decorators';\nimport {debounce} from '../../../src/modules/esl-utils/async/debounce';\nimport {ESLBaseElement} from '../../../src/modules/esl-base-element/core/esl-base-element';\nimport {ESLTraversingQuery} from '../../../src/modules/esl-traversing-query/core/esl-traversing-query';\n\nclass ESLDemoMediaSource extends ESLBaseElement {\n  static override is = 'esl-d-media-source';\n\n  @attr() public target: string;\n\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n    this.onChange();\n  }\n\n  protected render(): void {\n    const form = document.createElement('form');\n    form.innerHTML = `\n      <fieldset>\n        <legend>Video Settings:</legend>\n          <div class=\"input-group mb-2\">\n          <select class=\"form-control\" name=\"media-type\">\n            <option value=\"auto\">- Auto -</option>\n            <option value=\"audio\">HTML Audio</option>\n            <option value=\"video\">HTML Video</option>\n            <option value=\"youtube\">Youtube</option>\n            <option value=\"brightcove\">Brightcove</option>\n            <option value=\"iframe\">Iframe</option>\n          </select>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media src\" name=\"media-src\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Media id\" name=\"media-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player id\" name=\"player-id\" autocomplete=\"on\"/>\n        </div>\n        <div class=\"input-group mb-2\">\n          <input type=\"text\" class=\"form-control\" placeholder=\"Player account\" name=\"player-account\" autocomplete=\"on\"/>\n        </div>\n\n        <div class=\"form-group\">\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"muted\" class=\"form-check-input\"/> Muted</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"autoplay\" class=\"form-check-input\"/> Autoplay</label>\n          </div>\n          <div class=\"form-check form-check-inline\">\n            <label class=\"form-check-label\"><input type=\"checkbox\" name=\"disabled\" class=\"form-check-input\"/> Disabled</label>\n          </div>\n        </div>\n      </fieldset>\n    `;\n    form.action = 'javascript: void 0;';\n\n    this.innerHTML = '';\n    this.appendChild(form);\n  }\n\n  @listen('change')\n  @decorate(debounce, 750)\n  protected onChange(): void {\n    const inputs = this.querySelectorAll('input[name], select[name]');\n    Array.from(inputs).forEach((input: HTMLInputElement | HTMLSelectElement) => {\n      this.$targets.forEach((target: HTMLElement) => {\n        if (input instanceof HTMLInputElement && input.type === 'checkbox') {\n          target.toggleAttribute(input.name, input.checked);\n        } else {\n          target.setAttribute(input.name, input.value);\n        }\n      });\n    });\n  }\n}\n\nESLDemoMediaSource.register();\n","import {ESLTraversingQuery} from '../../../src/modules/esl-traversing-query/core';\nimport {ESLBaseElement} from '../../../src/modules/esl-base-element/core';\nimport {attr, listen} from '../../../src/modules/esl-utils/decorators';\n\ninterface MediaTarget {\n  play(): any;\n  pause(): any;\n  stop(): any;\n}\n\ninterface TestMediaAction {\n  title: string;\n  action: (target: MediaTarget, actionName: string, action: TestMediaAction) => void;\n  render: (actionName: string, action: TestMediaAction) => HTMLElement;\n}\n\nclass ESLDemoMediaControls extends ESLBaseElement {\n  public static override is = 'esl-d-media-controls';\n\n  public static ACTIONS: Record<string, TestMediaAction> = {\n    play: {\n      title: 'Play',\n      action: (target: any) => target.play(),\n      render: renderButton\n    },\n    pause: {\n      title: 'Pause',\n      action: (target: any) => target.pause(),\n      render: renderButton\n    },\n    stop: {\n      title: 'Stop',\n      action: (target: any) => target.stop(),\n      render: renderButton\n    }\n  };\n  public static ACTIONS_ALL = Object.keys(ESLDemoMediaControls.ACTIONS).join(',');\n\n  @attr() public target: string;\n  @attr({defaultValue: ESLDemoMediaControls.ACTIONS_ALL}) public actions: string;\n\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n  }\n\n  private render(): void {\n    const actionList = this.actions.split(',');\n\n    this.innerHTML = '';\n    for (const actionName of actionList) {\n      const action: TestMediaAction = ESLDemoMediaControls.ACTIONS[actionName];\n      if (!action) return;\n      this.appendChild(action.render(actionName, action));\n    }\n  }\n\n  @listen('click')\n  private onClick(e: MouseEvent): void {\n    const target = e.target as HTMLElement;\n    const actionName = target.dataset.action;\n    if (actionName && ESLDemoMediaControls.ACTIONS[actionName]) {\n      const actionDesc = ESLDemoMediaControls.ACTIONS[actionName];\n      const actionFn = actionDesc.action;\n      this.$targets.forEach(($el) => actionFn.call($el, $el, actionName, actionDesc));\n    }\n  }\n}\n\nfunction renderButton(actionName: string, action: TestMediaAction): HTMLButtonElement {\n  const btn = document.createElement('button');\n  btn.className = 'btn btn-sec-blue';\n  btn.dataset.action = actionName;\n  btn.textContent = action.title;\n  return btn;\n}\n\nESLDemoMediaControls.register();\n","import {ESLBaseElement} from '../../../../src/modules/esl-base-element/core';\nimport {bind, ready, memoize, attr} from '../../../../src/modules/esl-utils/decorators';\nimport {range} from '../../../../src/modules/esl-utils/misc/array';\nimport {isIE} from '../../../../src/modules/esl-utils/environment/device-detector';\n\nexport class ESLDemoMarquee extends ESLBaseElement {\n  static override is = 'esl-d-marquee';\n  static STARS_SEL = 'use';\n\n  @attr({defaultValue: '4'}) public targetsNumber: string;\n  @attr({defaultValue: '3000'}) public iterationTime: string;\n\n  private _$active: HTMLElement[] = [];\n  private _animateTimer: number = 0;\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    if (isIE) return;\n    this.startAnimation();\n  }\n  protected override disconnectedCallback(): void {\n    this.stopAnimation();\n    super.disconnectedCallback();\n  }\n\n  @memoize()\n  public get $stars(): HTMLElement[] {\n    return Array.from(document.querySelectorAll((this.constructor as typeof ESLDemoMarquee).STARS_SEL));\n  }\n  public get $randomStar(): HTMLElement {\n    const index = Math.floor(Math.random() * this.$stars.length);\n    return this.$stars[index];\n  }\n\n  public startAnimation(): void {\n    memoize.clear(this, '$stars');\n    this.stopAnimation();\n    if (this.$stars.length < 2) return;\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n  public stopAnimation(): void {\n    this._animateTimer && window.clearTimeout(this._animateTimer);\n  }\n\n  @bind\n  protected _onIteration(): void {\n    const $candidates = range(+this.targetsNumber, () => this.$randomStar);\n    this._$active.forEach((star) => star.classList.remove('animate'));\n    $candidates.forEach((star) => star.classList.add('animate'));\n    this._$active = $candidates;\n\n    this._animateTimer = window.setTimeout(this._onIteration, +this.iterationTime);\n  }\n}\n","import {prop, attr, boolAttr, listen} from '../../../../src/modules/esl-utils/decorators';\nimport {CSSClassUtils} from '../../../../src/modules/esl-utils/dom/class';\nimport {afterNextRender} from '../../../../src/modules/esl-utils/async/raf';\nimport {parseNumber} from '../../../../src/modules/esl-utils/misc/format';\nimport {ESLTraversingQuery} from '../../../../src/modules/esl-traversing-query/core';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core';\nimport {requestGss} from '../../search/search-script';\n\nimport type {ESLToggleableActionParams} from '../../../../src/modules/esl-toggleable/core';\n\nexport class ESLDemoSearchBox extends ESLToggleable {\n  static override is = 'esl-d-search-box';\n\n  @attr() public postCls: string;\n  @attr() public postClsDelay: string;\n  @attr({defaultValue: '::find(input)'}) public firstFocusable: string;\n\n  @boolAttr() public override autofocus: boolean;\n\n  @prop() public override closeOnOutsideAction = true;\n\n  public override onShow(params: ESLToggleableActionParams): void {\n    CSSClassUtils.add(this, this.postCls);\n    requestGss().then(() => this.showSearchElements(params));\n  }\n\n  private showSearchElements(params: ESLToggleableActionParams): void {\n    afterNextRender(() => super.onShow(params));\n    if (this.autofocus) {\n      const $focusEl = ESLTraversingQuery.first(this.firstFocusable, this) as HTMLElement;\n      $focusEl && window.setTimeout(() => $focusEl.focus(), parseNumber(this.postClsDelay));\n    }\n\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n\n  public override onHide(params: ESLToggleableActionParams): void {\n    super.onHide(params);\n    window.setTimeout(() => {\n      CSSClassUtils.remove(this, this.postCls);\n      this.activator?.focus({preventScroll: true});\n    }, parseNumber(this.postClsDelay));\n  }\n\n  @listen({\n    event: 'focusout',\n    target: '::parent(.header-search)'\n  })\n  protected onFocusOut(e: FocusEvent): void {\n    if (!e.relatedTarget || !e.currentTarget || (e.currentTarget as Node).contains(e.relatedTarget as Node)) return;\n    this.hide({hideDelay: 100});\n    this.activator = e.relatedTarget as HTMLElement;\n  }\n}\n","import {boolAttr, listen, prop, ready} from '../../../../src/modules/esl-utils/decorators';\nimport {ESLToggleable} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\nimport {ESLMediaQuery} from '../../../../src/modules/esl-media-query/core/esl-media-query';\n\nimport type {ESLToggleableActionParams} from '../../../../src/modules/esl-toggleable/core/esl-toggleable';\n\ninterface SidebarActionParams extends ESLToggleableActionParams {\n  /** Change state without animation */\n  immediate: boolean;\n}\n\nexport class ESLDemoSidebar extends ESLToggleable {\n  static override is = 'esl-d-sidebar';\n\n  @prop() public override closeOnEsc = true;\n  @prop() public override closeOnOutsideAction = true;\n\n  @prop() public submenus: string = '.sidebar-nav-secondary';\n  @prop() public activeMenuAttr: string = 'data-open';\n\n  @boolAttr({name: 'animation'}) protected _animation: boolean;\n\n  public get $submenus(): ESLToggleable[] {\n    return Array.from(this.querySelectorAll(this.submenus));\n  }\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n  }\n\n  protected storeState(): void {\n    this.open ? localStorage.removeItem('sidebar-collapsed') : localStorage.setItem('sidebar-collapsed', 'true');\n  }\n\n  protected override setInitialState(): void {\n    const isDesktop = ESLMediaQuery.for('@+MD').matches;\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'init', immediate: true});\n  }\n\n  public collapseAll(): void {\n    this.$submenus.forEach((menu) => menu.hide({activator: this}));\n  }\n\n  public expandActive(noAnimate: boolean = false): void {\n    this.$submenus\n      .filter((menu) => menu.hasAttribute('data-open'))\n      .forEach((menu) => menu.show({noAnimate, activator: this}));\n  }\n\n  protected override updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-expanded', String(this.open));\n  }\n\n  protected override onShow(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onShow(params);\n    this.expandActive(params.initiator === 'init');\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n  protected override onHide(params: SidebarActionParams): void {\n    this._animation = !params.immediate;\n    super.onHide(params);\n    this.collapseAll();\n    if (params.activator && params.activator.hasAttribute('data-store')) {\n      this.storeState();\n    }\n  }\n\n  @listen({\n    event: 'change',\n    target: ESLMediaQuery.for('@+MD')\n  })\n  protected onBreakpointChange({matches: isDesktop}: MediaQueryListEvent): void {\n    const isStoredOpen = !localStorage.getItem('sidebar-collapsed');\n    this.toggle(isDesktop && isStoredOpen, {force: true, initiator: 'bpchange', immediate: !isDesktop});\n  }\n\n  @listen({inherit: true})\n  protected override _onOutsideAction(e: Event): void {\n    if (ESLMediaQuery.for('@+MD').matches) return;\n    super._onOutsideAction(e);\n  }\n}\n","import {loadScript} from '../../../src/modules/esl-utils/dom/script';\nimport {memoizeFn} from '../../../src/modules/esl-utils/misc/memoize';\n\nfunction loadSearchScript(): Promise<Event> {\n  return loadScript('gss', 'https://cse.google.com/cse.js?cx=3171f866738b34f02');\n}\n\nconst onGSSReady = (): Promise<void> => {\n  return new Promise((resolve) => {\n    (window as any).__gcse = {\n      parsetags: 'onload',\n      initializationCallback: (): void => resolve()\n    };\n  });\n};\n\nexport const requestGss = memoizeFn(() => loadSearchScript().then(onGSSReady));\n","import {ESLBaseElement} from '../../../src/modules/esl-base-element/core';\nimport {CSSClassUtils} from '../../../src/modules/esl-utils/dom/class';\nimport {ready} from '../../../src/modules/esl-utils/decorators';\nimport {requestGss} from './search-script';\n\nexport class ESLDemoSearchPageWrapper extends ESLBaseElement {\n  static override is = 'esl-d-search-page-wrapper';\n\n  @ready\n  protected override connectedCallback(): void {\n    requestGss().then(() => this.afterSearchScriptLoad());\n  }\n\n  private afterSearchScriptLoad(): void {\n    const loadingAnimationEL = this.querySelector('.animation-loading');\n    if (loadingAnimationEL) {\n      CSSClassUtils.add(loadingAnimationEL, 'disabled');\n    }\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ARROW_DOWN, ARROW_LEFT, ARROW_RIGHT, ARROW_UP} from '../../esl-utils/dom/keys';\n\n/** Relative targeting type definition */\nexport type GroupTarget = 'next' | 'prev' | 'current';\n\n/**\n * ESLA11yGroup component\n * @author Julia Murashko\n *\n * ESLA11yGroup - helper custom element that adds a11y group behavior to targets.\n */\n@ExportNs('A11yGroup')\nexport class ESLA11yGroup extends ESLBaseElement {\n  public static override is = 'esl-a11y-group';\n\n  /** Mapping of the keyboard keys to {@link GroupTarget} */\n  public static KEY_MAP: Record<string, GroupTarget> = {\n    [ARROW_UP]: 'prev',\n    [ARROW_LEFT]: 'prev',\n    [ARROW_DOWN]: 'next',\n    [ARROW_RIGHT]: 'next'\n  };\n\n  /** Target elements multiple selector ({@link ESLTraversingQuery} syntax) */\n  @attr({defaultValue: '::child'}) public targets: string;\n\n  /** Activates target (via click event) on selection */\n  @boolAttr({}) public activateSelected: boolean;\n  /** Prevents scroll when target receives focus */\n  @boolAttr({}) public preventScroll: boolean;\n\n  /** @returns HTMLElement root element of the group */\n  public get $root(): HTMLElement | null {\n    return this.parentElement;\n  }\n  /** @returns HTMLElement[] targets of the group */\n  public get $targets(): HTMLElement[] {\n    if (!this.$root) return [];\n    return ESLTraversingQuery.all(this.targets, this.$root) as HTMLElement[];\n  }\n\n  @listen({\n    event: 'keydown',\n    target: (target: ESLA11yGroup) => target.$root\n  })\n  protected _onKeydown(e: KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n    if (!this.$targets.includes(target)) return;\n\n    const groupTarget = (this.constructor as typeof ESLA11yGroup).KEY_MAP[e.key];\n    if (!groupTarget) return;\n\n    this.goTo(groupTarget, target);\n    e.preventDefault();\n  }\n\n  /** Go to the target from the passed element or currently focused target by default */\n  public goTo(target: GroupTarget, from: HTMLElement | null = this.current()): void {\n    if (!from) return;\n    const targetEl = this[target](from);\n    if (!targetEl) return;\n    targetEl.focus({preventScroll: this.preventScroll});\n    this.activateSelected && targetEl.click();\n  }\n\n  /** @returns HTMLElement next target fot trigger */\n  public next(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index + 1) % triggers.length];\n  }\n\n  /** @returns HTMLElement previous target fot trigger */\n  public prev(trigger: HTMLElement): HTMLElement | undefined {\n    const triggers = this.$targets;\n    const index = triggers.indexOf(trigger);\n    return triggers[(index - 1 + triggers.length) % triggers.length];\n  }\n\n  /** @returns HTMLElement currently focused element from targets */\n  public current(): HTMLElement | null {\n    const $active = document.activeElement as HTMLElement;\n    return this.$targets.includes($active) ? $active : null;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    A11yGroup: typeof ESLA11yGroup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-a11y-group': ESLA11yGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {attr, jsonAttr, prop, listen} from '../../esl-utils/decorators';\nimport {isMatches} from '../../esl-utils/dom/traversing';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {createZIndexIframe} from '../../esl-utils/fixes/ie-fixes';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ESLToggleableActionParams, ESLToggleableRequestDetails} from '../../esl-toggleable/core';\n\nexport interface AlertActionParams extends ESLToggleableRequestDetails {\n  /** text to be shown; passes empty string or null to hide */\n  text?: string;\n  /** html content */\n  html?: string;\n  /** classes to add to alert element */\n  cls?: string;\n  /** timeout to clear classes */\n  hideTime?: number;\n}\n\n/**\n * ESLAlert component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLAlert is a component to show small notifications on your pages. ESLAlert can have multiple instances on the page.\n */\n@ExportNs('Alert')\nexport class ESLAlert extends ESLToggleable {\n  public static override is = 'esl-alert';\n  public static override observedAttributes = ['target'];\n\n  /** Default show/hide params for all ESLAlert instances */\n  public static defaultConfig: AlertActionParams = {\n    hideTime: 300,\n    hideDelay: 2500\n  };\n\n  /** Event to show alert component */\n  @prop('esl:alert:show') public override SHOW_REQUEST_EVENT: string;\n  /** Event to hide alert component */\n  @prop('esl:alert:hide') public override HIDE_REQUEST_EVENT: string;\n\n  /**\n   * Defines the scope (using {@link ESLTraversingQuery} syntax) element to listen for an activation event.\n   * Parent element by default\n   */\n  @attr({defaultValue: '::parent'}) public target: string;\n\n  /** Default show/hide params for current ESLAlert instance */\n  @jsonAttr<AlertActionParams>()\n  public override defaultParams: AlertActionParams;\n\n  protected $content: HTMLElement;\n  protected activeCls?: string;\n\n  private _$target: EventTarget;\n  private _clearTimeout: number;\n\n  /** Creates global alert instance (using body element as a base) */\n  public static init(options?: Partial<ESLAlert>): ESLAlert {\n    let alert: ESLAlert = document.querySelector(`body > ${ESLAlert.is}`)!;\n    if (!alert) {\n      alert = Object.assign(ESLAlert.create(), options || {});\n      document.body.appendChild(alert);\n    }\n    return alert;\n  }\n\n  protected override mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    const type = this.constructor as typeof ESLAlert;\n    return Object.assign({}, type.defaultConfig, this.defaultParams || {}, params || {});\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') {\n      this.$target = ESLTraversingQuery.first(this.target) as EventTarget;\n    }\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.setAttribute('role', this.getAttribute('role') || 'alert');\n    this.$content = document.createElement('div');\n    this.$content.className = 'esl-alert-content';\n    this.innerHTML = '';\n    this.appendChild(this.$content);\n    if (DeviceDetector.isIE) this.appendChild(createZIndexIframe());\n    if (this.target) {\n      this.$target = ESLTraversingQuery.first(this.target, this) as EventTarget;\n    }\n  }\n\n  /** Target element to listen to activation events */\n  public get $target(): EventTarget {\n    return this._$target;\n  }\n  public set $target($el: EventTarget) {\n    this._$target = $el;\n    this.$$on(this._onShowRequest);\n    this.$$on(this._onHideRequest);\n  }\n\n  protected override onShow(params: AlertActionParams): void {\n    if (this._clearTimeout) window.clearTimeout(this._clearTimeout);\n    if (params.html || params.text) {\n      this.render(params);\n      super.onShow(params);\n    }\n    this.hide(params);\n  }\n  protected override onHide(params: AlertActionParams): void {\n    super.onHide(params);\n    this._clearTimeout = window.setTimeout(() => this.clear(), params.hideTime);\n  }\n\n  protected render({text, html, cls}: AlertActionParams): void {\n    CSSClassUtils.remove(this, this.activeCls);\n    CSSClassUtils.add(this, this.activeCls = cls);\n    if (html) this.$content.innerHTML = html;\n    if (text) this.$content.textContent = text;\n  }\n  protected clear(): void {\n    this.$content.innerHTML = '';\n    CSSClassUtils.remove(this, this.activeCls);\n  }\n\n  protected override buildRequestParams(e: CustomEvent<ESLToggleableRequestDetails>): AlertActionParams | null {\n    const detail = e.detail || {};\n    if (!isMatches(this, detail.match)) return null;\n    if (e.type === this.SHOW_REQUEST_EVENT) return Object.assign({}, detail, {force: true});\n    if (e.type === this.HIDE_REQUEST_EVENT) return Object.assign({hideDelay: 0}, detail, {force: true});\n    return null;\n  }\n\n  @listen({inherit: true, target: (el: ESLAlert) => el.$target})\n  protected override _onHideRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    super._onHideRequest(e);\n    e.stopPropagation();\n  }\n\n  @listen({inherit: true, target: (el: ESLAlert) => el.$target})\n  protected override _onShowRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    super._onShowRequest(e);\n    e.stopPropagation();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Alert: typeof ESLAlert;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-alert': ESLAlert;\n  }\n}\n","import {ESLMixinElement} from '../../esl-mixin-element/core';\nimport {ready, jsonAttr} from '../../esl-utils/decorators';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\n\nimport {ESLAnimateService} from './esl-animate-service';\nimport type {ESLAnimateConfig} from './esl-animate-service';\n\n/**\n * ESLAnimateMixin - custom mixin element for quick {@link ESLAnimateService} attaching\n *\n * Use example:\n * `<div esl-animate>Content</div>`\n *\n * Supports additional parameters:\n * `<div esl-animate={repeat: true, ratio: 0.8, cls: 'in'}>Content</div>`\n */\n@ExportNs('AnimateMixin')\nexport class ESLAnimateMixin extends ESLMixinElement {\n  public static override is = 'esl-animate';\n\n  public static defaultConfig: ESLAnimateConfig = {\n    force: true\n  };\n\n  @jsonAttr({name: ESLAnimateMixin.is})\n  public options?: ESLAnimateConfig;\n\n  protected mergeDefaultParams(): ESLAnimateConfig {\n    const type = this.constructor as typeof ESLAnimateMixin;\n    return Object.assign({}, type.defaultConfig, this.options);\n  }\n\n  @ready\n  public override connectedCallback(): void {\n    super.connectedCallback();\n    this.reanimate();\n  }\n\n  @ready\n  public override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    ESLAnimateService.unobserve(this.$host);\n  }\n\n  /** Reinitialize {@link ESLAnimateService} for target */\n  public reanimate(): void {\n    ESLAnimateService.unobserve(this.$host);\n    ESLAnimateService.observe(this.$host, this.mergeDefaultParams());\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    AnimateMixin: typeof ESLAnimateMixin;\n  }\n}\n","import {wrap} from '../../esl-utils/misc/array';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {memoize, bind} from '../../esl-utils/decorators';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\n/** ESLAnimateService animation options */\nexport interface ESLAnimateConfig {\n  /** Class(es) to mark element animated */\n  cls?: string;\n\n  /** Animate if class already presented */\n  force?: boolean;\n\n  /** Animate items in group one by one, using groupDelay */\n  group?: boolean;\n\n  /** Delay to display element(s) after previous one. Used when group animation is enabled. Default: 100ms */\n  groupDelay?: number;\n\n  /** Do not unsubscribe after animate and repeat animation on each viewport intersection */\n  repeat?: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   * Default: 0.4 (40%)\n   */\n  ratio?: number;\n}\n\n/** ESLAnimateService animation inner options. Contains system animation properties */\ninterface ESLAnimateConfigInner extends ESLAnimateConfig {\n  // Required parts\n  cls: string;\n  ratio: number;\n  groupDelay: number;\n\n  /** (private) animation requested */\n  _timeout?: number;\n  /** (private) marker to unobserve */\n  _unsubscribe?: boolean;\n}\n\n/** Service to animate elements on viewport intersection */\n@ExportNs('AnimateService')\nexport class ESLAnimateService {\n\n  /** ESLAnimateService default animation configuration */\n  protected static DEFAULT_CONFIG: ESLAnimateConfigInner = {cls: 'in', groupDelay: 100, ratio: 0.4};\n  /** ESLAnimationService IntersectionObserver properties */\n  protected static OPTIONS_OBSERVER: IntersectionObserverInit = {threshold: [0.001, 0.2, 0.4, 0.6, 0.8]};\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param target - element(s) or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public static observe(target: Element | Element[], config: ESLAnimateConfig = {}): void {\n    wrap(target).forEach((item: Element) => this.instance.observe(item, config));\n  }\n\n  /** Unobserve element or elements */\n  public static unobserve(target: Element | Element[]): void {\n    wrap(target).forEach((item: Element) => this.instance.unobserve(item));\n  }\n\n  /** @returns if service observing target */\n  public static isObserved(target: Element): boolean {\n    return this.instance.isObserved(target);\n  }\n\n  @memoize()\n  private static get instance(): ESLAnimateService {\n    return new ESLAnimateService();\n  }\n\n  protected _io = new IntersectionObserver(this.onIntersect, ESLAnimateService.OPTIONS_OBSERVER);\n  protected _entries: Set<Element> = new Set();\n  protected _configMap = new WeakMap<Element, ESLAnimateConfigInner>();\n\n  protected deferredOnAnimate = debounce(() => this.onAnimate(), 100);\n\n  /**\n   * Subscribe ESlAnimateService on element(s) to animate it on viewport intersection\n   * @param el - element or elements to observe and animate\n   * @param config - optional animation configuration\n   */\n  public observe(el: Element, config: ESLAnimateConfig = {}): void {\n    const cfg = Object.assign({}, ESLAnimateService.DEFAULT_CONFIG, config);\n    this._configMap.set(el, cfg);\n    cfg.force && CSSClassUtils.remove(el, cfg.cls);\n    this._io.observe(el);\n  }\n\n  /** Unobserve element or elements */\n  public unobserve(el: Element): void {\n    this._io.unobserve(el);\n    this._configMap.delete(el);\n  }\n\n  /** @returns if service observing target */\n  public isObserved(target: Element): boolean {\n    return !!this._configMap.get(target);\n  }\n\n  /** Intersection observable callback */\n  @bind\n  protected onIntersect(entries: IntersectionObserverEntry[]): void {\n    entries.forEach(({target, intersectionRatio, isIntersecting}: IntersectionObserverEntry) => {\n      const config = this._configMap.get(target);\n      if (!config) return;\n\n      // Item will be marked as visible in case it intersecting to the viewport with a ratio grater then passed visibleRatio\n      if (isIntersecting && intersectionRatio >= config.ratio) {\n        this._entries.add(target);\n      }\n\n      // Item considered as invisible in case it is going to be intersected less then 1% of it's area\n      if (!isIntersecting && intersectionRatio <= 0.01) {\n        this._entries.delete(target);\n\n        if (config.repeat) {\n          CSSClassUtils.remove(target, config.cls);\n          config._timeout && clearTimeout(config._timeout);\n        }\n      }\n    });\n    this.deferredOnAnimate();\n  }\n\n  /** Process animation query */\n  protected onAnimate(): void {\n    let time = -1;\n    this._entries.forEach((target) => {\n      const config = this._configMap.get(target);\n      if (!config) return;\n\n      if (config._timeout) window.clearTimeout(config._timeout);\n      if (config.group) {\n        time = time === -1 ? 0 : (time + config.groupDelay);\n        config._timeout = window.setTimeout(() => this.onAnimateItem(target), time);\n      } else {\n        this.onAnimateItem(target);\n      }\n      config._unsubscribe = !config.repeat;\n    });\n  }\n\n  /** Animates passed item */\n  protected onAnimateItem(item: Element): void {\n    const config = this._configMap.get(item);\n    if (!config) return;\n\n    CSSClassUtils.add(item, config.cls);\n    this._entries.delete(item);\n\n    if (config._unsubscribe) this.unobserve(item);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    AnimateService: typeof ESLAnimateService;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ready, memoize, attr, boolAttr} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {ESLBaseElement} from '../../esl-base-element/core';\n\nimport {ESLAnimateService} from './esl-animate-service';\n\n/**\n * ESLAnimate - custom element for quick {@link ESLAnimateService} attaching\n *\n * Have two types of usage:\n * - trough the target-s definition, then esl-animate (without it's own content) became invisible plugin-component\n * `<esl-animate target=\"::next\"></esl-animate><div>Content</div>`\n * - trough the content wrapping\n * `<esl-animate>Content</esl-animate>`\n */\n@ExportNs('Animate')\nexport class ESLAnimate extends ESLBaseElement {\n  public static override is = 'esl-animate';\n  public static observedAttributes = ['group', 'repeat', 'target'];\n\n  /**\n   * Class(es) to add on viewport intersection\n   * @see ESLAnimateConfig.cls\n   */\n  @attr({defaultValue: 'in'}) public cls: string;\n\n  /**\n   * Enable group animation for targets\n   * @see ESLAnimateConfig.group\n   */\n  @boolAttr() public group: boolean;\n\n  /**\n   * Delay to start animation from previous item in group\n   * @see ESLAnimateConfig.groupDelay\n   */\n  @attr({defaultValue: '100'}) public groupDelay: string;\n\n  /**\n   * Re-animate item after its getting hidden\n   * @see ESLAnimateConfig.repeat\n   */\n  @boolAttr() public repeat: boolean;\n\n  /**\n   * Intersection ratio to consider element as visible.\n   * Only 0.2 (20%), 0.4 (40%), 0.6 (60%), 0.8 (80%) values are allowed due to share of IntersectionObserver instance\n   * with a fixed set of thresholds defined.\n   */\n  @attr() public ratio: string;\n\n  /**\n   * Define target(s) to observe and animate\n   * Uses {@link ESLTraversingQuery} with multiple targets support\n   * Default: ` ` - current element, `<esl-animate>` behave as a wrapper\n   */\n  @attr() public target: string;\n\n  /** Elements-targets found by target query */\n  @memoize()\n  public get $targets(): HTMLElement[] {\n    return ESLTraversingQuery.all(this.target, this) as HTMLElement[];\n  }\n\n  protected override attributeChangedCallback(): void {\n    if (!this.connected) return;\n    this.reanimate();\n  }\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.reanimate();\n  }\n\n  @ready\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    ESLAnimateService.unobserve(this.$targets);\n  }\n\n  /** Reinitialize {@link ESLAnimateService} for targets */\n  public reanimate(): void {\n    ESLAnimateService.unobserve(this.$targets);\n    memoize.clear(this, '$targets');\n    ESLAnimateService.observe(this.$targets, {\n      force: true,\n      cls: this.cls,\n      ratio: parseNumber(this.ratio, 0.4),\n      repeat: this.repeat,\n      group: this.group,\n      groupDelay: parseNumber(this.groupDelay, 0)\n    });\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Animate: typeof ESLAnimate;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-animate': ESLAnimate;\n  }\n}\n\n","import {setAttr} from '../../esl-utils/dom/attr';\nimport {prop} from '../../esl-utils/decorators';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {\n  ESLEventListener,\n  ESLListenerHandler,\n  ESLListenerCriteria,\n  ESLListenerDescriptor\n} from '../../esl-utils/dom/events';\nimport type {ESLBaseComponent} from '../../esl-utils/abstract/component';\n\n/** Finalize tag name (`is`) for passed ESLBaseElement-based class */\nconst finalize = (type: typeof ESLBaseElement, tagName: string): void => {\n  Object.defineProperty(type, 'is', {\n    get: () => tagName,\n    set(value) {\n      if (this === type) throw Error(`[ESL]: Cannot override ${type.name}.is property, the class is already registered`);\n      Object.defineProperty(this, 'is', {value, writable: true, configurable: true});\n    }\n  });\n};\n\n/**\n * Base class for ESL custom elements\n * Allows defining custom element with the optional custom tag name\n */\nexport abstract class ESLBaseElement extends HTMLElement implements ESLBaseComponent {\n  /** Custom element tag name */\n  public static is = '';\n\n  /** Event to indicate component significant state change that may affect other components state */\n  @prop('esl:refresh') public REFRESH_EVENT: string;\n\n  protected _connected: boolean = false;\n\n  /** @returns custom element tag name */\n  public get baseTagName(): string {\n    return (this.constructor as typeof ESLBaseElement).is;\n  }\n\n  protected connectedCallback(): void {\n    this._connected = true;\n    this.classList.add(this.baseTagName);\n\n    ESLEventUtils.subscribe(this);\n  }\n  protected disconnectedCallback(): void {\n    this._connected = false;\n\n    ESLEventUtils.unsubscribe(this);\n  }\n\n  /**\n   * Callback to handle changing of element attributes.\n   * Happens when attribute accessed for writing independently of the actual value change\n   */\n  protected attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {}\n\n  /** Check that the element is connected and `connectedCallback` has been executed */\n  public get connected(): boolean {\n    return this._connected;\n  }\n\n  /** Subscribes `handler` method marked with `@listen` decorator */\n  public $$on(handler: ESLListenerHandler): ESLEventListener[];\n  /** Subscribes `handler` function by the passed DOM event descriptor {@link ESLListenerDescriptor} or event name */\n  public $$on<EType extends keyof ESLListenerEventMap>(\n    event: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  public $$on(event: any, handler?: any): ESLEventListener[] {\n    return ESLEventUtils.subscribe(this, event, handler);\n  }\n\n  /** Unsubscribes event listener */\n  public $$off(...condition: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventUtils.unsubscribe(this, ...condition);\n  }\n\n  /**\n   * Gets or sets CSS classes for the current element.\n   * @param cls - CSS classes query {@link CSSClassUtils}\n   * @param value - boolean to set CSS class(es) state or undefined to skip mutation\n   * @returns current classes state or passed state\n   */\n  public $$cls(cls: string, value?: boolean): boolean {\n    if (value === undefined) return CSSClassUtils.has(this, cls);\n    CSSClassUtils.toggle(this, cls, value);\n    return value;\n  }\n\n  /**\n   * Gets or sets an attribute for the current element.\n   * If the `value` param is undefined then skips mutation.\n   * @param name - attribute name\n   * @param value - string attribute value, boolean attribute state or `null` to delete attribute\n   * @returns the current attribute value or previous value for mutation\n   */\n  public $$attr(name: string, value?: null | boolean | string): string | null {\n    const prevValue = this.getAttribute(name);\n    if (value !== undefined) setAttr(this, name, value);\n    return prevValue;\n  }\n\n  /**\n   * Dispatches component custom event.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return ESLEventUtils.dispatch(this, eventName, eventInit);\n  }\n\n  /**\n   * Register component in the {@link customElements} registry\n   * @param tagName - custom tag name to register custom element\n   */\n  public static register(this: typeof ESLBaseElement, tagName?: string): void {\n    tagName = tagName || this.is;\n    if (!tagName) throw new DOMException('[ESL]: Incorrect tag name', 'NotSupportedError');\n    const constructor: any = customElements.get(tagName);\n    if (constructor && (constructor !== this || constructor.is !== tagName)) {\n      throw new DOMException('[ESL]: Element tag already occupied or inconsistent', 'NotSupportedError');\n    }\n    if (constructor) return;\n    finalize(this, tagName);\n    customElements.define(tagName, this as any as CustomElementConstructor);\n  }\n\n  /** Shortcut for `customElements.whenDefined(currentCustomElement)` */\n  public static get registered(): Promise<CustomElementConstructor> {\n    return customElements.whenDefined(this.is);\n  }\n\n  /** Creates an instance of the current custom element */\n  public static create<T extends typeof ESLBaseElement>(this: T): InstanceType<T>;\n  /** General signature of {@link create} to allow simplified overrides of the method */\n  public static create(this: typeof ESLBaseElement): ESLBaseElement;\n  public static create<T extends typeof ESLBaseElement>(this: T): InstanceType<T> {\n    return document.createElement(this.is) as InstanceType<T>;\n  }\n}\n","import type {ESLCarousel} from './esl-carousel';\nimport type {ESLCarouselSlide} from './esl-carousel.slide';\nimport type {ESLCarouselDirection, ESLCarouselStaticState} from './nav/esl-carousel.nav.types';\n\n/** {@link ESLCarouselSlideEvent} init object */\ninterface ESLCarouselSlideEventInit {\n  /** Current slide index */\n  current: number;\n  /** Related slide index (target on pre-event, current on post-event) */\n  related: number;\n  /** Direction of slide animation */\n  direction: ESLCarouselDirection;\n  /** Auxiliary request attribute that represents object that initiate slide change */\n  activator?: any;\n}\n\n/** {@link ESLCarousel} event that represents slide change event */\nexport class ESLCarouselSlideEvent extends Event implements ESLCarouselSlideEventInit {\n  /** {@link ESLCarouselSlideEvent} event type dispatched before slide change (pre-event) */\n  public static readonly BEFORE = 'esl:before:slide:change';\n  /** {@link ESLCarouselSlideEvent} event type dispatched after slide change (post-event) */\n  public static readonly AFTER = 'esl:slide:change';\n\n  public override readonly target: ESLCarousel;\n  public readonly current: number;\n  public readonly related: number;\n  public readonly direction: ESLCarouselDirection;\n  public readonly activator?: any;\n\n  protected constructor(\n    type: string,\n    init: ESLCarouselSlideEventInit\n  ) {\n    super(type, {\n      bubbles: true,\n      cancelable: ESLCarouselSlideEvent.BEFORE === type,\n      composed: true\n    });\n    Object.assign(this, init);\n  }\n\n  public static create(type: 'BEFORE' | 'AFTER', init: ESLCarouselSlideEventInit): ESLCarouselSlideEvent {\n    return new ESLCarouselSlideEvent(ESLCarouselSlideEvent[type], init);\n  }\n}\n\n/** {@link ESLCarouselChangeEvent} init object */\ninterface ESLCarouselChangeEventInit {\n  /** Current {@link ESLCarousel} instance config */\n  config: ESLCarouselStaticState;\n  /** Previous {@link ESLCarousel} instance config */\n  oldConfig?: ESLCarouselStaticState;\n  /** A list of {@link ESLCarouselSlide}s that have added to the current carousel instance */\n  added: ESLCarouselSlide[];\n  /** A list of {@link ESLCarouselSlide}s that have removed from the current carousel instance */\n  removed: ESLCarouselSlide[];\n}\n\n/** {@link ESLCarousel} event that represents slide configuration change */\nexport class ESLCarouselChangeEvent extends Event implements ESLCarouselChangeEventInit {\n  /** {@link ESLCarouselSlideEvent} event type dispatched on carousel config changes */\n  public static readonly TYPE = 'esl:carousel:change';\n\n  public override readonly target: ESLCarousel;\n  public readonly config: ESLCarouselStaticState;\n  public readonly oldConfig?: ESLCarouselStaticState;\n  public readonly added: ESLCarouselSlide[] = [];\n  public readonly removed: ESLCarouselSlide[] = [];\n\n  protected constructor(init: ESLCarouselChangeEventInit) {\n    super(ESLCarouselChangeEvent.TYPE, {\n      bubbles: true,\n      cancelable: false,\n      composed: true\n    });\n    Object.assign(this, init);\n  }\n\n  public static create(init: ESLCarouselChangeEventInit): ESLCarouselChangeEvent {\n    return new ESLCarouselChangeEvent(init);\n  }\n}\n","import {memoize} from '../../esl-utils/decorators';\nimport {SyntheticEventTarget} from '../../esl-utils/dom';\nimport {ESLCarouselSlideEvent} from './esl-carousel.events';\n\nimport type {ESLCarousel, ESLCarouselActionParams} from './esl-carousel';\nimport type {ESLCarouselDirection} from './nav/esl-carousel.nav.types';\n\nexport abstract class ESLCarouselRenderer {\n  public static is: string;\n\n  protected readonly carousel: ESLCarousel;\n\n  constructor(carousel: ESLCarousel) {\n    this.carousel = carousel; // TODO: unsafe while lifecycle is not clear\n  }\n\n  /** @returns renderer type name */\n  public get type(): string {\n    return (this.constructor as typeof ESLCarouselRenderer).is;\n  }\n\n  /** @returns count of carousel slides */\n  public get size(): number {\n    return this.carousel.size;\n  }\n  /** @returns count of visible carousel slides */\n  public get count(): number {\n    return this.carousel.config.count;\n  }\n  /** @returns if the carousel is in a loop mode */\n  public get loop(): boolean {\n    return this.carousel.config.loop;\n  }\n\n  /** @returns {@link ESLCarousel} `$slideArea` */\n  public get $area(): HTMLElement {\n    return this.carousel.$slidesArea;\n  }\n\n  public bind(): void {\n    const type = this.constructor as typeof ESLCarouselRenderer;\n    this.carousel.classList.add(`${type.is}-carousel`);\n\n    this.onBind();\n  }\n  public unbind(): void {\n    const type = this.constructor as typeof ESLCarouselRenderer;\n    this.carousel.classList.remove(`${type.is}-carousel`);\n\n    this.onUnbind();\n  }\n\n  /** Processes binding of defined renderer to the carousel {@link ESLCarousel}. */\n  public onBind(): void {}\n  /** Processes unbinding of defined renderer from the carousel {@link ESLCarousel}. */\n  public onUnbind(): void {}\n  /** Processes drawing of the carousel {@link ESLCarousel}. */\n  public redraw(): void {}\n  /** Process slide change process */\n  public async navigate(index: number, direction: ESLCarouselDirection, {activator}: ESLCarouselActionParams): Promise<void> {\n    const {activeIndex, activeIndexes} = this.carousel;\n\n    if (activeIndex === index && activeIndexes.length === this.count) return;\n    if (!this.carousel.dispatchEvent(ESLCarouselSlideEvent.create('BEFORE', {\n      direction,\n      activator,\n      current: activeIndex,\n      related: index\n    }))) return;\n\n    try {\n      await this.onBeforeAnimate(index, direction);\n      await this.onAnimate(index, direction);\n      await this.onAfterAnimate(index, direction);\n    } catch (e: unknown) {\n      console.error(e);\n    }\n\n    this.setActive(index);\n\n    this.carousel.dispatchEvent(ESLCarouselSlideEvent.create('AFTER', {\n      direction,\n      activator,\n      current: index,\n      related: activeIndex\n    }));\n  }\n\n  /** Pre-processing animation action. */\n  public abstract onBeforeAnimate(index?: number, direction?: ESLCarouselDirection): Promise<void>;\n  /** Processes animation. */\n  public abstract onAnimate(index: number, direction: ESLCarouselDirection): Promise<void>;\n  /** Post-processing animation action. */\n  public abstract onAfterAnimate(index: number, direction: ESLCarouselDirection): Promise<void>;\n\n  /** Handles the slides transition. */\n  public abstract onMove(offset: number): void;\n  /** Ends current transition and make permanent all changes performed in the transition. */\n  public abstract commit(offset?: number): void;\n\n  /** Sets active slides from passed index **/\n  public setActive(from: number): void {\n    const count = Math.min(this.count, this.size);\n    this.carousel.$slides.forEach((el) => el.active = false);\n    for (let i = 0; i < count; i++) {\n      this.carousel.slideAt(from + i).active = true;\n    }\n  }\n\n  // Register API\n  @memoize()\n  public static get registry(): ESLCarouselRendererRegistry {\n    return new ESLCarouselRendererRegistry();\n  }\n  public static register(view: ESLCarouselRendererConstructor): void {\n    ESLCarouselRenderer.registry.register(view);\n  }\n}\n\nexport type ESLCarouselRendererConstructor = (new(carousel: ESLCarousel) => ESLCarouselRenderer) & typeof ESLCarouselRenderer;\n\nexport class ESLCarouselRendererRegistry extends SyntheticEventTarget {\n  private store = new Map<string, ESLCarouselRendererConstructor>();\n\n  public create(name: string, carousel: ESLCarousel): ESLCarouselRenderer {\n    let Renderer = this.store.get(name);\n    if (!Renderer) [Renderer] = this.store.values(); // take first Renderer in store\n    return new Renderer(carousel);\n  }\n\n  public register(view: ESLCarouselRendererConstructor): void {\n    if (!view || !view.is) throw Error('[ESL]: CarouselRendererRegistry] incorrect registration request');\n    if (this.store.has(view.is)) throw Error(`View with name ${view.is} already defined`);\n    this.store.set(view.is, view);\n    const detail = {name: view.is, view};\n    const event = new CustomEvent('change', {detail});\n    this.dispatchEvent(event);\n  }\n}\n","import {ESLBaseElement} from '../../esl-base-element/core';\nimport {boolAttr, memoize} from '../../esl-utils/decorators';\nimport {findNext, findPrev, findNextLooped, findPrevLooped} from '../../esl-utils/dom/traversing';\n\nimport type {ESLCarousel} from './esl-carousel';\n\n/**\n * ESLCarouselSlide component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLCarouselSlide - a component that provides content for ESLCarousel {@link ESLCarousel}\n */\nexport class ESLCarouselSlide extends ESLBaseElement {\n  /** @returns if the slide is active */\n  @boolAttr() public active: boolean;\n\n  @memoize()\n  public get $carousel(): ESLCarousel | undefined {\n    const carouselTag = this.baseTagName.replace('-slide', '');\n    return this.closest(carouselTag) as ESLCarousel | undefined;\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.$carousel?.addSlide && this.$carousel.addSlide(this);\n    this.updateA11y();\n  }\n\n  protected override disconnectedCallback(): void {\n    this.$carousel?.removeSlide && this.$carousel.removeSlide(this);\n    memoize.clear(this, '$carousel');\n    super.disconnectedCallback();\n  }\n\n  /** @returns index of the slide in the carousel. */\n  public get index(): number {\n    if (!this.parentNode) return NaN;\n    return Array.prototype.indexOf.call(this.parentNode.children, this);\n  }\n\n  /** @returns next slide sibling. */\n  public get $next(): ESLCarouselSlide {\n    return findNext(this, (this.constructor as typeof ESLCarouselSlide).is) as ESLCarouselSlide;\n  }\n  /** @returns prev slide sibling. */\n  public get $prev(): ESLCarouselSlide {\n    return findPrev(this, (this.constructor as typeof ESLCarouselSlide).is) as ESLCarouselSlide;\n  }\n\n  /** @returns next slide sibling (uses cyclic find). */\n  public get $nextCyclic(): ESLCarouselSlide {\n    return findNextLooped(this, (this.constructor as typeof ESLCarouselSlide).is) as ESLCarouselSlide;\n  }\n  /** @returns previous slide sibling (uses cyclic find). */\n  public get $prevCyclic(): ESLCarouselSlide {\n    return findPrevLooped(this, (this.constructor as typeof ESLCarouselSlide).is) as ESLCarouselSlide;\n  }\n\n  protected updateA11y(): void {\n    this.setAttribute('role', 'group');\n    if (!this.hasAttribute('aria-roledescription')) {\n      this.setAttribute('aria-roledescription', 'slide');\n    }\n    if (!this.hasAttribute('aria-label')) {\n      this.setAttribute('aria-label', `carousel item ${this.index + 1}`);\n    }\n  }\n\n  /** Creates slide element, use passed content as slide inner */\n  public static override create(content?: HTMLElement | DocumentFragment): ESLCarouselSlide {\n    const $slide = super.create() as ESLCarouselSlide;\n    if (content) $slide.appendChild(content);\n    return $slide;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {attr, boolAttr, decorate, listen, memoize} from '../../esl-utils/decorators';\n\nimport {microtask} from '../../esl-utils/async';\nimport {parseBoolean, isEqual} from '../../esl-utils/misc';\n\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {ESLResizeObserverTarget} from '../../esl-event-listener/core';\n\nimport {normalizeIndex, toIndex, canNavigate} from './nav/esl-carousel.nav.utils';\n\nimport {ESLCarouselSlide} from './esl-carousel.slide';\nimport {ESLCarouselRenderer} from './esl-carousel.renderer';\nimport {ESLCarouselChangeEvent} from './esl-carousel.events';\n\nimport type {ESLCarouselState, ESLCarouselDirection, ESLCarouselSlideTarget, ESLCarouselStaticState} from './nav/esl-carousel.nav.types';\n\n/** {@link ESLCarousel} action params interface */\nexport interface ESLCarouselActionParams {\n  /** Element requester of the change */\n  activator?: any;\n  /** Direction to move to. */\n  direction?: ESLCarouselDirection;\n  // TODO: implement\n  // noAnimation?: boolean;\n}\n\n/**\n * ESLCarousel component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLCarousel - a slideshow component for cycling through slides {@link ESLCarouselSlide}.\n */\n@ExportNs('Carousel')\nexport class ESLCarousel extends ESLBaseElement {\n  public static override is = 'esl-carousel';\n  public static observedAttributes = ['media', 'type', 'loop', 'count'];\n\n  /** Media query pattern used for {@link ESLMediaRuleList} of `type`, `loop` and `count` (default: `all`) */\n  @attr({name: 'media', defaultValue: 'all'}) public mediaCfg: string;\n  /** Renderer type name (`multi` by default). Supports {@link ESLMediaRuleList} syntax */\n  @attr({name: 'type', defaultValue: 'multi'}) public typeCfg: string;\n  /** Marker to enable loop mode for carousel (`true` by default). Supports {@link ESLMediaRuleList} syntax */\n  @attr({name: 'loop', defaultValue: 'false'}) public loopCfg: string;\n  /** Count of slides to show on the screen (`1` by default). Supports {@link ESLMediaRuleList} syntax */\n  @attr({name: 'count', defaultValue: '1'}) public countCfg: string;\n\n  /** true if carousel is in process of animating */\n  @boolAttr({readonly: true}) public animating: boolean;\n\n  /** Renderer type {@link ESLMediaRuleList} instance */\n  @memoize()\n  public get typeRule(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.mediaCfg, this.typeCfg);\n  }\n  /** Loop marker {@link ESLMediaRuleList} instance */\n  @memoize()\n  public get loopRule(): ESLMediaRuleList<boolean> {\n    return ESLMediaRuleList.parse(this.mediaCfg, this.loopCfg, parseBoolean);\n  }\n  /** Count of visible slides {@link ESLMediaRuleList} instance */\n  @memoize()\n  public get countRule(): ESLMediaRuleList<number> {\n    return ESLMediaRuleList.parse(this.mediaCfg, this.countCfg, parseInt);\n  }\n\n  /** Carousel instance current {@link ESLCarouselStaticState} */\n  @memoize()\n  public get config(): ESLCarouselStaticState {\n    return {\n      size: this.$slides.length,\n      count: this.countRule.value || 1,\n      loop: !!this.loopRule.value\n    };\n  }\n\n  /** Carousel instance current {@link ESLCarouselState} */\n  public get state(): ESLCarouselState {\n    return Object.assign({}, this.config, {\n      activeIndex: this.activeIndex\n    });\n  }\n\n  /** @returns currently active renderer */\n  @memoize()\n  public get renderer(): ESLCarouselRenderer {\n    const type = this.typeRule.value || 'multi';\n    const renderer = ESLCarouselRenderer.registry.create(type, this);\n    renderer && renderer.bind(); // TODO: small small - getter side effect\n    return renderer;\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.update();\n    this.updateA11y();\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected) return;\n    memoize.clear(this, `${attrName}Rule`);\n    this.update();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    memoize.clear(this, ['$container', '$slides', '$slidesArea']);\n  }\n\n  /** Updates the config and the state that is associated with */\n  @decorate(microtask)\n  public update(): void {\n    const oldType = this.renderer.type;\n    const oldConfig = this.config;\n    const $oldSlides = this.$slides;\n\n    memoize.clear(this, ['config', '$slides']);\n    if (oldType !== this.typeRule.value) {\n      this.renderer && this.renderer.unbind();\n      memoize.clear(this, 'renderer');\n    }\n    this.updateContainer();\n    this.renderer.redraw();\n\n    const added = this.$slides.filter((slide) => !$oldSlides.includes(slide));\n    const removed = $oldSlides.filter((slide) => !this.$slides.includes(slide));\n    const config = this.config;\n\n    if (!added.length && !removed.length && isEqual(config, oldConfig)) return;\n    this.dispatchEvent(ESLCarouselChangeEvent.create({added, removed, config, oldConfig}));\n  }\n\n  public updateContainer(): void {\n    if (!this.$container) return;\n    this.$container.toggleAttribute('empty', this.size === 0);\n    this.$container.toggleAttribute('single', this.size === 1);\n    this.$container.toggleAttribute('incomplete', this.size <= this.config.count);\n  }\n\n  /** Appends slide instance to the current carousel */\n  public addSlide(slide: HTMLElement | ESLCarouselSlide): void {\n    if (!slide) return;\n    if (!(slide instanceof ESLCarouselSlide)) return this.addSlide(ESLCarouselSlide.create(slide));\n    if (slide.parentNode !== this.$slidesArea) {\n      slide.remove();\n      this.$slidesArea?.appendChild(slide);\n    }\n    this.update();\n  }\n\n  /** Remove slide instance from the current carousel */\n  public removeSlide(slide: HTMLElement | ESLCarouselSlide): void {\n    if (!slide) return;\n    if (!(slide instanceof ESLCarouselSlide)) return this.removeSlide(slide.closest(ESLCarouselSlide.is)!);\n    if (slide.parentNode === this.$slidesArea) this.$slidesArea?.removeChild(slide);\n    this.update();\n  }\n\n  protected updateA11y(): void {\n    // TODO: update a11y -> check a11y everywhere\n  }\n\n  @listen({\n    event: 'change',\n    target: ({typeRule, countRule, loopRule}: ESLCarousel) => [typeRule, countRule, loopRule]\n  })\n  protected _onRuleUpdate(): void {\n    this.update();\n  }\n\n  @listen({event: 'change', target: ESLCarouselRenderer.registry})\n  protected _onRegistryUpdate(): void {\n    this.update();\n  }\n\n  @listen({event: 'resize', target: ESLResizeObserverTarget.for})\n  protected _onResize(): void {\n    this.renderer && this.renderer.redraw();\n  }\n\n  /** @returns slides that are processed by the current carousel. */\n  @memoize()\n  public get $slides(): ESLCarouselSlide[] {\n    const els = this.$slidesArea ? [...this.$slidesArea.children] : [];\n    return els.filter((slide): slide is ESLCarouselSlide  => slide.matches(ESLCarouselSlide.is));\n  }\n\n  /** @returns carousel container */\n  @memoize()\n  public get $container(): HTMLElement | null {\n    return this.closest(`[${ESLCarousel.is}-container]`);\n  }\n\n  /** @returns slides carousel area */\n  @memoize()\n  public get $slidesArea(): HTMLElement {\n    const $provided = this.querySelector('[data-slides-area]');\n    if ($provided) return $provided as HTMLElement;\n    const $container = document.createElement('div');\n    $container.setAttribute('data-slides-area', '');\n    this.appendChild($container);\n    return $container ;\n  }\n\n  /** @returns first active slide */\n  public get $activeSlide(): ESLCarouselSlide | null {\n    const actives = this.$slides.filter((el) => el.active);\n    if (actives.length === 0) return null;\n    if (actives.length === this.$slides.length) return this.$slides[0];\n\n    for (const slide of actives) {\n      const prevIndex = normalizeIndex(slide.index - 1, this.size);\n      if (!this.$slides[prevIndex].active) return slide;\n    }\n    return this.$slides[0];\n  }\n\n  /** @returns list of active slides. */\n  public get $activeSlides(): ESLCarouselSlide[] {\n    let $slide = this.$activeSlide;\n    let i = this.size;\n    const arr: ESLCarouselSlide[] = [];\n    while ($slide?.active && i > 0) {\n      arr.push($slide);\n      $slide = $slide.$nextCyclic;\n      i--;\n    }\n    return arr;\n  }\n\n  /** @returns count of slides. */\n  public get size(): number {\n    return this.$slides.length || 0;\n  }\n\n  /** @returns index of first active slide. */\n  public get activeIndex(): number {\n    return this.$activeSlide?.index || 0;\n  }\n  /** @returns list of active slide indexes. */\n  public get activeIndexes(): number[] {\n    return this.$slides.reduce((activeIndexes: number[], el, index) => {\n      if (el.active) activeIndexes.push(index);\n      return activeIndexes;\n    }, []);\n  }\n\n  /** Goes to the target according to passed params */\n  public goTo(target: ESLCarouselSlideTarget, params: ESLCarouselActionParams = {}): void {\n    if (!this.renderer) return;\n    const {index, dir} = toIndex(target, this.state);\n    const direction = params.direction || dir || 'next';\n    this.renderer.navigate(index, direction, params);\n  }\n\n  /** @returns side by index (supports not normalized indexes) */\n  public slideAt(index: number): ESLCarouselSlide {\n    return this.$slides[normalizeIndex(index, this.$slides.length)];\n  }\n\n  /** @returns if the passed slide target can be reached */\n  public canNavigate(target: ESLCarouselSlideTarget): boolean {\n    return canNavigate(target, this.state);\n  }\n\n  /**\n   * Registers component in the {@link customElements} registry\n   * @param tagName - custom tag name to register custom element\n   */\n  public static override register(tagName?: string): void {\n    ESLCarouselSlide.register((tagName || ESLCarousel.is) + '-slide');\n    customElements.whenDefined(ESLCarouselSlide.is).then(() => super.register.call(this, tagName));\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {}\n  export interface ESLLibrary {\n    Carousel: typeof ESLCarousel & ESLCarouselNS;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel': ESLCarousel;\n    'esl-carousel-slide': ESLCarouselSlide;\n  }\n}\n","import type {ESLCarouselDirection, ESLCarouselNavIndex, ESLCarouselSlideTarget, ESLCarouselState} from './esl-carousel.nav.types';\n\n/** @returns bounded slide index in bounds of [0, count] range */\nexport function boundIndex(value: number, max: number): number {\n  return Math.max(0, Math.min(max, value));\n}\n\n/** @returns normalized slide index in bounds of [0, count] range */\nexport function normalizeIndex(index: number, size: number): number {\n  return (size + (index % size)) % size;\n}\n\n/** Gets count of slides between active and passed considering given direction. */\nexport function getDistance(from: number, direction: ESLCarouselDirection, {activeIndex, size}: ESLCarouselState): number {\n  if (direction === 'prev') return normalizeIndex(activeIndex - from, size);\n  if (direction === 'next') return normalizeIndex(from - activeIndex, size);\n  return 0;\n}\n\n/** @returns closest direction to move from slide `from` to slide `to` */\nexport function calcDirection(from: number, to: number, size: number): ESLCarouselDirection {\n  const abs = Math.abs(from - to) % size;\n  if (to > from) {\n    return abs > size - abs ? 'prev' : 'next';\n  } else {\n    return abs > size - abs ? 'next' : 'prev';\n  }\n}\n\n/** @returns normalized numeric index from group index */\nexport function groupToIndex(group: number, count: number, size: number): number {\n  const groupCount = Math.ceil(size / count);\n  const value = normalizeIndex(group, groupCount);\n  const index = value + 1 === groupCount ? size - count : count * value;\n  return normalizeIndex(index, size);\n}\n\n/** @returns numeric group index from slide index */\nexport function indexToGroup(index: number, count: number, size: number): number {\n  const value = normalizeIndex(index, size);\n  const groupCount = Math.ceil(size / count);\n  const firstGroupIndex = value + count >= size ? groupCount - 1 : Math.floor(value / count);\n  const secondGroupIndex = (firstGroupIndex + 1) % groupCount;\n  // candidate groups have common slides\n  const isGroupIntersected = size - count + 1 < value + count && value + count <= size;\n  const commonCount = isGroupIntersected ? groupCount * count - size : 0;\n  const firstGroupCount = Math.min(size, (firstGroupIndex + 1) * count) - value;\n  const secondGroupCount = count - firstGroupCount + commonCount;\n  return (firstGroupCount >= secondGroupCount) ? firstGroupIndex : secondGroupIndex;\n}\n\nexport function indexToDirection(index: number, {activeIndex, size, loop}: ESLCarouselState): ESLCarouselDirection | null {\n  if (loop) return calcDirection(activeIndex, index, size);\n  if (activeIndex < index) return 'next';\n  if (activeIndex > index) return 'prev';\n  return null;\n}\n\nfunction splitTarget(target: string): {index: string, type: string} {\n  // Sanitize value\n  target = String(target).replace(/\\s/, '');\n  // Normalize shortcuts\n  target = target.includes(':') ? target : `slide:${target}`;\n  // Split type and index part\n  const [type, index] = String(target).split(':');\n  return {type, index};\n}\n\n/** Parse index value defining its value and type (absolute|relative)*/\nfunction parseIndex(index: string | ESLCarouselNavIndex): {value: number, isRelative: boolean, dir?: ESLCarouselDirection} {\n  if (typeof index === 'number') return {value: index, isRelative: false};\n  index = index.trim();\n  if (index === 'next') return {value: 1, isRelative: true, dir: 'next'};\n  if (index === 'prev') return {value: -1, isRelative: true, dir: 'prev'};\n  if (index[0] === '+') return {value: +index, isRelative: true, dir: 'next'};\n  if (index[0] === '-') return {value: +index, isRelative: true, dir: 'prev'};\n  return {value: +index, isRelative: false};\n}\n\n/** @returns normalized numeric index from string with absolute or relative index */\nfunction resolveSlideIndex(indexStr: string | ESLCarouselNavIndex, cfg: ESLCarouselState): {index: number, dir: ESLCarouselDirection | null} {\n  const {value, isRelative, dir} = parseIndex(indexStr);\n  const target = value + (isRelative ? cfg.activeIndex : 0);\n  const index = cfg.loop ? normalizeIndex(target, cfg.size) : boundIndex(target, cfg.size - cfg.count);\n  return {index, dir: dir || indexToDirection(index, cfg)};\n}\n\n/** @returns normalized numeric index from string with absolute or relative group index */\nfunction resolveGroupIndex(indexStr: string | ESLCarouselNavIndex, cfg: ESLCarouselState): {index: number, dir: ESLCarouselDirection | null} {\n  const {value, isRelative, dir} = parseIndex(indexStr);\n  if (!isRelative) {\n    const index = groupToIndex(value, cfg.count, cfg.size);\n    return {index, dir: indexToDirection(index, cfg)};\n  }\n  // TODO: extend navigation boundaries\n  if (value === -1 && cfg.activeIndex < cfg.count && cfg.activeIndex > 0) {\n    return {index: 0, dir: dir || 'prev'};\n  }\n  if (value === 1 && normalizeIndex(cfg.activeIndex + cfg.count, cfg.size) > cfg.size - cfg.count) {\n    return {index: cfg.size - cfg.count, dir: dir || 'next'};\n  }\n  const index = normalizeIndex(cfg.activeIndex + value * cfg.count, cfg.size);\n  return {index, dir: dir || indexToDirection(index, cfg)};\n}\n\n/** @returns normalized index from target definition and current state */\nexport function toIndex(target: ESLCarouselSlideTarget, cfg: ESLCarouselState): {index: number, dir: ESLCarouselDirection | null} {\n  if (typeof target === 'number') {\n    const index = cfg.loop ? normalizeIndex(target, cfg.size) : boundIndex(target, cfg.size - cfg.count);\n    return {index, dir: indexToDirection(index, cfg)};\n  }\n  const {type, index} = splitTarget(target);\n  if (type === 'group') return resolveGroupIndex(index, cfg);\n  if (type === 'slide') return resolveSlideIndex(index, cfg);\n  return {index: cfg.activeIndex, dir: null};\n}\n\nexport function canNavigate(target: ESLCarouselSlideTarget, cfg: ESLCarouselState): boolean {\n  const {dir, index} = toIndex(target, cfg);\n  if (!cfg.loop && index > cfg.activeIndex && dir === 'prev') return false;\n  if (!cfg.loop && index < cfg.activeIndex && dir === 'next') return false;\n  return !!dir && index !== cfg.activeIndex;\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr, bind, listen} from '../../../esl-utils/decorators';\n\nimport {ESLCarouselPlugin} from '../esl-carousel.plugin';\nimport {ESLCarouselSlideEvent} from '../../core/esl-carousel.events';\n\n/**\n * {@link ESLCarousel} auto-play (auto-advance) plugin mixin\n * Automatically switch slides by timeout\n *\n * @author Alexey Stsefanovich (ala'n)\n */\n@ExportNs('Carousel.Autoplay')\nexport class ESLCarouselAutoplayMixin extends ESLCarouselPlugin {\n  public static override is = 'esl-carousel-autoplay';\n\n  /** Timeout to send next command to the host carousel */\n  @attr({defaultValue: '5000', name: ESLCarouselAutoplayMixin.is})\n  public timeout: number;\n\n  /** Navigation command to send to the host carousel. Default: 'slide:next' */\n  @attr({defaultValue: 'slide:next', name: ESLCarouselAutoplayMixin.is + '-command'})\n  public command: string;\n\n  private _timeout: number | null = null;\n\n  protected override connectedCallback(): void {\n    if (super.connectedCallback()) {\n      this.start();\n    }\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.stop();\n  }\n\n  protected override attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    this.start();\n  }\n\n  /** Activates the timer to send commands */\n  public start(): void {\n    this.stop();\n    this._timeout = window.setTimeout(this._onInterval, this.timeout);\n  }\n\n  /** Deactivates the timer to send commands */\n  public stop(): void {\n    if (typeof this._timeout === 'number') {\n      window.clearTimeout(this._timeout);\n    }\n  }\n\n  /** Handles next timer interval */\n  @bind\n  protected _onInterval(): void {\n    this.$host?.goTo(this.command);\n    this._timeout = window.setTimeout(this._onInterval, this.timeout);\n  }\n\n  /** Handles auxiliary events to pause/resume timer */\n  @listen(`mouseout mouseover focusin focusout ${ESLCarouselSlideEvent.AFTER}`)\n  protected _onInteract(e: Event): void {\n    if (['mouseover', 'focusin'].includes(e.type)) {\n      this.stop();\n    } else {\n      this.start();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    Autoplay: typeof ESLCarouselAutoplayMixin;\n  }\n}\n","import {ESLMixinElement} from '../../esl-mixin-element/ui/esl-mixin-element';\nimport {ESLCarousel} from '../core/esl-carousel';\n\n/** Base mixin plugin of {@link ESLCarousel} */\nexport abstract class ESLCarouselPlugin extends ESLMixinElement {\n  /** {@link ESLCarousel} host instance */\n  public override $host: ESLCarousel;\n\n  protected override connectedCallback(): boolean | void {\n    const {$host} = this;\n    if (($host as unknown) instanceof ESLCarousel) {\n      super.connectedCallback();\n      return true;\n    } else {\n      const {is} = this.constructor as typeof ESLCarouselPlugin;\n      console.error('[ESL]: %o is not correct target for %o', $host, is);\n      this.$host.removeAttribute(is);\n      return false;\n    }\n  }\n\n  public static override register(): void {\n    ESLCarousel.registered.then(() => super.register());\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nimport {ESLCarouselPlugin} from '../esl-carousel.plugin';\nimport {attr, listen} from '../../../esl-utils/decorators';\nimport {ARROW_LEFT, ARROW_RIGHT} from '../../../esl-utils/dom/keys';\n\n/**\n * {@link ESLCarousel} Keyboard arrow support\n *\n * @author Alexey Stsefanovich (ala'n)\n */\n@ExportNs('Carousel.Keyboard')\nexport class ESLCarouselKeyboardMixin extends ESLCarouselPlugin {\n  public static override is = 'esl-carousel-keyboard';\n\n  /** Prefix to request next/prev navigation */\n  @attr({defaultValue: 'slide', name: ESLCarouselKeyboardMixin.is}) public type: 'slide' | 'group';\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (ARROW_LEFT === event.key) {\n      this.$host.goTo(`${this.type}:prev`);\n    }\n    if (ARROW_RIGHT === event.key) {\n      this.$host.goTo(`${this.type}:next`);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    Keyboard: typeof ESLCarouselKeyboardMixin;\n  }\n}\n","// TODO: rework, simplify and refactor\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr, listen, memoize} from '../../../esl-utils/decorators';\nimport {ARROW_LEFT, ARROW_RIGHT} from '../../../esl-utils/dom/keys';\nimport {findNextLooped, findPrevLooped} from '../../../esl-utils/dom/traversing';\nimport {ESLBaseElement} from '../../../esl-base-element/core';\nimport {ESLTraversingQuery} from '../../../esl-traversing-query/core';\n\nimport {indexToGroup} from '../../core/nav/esl-carousel.nav.utils';\nimport {ESLCarouselChangeEvent, ESLCarouselSlideEvent} from '../../core/esl-carousel.events';\n\nimport type {ESLCarousel} from '../../core/esl-carousel';\n\n/**\n * {@link ESLCarousel} Dots navigation element\n * @author Julia Murashko\n *\n * Example:\n * ```\n * <esl-carousel-dots></esl-carousel-dots>\n * ```\n */\n@ExportNs('Carousel.Dots')\nexport class ESLCarouselNavDots extends ESLBaseElement {\n  public static override is = 'esl-carousel-dots';\n\n  /** {@link ESLTraversingQuery} string to find {@link ESLCarousel} instance */\n  @attr({\n    defaultValue: '::parent([esl-carousel-container])::find(esl-carousel)'\n  })\n  public carousel: string;\n\n  /** @returns ESLCarousel instance; based on {@link carousel} attribute */\n  @memoize()\n  public get $carousel(): ESLCarousel | null {\n    return ESLTraversingQuery.first(this.carousel, this) as ESLCarousel;\n  }\n\n  public override async connectedCallback(): Promise<void> {\n    this.$$attr('disabled', true);\n    if (!this.$carousel) return;\n    await customElements.whenDefined(this.$carousel.tagName.toLowerCase());\n    super.connectedCallback();\n    this.rerender();\n    this.updateA11y();\n  }\n\n  public override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    memoize.clear(this, '$carousel');\n  }\n\n  /** Renders dots according to the carousel state. */\n  public rerender(): void {\n    if (!this.$carousel) return;\n    const {activeIndex, count, size} = this.$carousel.state;\n    this.$$attr('disabled', size < 2);\n    let html = '';\n    const activeDot = indexToGroup(activeIndex, count, size);\n    for (let i = 0; i < Math.ceil(size / count); ++i) {\n      html += this.buildDot(i, i === activeDot);\n    }\n    this.innerHTML = html;\n  }\n\n  /** Builds content of dots. */\n  public buildDot(index: number, isActive: boolean): string {\n    return `<button role=\"button\"\n                aria-label=\"Show group ${index  + 1}\"\n                aria-disabled=\"${isActive}\"\n                data-nav-target=\"group:${index}\"\n                class=\"carousel-dot ${isActive ? 'active-dot' : ''}\"\n                aria-current=\"${isActive ? 'true' : 'false'}\"></button>`;\n  }\n\n  protected updateA11y(): void {\n    this.setAttribute('role', 'group');\n    if (!this.hasAttribute('aria-label')) {\n      this.setAttribute('aria-label', 'Carousel dots');\n    }\n  }\n\n  /** Handles carousel state changes */\n  @listen({\n    event: `${ESLCarouselSlideEvent.AFTER} ${ESLCarouselChangeEvent.TYPE}`,\n    target: ($el: ESLCarouselNavDots) => $el.$carousel\n  })\n  protected _onSlideChange(e: Event): void {\n    if (this.$carousel !== e.target) return;\n    this.rerender();\n  }\n\n  /** Handles `click` on the dots */\n  @listen('click')\n  protected _onClick(event: PointerEvent): void {\n    if (!this.$carousel || typeof this.$carousel.goTo !== 'function') return;\n    const $target = (event.target as Element).closest('[data-nav-target]');\n    if (!$target) return;\n    this.$carousel.goTo($target.getAttribute('data-nav-target')!);\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    const $eventTarget: HTMLElement = event.target as HTMLElement;\n    if (ARROW_LEFT === event.key) {\n      const $nextDot = findPrevLooped($eventTarget, '.carousel-dot') as HTMLElement;\n      $nextDot.click();\n    }\n    if (ARROW_RIGHT === event.key) {\n      const $nextDot = findNextLooped($eventTarget, '.carousel-dot') as HTMLElement;\n      $nextDot.click();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    Dots: typeof ESLCarouselNavDots;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-carousel-dots': ESLCarouselNavDots;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr, listen, memoize} from '../../../esl-utils/decorators';\nimport {ESLMixinElement} from '../../../esl-mixin-element/core';\nimport {ESLTraversingQuery} from '../../../esl-traversing-query/core';\n\nimport {ESLCarouselChangeEvent, ESLCarouselSlideEvent} from '../../core/esl-carousel.events';\n\nimport type {ESLCarousel} from '../../core/esl-carousel';\nimport type {ESLCarouselSlideTarget} from '../../core/nav/esl-carousel.nav.types';\n\n/**\n * ESLCarousel navigation helper to define triggers for carousel navigation.\n *\n * Example:\n * ```\n * <div esl-carousel-container>\n *  <button esl-carousel-nav=\"group:prev\">Prev</button>\n *  <esl-carousel>...</esl-carousel>\n *  <button esl-carousel-nav=\"group:next\">Next</button>\n * </div>\n * ```\n */\n@ExportNs('Carousel.Nav')\nexport class ESLCarouselNavMixin extends ESLMixinElement {\n  static override is = 'esl-carousel-nav';\n\n  /** {@link ESLCarouselSlideTarget} target to navigate in carousel */\n  @attr({name: ESLCarouselNavMixin.is}) public target: ESLCarouselSlideTarget;\n\n  /** {@link ESLTraversingQuery} string to find {@link ESLCarousel} instance */\n  @attr({\n    name: ESLCarouselNavMixin.is + '-target',\n    defaultValue: '::parent([esl-carousel-container])::find(esl-carousel)'\n  })\n  public carousel: string;\n\n  /** @returns ESLCarousel instance; based on {@link carousel} attribute */\n  @memoize()\n  public get $carousel(): ESLCarousel | null {\n    return ESLTraversingQuery.first(this.carousel, this.$host) as ESLCarousel;\n  }\n\n  public override async connectedCallback(): Promise<void> {\n    this.$$attr('disabled', true);\n    if (!this.$carousel) return;\n    await customElements.whenDefined(this.$carousel.tagName.toLowerCase());\n    super.connectedCallback();\n    this._onSlideChange();\n  }\n\n  public override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    memoize.clear(this, '$carousel');\n  }\n\n  /** Handles carousel state changes */\n  @listen({\n    event: `${ESLCarouselSlideEvent.AFTER} ${ESLCarouselChangeEvent.TYPE}`,\n    target: ($nav: ESLCarouselNavMixin) => $nav.$carousel\n  })\n  protected _onSlideChange(): void {\n    const canNavigate = this.$carousel && this.$carousel.canNavigate(this.target);\n    this.$$attr('disabled', !canNavigate);\n  }\n\n  /** Handles nat target clicks */\n  @listen('click')\n  protected _onClick(e: PointerEvent): void {\n    if (!this.$carousel || typeof this.$carousel.goTo !== 'function') return;\n    this.$carousel.goTo(this.target);\n    e.preventDefault();\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    Nav: typeof ESLCarouselNavMixin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr, listen, memoize} from '../../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../../esl-traversing-query/core';\n\nimport {ESLCarousel} from '../../core/esl-carousel';\nimport {ESLCarouselPlugin} from '../esl-carousel.plugin';\nimport {ESLCarouselSlideEvent} from '../../core/esl-carousel.events';\n\n/**\n * Slide Carousel Link plugin mixin to bind carousel positions\n */\n@ExportNs('Carousel.RelateTo')\nexport class ESLCarouselRelateToMixin extends ESLCarouselPlugin {\n  public static override is = 'esl-carousel-relate-to';\n\n  @attr({name: ESLCarouselRelateToMixin.is})\n  public target: string;\n\n  /** @returns ESLCarousel target to share state changes */\n  @memoize()\n  public get $target(): ESLCarousel | null {\n    const $target = ESLTraversingQuery.first(this.target);\n    return ($target instanceof ESLCarousel) ? $target : null;\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    memoize.clear(this, '$target');\n  }\n\n  /** Handles event that fires when the carousel slides state is changed. */\n  @listen(ESLCarouselSlideEvent.AFTER)\n  protected _onSlideChange(e: ESLCarouselSlideEvent): void {\n    if (!this.$target) return;\n    if (e.activator !== this) {\n      this.$target.goTo(this.$host.activeIndex, {\n        activator: this\n      });\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    RelateTo: typeof ESLCarouselRelateToMixin;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {attr, prop, listen} from '../../../esl-utils/decorators';\nimport {getTouchPoint, isMouseEvent, isTouchEvent} from '../../../esl-utils/dom';\nimport {ESLMediaQuery} from '../../../esl-media-query/core';\n\nimport {ESLCarouselPlugin} from '../esl-carousel.plugin';\n\nimport type {Point} from '../../../esl-utils/dom/events';\n\n\n/**\n * {@link ESLCarousel} Touch handler mixin\n *\n * Usage:\n * ```\n * <esl-carousel esl-carousel-touch=\"all\"></esl-carousel>\n *\n * <esl-carousel esl-carousel-touch=\"@mobile\"></esl-carousel>\n * ```\n */\n@ExportNs('Carousel.Touch')\nexport class ESLCarouselTouchMixin extends ESLCarouselPlugin {\n  public static override is = 'esl-carousel-touch';\n\n  /** Min distance in pixels to activate drugging mode */\n  @prop(5) public tolerance: number;\n\n  /** {@link ESLMediaQuery} condition to have touch support active */\n  @attr({name: ESLCarouselTouchMixin.is}) public media: string;\n\n  /** Point to start from */\n  protected startPoint: Point = {x: 0, y: 0};\n  /** Marker whether touch event is started */\n  protected isTouchStarted = false;\n\n  /** @returns marker whether the event should be ignored. */\n  protected isIgnoredEvent(event: TouchEvent | PointerEvent | MouseEvent): boolean | undefined {\n    // No nav required\n    if (this.$host.size <= this.$host.config.count) return true;\n    // Check for media condition\n    if (!ESLMediaQuery.for(this.media).matches) return true;\n    // Multi-touch gesture\n    if (isTouchEvent(event) && event.touches.length !== 1) return true;\n    // Non-primary mouse button initiate drug event\n    if (isMouseEvent(event) && event.button !== 0) return true;\n    // Check for form target\n    return !!(event.target as HTMLElement).closest('input, textarea, [editable]');\n  }\n\n  /** Handles `mousedown` / `touchstart` event to manage thumb drag start and scroll clicks */\n  @listen('mousedown touchstart')\n  protected _onPointerDown(event: MouseEvent | TouchEvent): void {\n    if (this.isTouchStarted || !this.$host.renderer || this.$host.animating) return;\n\n    this.isTouchStarted = !this.isIgnoredEvent(event);\n    if (!this.isTouchStarted) return;\n\n    this.startPoint = getTouchPoint(event);\n\n    isMouseEvent(event) && this.$$on({event: 'mousemove', target: window}, this._onPointerMove);\n    isMouseEvent(event) && this.$$on({event: 'mouseup', target: window}, this._onPointerUp);\n    isTouchEvent(event) && this.$$on({event: 'touchmove', target: window}, this._onPointerMove);\n    isTouchEvent(event) && this.$$on({event: 'touchend', target: window}, this._onPointerUp);\n  }\n\n  /** Processes `mousemove` and `touchmove` events. */\n  protected _onPointerMove(event: TouchEvent | PointerEvent | MouseEvent): void {\n    if (!this.isTouchStarted) return;\n    const point = getTouchPoint(event);\n    const offset = point.x - this.startPoint.x;\n\n    if (!this.$host.hasAttribute('dragging')) {\n      if (Math.abs(offset) < this.tolerance) return;\n      this.$$attr('dragging', true);\n    }\n\n    event.preventDefault();\n    // ignore single click\n    offset !== 0 && this.$host.renderer.onMove(offset);\n  }\n\n  /** Processes `mouseup` and `touchend` events. */\n  protected _onPointerUp(event: TouchEvent | PointerEvent | MouseEvent): void {\n    // Unbinds drag listeners\n    this.$$off(this._onPointerMove);\n    this.$$off(this._onPointerUp);\n\n    this.isTouchStarted = false;\n\n    if (this.$$attr('dragging', false) !== null) {\n      event.preventDefault();\n      const point = getTouchPoint(event);\n      const offset = point.x - this.startPoint.x;\n      // ignore single click\n      offset !== 0 && this.$host.renderer.commit(offset);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLCarouselNS {\n    Touch: typeof ESLCarouselTouchMixin;\n  }\n}\n","import {promisifyEvent, promisifyTransition, resolvePromise} from '../../../esl-utils/async';\n\nimport {boundIndex, calcDirection, normalizeIndex} from '../../core/nav/esl-carousel.nav.utils';\nimport {ESLCarouselRenderer} from '../../core/esl-carousel.renderer';\nimport {ESLCarouselSlideEvent} from '../../core/esl-carousel.events';\n\nimport type {ESLCarouselDirection} from '../../core/nav/esl-carousel.nav.types';\n\n@ESLCarouselRenderer.register\nexport class ESLMultiCarouselRenderer extends ESLCarouselRenderer {\n  public static override is = 'multi';\n\n  /** Slides gap width */\n  protected gapWidth: number = 0;\n  /** Slide width cached value */\n  protected slideWidth: number = 0;\n  /** First index of active slides. */\n  protected currentIndex: number = 0;\n\n  /**\n   * Processes binding of defined renderer to the carousel {@link ESLCarousel}.\n   * Prepare to renderer animation.\n   */\n  public override onBind(): void {\n    this.currentIndex = this.carousel.activeIndex;\n    this.redraw();\n  }\n\n  public override redraw(): void {\n    this.resize();\n    this.reindex();\n    this.setActive(this.currentIndex);\n  }\n\n  /**\n   * Processes unbinding of defined renderer from the carousel {@link ESLCarousel}.\n   * Clear animation.\n   */\n  public override onUnbind(): void {\n    this.carousel.$slides.forEach((el) => {\n      el.toggleAttribute('visible', false);\n      el.style.removeProperty('order');\n      el.style.removeProperty('width');\n    });\n    this.$area.style.removeProperty('transform');\n    this.$area.style.transform = 'translate3d(0px, 0px, 0px)';\n    this.carousel.toggleAttribute('animating', false);\n  }\n\n  /** Pre-processing animation action. */\n  public async onBeforeAnimate(): Promise<void> {\n    if (this.carousel.hasAttribute('animating')) return Promise.reject('Already animating');\n    this.carousel.$slides.forEach((el) => el.toggleAttribute('visible', true));\n    return Promise.resolve();\n  }\n\n  /** Processes animation. */\n  public async onAnimate(nextIndex: number, direction: ESLCarouselDirection): Promise<void> {\n    const {activeIndex, $slidesArea} =  this.carousel;\n    this.currentIndex = activeIndex;\n    if (!$slidesArea) return;\n    while (this.currentIndex !== nextIndex) {\n      await this.onBeforeStepAnimate(direction);\n      await this.onAfterStepAnimate(direction);\n    }\n  }\n\n  /** Post-processing animation action. */\n  public async onAfterAnimate(): Promise<void> {\n    this.$area.style.transform = 'translate3d(0px, 0px, 0px)';\n    this.carousel.$slides.forEach((el) => el.removeAttribute('visible'));\n    return Promise.resolve();\n  }\n\n  /** Pre-processing the transition animation of one slide. */\n  protected async onBeforeStepAnimate(direction: ESLCarouselDirection): Promise<void> {\n    const orderIndex = direction === 'next' ? this.currentIndex : normalizeIndex(this.currentIndex - 1, this.size);\n    this.reindex(orderIndex);\n\n    // TODO: reflow\n    const offsetIndex = direction === 'next' ? normalizeIndex(this.currentIndex + 1, this.size) : this.currentIndex;\n    const offset = this.carousel.$slides[offsetIndex].offsetLeft;\n    const shiftXBefore = direction === 'next' ? 0 : -offset;\n    this.$area.style.transform = `translate3d(${shiftXBefore}px, 0px, 0px)`;\n\n    +this.carousel.offsetLeft;\n    this.carousel.toggleAttribute('animating', true);\n\n    const shiftXAfter = direction === 'next' ? -offset : 0;\n    this.$area.style.transform = `translate3d(${shiftXAfter}px, 0px, 0px)`;\n\n    return promisifyTransition(this.$area, 'transform');\n  }\n\n  /** Post-processing the transition animation of one slide. */\n  protected async onAfterStepAnimate(direction: ESLCarouselDirection): Promise<void> {\n    // TODO: onAfterAnimate\n    this.$area.style.transform = 'translate3d(0px, 0px, 0px)';\n\n    this.currentIndex = direction === 'next' ? this.currentIndex + 1 : this.currentIndex - 1;\n    this.currentIndex = normalizeIndex(this.currentIndex, this.size);\n\n    this.reindex(this.currentIndex);\n\n    this.carousel.toggleAttribute('animating', false);\n    +this.carousel.offsetLeft;\n    return Promise.resolve();\n  }\n\n  /** Handles the slides transition. */\n  public onMove(offset: number): void {\n    this.carousel.$slides.forEach((el) => el.toggleAttribute('visible', true));\n\n    const sign = offset < 0 ? 1 : -1;\n    const slideWidth = this.slideWidth + this.gapWidth;\n    const count = Math.floor(Math.abs(offset) / slideWidth);\n    const currentIndex = normalizeIndex(this.carousel.activeIndex + count * sign, this.size);\n\n    if (!this._checkNonLoop(offset)) return;\n\n    const orderIndex = offset < 0 ? currentIndex : normalizeIndex(currentIndex - 1, this.size);\n    this.reindex(orderIndex);\n    this.currentIndex = currentIndex;\n\n    const stageOffset = offset < 0 ? offset + count * slideWidth : offset - (count + 1) * slideWidth;\n    this.$area.style.transform = `translateX(${stageOffset}px)`;\n  }\n\n  protected _checkNonLoop(offset: number): boolean {\n    const sign = offset < 0 ? 1 : -1;\n    const count = Math.floor(Math.abs(offset) / (this.slideWidth + this.gapWidth));\n    const nextIndex = this.carousel.activeIndex + count * sign;\n    const currentIndex = normalizeIndex(this.carousel.activeIndex + count * sign, this.size);\n\n    if (this.loop) return true;\n    // check non-loop state\n    if (nextIndex >= this.carousel.size || nextIndex < 0) return false;\n    // check left border of non-loop state\n    if (offset > 0 && currentIndex - 1 < 0) return false;\n    // check right border of non-loop state\n    return !(offset < 0 && currentIndex + 1 + this.count > this.carousel.size);\n  }\n\n  /** Ends current transition and make permanent all changes performed in the transition. */\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  public async commit(offset: number): Promise<void> {\n    const activeIndex = this.carousel.activeIndex;\n    const achieveBorders = this._checkNonLoop(offset);\n    if (achieveBorders) {\n      const slideWidth = this.slideWidth + this.gapWidth;\n      // calculate offset to move to\n      const shiftCount = Math.abs(offset) % slideWidth >= slideWidth / 4 ? 1 : 0;\n      const stageOffset = offset < 0 ? -shiftCount * slideWidth : (shiftCount - 1) * slideWidth - this.gapWidth;\n\n      this.carousel.toggleAttribute('animating', true);\n      this.$area.style.transform = `translateX(${stageOffset}px)`;\n      await promisifyEvent(this.$area, 'transitionend').catch(resolvePromise);\n    }\n\n    // clear animation\n    this.carousel.toggleAttribute('animating', false);\n    this.$area.style.transform = 'translateX(0)';\n    this.carousel.$slides.forEach((el) => el.toggleAttribute('visible', false));\n\n    const sign = offset < 0 ? 1 : -1;\n    const count = Math.abs(offset) % this.slideWidth >= this.slideWidth / 4 ?\n      Math.ceil(Math.abs(offset) / this.slideWidth) : Math.floor(Math.abs(offset) / this.slideWidth);\n    const nextIndex = this.carousel.activeIndex + count * sign;\n\n    if (this.loop) {\n      this.currentIndex = normalizeIndex(nextIndex, this.size);\n    } else {\n      this.currentIndex = boundIndex(nextIndex, this.size - this.count);\n    }\n\n    let direction: ESLCarouselDirection = offset > 0 ? 'prev' : 'next';\n    direction = direction || calcDirection(this.carousel.activeIndex, this.currentIndex, this.size);\n    this.reindex(this.currentIndex);\n\n    this.setActive(this.currentIndex);\n\n    if (activeIndex !== this.currentIndex) {\n      this.carousel.dispatchEvent(ESLCarouselSlideEvent.create('AFTER', {\n        direction,\n        current: this.currentIndex,\n        related: activeIndex\n      }));\n    }\n  }\n\n  /** Sets order style property for slides starting at index */\n  protected resize(): void {\n    const {$slides, $slidesArea} = this.carousel;\n    if (!$slidesArea || !$slides.length) return;\n    const slidesAreaStyles = getComputedStyle($slidesArea);\n    const width = parseFloat(slidesAreaStyles.width);\n    this.gapWidth = parseFloat(slidesAreaStyles.columnGap);\n    this.slideWidth = (width - this.gapWidth * (this.count - 1)) / this.count;\n    $slides.forEach((slide) => slide.style.minWidth = this.slideWidth + 'px');\n  }\n\n  /** Sets order style property for slides starting at index */\n  protected reindex(index: number = this.currentIndex): void {\n    if (index < 0 || index > this.carousel.size) return;\n    const {size, $slides} = this.carousel;\n    if (!$slides.length) return;\n    for (let i = 0; i < size; ++i) {\n      $slides[i].style.order = String((size + i - index) % size);\n    }\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {dispatchCustomEvent} from '../../esl-utils/dom/events/misc';\nimport {ESLEventListener} from './listener';\nimport {getAutoDescriptors, isEventDescriptor, initDescriptor} from './descriptors';\n\nimport type {\n  ESLListenerHandler,\n  ESLListenerCriteria,\n  ESLListenerDescriptor,\n  ESLListenerDescriptorFn\n} from './types';\n\n@ExportNs('EventUtils')\nexport class ESLEventUtils {\n  /**\n   * Dispatches custom event. Alias for {@link dispatchCustomEvent}\n   * @see dispatchCustomEvent\n   */\n  public static dispatch = dispatchCustomEvent;\n\n  /** @deprecated alias for {@link getAutoDescriptors} */\n  public static descriptors = getAutoDescriptors;\n\n  /** Gets {@link ESLListenerDescriptorFn}s of the passed object */\n  public static getAutoDescriptors = getAutoDescriptors;\n\n  /**\n   * Decorates passed `key` of the `host` as an {@link ESLListenerDescriptorFn} using `desc` meta information\n   * @param host - object holder of the function to decorate\n   * @param key - string key of the function in holder object\n   * @param desc - descriptor meta information to assign\n   * @returns ESLListenerDescriptorFn created on the host\n   */\n  public static initDescriptor = initDescriptor;\n\n  /** Type guard to check if the passed function is typeof {@link ESLListenerDescriptorFn} */\n  public static isEventDescriptor = isEventDescriptor;\n\n  /**\n   * Gets currently subscribed listeners of the host\n   * @param host - host object (listeners context) to associate subscription\n   * @param criteria - optional set of criteria {@link ESLListenerCriteria} to filter listeners list\n   */\n  public static listeners(host: object, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventListener.get(host, ...criteria);\n  }\n\n  /**\n   * Subscribes all auto descriptors of the host\n   * @param host - host object (listeners context) to find descriptors and associate subscription\n   * */\n  public static subscribe(host: object): ESLEventListener[];\n  /**\n   * Subscribes decorated as an {@link ESLListenerDescriptorFn} `handler` function\n   * @param host - host object (listeners context) to associate subscription\n   * @param handler - handler function decorated as {@link ESLListenerDescriptorFn}\n   */\n  public static subscribe(host: object, handler: ESLListenerHandler): ESLEventListener[];\n  /**\n   * Subscribes `handler` function with the passed event type or {@link ESLListenerDescriptor} with event type declared\n   * @param host - host object (listeners context) to associate subscription\n   * @param descriptor - event or {@link ESLListenerDescriptor} with defined event type\n   * @param handler - handler function to subscribe\n   */\n  public static subscribe<EType extends keyof ESLListenerEventMap>(\n    host: object,\n    descriptor: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  /**\n   * Subscribes `handler` function decorated with {@link ESLListenerDescriptorFn} with the passed additional {@link ESLListenerDescriptor} data\n   * @param host - host object (listeners context) to associate subscription\n   * @param descriptor - {@link ESLListenerDescriptor} additional data\n   * @param handler - handler function decorated as {@link ESLListenerDescriptorFn}\n   */\n  public static subscribe<EType extends keyof ESLListenerEventMap>(\n    host: object,\n    descriptor: Partial<ESLListenerDescriptor>,\n    handler: ESLListenerDescriptorFn<EType>\n  ): ESLEventListener[];\n  public static subscribe(\n    host: object,\n    eventDesc?: string | Partial<ESLListenerDescriptor> | ESLListenerHandler,\n    handler: ESLListenerHandler = eventDesc as ESLListenerDescriptorFn\n  ): ESLEventListener[] {\n    if (arguments.length === 1) {\n      const descriptors = getAutoDescriptors(host);\n      // TODO: flatMap when ES5 will be out of support list\n      return descriptors.reduce(\n        (acc, desc) => acc.concat(ESLEventListener.subscribe(host, desc)),\n        [] as ESLEventListener[]\n      );\n    }\n    if (typeof eventDesc === 'string') eventDesc = {event: eventDesc};\n    const listeners = ESLEventListener.subscribe(host, handler, eventDesc as ESLListenerDescriptor);\n    if (!listeners.length) {\n      const mergedDesc = Object.assign({}, eventDesc, {handler});\n      console.warn('[ESL]: Empty subscription %o', mergedDesc);\n    }\n    return listeners;\n  }\n\n  /**\n   * Unsubscribes {@link ESLEventListener}(s) from the object\n   * @param host - host element that stores subscriptions (listeners context)\n   * @param criteria - optional set of criteria {@link ESLListenerCriteria} to filter listeners to remove\n   */\n  public static unsubscribe(host: object, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    const listeners = ESLEventListener.get(host, ...criteria);\n    listeners.forEach((listener) => listener.unsubscribe());\n    return listeners;\n  }\n}\n\n/** @deprecated alias for {@link ESLEventUtils} */\nexport const EventUtils = ESLEventUtils;\n","import {isObject} from '../../esl-utils/misc/object/types';\n\nimport type {ESLListenerDescriptorExt, ESLListenerDescriptorFn} from './types';\n\n/** Key to store listeners on the host */\nconst DESCRIPTORS = (window.Symbol || String)('__esl_descriptors');\n\n/**\n * @param host - host object\n * @returns object own descriptors keys or an empty array\n */\nfunction getOwnDescriptorsKeys(host: object): string[] {\n  return Object.hasOwnProperty.call(host, DESCRIPTORS) ? (host as any)[DESCRIPTORS] : [];\n}\n\n/**\n * Marks host own key to be auto-collectable\n * @param host - host object\n * @param key - descriptor own key\n */\nfunction addDescriptorKey(host: object, key: string): void {\n  const value = getOwnDescriptorsKeys(host);\n  if (!value.includes(key)) value.push(key);\n  Object.defineProperty(host, DESCRIPTORS, {value, configurable: true});\n}\n\n/** Collects descriptors key from the whole prototype chain */\nfunction getDescriptorsKeysFor<T extends object>(host: T): (keyof T)[] {\n  const store: Record<string, boolean> = {};\n  for (let proto = host; proto; proto = Object.getPrototypeOf(proto)) {\n    getOwnDescriptorsKeys(proto).forEach((key) => (store[key] = true));\n  }\n  return Object.keys(store) as (keyof T)[];\n}\n\n/** Type guard to check if the passed function is typeof {@link ESLListenerDescriptorFn} */\nexport function isEventDescriptor(obj: any): obj is ESLListenerDescriptorFn {\n  if (typeof obj !== 'function' || !Object.hasOwnProperty.call(obj, 'event')) return false;\n  return typeof obj.event === 'string' || typeof obj.event === 'function';\n}\n\n/** Gets {@link ESLListenerDescriptorFn}s of the passed object */\nexport function getAutoDescriptors(host: object): ESLListenerDescriptorFn[] {\n  if (!isObject(host)) return [];\n  const keys = getDescriptorsKeysFor(host);\n  const values = keys.map((key) => host[key]);\n  return values.filter((desc: ESLListenerDescriptorFn) => isEventDescriptor(desc) && desc.auto === true);\n}\n\n/**\n * Decorates passed `key` of the `host` as an {@link ESLListenerDescriptorFn} using `desc` meta information\n * @param host - object holder of the function to decorate\n * @param key - string key of the function in holder object\n * @param desc - descriptor meta information to assign\n * @returns ESLListenerDescriptorFn created on the host\n */\nexport function initDescriptor<T extends object>(\n  host: T,\n  key: keyof T & string,\n  desc: ESLListenerDescriptorExt\n): ESLListenerDescriptorFn {\n  const fn = host[key];\n  if (typeof fn !== 'function') throw new TypeError(`[ESL] Init Descriptor: ${key} is not a function`);\n\n  // Inherit event meta information from the prototype key\n  if (desc.inherit) {\n    const superDesc = Object.getPrototypeOf(host)[key];\n    if (!isEventDescriptor(superDesc)) throw new ReferenceError(`[ESL] Init Descriptor: no parent event descriptor found for ${key}`);\n    desc = Object.assign({auto: false}, superDesc, desc);\n  } else {\n    desc = Object.assign({auto: false}, desc);\n  }\n\n  if (desc.auto) addDescriptorKey(host, key);\n  return Object.assign(fn, desc) as ESLListenerDescriptorFn;\n}\n","import {wrap} from '../../esl-utils/misc/array';\nimport {resolveProperty} from '../../esl-utils/misc/functions';\nimport {memoize} from '../../esl-utils/decorators/memoize';\nimport {isObject} from '../../esl-utils/misc/object/types';\nimport {isSimilar} from '../../esl-utils/misc/object/compare';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {isPassiveByDefault} from '../../esl-utils/dom/events/misc';\nimport {resolveDomTarget} from '../../esl-utils/abstract/dom-target';\n\nimport type {PropertyProvider} from '../../esl-utils/misc/functions';\nimport type {\n  ESLListenerTarget,\n  ESLListenerDefinition,\n  ESLListenerDescriptor,\n  ESLListenerDescriptorFn,\n  ESLListenerHandler,\n  ESLListenerCriteria\n} from './types';\n\n/** Key to store listeners on the host */\nconst LISTENERS = (window.Symbol || String)('__esl_listeners');\n\n/**\n * Splits and deduplicates event string\n * @returns array of unique events presented in events string\n */\nexport const splitEvents = (events: string): string[] => {\n  const terms = (events || '').split(' ').map((term) => term.trim());\n  const deduplicate = new Set<string>();\n  return terms.filter((term) => {\n    if (!term || deduplicate.has(term)) return false;\n    deduplicate.add(term);\n    return true;\n  });\n};\n\n/**\n * `EventListener` instance, used as an 'inner' record to process subscriptions made by `ESLEventUtils`\n * Uses `EventListenerObject` interface to subscribe on event.\n *\n * Use Chrome console `getEventListeners` method to check subscribers details when debugging ESLEventListener subscriptions.\n * */\nexport class ESLEventListener implements ESLListenerDefinition, EventListenerObject {\n  public readonly target?: ESLListenerTarget | PropertyProvider<ESLListenerTarget>;\n  public readonly selector?: string;\n  public readonly capture?: boolean;\n\n  public readonly once?: boolean;\n  public readonly auto?: boolean;\n  public readonly passive?: boolean;\n\n  protected constructor(\n    public readonly host: object,\n    public readonly event: string,\n    public readonly handler: ESLListenerHandler,\n    desc: ESLListenerDescriptor\n  ) {\n    const defaults = {\n      capture: false,\n      passive: isPassiveByDefault(event)\n    };\n    Object.assign(this, defaults, desc, {event});\n  }\n\n  /** @returns target element to listen */\n  @memoize()\n  public get $targets(): EventTarget[] {\n    const target = resolveProperty(this.target, this.host);\n    if (isObject(target)) return wrap(target);\n    const $host = resolveDomTarget(this.host);\n    if (typeof target === 'string') return ESLTraversingQuery.all(target, $host);\n    if (typeof target === 'undefined' && $host instanceof Element) return [$host];\n    return [];\n  }\n\n  /** @returns resolved selector to check event target */\n  public get delegate(): string | undefined {\n    return resolveProperty(this.selector, this.host);\n  }\n\n  /**\n   * Checks if the passed criteria matches current event listener\n   * - `string` type criteria checked by the `event` name\n   * - `function` type criteria checked by the `handler` reference\n   * - `object` type criteria checked as descriptor using `isSimilar` comparer\n   * Note: `function` (handler) marcher has a priority over descriptor check, so handler function own properties will be ignored\n   */\n  public matches(desc?: ESLListenerCriteria): boolean {\n    if (typeof desc === 'string') return this.event === desc;\n    if (typeof desc === 'function') return this.handler === desc;\n    if (typeof desc === 'object') return isSimilar(this, desc, false);\n    return false;\n  }\n\n  /**\n   * Memoized builder for bound and decorated low level subscription.\n   * Implements DOM API {@link EventListenerObject.handleEvent}\n   */\n  @memoize()\n  public get handleEvent(): EventListener {\n    const handlerBound = this.handler.bind(this.host);\n    const handlerFull = this.once\n      ? (e: Event): void => (handlerBound(e), this.unsubscribe())\n      : handlerBound;\n    return this.selector\n      ? (e: Event): void => this.handleDelegation(e, handlerFull)\n      : handlerFull;\n  }\n\n  /** Executes handler if the passed event is accepted by the selector */\n  protected handleDelegation(e: Event, handler: EventListener): void {\n    const {delegate} = this;\n    const target = e.target;\n    const current = e.currentTarget;\n\n    if (typeof delegate !== 'string' || !delegate) return;\n    if (!(target instanceof Element) || !(current instanceof Element)) return;\n\n    const $delegate = target.closest(delegate);\n    if (current.contains($delegate)) handler(Object.assign(e, {$delegate}));\n  }\n\n  /**\n   * (Re-)Subscribes event listener instance\n   * @returns if subscription was successful\n   */\n  public subscribe(): boolean {\n    const {passive, capture} = this;\n    this.unsubscribe();\n    memoize.clear(this, '$targets');\n    memoize.clear(this, 'handleEvent');\n    if (!this.$targets.length) return false;\n    this.$targets.forEach((el: EventTarget) => el.addEventListener(this.event, this, {passive, capture}));\n    ESLEventListener.add(this.host, this);\n    return true;\n  }\n\n  /** Unsubscribes event listener instance */\n  public unsubscribe(): void {\n    const {capture} = this;\n    if (!memoize.has(this, '$targets')) return;\n    this.$targets.forEach((el: EventTarget) => el.removeEventListener(this.event, this, {capture}));\n    ESLEventListener.remove(this.host, this);\n  }\n\n  /**\n   * Gets stored listeners array the passed `host` object\n   * Supports additional filtration criteria\n   */\n  public static get(host?: object, ...criteria: ESLListenerCriteria[]): ESLEventListener[] {\n    if (!isObject(host)) return [];\n    const listeners = ((host as any)[LISTENERS] || []) as ESLEventListener[];\n    if (!criteria.length) return listeners;\n    return listeners.filter((listener) => criteria.every(listener.matches, listener));\n  }\n  /** Adds listener to the listener store of the host object */\n  protected static add(host: object, instance: ESLEventListener): void {\n    if (!isObject(host)) return;\n    if (!Object.hasOwnProperty.call(host, LISTENERS)) (host as any)[LISTENERS] = [];\n    (host as any)[LISTENERS].push(instance);\n  }\n  /** Removes listener from the listener store of the host object */\n  protected static remove(host: object, instance: ESLEventListener): void {\n    const listeners = ESLEventListener.get(host);\n    const value = listeners.filter((listener) => listener !== instance);\n    Object.defineProperty(host, LISTENERS, {value, configurable: true});\n  }\n\n  /**\n   * Subscribes `handler` function with the passed event type or {@link ESLListenerDescriptor} with event type declared\n   * @param host - host object (listeners context) to associate subscription\n   * @param handler - handler function to subscribe\n   * @param descriptor - event or {@link ESLListenerDescriptor} with defined event type\n   */\n  public static subscribe(\n    host: object,\n    handler: ESLListenerHandler | ESLListenerDescriptorFn,\n    descriptor: ESLListenerDescriptor | ESLListenerDescriptorFn = handler as ESLListenerDescriptorFn\n  ): ESLEventListener[] {\n    if (typeof handler !== 'function') return [];\n    const eventDesc = handler !== descriptor ? Object.assign({}, handler, descriptor) : descriptor;\n    const listeners = ESLEventListener.createOrResolve(host, handler, eventDesc);\n    return listeners.filter((listener) => listener.subscribe());\n  }\n\n  /** Creates or resolves existing event listeners by handler and descriptors */\n  public static createOrResolve(\n    host: object,\n    handler: ESLListenerHandler,\n    desc: ESLListenerDescriptor\n  ): ESLEventListener[] {\n    if (!isObject(host)) return [];\n    const eventString = resolveProperty(desc.event, host);\n    const listeners: ESLEventListener[] = [];\n    for (const event of splitEvents(eventString)) {\n      const subscribed = ESLEventListener.get(host, event, handler, {\n        target: desc.target,\n        selector: desc.selector,\n        capture: !!desc.capture\n      });\n      if (subscribed.length) listeners.push(...subscribed);\n      else listeners.push(new ESLEventListener(host, event, handler, desc));\n    }\n    return listeners;\n  }\n}\n","import {overrideEvent} from '../../../esl-utils/dom/events/misc';\n\nimport type {ESLResizeObserverTarget} from './resize.adapter';\n\n/** Custom event that {@link ESLResizeObserverTarget} produces */\nexport class ESLElementResizeEvent extends UIEvent implements ResizeObserverEntry {\n  /** A reference to the {@link Element} or SVGElement being observed */\n  public override readonly target: Element;\n  /** A reference to the {@link ESLResizeObserverTarget} */\n  public override readonly currentTarget: ESLResizeObserverTarget;\n\n  /**\n   * A DOMRectReadOnly object containing the new size of the observed element.\n   * Note that this is better supported than `borderBoxSize` or `contentBoxSize`,\n   * but it is left over from an earlier implementation of the Resize Observer API,\n   * is still included in the spec for web compat reasons, and may be deprecated in future versions.\n   * @see ResizeObserverEntry.prototype.contentRect\n   */\n  public readonly contentRect: DOMRectReadOnly;\n  /**\n   * An object containing the new border box size of the observed element\n   * @see ResizeObserverEntry.prototype.borderBoxSize\n   */\n  public readonly borderBoxSize: readonly ResizeObserverSize[];\n  /**\n   * An object containing the new content box size of the observed element\n   * @see ResizeObserverEntry.prototype.contentBoxSize\n   */\n  public readonly contentBoxSize: readonly ResizeObserverSize[];\n  /**\n   * An object containing the new content box size in device pixels of the observed element\n   * @see ResizeObserverEntry.prototype.devicePixelContentBoxSize\n   */\n  public readonly devicePixelContentBoxSize: readonly ResizeObserverSize[];\n\n  protected constructor(target: Element) {\n    super('resize', {bubbles: false, cancelable: false});\n    overrideEvent(this, 'target', target);\n  }\n\n  /** Creates {@link ESLElementResizeEvent} from {@link ResizeObserverEntry} */\n  public static fromEntry(entry: ResizeObserverEntry): ESLElementResizeEvent {\n    const event = new ESLElementResizeEvent(entry.target);\n    const {\n      contentRect, borderBoxSize,\n      contentBoxSize, devicePixelContentBoxSize\n    } = entry;\n    Object.assign(event, {\n      contentRect, borderBoxSize,\n      contentBoxSize, devicePixelContentBoxSize\n    });\n    return event;\n  }\n\n  // /** Creates {@link ESLElementResizeEvent} from resize {@link Event} */\n  // public static fromEvent(event: UIEvent): ESLElementResizeEvent {\n  //   // TODO: converter\n  // }\n}\n\ndeclare global {\n  /** Extended event map with the custom event definition */\n  export interface ESLListenerEventMap {\n    /** Native resize event or {@link ESLElementResizeEvent} in case {@link ESLResizeObserverTarget} */\n    'resize': UIEvent | ESLElementResizeEvent;\n  }\n}\n","import {SyntheticEventTarget} from '../../../esl-utils/dom/events/target';\nimport {resolveDomTarget} from '../../../esl-utils/abstract/dom-target';\nimport {ESLElementResizeEvent} from './resize.adapter.event';\n\nimport type {ESLDomElementTarget} from '../../../esl-utils/abstract/dom-target';\n\nexport {ESLElementResizeEvent};\n\n/** Adapter class for {@link ResizeObserver} that implements {@link EventTarget} */\nexport class ESLResizeObserverTarget extends SyntheticEventTarget {\n  /** {@link ESLResizeObserverTarget} instances holder */\n  protected static readonly mapping = new WeakMap<Element, ESLResizeObserverTarget>();\n  /** {@link ResizeObserver} instance to observe DOM element related to {@link ESLResizeObserverTarget} */\n  protected static readonly observer$$ = new ResizeObserver((changes: ResizeObserverEntry[]) =>\n    changes.forEach(this.handleChange, this)\n  );\n\n  /** Observed {@link Element} of the {@link ESLResizeObserverTarget} instance */\n  public readonly target: Element;\n\n  /** Internal method to handle {@link ResizeObserver} entry change */\n  protected static handleChange(\n    this: typeof ESLResizeObserverTarget,\n    entry: ResizeObserverEntry\n  ): void {\n    const adapter = this.mapping.get(entry.target);\n    if (!adapter) return;\n    adapter.dispatchEvent(ESLElementResizeEvent.fromEntry(entry));\n  }\n\n  /** Creates {@link ESLResizeObserverTarget} instance for the {@link ESLDomElementTarget} */\n  public static for(target: ESLDomElementTarget): ESLResizeObserverTarget {\n    return new ESLResizeObserverTarget(target);\n  }\n\n  /**\n   * Creates {@link ESLResizeObserverTarget} for the {@link ESLDomElementTarget}.\n   * Note the {@link ESLResizeObserverTarget} instances are singletons relatively to the {@link Element}\n   */\n  protected constructor(target: ESLDomElementTarget) {\n    target = resolveDomTarget(target);\n    const instance = ESLResizeObserverTarget.mapping.get(target);\n    if (instance) return instance;\n\n    super();\n    this.target = target;\n    ESLResizeObserverTarget.mapping.set(this.target, this);\n  }\n\n  /** Subscribes to the observed target {@link Element} changes */\n  public override addEventListener(callback: EventListener): void;\n  public override addEventListener(event: 'resize', callback: EventListener): void;\n  public override addEventListener(event: any, callback: EventListener = event): void {\n    if (typeof event === 'string' && event !== 'resize') {\n      console.warn(`[ESL]: ESLResizeObserverTarget does not support '${event}' type`);\n      return;\n    }\n\n    super.addEventListener('resize', callback);\n    if (this.getEventListeners('resize').length > 1) return;\n    ESLResizeObserverTarget.observer$$.observe(this.target);\n  }\n\n  /** Unsubscribes from the observed target {@link Element} changes */\n  public override removeEventListener(callback: EventListener): void;\n  public override removeEventListener(event: 'resize', callback: EventListener): void;\n  public override removeEventListener(event: any, callback: EventListener = event): void {\n    if (typeof event === 'string' && event !== 'resize') return;\n\n    super.removeEventListener('resize', callback);\n    if (this.hasEventListener('resize')) return;\n    ESLResizeObserverTarget.observer$$.unobserve(this.target);\n  }\n}\n","import type {ESLNote} from './esl-note';\n\nexport interface FootnotesItem {\n  index: string[];\n  renderedIndex: string[];\n  text: string;\n}\n\n/** Converts notes list to footnotes items list */\nfunction convertNotesToFootnotesList(notes: ESLNote[]): FootnotesItem[] {\n  return notes.map(({index, renderedIndex, html}) => ({\n    index: [`${index}`],\n    renderedIndex: [renderedIndex],\n    text: html\n  }));\n}\n\n/** Compiles footnotes non-grouped list */\nexport function compileFootnotesNongroupedList(notes: ESLNote[]): FootnotesItem[] {\n  return convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes));\n}\n\n/** Compiles footnotes grouped list */\nexport function compileFootnotesGroupedList(notes: ESLNote[]): FootnotesItem[] {\n  const map = new Map() ;\n  convertNotesToFootnotesList(notes.filter((note) => note.allowFootnotes)).forEach((note) => {\n    const {index, renderedIndex, text} = note;\n    map.has(text) ? map.set(text, {\n      index: [...map.get(text).index, ...index],\n      renderedIndex: [...map.get(text).renderedIndex, ...renderedIndex],\n      text\n    }) : map.set(text, note);\n  });\n  const groupedList: FootnotesItem[] = [];\n  map.forEach((note, text) => groupedList.push(note));\n  return groupedList;\n}\n\n/** Sorts notes list */\nexport function sortFootnotes(notes: ESLNote[]): ESLNote[] {\n  return notes.sort((note1: ESLNote, note2: ESLNote): number => {\n    if (note1 === note2) return 0;\n    // eslint-disable-next-line no-bitwise\n    if (note1.compareDocumentPosition(note2) & Node.DOCUMENT_POSITION_PRECEDING) {\n      // note2 comes before note1\n      return 1;\n    }\n    return -1;\n  });\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, memoize, attr, listen, prop} from '../../esl-utils/decorators';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {compileFootnotesGroupedList, compileFootnotesNongroupedList, sortFootnotes} from './esl-footnotes-data';\n\nimport type {ESLNote} from './esl-note';\nimport type {FootnotesItem} from './esl-footnotes-data';\n\n@ExportNs('Footnotes')\nexport class ESLFootnotes extends ESLBaseElement {\n  static override is = 'esl-footnotes';\n\n  /** Event to request acknowledgment from {@link ESLNotes} instances */\n  @prop('esl:footnotes:request') public FOOTNOTE_REQUEST_EVENT: string;\n  /** Event to acknowledge {@link ESLFootnotes} instance about footnote */\n  @prop('esl:footnotes:response') public FOOTNOTE_RESPONSE_EVENT: string;\n\n  /** Target element {@link ESLTraversingQuery} to define scope */\n  @attr({defaultValue: '::parent'}) public scopeTarget: string;\n\n  /** Grouping note instances with identical content enable/disable */\n  @attr({defaultValue: 'enable'}) public grouping: string;\n\n  /** Label for 'return to note' button title */\n  @attr({defaultValue: 'Back to note'}) public backToNoteLabel: string;\n\n  protected _notes: ESLNote[] = [];\n  protected deferredOnUpdate = debounce(() => this._onUpdate(), 150);\n\n  /** Scope element */\n  @memoize()\n  protected get scopeEl(): HTMLElement {\n    return ESLTraversingQuery.first(this.scopeTarget, this) as HTMLElement;\n  }\n\n  /** Notes that are allowed to be processed by footnotes */\n  public get notes(): ESLNote[] {\n    return this._notes.filter((note) => note.allowFootnotes);\n  }\n\n  /** List of notes to show */\n  protected get footnotesList(): FootnotesItem[] {\n    this.reindex();\n    return this.grouping !== 'enable'\n      ? compileFootnotesNongroupedList(this._notes)\n      : compileFootnotesGroupedList(this._notes);\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.id) {\n      this.id = sequentialUID(this.baseTagName, this.baseTagName + '-');\n    }\n\n    this._notifyNotes();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this._notes.forEach((el) => el.unlink());\n    this._notes = [];\n  }\n\n  /** Adds the note to the footnotes list */\n  public linkNote(note: ESLNote): void {\n    if (this._notes.includes(note)) return;\n    this._notes.push(note);\n    const index = +sequentialUID(ESLFootnotes.is, '');\n    note.link(this, index);\n  }\n\n  /** Reindexes the list of notes */\n  public reindex(): void {\n    this._sortNotes();\n    this.notes.forEach((note, index) => note.index = index + 1);\n  }\n\n  /** Removes the note from the footnotes list */\n  public unlinkNote(note: ESLNote): void {\n    this._notes = this._notes.filter((el) => el !== note);\n    this.deferredOnUpdate();\n  }\n\n  /** Updates the content of footnotes */\n  public update(): void {\n    this.deferredOnUpdate();\n  }\n\n  /** Sorts list of notes */\n  protected _sortNotes(): void {\n    this._notes = sortFootnotes(this._notes);\n  }\n\n  /** Builds content of footnotes */\n  protected buildItems(): string {\n    const items = this.footnotesList.map((footnote) => this.buildItem(footnote)).join('');\n    return `<ul class=\"esl-footnotes-items\">${items}</ul>`;\n  }\n\n  /** Builds one item from footnotes list */\n  protected buildItem(footnote: FootnotesItem): string {\n    const item = `${this.buildItemIndex(footnote)}${this.buildItemText(footnote)}${this.buildItemBack(footnote)}`;\n    return `<li class=\"esl-footnotes-item\" data-order=\"${footnote.index}\">${item}</li>`;\n  }\n\n  /** Builds item index */\n  protected buildItemIndex(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-index\">${footnote.renderedIndex.map(this.buildWrappedItemIndex).join(', ')}</span>`;\n  }\n\n  /** Builds item index wrapped with span related to esl-note by id */\n  @bind\n  protected buildWrappedItemIndex(index: string): string {\n    return `<span id=\"${this.id}-${index}\">${index}</span>`;\n  }\n\n  /** Builds item text */\n  protected buildItemText(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-text\">${footnote.text}</span>`;\n  }\n\n  /** Builds item back-to-note button */\n  protected buildItemBack(footnote: FootnotesItem): string {\n    return `<span class=\"esl-footnotes-back-to-note\" tabindex=\"0\" title=\"${this.backToNoteLabel}\"></span>`;\n  }\n\n  /** Actions on update footnotes */\n  @bind\n  protected _onUpdate(): void {\n    this.innerHTML = this.buildItems();\n  }\n\n  /** Handles `response` event from note */\n  @listen({\n    event: (el: ESLFootnotes) => el.FOOTNOTE_RESPONSE_EVENT,\n    target: (el: ESLFootnotes) => el.scopeEl\n  })\n  protected _onNoteSubscribe(e: CustomEvent): void {\n    const note = e.target as ESLNote;\n    this.linkNote(note);\n    this.deferredOnUpdate();\n\n    e.stopImmediatePropagation();\n  }\n\n  /** Handles `click` event */\n  @listen({\n    event: 'click',\n    selector: '.esl-footnotes-back-to-note'\n  })\n  protected _onItemClick(e: MouseEvent | KeyboardEvent): void {\n    const target = e.target as HTMLElement;\n    const orderAttr = target.closest('.esl-footnotes-item')?.getAttribute('data-order');\n    const order = orderAttr?.split(',').map((item) => +item);\n    order && this._onBackToNote(order);\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(event.key)) this._onItemClick(event);\n  }\n\n  /** Actions on back-to-note click  */\n  protected _onBackToNote(order: number[]): void {\n    const index = order[order.length - 1];\n    this.notes.forEach((note) => {\n      note.highlight(order.includes(note.index));\n      if (note.index === index) {\n        note.activate();\n      }\n    });\n  }\n\n  /** Turns off highlight for notes with the same text */\n  public turnOffHighlight(note: ESLNote): void {\n    this._notes\n      .filter((item) => note.html === item.html)\n      .forEach((item) => item.highlight(false));\n  }\n\n  /**\n   * Sends a request to all notes, expecting to get a response from\n   * the unlinked ones and link up with them */\n  protected _notifyNotes(): void {\n    ESLEventUtils.dispatch(this, this.FOOTNOTE_REQUEST_EVENT);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Footnotes: typeof ESLFootnotes;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-footnotes': ESLFootnotes;\n  }\n}\n","import {ESLMixinElement} from '../../esl-mixin-element/core';\nimport {prop} from '../../esl-utils/decorators';\n\nimport type {ESLNote} from './esl-note';\n\n/**\n * Optional mixin element to support esl-note-ignore attribute dynamic changes\n */\nexport class ESLNoteIgnore extends ESLMixinElement {\n  public static override is = 'esl-note-ignore';\n\n  /** Selector to find all dependent ESLNote elements */\n  @prop('esl-note') protected noteSelector: string;\n\n  /** Callback to handle changing of additional attributes */\n  public override attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (oldValue === newValue) return;\n    [...this.$host.querySelectorAll<ESLNote>(this.noteSelector)].forEach(($note) => $note.updateIgnoredQuery());\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement, prop} from '../../esl-base-element/core';\nimport {ready, attr, boolAttr, memoize, listen} from '../../esl-utils/decorators';\nimport {ESLTooltip} from '../../esl-tooltip/core';\nimport {promisifyTimeout, repeatSequence} from '../../esl-utils/async';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {scrollIntoView} from '../../esl-utils/dom/scroll';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport type {ESLFootnotes} from './esl-footnotes';\nimport type {TooltipActionParams} from '../../esl-tooltip/core/esl-tooltip';\nimport type {IMediaQueryCondition} from '../../esl-media-query/core/conditions/media-query-base';\n\n@ExportNs('Note')\nexport class ESLNote extends ESLBaseElement {\n  public static override is = 'esl-note';\n  public static observedAttributes = ['tooltip-shown', 'ignore'];\n\n  /** Timeout before activating note (to have time to show content with this note) */\n  public static readonly activateTimeout = 100;\n\n  /** Event to request acknowledgment from {@link ESLNotes} instances */\n  @prop('esl:footnotes:request') public FOOTNOTE_REQUEST_EVENT: string;\n  /** Event to acknowledge {@link ESLFootnotes} instance about footnote */\n  @prop('esl:footnotes:response') public FOOTNOTE_RESPONSE_EVENT: string;\n\n  /** Linked state marker */\n  @boolAttr() public linked: boolean;\n  /** Standalone state marker */\n  @boolAttr() public standalone: boolean;\n  /** Tooltip state marker */\n  @boolAttr() public tooltipShown: boolean;\n\n  /** Media query to specify that footnotes must ignore this note. Default: `not all` */\n  @attr({defaultValue: 'not all'}) public ignore: string;\n\n  /** Tooltip content */\n  @attr() public html: string;\n  /**\n   * Note label in stand-alone mode (detached from footnotes),\n   * in the connected state it is a numeric index that is calculated automatically\n   */\n  @attr({defaultValue: '*'}) public standaloneLabel: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackHover: string;\n\n  /** Target to container element {@link ESLTraversingQuery} to define bounds of tooltip visibility (window by default) */\n  @attr() public container: string;\n\n  /** margin around the element that is used as the viewport for checking the visibility of the note tooltip */\n  @attr({defaultValue: '0px'})  public intersectionMargin: string;\n\n  protected _$footnotes: ESLFootnotes | null;\n  protected _index: number;\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  /** Marker to allow footnotes to pick up this note */\n  public get allowFootnotes(): boolean {\n    return !this.queryToIgnore.matches;\n  }\n\n  /** Note index in the scope content */\n  public get index(): number {\n    return this._index;\n  }\n  public set index(value: number) {\n    this._index = value;\n    this.innerHTML = this.renderedHTML;\n  }\n\n  /** Note index in the displayed list of footnotes */\n  public get renderedIndex(): string {\n    return this.allowFootnotes ? `${this._index}` : this.standaloneLabel;\n  }\n\n  /** Note markup */\n  protected get renderedHTML(): string {\n    const index = this.renderedIndex;\n    if (!this._$footnotes) return index;\n    const footnotesIndexId = `${this._$footnotes.id}-${index}`;\n    return `<a class=\"esl-note-link\" href=\"#${footnotesIndexId}\" tabindex=\"-1\">${index}</a>`;\n  }\n\n  /** Query to describe conditions to ignore note by footnotes  */\n  @memoize()\n  public get queryToIgnore(): IMediaQueryCondition {\n    const ignore = this.getClosestRelatedAttr('ignore') || this.ignore;\n    return ESLMediaQuery.for(ignore);\n  }\n\n  /** The text writing directionality of the element */\n  protected get currentDir(): string {\n    return getComputedStyle(this).direction;\n  }\n\n  /** The base language of the element */\n  protected get currentLang(): string {\n    const el = this.closest('[lang]');\n    return (el) ? (el as HTMLElement).lang : '';\n  }\n\n  @ready\n  protected override connectedCallback(): void {\n    this.init();\n    super.connectedCallback();\n    this._sendResponseToFootnote();\n  }\n\n  @ready\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._$footnotes?.unlinkNote(this);\n    this.restore();\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'tooltip-shown' && newVal === null) {\n      this._$footnotes?.turnOffHighlight(this);\n    }\n    if (attrName === 'ignore') {\n      this.updateIgnoredQuery();\n    }\n  }\n\n  /** Revises the settings for ignoring the note */\n  public updateIgnoredQuery(): void {\n    memoize.clear(this, 'queryToIgnore');\n    this.$$on(this._onIgnoreConditionChange);\n    this._onIgnoreConditionChange();\n  }\n\n  /** Gets attribute value from the closest element with group behavior settings */\n  protected getClosestRelatedAttr(attrName: string): string | null {\n    const relatedAttrName = `${this.baseTagName}-${attrName}`;\n    const $closest = this.closest(`[${relatedAttrName}]`);\n    return $closest ? $closest.getAttribute(relatedAttrName) : null;\n  }\n\n  /** Activates note */\n  public activate(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    ESLEventUtils.dispatch(this, 'esl:show:request');\n    // TODO: replace timeout with a more reliable mechanism to have time to show content with this note\n    repeatSequence(() => {\n      return promisifyTimeout((this.constructor as typeof ESLNote).activateTimeout)\n        .then(() => scrollIntoView(this, {behavior: 'smooth', block: 'center'}))\n        .then(() => ESLTooltip.open || this.showTooltip());\n    }, 3);\n  }\n\n  /** Highlights note */\n  public highlight(enable: boolean = true): void {\n    this.classList.toggle('highlight', enable);\n  }\n\n  /** Links note with footnotes */\n  public link(footnotes: ESLFootnotes, index: number): void {\n    this.linked = true;\n    this._$footnotes = footnotes;\n    this.index = index;\n    this.tabIndex = 0;\n    this.update();\n  }\n\n  /** Unlinks note from footnotes */\n  public unlink(): void {\n    this.restore();\n    this.update();\n    this._sendResponseToFootnote();\n  }\n\n  /** Updates note state */\n  public update(): void {\n    this.standalone = !(this.linked && this.allowFootnotes);\n  }\n\n  /** Initial initialization of the element during the connection to DOM */\n  protected init(): void {\n    if (!this.html) {\n      this.html = this.innerHTML;\n    }\n    memoize.clear(this, 'queryToIgnore');\n    this.index = 0;\n    this.linked = false;\n    this.update();\n  }\n\n  /** Restores original note content after unlinking */\n  protected restore(): void {\n    this.linked = false;\n    this._$footnotes = null;\n    this.index = 0;\n    this.tabIndex = -1;\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLNote, ...params: TooltipActionParams[]): TooltipActionParams {\n    const container = this.getClosestRelatedAttr('container') || this.container;\n    const containerEl = container ? ESLTraversingQuery.first(container, this) as HTMLElement : undefined;\n    return Object.assign({\n      initiator: 'note',\n      activator: this,\n      containerEl,\n      html: this.html,\n      dir: this.currentDir,\n      lang: this.currentLang,\n      intersectionMargin: this.intersectionMargin\n    }, ...params);\n  }\n\n  /** Shows tooltip with passed params */\n  public showTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    ESLTooltip.show(actionParams);\n    this.highlight();\n  }\n  /** Hides tooltip with passed params */\n  public hideTooltip(params: TooltipActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n    }, params);\n    ESLTooltip.hide(actionParams);\n  }\n  /** Toggles tooltip with passed params */\n  public toggleTooltip(params: TooltipActionParams = {}, state: boolean = !this.tooltipShown): void {\n    state ? this.showTooltip(params) : this.hideTooltip(params);\n  }\n\n  /** Handles `click` event */\n  @listen('click')\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE].includes(event.key)) return;\n    event.preventDefault();\n    event.stopPropagation();\n    return this.toggleTooltip({event});\n  }\n\n  /** Handles hover `mouseenter` event */\n  @listen('mouseenter')\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.showTooltip({event});\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @listen('mouseleave')\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    this.hideTooltip({event, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Actions on breakpoint changing */\n  @listen({\n    event: 'change',\n    target: (el: ESLNote) => el.queryToIgnore\n  })\n  protected _onIgnoreConditionChange(): void {\n    if (ESLTooltip.open) {\n      this.hideTooltip();\n    }\n    this.innerHTML = this.renderedHTML;\n    this.update();\n    this._$footnotes?.update();\n  }\n\n  /** Handles footnotes request event */\n  @listen({\n    event: (el: ESLNote) => el.FOOTNOTE_REQUEST_EVENT,\n    target: document.body\n  })\n  protected _onFootnotesReady(e: CustomEvent): void {\n    if (this.linked) return;\n    this._sendResponseToFootnote();\n  }\n\n  /** Sends the response to footnotes */\n  protected _sendResponseToFootnote(): void {\n    ESLEventUtils.dispatch(this, this.FOOTNOTE_RESPONSE_EVENT);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Note: typeof ESLNote;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-note': ESLNote;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {attr, boolAttr} from '../../../esl-utils/decorators';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nimport type {ESLSelectOption} from './esl-select-wrapper';\n\n/**\n * ESLSelectItem component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectItem - inner component to render an option\n */\n@ExportNs('SelectItem')\nexport class ESLSelectItem extends ESLBaseElement {\n  public static override readonly is: string = 'esl-select-item';\n  public static observedAttributes = ['selected', 'disabled'];\n\n  /** Option value */\n  @attr() public value: string;\n  /** Selected state marker */\n  @boolAttr() public selected: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n\n  /** Original option */\n  public original: ESLSelectOption;\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.tabIndex = 0;\n    this.setAttribute('role', 'checkbox');\n    this.setAttribute('aria-selected', String(this.selected));\n  }\n\n  protected override attributeChangedCallback(attrName: string): void {\n    if (attrName === 'selected') {\n      this.setAttribute('aria-selected', String(this.selected));\n    }\n    if (attrName === 'disabled') {\n      this.setAttribute('aria-disabled', String(this.disabled));\n    }\n  }\n\n  public update(option?: ESLSelectOption): void {\n    if (option) this.original = option;\n    this.value = this.original.value;\n    this.disabled = this.original.disabled;\n    this.selected = this.original.selected;\n    this.textContent = this.original.text;\n  }\n\n  /** Helper to create an option item */\n  public static build(option: ESLSelectOption): ESLSelectItem {\n    const item = ESLSelectItem.create();\n    item.update(option);\n    return item;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectItem: typeof ESLSelectItem;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-item': ESLSelectItem;\n  }\n}\n","import {bind, attr, boolAttr, listen} from '../../../esl-utils/decorators';\nimport {ARROW_DOWN, ARROW_UP, ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLScrollbar} from '../../../esl-scrollbar/core';\nimport {ESLSelectItem} from './esl-select-item';\nimport {ESLSelectWrapper} from './esl-select-wrapper';\n\n/**\n * ESLSelectList component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelectList is a component to show selectable list of items. Decorates native HTMLSelectElement\n */\n@ExportNs('SelectList')\nexport class ESLSelectList extends ESLSelectWrapper {\n  public static override readonly is = 'esl-select-list';\n  public static observedAttributes = ['select-all-label', 'disabled'];\n\n  public static override register(): void {\n    ESLSelectItem.register();\n    super.register();\n  }\n\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the list */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $items: ESLSelectItem[];\n  protected $list: HTMLDivElement;\n  protected $scroll: ESLScrollbar;\n  protected $selectAll: ESLSelectItem;\n\n  constructor() {\n    super();\n    this.$list = document.createElement('div');\n    this.$list.setAttribute('role', 'list');\n    this.$list.classList.add('esl-scrollable-content');\n    this.$list.classList.add('esl-select-list-container');\n    this.$scroll = ESLScrollbar.create();\n    this.$scroll.target = '::prev';\n    this.$selectAll = ESLSelectItem.create();\n    this.$selectAll.classList.add('esl-select-all-item');\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    if (attrName === 'select-all-label') {\n      this.$selectAll.textContent = newVal;\n    }\n    if (attrName === 'disabled') {\n      this._updateDisabled();\n    }\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n\n    this.bindSelect();\n\n    this._updateDisabled();\n  }\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    this.appendChild(this.$selectAll);\n    this.appendChild(this.$list);\n    this.appendChild(this.$scroll);\n  }\n\n  protected bindSelect(): void {\n    const target = this.querySelector('[esl-select-target]');\n    if (!target || !(target instanceof HTMLSelectElement)) return;\n    this.$select = target;\n  }\n\n  protected _renderItems(): void {\n    if (!this.$select) return;\n    this.$list.innerHTML = '';\n    this.$items = this.options.map(ESLSelectItem.build);\n    if (this.pinSelected) {\n      this._renderGroup(this.$items.filter((option) => option.selected));\n      this._renderGroup(this.$items.filter((option) => !option.selected));\n    } else {\n      this._renderGroup(this.$items);\n    }\n    this.toggleAttribute('multiple', this.multiple);\n  }\n  protected _renderGroup(items: ESLSelectItem[]): void {\n    items.forEach((item) => this.$list.appendChild(item));\n    const [last] = items.slice(-1);\n    last && last.classList.add('last-in-group');\n  }\n\n  protected _updateSelectAll(): void {\n    if (!this.multiple) {\n      this.$selectAll.removeAttribute('tabindex');\n      return;\n    }\n    this.$selectAll.tabIndex = 0;\n    this.$selectAll.selected = this.isAllSelected();\n    this.$selectAll.textContent = this.selectAllLabel;\n  }\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n  }\n\n  @bind\n  protected override _onTargetChange(newTarget: HTMLSelectElement | undefined, oldTarget: HTMLSelectElement | undefined): void {\n    super._onTargetChange(newTarget, oldTarget);\n    this._updateSelectAll();\n    this._renderItems();\n  }\n\n  @listen({inherit: true})\n  public override _onChange(): void {\n    this._updateSelectAll();\n    this.$items.forEach((item) => item.update());\n  }\n\n  @bind\n  public override _onListChange(): void {\n    this._renderItems();\n  }\n\n  @listen('click')\n  protected _onClick(e: MouseEvent | KeyboardEvent): void {\n    if (this.disabled) return;\n    const target = e.target;\n    if (!target || !(target instanceof ESLSelectItem)) return;\n    if (target.classList.contains('esl-select-all-item')) {\n      this.setAllSelected(!target.selected);\n    } else {\n      this.setSelected(target.value, !target.selected);\n    }\n  }\n\n  @listen('keydown')\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this._onClick(e);\n      e.preventDefault();\n    }\n    if ([ARROW_UP, ARROW_DOWN].includes(e.key)) {\n      const index = this.$items.indexOf(document.activeElement as ESLSelectItem);\n      const count = this.$items.length;\n      const increment = e.key === ARROW_UP ? -1 : 1;\n      if (index === -1) return;\n      this.$items[(index + increment + count) % count].focus();\n      e.preventDefault();\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    SelectList: typeof ESLSelectList;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select-list': ESLSelectList;\n  }\n}\n","import {ESLBaseElement, listen} from '../../../esl-base-element/core';\nimport {ESLEventUtils} from '../../../esl-utils/dom/events';\n\n/** Interface for option definition */\nexport interface ESLSelectOption {\n  /** Label text of the option */\n  text: string;\n  /** Value of the option */\n  value: string;\n  /** Disabled marker */\n  disabled: boolean;\n  /** Selected marker */\n  selected: boolean;\n  /** Initially selected marker */\n  defaultSelected: boolean;\n}\n\n/** Interface to declare options source for select components */\nexport interface ESLSelectModel {\n  /** Allow multiple items */\n  multiple: boolean;\n  /** Get list of options */\n  options: ESLSelectOption[];\n  /** Get list of selected options */\n  selectedOptions: ESLSelectOption[];\n\n  /** Toggle option with passed value to the state */\n  setSelected(value: string, state: boolean): void;\n  /** Check selected state*/\n  isSelected(value: string): boolean;\n  /** Has selected options */\n  hasSelected(): boolean;\n\n  /** Check that all options are selected */\n  isAllSelected(): boolean;\n  /** Toggle all options to the state */\n  setAllSelected(state: boolean): void;\n}\n\n/**\n * Base class for {@link HTMLSelectElement} wrapper element, implements {@link ESLSelectModel} options source\n */\nexport abstract class ESLSelectWrapper extends ESLBaseElement implements ESLSelectModel {\n  protected static observationConfig: MutationObserverInit = {\n    subtree: true,\n    attributes: true,\n    attributeFilter: ['value', 'selected', 'disabled'],\n    childList: true,\n    characterData: true\n  };\n\n  private _$select: HTMLSelectElement;\n  private _mutationObserver = new MutationObserver(this._onTargetMutation.bind(this));\n\n  /** Native select that is wrapped */\n  public get $select(): HTMLSelectElement {\n    return this._$select;\n  }\n  public set $select(select: HTMLSelectElement) {\n    const prev = this._$select;\n    this._$select = select;\n    this._onTargetChange(select, prev);\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._mutationObserver.disconnect();\n  }\n\n  @listen({\n    event: 'change',\n    target: (el: ESLSelectWrapper) => el.$select\n  })\n  protected _onChange(event?: Event): void {}\n\n  protected _onListChange(): void {}\n\n  protected _onTargetChange(newTarget: HTMLSelectElement | undefined,\n                            oldTarget: HTMLSelectElement | undefined): void {\n    this.$$on(this._onChange);\n    this._mutationObserver.disconnect();\n    const type = (this.constructor as typeof ESLSelectWrapper);\n    if (newTarget) this._mutationObserver.observe(newTarget, type.observationConfig);\n  }\n\n  protected _onTargetMutation(changes: MutationRecord[]): void {\n    const isListChange = (change: MutationRecord): boolean => change.addedNodes.length + change.removedNodes.length > 0;\n    changes.some(isListChange) ? this._onListChange() : this._onChange();\n  }\n\n  @listen({\n    event: 'reset',\n    target: (el: ESLSelectWrapper) => el.ownerDocument\n  })\n  protected _onReset(event: Event): void {\n    if (!event.target || event.target !== this.form) return;\n    setTimeout(() => this._onChange(event));\n  }\n\n  public get multiple(): boolean {\n    return this.$select && this.$select.multiple;\n  }\n\n  public get options(): ESLSelectOption[] {\n    return this.$select ? Array.from(this.$select.options) : [];\n  }\n  public get selectedOptions(): ESLSelectOption[] {\n    return this.options.filter((item) => item.selected);\n  }\n\n  protected getOption(value: string): ESLSelectOption | undefined {\n    return this.options.find((item) => item.value === value);\n  }\n\n  public setSelected(value: string, state: boolean): void {\n    if (!this.$select) return;\n    const option = this.getOption(value);\n    option && (option.selected = state);\n    ESLEventUtils.dispatch(this.$select, 'change');\n  }\n  public isSelected(value: string): boolean {\n    const opt = this.getOption(value);\n    return !!opt && opt.selected;\n  }\n  public hasSelected(): boolean {\n    return this.options.some((item) => item.selected);\n  }\n\n  public isAllSelected(): boolean {\n    return this.options.every((item) => item.selected || item.disabled);\n  }\n\n  public setAllSelected(state: boolean): void {\n    if (!this.multiple || !this.$select) return;\n    this.options.forEach((item: HTMLOptionElement) => item.selected = !item.disabled && state);\n    ESLEventUtils.dispatch(this.$select, 'change');\n  }\n\n  // Proxy select methods and values\n  public get value(): string | undefined {\n    return this.$select?.value;\n  }\n  public get values(): string[] {\n    return this.selectedOptions.map((item: HTMLOptionElement) => item.value);\n  }\n\n  public get form(): HTMLFormElement | null {\n    return this.$select?.form;\n  }\n\n  public get name(): string {\n    return this.$select?.name;\n  }\n  public set name(name: string) {\n    this.$select && (this.$select.name = name);\n  }\n\n  public get required(): boolean {\n    return this.$select?.required;\n  }\n  public set required(required: boolean) {\n    this.$select && (this.$select.required = required);\n  }\n\n  // Validation API values\n  public get validity(): ValidityState {\n    return this.$select?.validity;\n  }\n  public get validationMessage(): string {\n    return this.$select?.validationMessage;\n  }\n  public get willValidate(): boolean {\n    return this.$select?.willValidate;\n  }\n\n  // Validation API methods\n  public checkValidity(): boolean {\n    return this.$select?.checkValidity();\n  }\n  public reportValidity(): boolean {\n    return this.$select?.reportValidity();\n  }\n  public setCustomValidity(error: string): void {\n    this.$select?.setCustomValidity(error);\n  }\n}\n","import {ESLPopup} from '../../../esl-popup/core';\nimport {prop, listen, memoize} from '../../../esl-utils/decorators';\nimport {TAB} from '../../../esl-utils/dom/keys';\nimport {ESLSelectList} from '../../esl-select-list/core';\n\nimport type {ESLSelect} from './esl-select';\nimport type {ESLToggleableActionParams} from '../../../esl-toggleable/core/esl-toggleable';\nimport type {PositionType} from '../../../esl-popup/core/esl-popup-position';\n\n/**\n * ESLSelectDropdown component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom component to render {@link ESLSelect} dropdown section\n * Uses {@link ESLSelectList} to render the content\n */\nexport class ESLSelectDropdown extends ESLPopup {\n  public static override readonly is = 'esl-select-dropdown';\n  public static override register(): void {\n    ESLSelectList.register();\n    super.register();\n  }\n\n  /** Owner ESLSelect instance */\n  public $owner: ESLSelect;\n\n  /** Inner delay timer to dispose popup with list */\n  protected _disposeTimeout: number;\n\n  @prop(true) public override closeOnEsc: boolean;\n  @prop(true) public override closeOnOutsideAction: boolean;\n  @prop('bottom') public override position: PositionType;\n\n  /** Inner ESLSelectList component */\n  @memoize()\n  protected get $list(): ESLSelectList {\n    return ESLSelectList.create();\n  }\n\n  protected override setInitialState(): void {}\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$list);\n  }\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$list);\n  }\n\n  protected override onShow(params: ESLToggleableActionParams): void {\n    !this.connected && document.body.appendChild(this);\n    this._disposeTimeout && window.clearTimeout(this._disposeTimeout);\n\n    this.$$cls(this.$owner.dropdownClass, true);\n    this.$list.pinSelected = this.$owner.pinSelected;\n    this.$list.selectAllLabel = this.$owner.selectAllLabel;\n    this.$list.$select = this.$owner.$select;\n\n    super.onShow(params);\n    const $focusable: HTMLElement | null = this.querySelector('[tabindex]');\n    $focusable?.focus({preventScroll: true});\n    this._updatePosition();\n  }\n\n  protected override onHide(params: ESLToggleableActionParams): void {\n    const $select = this.activator;\n    super.onHide(params);\n    this._disposeTimeout = window.setTimeout(() => {\n      if (this.parentNode !== document.body) return;\n      document.body.removeChild(this);\n    }, 1000);\n    $select && setTimeout(() => $select.focus({preventScroll: true}), 0);\n  }\n\n  @listen('keydown')\n  protected override _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    const $els = this.querySelectorAll('[tabindex]');\n    const $first = $els[0] as HTMLElement;\n    const $last = $els[$els.length - 1] as HTMLElement;\n    if ($first && e.target === $last && !e.shiftKey) $first.focus();\n    if ($last && e.target === $first && e.shiftKey) $last.focus();\n  }\n\n  protected override _updatePosition(): void {\n    const $select = this.activator;\n    if ($select) this.style.width = `${$select.getBoundingClientRect().width}px`;\n    super._updatePosition();\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-dropdown': ESLSelectDropdown;\n  }\n}\n","import {ESLBaseElement} from '../../../esl-base-element/core';\nimport {format} from '../../../esl-utils/misc/format';\nimport {rafDecorator} from '../../../esl-utils/async/raf';\nimport {attr, boolAttr, decorate, listen, memoize} from '../../../esl-utils/decorators';\n\nimport type {ESLSelect} from './esl-select';\n\n/**\n * ESLSelectRenderer component\n * @author Alexey Stsefanovich (ala'n)\n *\n * Auxiliary inner custom element to render {@link ESLSelect} inline field\n */\nexport class ESLSelectRenderer extends ESLBaseElement {\n  public static override readonly is = 'esl-select-renderer';\n\n  /** Attribute for empty text value */\n  @attr() public emptyText: string;\n  /** Attribute for more label format */\n  @attr() public moreLabelFormat: string;\n  /** Marker attribute to reflect filled state */\n  @boolAttr() public hasValue: boolean;\n\n  /** Internal container */\n  @memoize()\n  protected get $container(): HTMLElement {\n    const $container = document.createElement('div');\n    $container.className = 'esl-select-text-container';\n    $container.appendChild(this.$text);\n    $container.appendChild(this.$rest);\n    return $container;\n  }\n\n  /** Inner remove button */\n  @memoize()\n  protected get $remove(): HTMLElement {\n    const $remove = document.createElement('button');\n    $remove.type = 'button';\n    $remove.setAttribute('aria-label', 'Clear');\n    $remove.className = 'esl-select-clear-btn icon-nav-close-menu';\n    return $remove;\n  }\n\n  /** Inner text element */\n  @memoize()\n  protected get $text(): HTMLElement {\n    const $text = document.createElement('span');\n    $text.className = 'esl-select-text';\n    return $text;\n  }\n\n  /** Inner rest label element */\n  @memoize()\n  protected get $rest(): HTMLElement {\n    const $rest = document.createElement('span');\n    $rest.className = 'esl-select-text';\n    return $rest;\n  }\n\n  /** ESLSelect owner */\n  get owner(): ESLSelect | null {\n    if (!this.parentElement || !this.parentElement.matches('esl-select')) return null;\n    return this.parentElement as ESLSelect;\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.appendChild(this.$container);\n    this.appendChild(this.$remove);\n    Promise.resolve().then(() => this.render());\n  }\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeChild(this.$container);\n    this.removeChild(this.$remove);\n  }\n\n  /** Rerender component with markers */\n  @listen({\n    event: 'esl:change:value',\n    target: (el: ESLSelectRenderer) => el.owner\n  })\n  public render(): void {\n    if (!this.owner) return;\n    const selected = this.owner.selectedOptions;\n    this.hasValue = !!selected.length;\n    this.toggleAttribute('multiple', this.owner.multiple);\n    this.applyItems(selected.map((item) => item.text));\n  }\n\n  /** Render item with a visible items limit */\n  protected apply(items: string[], limit: number): void {\n    const length = items.length;\n    const rest = length - limit;\n    const options = {rest, length, limit};\n    this.$text.textContent = items.slice(0, limit).join(', ');\n    if (rest > 0) {\n      this.$rest.textContent = format(this.moreLabelFormat || '', options);\n    } else {\n      this.$rest.textContent = '';\n    }\n  }\n  /** Render items using adaptive algorithm */\n  protected applyItems(items: string[]): void {\n    let size = 0;\n    do {\n      this.apply(items, ++size); // Render with extended limit while it not fits to the container\n    } while (size <= items.length && this.$container.scrollWidth <= this.$container.clientWidth);\n    this.apply(items, size - 1); // Render last limit that fits\n  }\n\n  /** Handle clear button click */\n  @listen({event: 'click', selector: '.esl-select-clear-btn'})\n  protected _onClear(e: MouseEvent): void {\n    if (!this.owner) return;\n    this.owner.setAllSelected(false);\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  @listen({event: 'resize', target: window})\n  @decorate(rafDecorator)\n  protected _onResize(): void {\n    this.render();\n  }\n}\n\ndeclare global {\n  export interface HTMLElementTagNameMap {\n    'esl-select-renderer': ESLSelectRenderer;\n  }\n}\n","import {attr, boolAttr, listen} from '../../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../../esl-utils/dom/class';\nimport {ENTER, SPACE} from '../../../esl-utils/dom/keys';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {ESLEventUtils} from '../../../esl-utils/dom/events';\n\nimport {ESLSelectWrapper} from '../../esl-select-list/core/esl-select-wrapper';\nimport {ESLSelectRenderer} from './esl-select-renderer';\nimport {ESLSelectDropdown} from './esl-select-dropdown';\n\n/**\n * ESLSelect component\n * @author Alexey Stsefanovich (ala'n)\n *\n * ESLSelect is a component on top of native select that brings more customization features.\n * Uses \"select with dropdown\" view. Supports both single and multiple selection.\n */\n@ExportNs('Select')\nexport class ESLSelect extends ESLSelectWrapper {\n  public static override readonly is = 'esl-select';\n  public static observedAttributes = ['disabled', 'dropdown-class'];\n\n  public static override register(): void {\n    ESLSelectDropdown.register();\n    ESLSelectRenderer.register();\n    super.register();\n  }\n\n  /** Placeholder text property */\n  @attr() public placeholder: string;\n  /** Class(es) to mark not empty state */\n  @attr() public hasValueClass: string;\n  /** Class(es) for focused state. Select is also focused if the dropdown list is opened */\n  @attr() public hasFocusClass: string;\n  /** Class(es) for select dropdown */\n  @attr() public dropdownClass: string;\n  /** Select all options text */\n  @attr({defaultValue: 'Select All'}) public selectAllLabel: string;\n\n  /**\n   * Text to add when there is not enough space to show all selected options inline,\n   * Supports `{rest}`, `{length}` and `{limit}` placeholders\n   */\n  @attr({defaultValue: '+ {rest} more...'}) public moreLabelFormat: string;\n\n  /** Dropdown open marker */\n  @boolAttr() public open: boolean;\n  /** Disabled state marker */\n  @boolAttr() public disabled: boolean;\n  /** Marker for selecting items to be pinned to the top of the dropdown */\n  @boolAttr() public pinSelected: boolean;\n\n  protected $renderer: ESLSelectRenderer;\n  protected $dropdown: ESLSelectDropdown;\n\n  constructor() {\n    super();\n\n    this.$renderer = document.createElement(ESLSelectRenderer.is);\n    this.$dropdown = document.createElement(ESLSelectDropdown.is);\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (attrName === 'disabled') this._updateDisabled();\n    if (attrName === 'dropdown-class') {\n      this.$dropdown.$$cls(oldVal, false);\n      this.$dropdown.$$cls(newVal, true);\n    }\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n\n    this.$select = this.querySelector('[esl-select-target]')!;\n    if (!this.$select) return;\n\n    this._prepare();\n    this._updateDisabled();\n    this._updateMarkers();\n  }\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._dispose();\n  }\n\n  /** Catches the focus */\n  public override focus(options?: FocusOptions): void {\n    this.$select.focus(options);\n  }\n  /** Updates select component */\n  public update(valueChanged = true): void {\n    this._updateMarkers();\n    if (!valueChanged) return;\n    // TODO: silent updates\n    ESLEventUtils.dispatch(this, 'esl:change:value', {detail: {event: null}});\n  }\n\n  protected _prepare(): void {\n    this.$renderer.className = this.$select.className;\n    this.$renderer.emptyText = this.placeholder;\n    this.$renderer.moreLabelFormat = this.moreLabelFormat;\n    this.$dropdown.$owner = this;\n    this.appendChild(this.$renderer);\n  }\n  protected _dispose(): void {\n    this.$select.className = this.$renderer.className;\n    this.removeChild(this.$renderer);\n  }\n\n  protected _updateMarkers(): void {\n    const hasValue = this.hasSelected();\n    this.toggleAttribute('has-value', hasValue);\n    CSSClassUtils.toggle(this, this.hasValueClass, hasValue);\n\n    const focusEl = document.activeElement;\n    const hasFocus = this.open || (focusEl && this.contains(focusEl));\n    CSSClassUtils.toggle(this, this.hasFocusClass, !!hasFocus);\n  }\n  protected _updateDisabled(): void {\n    this.setAttribute('aria-disabled', String(this.disabled));\n    if (!this.$select) return;\n    this.$select.disabled = this.disabled;\n    if (this.disabled && this.open) this.$dropdown.hide();\n  }\n\n  @listen({inherit: true})\n  protected override _onChange(event: Event): void {\n    this._updateMarkers();\n    ESLEventUtils.dispatch(this, 'esl:change:value', {detail: {event}});\n  }\n\n  @listen('focusout')\n  protected _onFocusOut(): void {\n    this._updateMarkers();\n  }\n\n  @listen('click')\n  protected _onClick(): void {\n    if (this.disabled) return;\n    this.$dropdown.toggle(!this.$dropdown.open, {\n      activator: this.$renderer,\n      initiator: 'select'\n    });\n  }\n\n  @listen('keydown')\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this.click();\n      e.preventDefault();\n    }\n  }\n\n  @listen({\n    event: 'esl:show esl:hide',\n    target: (el: ESLSelect) => el.$dropdown\n  })\n  protected _onPopupStateChange(e: CustomEvent): void {\n    this.open = this.$dropdown.open;\n    this._updateMarkers();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Select: typeof ESLSelect;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-select': ESLSelect;\n  }\n}\n","import {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport type {ESLImage} from './esl-image';\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Image lazy loading IntersectionObserver instance */\nexport function getIObserver(): IntersectionObserver {\n  if (!iObserver) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [0.01], // 0 + 1 are not correctly handled by all browsers\n      rootMargin: DeviceDetector.isMobile ? '250px' : '500px' // rootMargin value for IntersectionObserver\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const image = entry.target as ESLImage;\n\n  // Check that entry is going to appear in the viewport area\n  if (entry.isIntersecting || entry.intersectionRatio > 0) {\n    image.triggerLoad();\n  }\n}\n","import {sanitize} from '../../esl-utils/dom/sanitize';\n\nimport type {ESLImage} from './esl-image';\n\nexport const EMPTY_IMAGE = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\nexport const isEmptyImage = (src: string): boolean => src === EMPTY_IMAGE;\n\n/**\n * Describe mods configurations\n */\nexport interface ESLImageRenderStrategy {\n  /** Apply image from shadow loader */\n  apply: (img: ESLImage, shadowImg: HTMLImageElement) => void;\n  /** Clean strategy specific changes from ESLImage */\n  clear: (img: ESLImage) => void;\n}\n\n/**\n * Describes object that contains strategies mapping\n */\nexport interface ESLImageStrategyMap {\n  [mode: string]: ESLImageRenderStrategy;\n}\n\nexport const STRATEGIES: ESLImageStrategyMap = {\n  'cover': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n    },\n    clear(img): void {\n      img.style.backgroundImage = '';\n    }\n  },\n  'save-ratio': {\n    apply(img, shadowImg): void {\n      const src = shadowImg.src;\n      const isEmpty = !src || isEmptyImage(src);\n      img.style.backgroundImage = isEmpty ? '' : `url(\"${src}\")`;\n      if (shadowImg.width === 0) return;\n      img.style.paddingTop = isEmpty ? '' : `${(shadowImg.height * 100 / shadowImg.width)}%`;\n    },\n    clear(img): void {\n      img.style.paddingTop = '';\n      img.style.backgroundImage = '';\n    }\n  },\n  'fit': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.removeAttribute('width');\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'origin': {\n    apply(img, shadowImg): void {\n      const innerImg = img.attachInnerImage();\n      innerImg.src = shadowImg.src;\n      innerImg.width = shadowImg.width / window.devicePixelRatio;\n    },\n    clear(img): void {\n      img.removeInnerImage();\n    }\n  },\n  'inner-svg': {\n    apply(img, shadowImg): void {\n      const request = new XMLHttpRequest();\n      request.open('GET', shadowImg.src, true);\n      request.onreadystatechange = (): void => {\n        if (request.readyState !== 4 || request.status !== 200) return;\n        img.innerHTML = sanitize(request.responseText, ['svg']);\n      };\n      request.send();\n    },\n    clear(img): void {\n      img.innerHTML = '';\n    }\n  }\n};\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, prop, attr, boolAttr} from '../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {ESLMediaRuleList} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core/esl-traversing-query';\n\nimport {getIObserver} from './esl-image-iobserver';\nimport {EMPTY_IMAGE, STRATEGIES, isEmptyImage} from './esl-image-strategies';\n\nimport type {ESLImageRenderStrategy} from './esl-image-strategies';\n\ntype LoadState = 'error' | 'loaded' | 'ready';\nconst isLoadState = (state: string): state is LoadState => ['error', 'loaded', 'ready'].includes(state);\n\n/**\n * ESLImage - custom element, that provides flexible ways to include images on web pages.\n * Was originally developed as an alternative to `<picture>` element, but with more features inside.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Image')\nexport class ESLImage extends ESLBaseElement {\n  public static override is = 'esl-image';\n  public static observedAttributes = ['alt', 'role', 'mode', 'aria-label', 'data-src', 'data-src-base', 'lazy-triggered'];\n\n  /** Default container class value */\n  public static DEFAULT_CONTAINER_CLS = 'img-container-loaded';\n\n  public static readonly STRATEGIES = STRATEGIES;\n  public static readonly EMPTY_IMAGE = EMPTY_IMAGE;\n\n  /** Event that represents ready state of {@link ESLImage} */\n  @prop('ready') public READY_EVENT: string;\n  /** Event that represents successfully loaded state of {@link ESLImage} */\n  @prop('load') public LOAD_EVENT: string;\n  /** Event that represents error state of {@link ESLImage} */\n  @prop('error') public ERROR_EVENT: string;\n\n  @attr() public alt: string;\n  @attr({defaultValue: 'save-ratio'}) public mode: string;\n  @attr({dataAttr: true}) public src: string;\n  @attr({dataAttr: true}) public srcBase: string;\n\n  @attr({defaultValue: 'none'}) public lazy: 'auto' | 'manual' | 'none' | '';\n  @boolAttr() public lazyTriggered: boolean;\n\n  @boolAttr() public refreshOnUpdate: boolean;\n  @attr({defaultValue: 'inner-image'}) public innerImageClass: string;\n\n  @attr({defaultValue: null}) public containerClass: string | null;\n  @attr({defaultValue: '::parent'}) public containerClassTarget: string;\n  @attr({defaultValue: 'ready'}) public containerClassState: string;\n\n  @boolAttr({readonly: true}) public readonly ready: boolean;\n  @boolAttr({readonly: true}) public readonly loaded: boolean;\n  @boolAttr({readonly: true}) public readonly error: boolean;\n\n  private _strategy: ESLImageRenderStrategy | null;\n  private _innerImg: HTMLImageElement | null;\n  private _srcRules: ESLMediaRuleList<string>;\n  private _currentSrc: string;\n  private _detachLazyTrigger: () => void;\n  private _shadowImageElement: HTMLImageElement;\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.alt =\n      this.alt || this.getAttribute('aria-label') || this.getAttribute('data-alt') || '';\n    this.updateA11y();\n    this.srcRules = ESLMediaRuleList.parse(this.src);\n    if (this.lazyObservable) {\n      this.removeAttribute('lazy-triggered');\n      getIObserver().observe(this);\n      this._detachLazyTrigger = function (): void {\n        getIObserver().unobserve(this);\n        this._detachLazyTrigger = null;\n      };\n    }\n    this.refresh();\n  }\n\n  protected override disconnectedCallback(): void {\n    this.clearImage();\n    super.disconnectedCallback();\n    this._detachLazyTrigger && this._detachLazyTrigger();\n    if (this._srcRules) {\n      this._srcRules.removeEventListener(this._onMediaMatchChange);\n    }\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'aria-label':\n        this.alt = newVal || '';\n        break;\n      case 'alt':\n      case 'role':\n        this.updateA11y();\n        break;\n      case 'data-src':\n        this.srcRules = ESLMediaRuleList.parse(newVal);\n        this.refresh();\n        break;\n      case 'data-src-base':\n        this.refresh();\n        break;\n      case 'mode':\n        this.changeMode(oldVal, newVal);\n        break;\n      case 'lazy-triggered':\n        this.lazyTriggered && this.update();\n        break;\n    }\n  }\n\n  public get srcRules(): ESLMediaRuleList<string> {\n    if (!this._srcRules) {\n      this.srcRules = ESLMediaRuleList.parse(this.src);\n    }\n    return this._srcRules;\n  }\n\n  public set srcRules(rules: ESLMediaRuleList<string>) {\n    if (this._srcRules) {\n      this._srcRules.removeEventListener(this._onMediaMatchChange);\n    }\n    this._srcRules = rules;\n    this._srcRules.addEventListener(this._onMediaMatchChange);\n  }\n\n  public get currentSrc(): string {\n    return this._currentSrc;\n  }\n\n  public get empty(): boolean {\n    return !this._currentSrc || isEmptyImage(this._currentSrc);\n  }\n\n  public get canUpdate(): boolean {\n    return this.lazyTriggered || this.lazy === 'none';\n  }\n\n  public get lazyObservable(): boolean {\n    return this.lazy !== 'none' && this.lazy !== 'manual';\n  }\n\n  public get originalWidth(): number {\n    return this._shadowImageElement ? this._shadowImageElement.width : 0;\n  }\n\n  public get originalHeight(): number {\n    return this._shadowImageElement ? this._shadowImageElement.height : 0;\n  }\n\n  public triggerLoad(): void {\n    this.setAttribute('lazy-triggered', '');\n  }\n\n  protected changeMode(oldVal: string, newVal: string): void {\n    oldVal = oldVal || 'save-ratio';\n    newVal = newVal || 'save-ratio';\n    if (oldVal === newVal) return;\n    if (!STRATEGIES[newVal]) {\n      this.mode = oldVal;\n      throw new Error('ESL Image: Unsupported mode: ' + newVal);\n    }\n    this.clearImage();\n    if (this.loaded) this.syncImage();\n  }\n\n  protected update(force: boolean = false): void {\n    if (!this.canUpdate) return;\n\n    const src = this.getPath(this.srcRules.activeValue);\n\n    if (this._currentSrc !== src || !this.ready || force) {\n      this._currentSrc = src;\n      this._shadowImg.src = src;\n\n      if (this.refreshOnUpdate || !this.ready) {\n        this.syncImage();\n      }\n\n      if (this._shadowImg.complete) {\n        this._shadowImgError ? this._onError() : this._onLoad();\n      }\n    }\n\n    this._detachLazyTrigger && this._detachLazyTrigger();\n  }\n\n  protected updateA11y(): void {\n    const role = this.getAttribute('role') || 'img';\n    this.setAttribute('role', role);\n    this.innerImage && (this.innerImage.alt = this.alt);\n    if (role === 'img') this.setAttribute('aria-label', this.alt);\n  }\n\n  protected getPath(src: string | undefined): string {\n    if (!src || src === '0' || src === 'none') {\n      return ESLImage.EMPTY_IMAGE;\n    }\n    return this.srcBase + src;\n  }\n\n  public refresh(): void {\n    this.removeAttribute('loaded');\n    this.removeAttribute('ready');\n    this.updateContainerClasses();\n    this.clearImage();\n    this.update(true);\n  }\n\n  private syncImage(): void {\n    const strategy = STRATEGIES[this.mode];\n    this._strategy = strategy;\n    strategy && strategy.apply(this, this._shadowImg);\n  }\n\n  private clearImage(): void {\n    this._strategy && this._strategy.clear(this);\n    this._strategy = null;\n  }\n\n  public get innerImage(): HTMLImageElement | null {\n    return this._innerImg;\n  }\n\n  public attachInnerImage(): HTMLImageElement {\n    if (!this._innerImg) {\n      this._innerImg = this.querySelector(`img.${this.innerImageClass}`) ||\n        this._shadowImg.cloneNode() as HTMLImageElement;\n      this._innerImg.className = this.innerImageClass;\n    }\n    if (!this._innerImg.parentNode) {\n      this.appendChild(this._innerImg);\n    }\n    this._innerImg.alt = this.alt;\n    return this._innerImg;\n  }\n\n  public removeInnerImage(): void {\n    if (!this.innerImage) return;\n    this.removeChild(this.innerImage);\n    setTimeout(() => {\n      if (this._innerImg && !this._innerImg.parentNode) {\n        this._innerImg = null;\n      }\n    });\n  }\n\n  protected get _shadowImg(): HTMLImageElement {\n    if (!this._shadowImageElement) {\n      this._shadowImageElement = new Image();\n      this._shadowImageElement.onload = this._onLoad;\n      this._shadowImageElement.onerror = this._onError;\n    }\n    return this._shadowImageElement;\n  }\n\n  protected get _shadowImgError(): boolean {\n    if (!this._shadowImg.complete) return false;\n    if (this._shadowImg.src.slice(-4) === '.svg') return false;\n    return this._shadowImg.naturalHeight <= 0;\n  }\n\n  @bind\n  private _onLoad(): void {\n    this.syncImage();\n    this._onReadyState(true);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onError(): void {\n    this._onReadyState(false);\n    this.updateContainerClasses();\n  }\n\n  @bind\n  private _onMediaMatchChange(): void {\n    this.update();\n  }\n\n  private _onReadyState(successful: boolean): void {\n    if (this.ready) return;\n    this.toggleAttribute('loaded', successful);\n    this.toggleAttribute('error', !successful);\n    this.toggleAttribute('ready', true);\n\n    this.$$fire(successful ? this.LOAD_EVENT : this.ERROR_EVENT, {bubbles: false});\n    this.$$fire(this.READY_EVENT, {bubbles: false});\n  }\n\n  public updateContainerClasses(): void {\n    if (this.containerClass === null) return;\n    const cls = this.containerClass || (this.constructor as typeof ESLImage).DEFAULT_CONTAINER_CLS;\n    const state = isLoadState(this.containerClassState) && this[this.containerClassState];\n\n    const targetEl = ESLTraversingQuery.first(this.containerClassTarget, this) as HTMLElement;\n    targetEl && CSSClassUtils.toggle(targetEl, cls, state);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Image: typeof ESLImage;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-image': ESLImage;\n  }\n}\n","import {DeviceDetector} from '../../../esl-utils/environment/device-detector';\nimport {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst shortcuts = new Map<string, string | boolean>();\n\n/**\n * Static shortcuts preprocessor. Used to store device related shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('EnvShortcuts')\nexport class ESLEnvShortcuts {\n  // For debug purposes\n  private static readonly _shortcuts = shortcuts;\n\n  /**\n   * Add mapping\n   * @param shortcut - term to find in query\n   * @param value - media query string or boolean result (that represents `all` or `not all` conditions)\n   */\n  public static add(shortcut: string, value: string | boolean): void {\n    if (!['boolean', 'string'].includes(typeof value)) value = false;\n    shortcuts.set(shortcut.toLowerCase(), value);\n  }\n\n  /** Remove mapping for passed shortcut term */\n  public static remove(shortcut: string): boolean {\n    return shortcuts.delete(shortcut.toLowerCase());\n  }\n\n  /** Replaces shortcut to registered result */\n  public static process(match: string): string | boolean | undefined {\n    if (shortcuts.has(match)) return shortcuts.get(match);\n  }\n}\n\n// Touch check\nESLEnvShortcuts.add('touch', DeviceDetector.isTouchDevice);\n\n// Basic device type shortcuts\nESLEnvShortcuts.add('bot', DeviceDetector.isBot);\nESLEnvShortcuts.add('mobile', DeviceDetector.isMobile);\nESLEnvShortcuts.add('desktop', !DeviceDetector.isMobile);\nESLEnvShortcuts.add('android', DeviceDetector.isAndroid);\nESLEnvShortcuts.add('ios', DeviceDetector.isMobileIOS);\n\n// Basic browser shortcuts\nESLEnvShortcuts.add('ie', DeviceDetector.isIE);\nESLEnvShortcuts.add('edge', DeviceDetector.isEdgeHTML);\nESLEnvShortcuts.add('gecko', DeviceDetector.isGecko);\nESLEnvShortcuts.add('webkit', DeviceDetector.isWebkit);\nESLEnvShortcuts.add('blink', DeviceDetector.isBlink);\nESLEnvShortcuts.add('safari', DeviceDetector.isSafari);\nESLEnvShortcuts.add('safari-ios', DeviceDetector.isMobileSafari);\n\ndeclare global {\n  export interface ESLLibrary {\n    EnvShortcuts: typeof ESLEnvShortcuts;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\n\nconst registry = new Map<string, ESLScreenBreakpoint>();\n\n/**\n * ESL Screen Breakpoints registry\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Screen Breakpoint registry is used to provide custom breakpoints for {@link ESLMediaQuery}\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenBreakpoints')\nexport abstract class ESLScreenBreakpoints {\n  protected static readonly BP_REGEXP = /^([+-]?)([a-z]+)/i;\n  protected static readonly BP_NAME_REGEXP = /^[a-z]+/i;\n\n  /**\n   * Add or replace breakpoint shortcut that can be used inside ESLMediaQuery\n   * @param name - name of shortcut\n   * @param minWidth - min width for breakpoint\n   * @param maxWidth - max width for breakpoint\n   */\n  public static add(name: string, minWidth: number, maxWidth: number): ESLScreenBreakpoint | undefined {\n    name = name.toLowerCase();\n    if (ESLScreenBreakpoints.BP_NAME_REGEXP.test(name)) {\n      const current = registry.get(name);\n      registry.set(name, new ESLScreenBreakpoint(name, minWidth, maxWidth));\n      return current;\n    }\n    throw new Error('The shortcut should consist only of Latin characters and be at least one character long.');\n  }\n\n  /** Removes screen breakpoint */\n  public static remove(name: string): boolean {\n    return registry.delete(name.toLowerCase());\n  }\n\n  /** @returns known breakpoint shortcut instance */\n  public static get(name: string): ESLScreenBreakpoint | undefined {\n    return registry.get((name || '').toLowerCase());\n  }\n\n  /** All available breakpoints names */\n  public static get names(): string[] {\n    const keys: string[] = [];\n    registry.forEach((value, key) => keys.push(key));\n    return keys;\n  }\n\n  /** @returns breakpoints shortcut replacement */\n  public static process(term: string): string | undefined {\n    const [, sign, bp] = term.match(ESLScreenBreakpoints.BP_REGEXP) || [];\n    const shortcut = ESLScreenBreakpoints.get(bp);\n    if (!shortcut) return;\n    if (sign === '+') return shortcut.mediaQueryGE;\n    if (sign === '-') return shortcut.mediaQueryLE;\n    return shortcut.mediaQuery;\n  }\n}\n\n/** ESL Screen Breakpoint description */\nexport class ESLScreenBreakpoint {\n  constructor(\n    public readonly name: string,\n    public readonly min: number,\n    public readonly max: number\n  ) {}\n\n  public get mediaQuery(): string {\n    return `(min-width: ${this.min}px) and (max-width: ${this.max}px)`;\n  }\n\n  public get mediaQueryGE(): string {\n    return `(min-width: ${this.min}px)`;\n  }\n\n  public get mediaQueryLE(): string {\n    return `(max-width: ${this.max}px)`;\n  }\n\n  public toString(): string {\n    return `[${this.name}]: ${this.min} to ${this.max}`;\n  }\n}\n\n// Defaults\nESLScreenBreakpoints.add('xs', 1, 767);\nESLScreenBreakpoints.add('sm', 768, 991);\nESLScreenBreakpoints.add('md', 992, 1199);\nESLScreenBreakpoints.add('lg', 1200, 1599);\nESLScreenBreakpoints.add('xl', 1600, 999999);\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenBreakpoints: typeof ESLScreenBreakpoints;\n  }\n}\n","import {ExportNs} from '../../../esl-utils/environment/export-ns';\nimport {DeviceDetector} from '../../../esl-utils/environment/device-detector';\n\n/**\n * DPR preprocessor. Used to replace DPR shortcuts.\n * @author Alexey Stsefanovich (ala'n)\n *\n * @implements IMediaQueryPreprocessor statically\n */\n@ExportNs('ScreenDPR')\nexport class ESLScreenDPR {\n  protected static readonly VALUE_REGEXP = /(\\d(\\.\\d)?)x/;\n\n  /** Option to exclude dpr greater then 2 for bots */\n  public static ignoreBotsDpr = false;\n\n  public static toDPI(dpr: number): string {\n    return (96 * dpr).toFixed(1);\n  }\n\n  public static process(match: string): string | undefined {\n    if (!ESLScreenDPR.VALUE_REGEXP.test(match)) return;\n    const dpr = parseFloat(match);\n    if (dpr < 0 || isNaN(dpr)) return;\n    if (ESLScreenDPR.ignoreBotsDpr && DeviceDetector.isBot && dpr > 1) return 'not all';\n    if (DeviceDetector.isSafari) return `(-webkit-min-device-pixel-ratio: ${dpr})`;\n    return `(min-resolution: ${ESLScreenDPR.toDPI(dpr)}dpi)`;\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ScreenDPR: typeof ESLScreenDPR;\n  }\n}\n","export interface IMediaQueryCondition extends EventTarget {\n  /** @returns true if current environment satisfies query */\n  matches: boolean;\n\n  /** @deprecated alias for `addEventListener` */\n  addListener(cb: EventListener): void;\n  /** Subscribes to media query state change. Shortcut for `addEventListener('change', callback)` */\n  addEventListener(callback: EventListener): void;\n  /** Subscribes to media query state change. Implements {@link EventTarget} interface */\n  addEventListener(type: 'change', callback: EventListener): void;\n\n  /** @deprecated alias for `removeEventListener` */\n  removeListener(cb: EventListener): void;\n  /** Unsubscribes from media query state change event. Shortcut for `removeEventListener('change', callback)` */\n  removeEventListener(callback: EventListener): void;\n  /** Unsubscribes from media query state change event. Implements {@link EventTarget} interface */\n  removeEventListener(type: 'change', callback: EventListener): void;\n\n  /** Optimize condition with nested hierarchy */\n  optimize(): IMediaQueryCondition;\n}\n\n/** Custom event dispatched by {@link ESLMediaQuery} instances */\nexport class ESLMediaChangeEvent extends Event {\n  /** `true` if the query is matched device conditions when event was dispatched */\n  public readonly matches: boolean;\n  public override readonly target: IMediaQueryCondition;\n\n  constructor(matches: boolean) {\n    super('change');\n    this.matches = matches;\n  }\n\n  /** Returns serialized value of the current {@link ESLMediaQuery} */\n  public get media(): string {\n    return String(this.target);\n  }\n}\n","import {SyntheticEventTarget} from '../../../esl-utils/dom/events';\nimport {ALL, NOT_ALL} from './media-query-const';\nimport {ESLMediaChangeEvent} from './media-query-base';\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Simple media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Wraps matchMedia instance\n */\nexport class MediaQueryCondition extends SyntheticEventTarget implements IMediaQueryCondition {\n  protected readonly _inverted: boolean;\n  protected readonly _mq: MediaQueryList;\n\n  constructor(query: string, inverted = false) {\n    super();\n    this._inverted = inverted;\n    this._mq = matchMedia(query.trim() || 'all');\n    this._onChange = this._onChange.bind(this);\n  }\n\n  public get matches(): boolean {\n    return this._inverted ? !this._mq.matches : this._mq.matches;\n  }\n\n  public override addEventListener(callback: EventListener): void;\n  public override addEventListener(type: 'change', callback: EventListener): void;\n  public override addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.getEventListeners('change').length > 1) return;\n    if (typeof this._mq.addEventListener === 'function') {\n      this._mq.addEventListener('change', this._onChange);\n    } else {\n      this._mq.addListener(this._onChange);\n    }\n  }\n\n  public override removeEventListener(callback: EventListener): void;\n  public override removeEventListener(type: 'change', callback: EventListener): void;\n  public override removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    if (typeof this._mq.removeEventListener === 'function') {\n      this._mq.removeEventListener('change', this._onChange);\n    } else {\n      this._mq.removeListener(this._onChange);\n    }\n  }\n\n  /** Optimize query. Can simplify query to {@link MediaQueryConstCondition} */\n  public optimize(): IMediaQueryCondition {\n    if (ALL.eq(this)) return this._inverted ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(this)) return this._inverted ? ALL : NOT_ALL;\n    return this;\n  }\n\n  public override toString(): string {\n    const query = this._mq.media;\n    const inverted = this._inverted;\n    const complex = inverted && /\\)[\\s\\w]+\\(/.test(query);\n    return (inverted ? 'not ' : '') + (complex ? `(${query})` : query);\n  }\n\n  /** Handles query change and dispatches it on top level in case result value is changed */\n  protected _onChange(): void {\n    this.dispatchEvent(new ESLMediaChangeEvent(this._mq.matches));\n  }\n}\n","import type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Const media condition implementation\n * @author Alexey Stsefanovich (ala'n)\n *\n * Ignores listeners always return the same result.\n * Have only two instances: {@link ALL} and {@link NOT_ALL}\n */\nclass MediaQueryConstCondition implements IMediaQueryCondition {\n  constructor(private readonly _matches: boolean) {}\n\n  public get matches(): boolean {\n    return this._matches;\n  }\n\n  public addListener(): void {}\n  public addEventListener(): void {}\n\n  public removeListener(): void {}\n  public removeEventListener(): void {}\n\n  public dispatchEvent(): boolean {\n    return false;\n  }\n\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n  public toString(): string {\n    return this._matches ? 'all' : 'not all';\n  }\n\n  /** Compares const media condition with the passed query instance or string */\n  public eq(val: IMediaQueryCondition | string): boolean {\n    return String(val).trim() === this.toString();\n  }\n}\n\nexport const ALL = new MediaQueryConstCondition(true);\nexport const NOT_ALL = new MediaQueryConstCondition(false);\n","import {SyntheticEventTarget} from '../../../esl-utils/dom/events';\nimport {ESLMediaChangeEvent} from './media-query-base';\nimport {ALL, NOT_ALL} from './media-query-const';\n\nimport type {IMediaQueryCondition} from './media-query-base';\n\n/**\n * Abstract multiple media conditions container\n * @author Alexey Stsefanovich (ala'n)\n *\n * Observe all child items. Dispatch changes when the whole condition result is changed\n */\nabstract class MediaQueryContainer extends SyntheticEventTarget implements IMediaQueryCondition {\n  protected _matches: boolean;\n\n  constructor(protected readonly items: IMediaQueryCondition[] = []) {\n    super();\n    this._matches = this.matches;\n    this._onChange = this._onChange.bind(this);\n  }\n\n  public override addEventListener(callback: EventListener): void;\n  public override addEventListener(type: 'change', callback: EventListener): void;\n  public override addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.getEventListeners('change').length > 1) return;\n    this.items.forEach((item) => item.addEventListener('change', this._onChange));\n  }\n\n  public override removeEventListener(callback: EventListener): void;\n  public override removeEventListener(type: 'change', callback: EventListener): void;\n  public override removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    this.items.forEach((item) => item.removeEventListener('change', this._onChange));\n  }\n\n  public optimize(): IMediaQueryCondition {\n    return this;\n  }\n  public get matches(): boolean {\n    return false;\n  }\n\n  /** Handles query change and dispatches it on top level in case result value is changed */\n  protected _onChange(): void {\n    const {matches} = this;\n    if (this._matches ===  matches) return;\n    this.dispatchEvent(new ESLMediaChangeEvent(this._matches = matches));\n  }\n}\n\n/** Conjunction (AND) group of media conditions */\nexport class MediaQueryConjunction extends MediaQueryContainer {\n  public override get matches(): boolean {\n    return this.items.every((item) => item.matches);\n  }\n\n  public override optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => NOT_ALL.eq(item))) return NOT_ALL;\n    const items = optimizedItems.filter((item) => !ALL.eq(item));\n    if (items.length === 0) return ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryConjunction(items);\n  }\n\n  public override toString(): string {\n    return this.items.join(' and ');\n  }\n}\n\n/** Disjunction (OR) group of media conditions */\nexport class MediaQueryDisjunction extends MediaQueryContainer {\n  public override get matches(): boolean {\n    return this.items.some((item) => item.matches);\n  }\n\n  public override optimize(): IMediaQueryCondition {\n    const optimizedItems = this.items.map((item) => item.optimize());\n    if (optimizedItems.some((item) => ALL.eq(item))) return ALL;\n    const items = optimizedItems.filter((item) => !NOT_ALL.eq(item));\n    if (items.length === 0) return NOT_ALL;\n    if (items.length === 1) return items[0];\n    return new MediaQueryDisjunction(items);\n  }\n\n  public override toString(pretty = false): string {\n    return this.items.join(pretty ? ' or ' : ', ');\n  }\n}\n","import {memoize} from '../../esl-utils/decorators';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\n\nimport {ESLScreenDPR} from './common/screen-dpr';\nimport {ESLScreenBreakpoints} from './common/screen-breakpoint';\nimport {ESLEnvShortcuts} from './common/env-shortcuts';\n\nimport {ALL, NOT_ALL} from './conditions/media-query-const';\nimport {MediaQueryCondition} from './conditions/media-query-condition';\nimport {MediaQueryConjunction, MediaQueryDisjunction} from './conditions/media-query-containers';\n\nimport type {IMediaQueryCondition} from './conditions/media-query-base';\n\nexport interface IMediaQueryPreprocessor {\n  process: (match: string) => string | boolean | undefined;\n}\n\n/**\n * ESL Media Query\n * @implements EventTarget\n * Provides special media condition syntax - ESLMediaQuery\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n *\n * Utility to support extended MediaQuery features\n * Supports\n * - CSS MediaQuery matching check\n * - DPR display queries (`@x1|@x2|@x3`)\n * - Registered screen default sizes (breakpoints) shortcuts (`@[-|+](XS|SM|MD|LG|XL)`)\n * - Device and browser shortcuts (`@MOBILE|@DESKTOP|@IE`)\n * - Custom static shortcuts and custom query preprocessors\n * - `not` logic operation (can have multiple not operators before any term of the query)\n * - `or` or `,` logical operator (have a lowest priority)\n * - Query matching change listeners\n * - Implements {@link EventTarget}, compatible with {@link ESLEventListener}\n *\n * Building query process:\n *\n * [Building query logical tree] - [preprocess nodes queries] - [building native MediaQueryList nodes] - [query tree optimization]\n */\n@ExportNs('MediaQuery')\nexport abstract class ESLMediaQuery implements IMediaQueryCondition {\n  /** Always true condition */\n  public static readonly ALL: ESLMediaQuery = ALL;\n  /** Always false condition */\n  public static readonly NOT_ALL: ESLMediaQuery = NOT_ALL;\n\n  protected static readonly SHORTCUT_PATTERN = /@([a-z0-9.+-]+)/i;\n  protected static readonly _preprocessors: IMediaQueryPreprocessor[] = [];\n\n  /** Adds {@link IMediaQueryPreprocessor} instance for query preprocessing step */\n  public static use(preprocessor: IMediaQueryPreprocessor): typeof ESLMediaQuery {\n    this._preprocessors.unshift(preprocessor);\n    return this;\n  }\n\n  /** Cached method to create {@link ESLMediaQuery} condition instance from query string */\n  @memoize()\n  public static for(query: string): ESLMediaQuery {\n    return ESLMediaQuery.from(query);\n  }\n\n  /** Creates {@link ESLMediaQuery} condition instance from query string */\n  public static from(query: string): ESLMediaQuery {\n    const conjunctions = query.split(/\\sor\\s|,/).map((term) => {\n      const conditions = term.split(/\\sand\\s/).map(ESLMediaQuery.parseSimpleQuery);\n      return new MediaQueryConjunction(conditions);\n    });\n    return new MediaQueryDisjunction(conjunctions).optimize();\n  }\n\n  /** Preprocess simple query term by applying replacers and shortcuts rules */\n  protected static preprocess(term: string): string {\n    if (!this.SHORTCUT_PATTERN.test(term)) return term;\n    const shortcut = term.trim().substring(1).toLowerCase();\n    for (const replacer of this._preprocessors) {\n      const result = replacer.process(shortcut);\n      if (typeof result === 'string') return result;\n      if (typeof result === 'boolean') return result ? 'all' : 'not all';\n    }\n    return term;\n  }\n\n  /** Creates simple {@link ESLMediaQuery} condition */\n  protected static parseSimpleQuery(term: string): ESLMediaQuery {\n    const query = term.replace(/^\\s*not\\s+/, '');\n    const queryInverted = query !== term;\n    const processedQuery = ESLMediaQuery.preprocess(query);\n    const sanitizedQuery = processedQuery.replace(/^\\s*not\\s+/, '');\n    const resultInverted = processedQuery !== sanitizedQuery;\n    const invert = queryInverted !== resultInverted;\n\n    if (ALL.eq(sanitizedQuery)) return invert ? NOT_ALL : ALL;\n    if (NOT_ALL.eq(sanitizedQuery)) return invert ? ALL : NOT_ALL;\n    return new MediaQueryCondition(sanitizedQuery, invert);\n  }\n\n  // Implements IESLMQCondition to allow use ESLMediaQuery as IESLMQCondition type alias\n  public abstract matches: boolean;\n\n  public abstract optimize(): ESLMediaQuery;\n  public abstract dispatchEvent(event: Event): boolean;\n  public abstract toString(): string;\n\n  public abstract addEventListener(callback: EventListener): void;\n  public abstract addEventListener(type: 'change', callback: EventListener): void;\n  public abstract removeEventListener(callback: EventListener): void;\n  public abstract removeEventListener(type: 'change', callback: EventListener): void;\n\n  /** @deprecated alias for `addEventListener` */\n  public abstract addListener(cb: EventListener): void;\n  /** @deprecated alias for `removeEventListener` */\n  public abstract removeListener(cb: EventListener): void;\n}\n\n// Register otb preprocessors\nESLMediaQuery.use(ESLScreenDPR);\nESLMediaQuery.use(ESLScreenBreakpoints);\nESLMediaQuery.use(ESLEnvShortcuts);\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaQuery: typeof ESLMediaQuery;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {evaluate} from '../../esl-utils/misc/format';\nimport {deepMerge, isEqual} from '../../esl-utils/misc/object';\nimport {SyntheticEventTarget} from '../../esl-utils/dom/events';\nimport {ESLMediaRule} from './esl-media-rule';\n\nimport type {RulePayloadParser} from './esl-media-rule';\n\n/** Custom event dispatched by {@link ESLMediaRuleList} instances */\nexport class ESLMediaRuleListEvent<T = any> extends Event {\n  /** Current value of target {@link ESLMediaRuleList} instances */\n  public readonly current: T;\n  /** Previous value of target {@link ESLMediaRuleList} instances */\n  public readonly previous: T;\n  /** Target {@link ESLMediaRuleList} instances */\n  public override readonly target: ESLMediaRuleList<T>;\n\n  constructor(current: T, previous: T) {\n    super('change');\n    Object.assign(this, {current, previous});\n  }\n}\n\n/**\n * ESLMediaRuleList - {@link ESLMediaRule} observable collection\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n *\n * Represents observable object that wraps environment to value mapping\n */\n@ExportNs('MediaRuleList')\nexport class ESLMediaRuleList<T = any> extends SyntheticEventTarget {\n  /** String value parser (default) */\n  public static STRING_PARSER: RulePayloadParser<string> = String;\n  /** Object value parser. Uses {@link evaluate} to parse value */\n  public static OBJECT_PARSER = <U = any>(val: string): U | undefined => evaluate(val);\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Expect serialized {@link ESLMediaRule}s separated by '|'\n   * Uses exact strings as rule list values\n   *\n   * @param query - query string\n   */\n  public static parse(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation.\n   * Expect serialized {@link ESLMediaRule}s separated by '|'\n   *\n   * @param query - query string\n   * @param parser - value parser function\n   */\n  public static parse<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parse('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5')\n   * ```\n   */\n  public static parse(mask: string, values: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   * @param parser - value parser function\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5', Number)\n   * ```\n   */\n  public static parse<U>(mask: string, values: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parse(query: string, ...common: (string | RulePayloadParser<any>)[]): ESLMediaRuleList {\n    const parser: RulePayloadParser<any> = typeof common[common.length - 1] === 'function' ? common.pop() as any : String;\n    const value = common.pop();\n    return typeof value === 'string' ?\n      ESLMediaRuleList.parseTuple(query, value, parser) :\n      ESLMediaRuleList.parseQuery(query, parser);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * Uses exact strings as rule list values\n   * @param query - query string\n   */\n  public static parseQuery(query: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from string query representation\n   * @param query - query string\n   * @param parser - value parser function\n   */\n  public static parseQuery<U>(query: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parseQuery(query: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const rules = query.split('|')\n      .map((lex: string) => ESLMediaRule.parse(lex, parser))\n      .filter((rule: ESLMediaRule) => !!rule) as ESLMediaRule[];\n    return new ESLMediaRuleList(rules);\n  }\n\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple('@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5')\n   * ```\n   */\n  public static parseTuple(mask: string, values: string): ESLMediaRuleList<string>;\n  /**\n   * Creates `ESLMediaRuleList` from two strings with conditions and values sequences\n   *\n   * @param mask - media conditions tuple string (uses '|' as separator)\n   * @param values - values tuple string (uses '|' as separator)\n   * @param parser - value parser function\n   *\n   * @example\n   * ```ts\n   * ESLMediaRuleList.parseTuple(@XS|@SM|@MD|@LG|@XL', '1|2|3|4|5', Number)\n   * ```\n   */\n  public static parseTuple<U>(mask: string, values: string, parser: RulePayloadParser<U>): ESLMediaRuleList<U>;\n  public static parseTuple(mask: string, values: string, parser: RulePayloadParser<any> = String): ESLMediaRuleList {\n    const queries = mask.split('|');\n    const valueList = values.split('|');\n    while (valueList.length < queries.length && valueList.length !== 0) valueList.push(valueList[valueList.length - 1]);\n    if (valueList.length !== queries.length) throw Error('Value doesn\\'t correspond to mask');\n    const rules: (ESLMediaRule | undefined)[] = queries.map((query, i) => ESLMediaRule.create(valueList[i], query, parser));\n    const validRules = rules.filter((rule) => !!rule) as ESLMediaRule[];\n    return new ESLMediaRuleList(validRules);\n  }\n\n  protected _value: T | undefined;\n  protected readonly _rules: ESLMediaRule<T>[];\n\n  private constructor(rules: ESLMediaRule<T>[]) {\n    super();\n    this._rules = rules;\n    this._onMatchChanged = this._onMatchChanged.bind(this);\n  }\n\n  /** Subscribes to the instance active rule change */\n  public override addEventListener(callback: EventListener): void;\n  public override addEventListener(type: 'change', callback: EventListener): void;\n  public override addEventListener(type: any, callback: EventListener = type): void {\n    super.addEventListener(type, callback);\n    if (this.getEventListeners('change').length > 1) return;\n    this._value = this.computedValue;\n    this.rules.forEach((rule) => rule.addEventListener(this._onMatchChanged));\n  }\n\n  /** Unsubscribes from the instance active rule change */\n  public override removeEventListener(callback: EventListener): void;\n  public override removeEventListener(type: 'change', callback: EventListener): void;\n  public override removeEventListener(type: any, callback: EventListener = type): void {\n    super.removeEventListener(type, callback);\n    if (this.hasEventListener()) return;\n    delete this._value;\n    this.rules.forEach((rule) => rule.removeEventListener(this._onMatchChanged));\n  }\n\n  /** Array of {@link ESLMediaRule}s that forms the current {@link ESLMediaRuleList} */\n  public get rules(): ESLMediaRule<T>[] {\n    return this._rules;\n  }\n\n  /** All active {@link ESLMediaRule}s */\n  public get active(): ESLMediaRule<T>[] {\n    return this.rules.filter((rule) => rule.matches);\n  }\n  /** Value of the last of active rules */\n  public get activeValue(): T | undefined {\n    return this.active.pop()?.payload;\n  }\n  /** All active rule values */\n  public get activeValues(): T[] {\n    return this.active.map((rule) => rule.payload);\n  }\n\n  /**\n   * Current value of {@link ESLMediaRuleList} object\n   * Uses cache if current object is under observation\n   */\n  public get value(): T | undefined {\n    if (!this.hasEventListener()) return this.computedValue;\n    return Object.hasOwnProperty.call(this, '_value') ? this._value : this.computedValue;\n  }\n  /** Always computed value of the current {@link ESLMediaRuleList} object */\n  public get computedValue(): T | undefined {\n    return deepMerge(undefined, ...this.activeValues);\n  }\n\n  /** Handles inner rules state change */\n  private _onMatchChanged(): void {\n    const curValue = this.value;\n    const newValue = this.computedValue;\n    if (isEqual(curValue, newValue)) return;\n    this._value = newValue;\n    this.dispatchEvent(new ESLMediaRuleListEvent(newValue, curValue));\n  }\n\n  /** @returns serialized {@link ESLMediaRuleList} object representation*/\n  public override toString(): string {\n    return this.rules.join('|');\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    MediaRuleList: typeof ESLMediaRuleList;\n  }\n}\n","import {ESLMediaQuery} from './esl-media-query';\n\nexport type RulePayloadParser<T> = (val: string) => T | undefined;\n\n/**\n * ESL Media Rule\n * @author Yuliya Adamskaya\n *\n * Helper class to wrap {@link ESLMediaQuery} with the payload value\n * @see ESLMediaQuery\n * @see ESLMediaRuleList\n */\nexport class ESLMediaRule<T = any> {\n  public readonly query: ESLMediaQuery;\n  public readonly payload: T;\n\n  constructor(payload: T, query: string = '') {\n    this.query = ESLMediaQuery.for(query);\n    this.payload = payload;\n  }\n\n  /** @returns if the inner {@link ESLMediaQuery} is matching current device configuration */\n  public get matches(): boolean {\n    return this.query.matches;\n  }\n\n  /** Subscribes on inner {@link ESLMediaQuery} changes */\n  public addEventListener(callback: EventListener): void;\n  public addEventListener(type: 'change', callback: EventListener): void;\n  public addEventListener(type: any, callback: EventListener = type): void {\n    this.query.addEventListener(callback);\n  }\n\n  /** Unsubscribes from inner {@link ESLMediaQuery} changes */\n  public removeEventListener(callback: EventListener): void;\n  public removeEventListener(type: 'change', callback: EventListener): void;\n  public removeEventListener(type: any, callback: EventListener = type): void {\n    this.query.removeEventListener(callback);\n  }\n\n  public toString(): string {\n    const val = typeof this.payload === 'object' ?\n      JSON.stringify(this.payload) :\n      String(this.payload);\n    return `${this.query} => ${val}`;\n  }\n\n  /**\n   * Creates the {@link ESLMediaRule} instance from payload string, query and valueParser.\n   * If the payload parse result is undefined then rule will be undefined.\n   */\n  public static create<U>(payload: string, query: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const payloadValue = parser(payload.trim());\n    if (typeof payloadValue === 'undefined') return undefined;\n    return new ESLMediaRule<U>(payloadValue, query.trim());\n  }\n\n  /** Parses the rule string to the {@link ESLMediaRule} instance */\n  public static parse<U>(lex: string, parser: RulePayloadParser<U>): ESLMediaRule<U> | undefined {\n    const parts = lex.split('=>');\n    const query = parts.length === 2 ? parts[0] : '';\n    const payload = parts.length === 2 ? parts[1] : parts[0];\n    return ESLMediaRule.create(payload, query, parser);\n  }\n\n  /** Shortcut to create always active {@link ESLMediaRule} with passed value */\n  public static all<U>(payload: U): ESLMediaRule<U> {\n    return new ESLMediaRule<U>(payload, 'all');\n  }\n  /** Shortcut to create always inactive {@link ESLMediaRule} */\n  public static empty(): ESLMediaRule<undefined> {\n    return new ESLMediaRule(undefined, 'all');\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst RATIO_TO_ACTIVATE = 0.75; // TODO: customizable, at least global\nconst RATIO_TO_DEACTIVATE = 0.20; // TODO: customizable, at least global\n\nlet iObserver: IntersectionObserver;\n\n/** ESL Media Play-In-Viewport IntersectionObserver instance */\nexport function getIObserver(lazy: boolean = false): IntersectionObserver {\n  if (!iObserver && !lazy) {\n    iObserver = new IntersectionObserver(function (entries) {\n      entries.forEach(handleViewport);\n    }, {\n      threshold: [RATIO_TO_DEACTIVATE, RATIO_TO_ACTIVATE]\n    });\n  }\n  return iObserver;\n}\n\nfunction handleViewport(entry: IntersectionObserverEntry): void {\n  const video = entry.target as ESLMedia;\n\n  // Videos that playing and out of min ratio RATIO_TO_DEACTIVATE should be stopped\n  if (video.active && entry.intersectionRatio <= RATIO_TO_DEACTIVATE) {\n    video.pause();\n  }\n  // Play should start only for inactive and background(muted) videos that are visible more than on RATIO_TO_ACTIVATE\n  if (!video.active && video.autoplay && entry.intersectionRatio >= RATIO_TO_ACTIVATE) {\n    video.play();\n  }\n}\n","import type {ESLMedia} from './esl-media';\n\nconst managerMap = new Map<string, ESLMedia>();\n\n/**\n * Group restriction manager for {@link ESLMedia}\n * Only one media in group can be played\n * Empty group is ignored\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\nexport class MediaGroupRestrictionManager {\n  /** @internal */\n  static get managerMap(): Map<string, ESLMedia> {\n    return managerMap;\n  }\n\n  /** Register instance play state in group */\n  public static registerPlay(instance: ESLMedia): void {\n    if (instance.group) {\n      const current = managerMap.get(instance.group);\n      managerMap.set(instance.group, instance);\n      if (!current || current === instance || !current.active) return;\n      if (current.$$fire(current.MANAGED_PAUSE_EVENT)) current.pause();\n    }\n  }\n\n  /** Unregister instance */\n  public static unregister(instance: ESLMedia): void {\n    if (instance.group) {\n      const reg = managerMap.get(instance.group);\n      if (reg === instance) managerMap.delete(instance.group);\n    }\n  }\n}\n","import {ESLMediaProviderRegistry} from './esl-media-registry';\n\nimport type {ESLMedia} from './esl-media';\n\nexport enum PlayerStates {\n  BUFFERING = 3,\n  ENDED = 0,\n  PAUSED = 2,\n  PLAYING = 1,\n  UNSTARTED = -1,\n  VIDEO_CUED = 5,\n  UNINITIALIZED = -2\n}\n\nexport interface MediaProviderConfig {\n  mediaSrc?: string;\n  mediaId?: string;\n  loop: boolean;\n  muted: boolean;\n  controls: boolean;\n  autoplay: boolean;\n  title: string;\n  preload?: 'none' | 'metadata' | 'auto' | '';\n  playsinline?: boolean;\n}\n\nexport type ProviderType = (new(component: ESLMedia, config: MediaProviderConfig) => BaseProvider) & typeof BaseProvider;\n\nexport type ProviderObservedParams = 'loop' | 'muted' | 'controls';\n\n/**\n * BaseProvider class for media API providers\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya, Natallia Harshunova\n */\nexport abstract class BaseProvider {\n  static readonly providerName: string;\n\n  static parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    return null;\n  }\n  static parseConfig(component: ESLMedia): MediaProviderConfig {\n    const {loop, muted, controls, autoplay, title, preload, playsinline, mediaId, mediaSrc} = component;\n    const config = {loop, muted, controls, autoplay, title, preload, playsinline};\n    if (mediaId) Object.assign(config, {mediaId});\n    if (mediaSrc) Object.assign(config, {mediaSrc});\n    return config;\n  }\n\n  protected config: MediaProviderConfig;\n  protected component: ESLMedia;\n  protected _el: HTMLElement;\n  protected _ready: Promise<any>;\n\n  public constructor(component: ESLMedia, config: MediaProviderConfig) {\n    this.config = config;\n    this.component = component;\n  }\n\n  /** Wraps _ready promise */\n  get ready(): Promise<any> {\n    if (!this._ready) {\n      const res = Promise.reject('Not Initialized');\n      res.catch((e) => console.log('Rejected Media Operation: ', e));\n      return res;\n    }\n    return this._ready;\n  }\n\n  /** Bind the provider instance to the component */\n  public abstract bind(): void;\n\n  /** Unbind the provider instance from the component */\n  public unbind(): void {\n    Array.from(this.component.querySelectorAll('.esl-media-inner'))\n      .forEach((el: Node) => el.parentNode && el.parentNode.removeChild(el));\n  }\n\n  /** Provider name */\n  public get name(): string {\n    return (this.constructor as typeof BaseProvider).providerName;\n  }\n\n  /** @returns current state of the player */\n  public abstract get state(): PlayerStates;\n\n  /** @returns recommended aspect ratio */\n  public abstract get defaultAspectRatio(): number;\n\n  /** @returns resource duration */\n  public abstract get duration(): number;\n\n  /** @returns resource current time */\n  public abstract get currentTime(): number;\n\n  /** Low-level provider 'seek to' method implementation */\n  protected abstract seekTo(pos?: number): void | Promise<any>;\n\n  /** Low-level provider 'play' method implementation */\n  protected abstract play(): void | Promise<any>;\n\n  /** Low-level provider 'pause' method implementation */\n  protected abstract pause(): void | Promise<any>;\n\n  /** Low-level provider 'stop' method implementation */\n  protected abstract stop(): void | Promise<any>;\n\n  /** Set focus to the inner content */\n  public focus(): void {\n    this._el?.focus();\n  }\n\n  protected onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.config[param] = value;\n  }\n\n  /** Set size for inner content */\n  public setSize(width: number | 'auto', height: number | 'auto'): void {\n    if (!this._el) return;\n    this._el.style.setProperty('width', width === 'auto' ? null : `${width}px`);\n    this._el.style.setProperty('height', height === 'auto' ? null : `${height}px`);\n  }\n\n  /**\n   * Executes toggle action:\n   * If the player is PAUSED then it starts playing otherwise it pause playing\n   */\n  protected toggle(): void | Promise<any> {\n    if ([PlayerStates.PAUSED, PlayerStates.UNSTARTED, PlayerStates.VIDEO_CUED].includes(this.state)) {\n      return this.play();\n    } else {\n      return this.pause();\n    }\n  }\n\n  /** Executes onConfigChange action when api is ready */\n  public onSafeConfigChange(param: ProviderObservedParams, value: boolean): void {\n    this.ready.then(() => this.onConfigChange(param, value));\n  }\n\n  /** Executes seekTo action when api is ready */\n  public safeSeekTo(pos: number): Promise<void> {\n    return this.ready.then(() => this.seekTo(pos));\n  }\n\n  /** Executes play when api is ready */\n  public safePlay(): Promise<void> {\n    return this.ready.then(() => this.play());\n  }\n\n  /** Executes pause when api is ready */\n  public safePause(): Promise<void> {\n    return this.ready.then(() => this.pause());\n  }\n\n  /**\n   * Executes stop when api is ready\n   * @returns Promise\n   */\n  public safeStop(): Promise<void> {\n    return this.ready.then(() => this.stop());\n  }\n\n  /**\n   * Executes toggle when api is ready\n   * @returns Promise\n   */\n  public safeToggle(): Promise<void> {\n    return this.ready.then(() => this.toggle());\n  }\n\n  /**\n   * Register current provider.\n   * Can be used as a decorator.\n   */\n  public static register(this: ProviderType): void;\n  public static register(this: unknown, provider?: ProviderType): void;\n  public static register(this: any, provider?: ProviderType): void {\n    provider = provider || this;\n    if (provider === BaseProvider) throw new Error('`BaseProvider` can\\'t be registered.');\n    if (!(provider?.prototype instanceof BaseProvider)) throw new Error('Provider should be instanceof `BaseProvider`');\n    ESLMediaProviderRegistry.instance.register(provider);\n  }\n}\n","import {Observable} from '../../esl-utils/abstract/observable';\nimport type {BaseProvider, ProviderType} from './esl-media-provider';\n\nimport type {ESLMedia} from './esl-media';\n\nlet evRegistryInstance: ESLMediaProviderRegistry | null = null;\n/**\n * ESLMediaProviderRegistry class to store media API providers\n * @author Yuliya Adamskaya, Natallia Harshunova\n */\nexport class ESLMediaProviderRegistry extends Observable<(name: string, provider: ProviderType) => void> {\n  private providersMap: Map<string, ProviderType> = new Map();\n\n  public static get instance(): ESLMediaProviderRegistry {\n    if (!evRegistryInstance) {\n      evRegistryInstance = new ESLMediaProviderRegistry();\n    }\n    return evRegistryInstance;\n  }\n\n  /** List of registered providers */\n  public get providers(): ProviderType[] {\n    const list: ProviderType[] = [];\n    this.providersMap.forEach((provider) => list.push(provider));\n    return list;\n  }\n\n  /** Register provider */\n  public register(provider: ProviderType): void {\n    if (!provider.providerName) throw new Error('Provider should have a name');\n    this.providersMap.set(provider.providerName, provider);\n    this.fire(provider.providerName, provider);\n  }\n\n  /** Check that provider is registered for passed name */\n  public has(name: string): boolean {\n    return this.providersMap.has(name);\n  }\n\n  /** Find provider by name */\n  public findByName(name: string): ProviderType | null {\n    if (!name || name === 'auto') return null;\n    return this.providersMap.get(name.toLowerCase()) || null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance */\n  public createFor(media: ESLMedia): BaseProvider | null {\n    return this.createByType(media) || this.createBySrc(media);\n  }\n\n  /** Create provider instance for passed ESLMedia instance via provider name */\n  private createByType(media: ESLMedia): BaseProvider | null {\n    const provider = this.findByName(media.mediaType);\n    return provider ? ESLMediaProviderRegistry._create(provider, media) : null;\n  }\n\n  /** Create provider instance for passed ESLMedia instance via url */\n  private createBySrc(media: ESLMedia): BaseProvider | null {\n    for (const provider of this.providers.reverse()) {\n      const cfg = provider.parseUrl(media.mediaSrc);\n      if (cfg) return ESLMediaProviderRegistry._create(provider, media, cfg);\n    }\n    return null;\n  }\n\n  /** Create provider instance for passed configuration */\n  private static _create(provider: ProviderType, media: ESLMedia, cfg = provider.parseUrl(media.mediaSrc)): BaseProvider {\n    const config = Object.assign({}, cfg || {}, provider.parseConfig(media));\n    return new provider(media, config);\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind, prop, attr, boolAttr} from '../../esl-utils/decorators';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {parseAspectRatio} from '../../esl-utils/misc/format';\n\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\n\nimport {SPACE, PAUSE} from '../../esl-utils/dom/keys';\nimport {getIObserver} from './esl-media-iobserver';\nimport {PlayerStates} from './esl-media-provider';\nimport {ESLMediaProviderRegistry} from './esl-media-registry';\nimport {MediaGroupRestrictionManager} from './esl-media-manager';\n\nimport type {BaseProvider} from './esl-media-provider';\n\nexport type ESLMediaFillMode = 'cover' | 'inscribe' | '';\n\n/**\n * ESLMedia - custom element, that provides an ability to add and configure media (video / audio)\n * using a single tag as well as work with external providers using simple native-like API.\n *\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@ExportNs('Media')\nexport class ESLMedia extends ESLBaseElement {\n  public static override is = 'esl-media';\n  public static observedAttributes = [\n    'disabled',\n    'load-condition',\n    'media-type',\n    'media-id',\n    'media-src',\n    'fill-mode',\n    'aspect-ratio',\n    'play-in-viewport',\n    'muted',\n    'loop',\n    'controls'\n  ];\n\n  /** Event to dispatch on ready state */\n  @prop('esl:media:ready') public READY_EVENT: string;\n  /** Event to dispatch on error state */\n  @prop('esl:media:error') public ERROR_EVENT: string;\n  /** Event to dispatch when player plays */\n  @prop('esl:media:play') public PLAY_EVENT: string;\n  /** Event to dispatch when player paused */\n  @prop('esl:media:paused') public PAUSED_EVENT: string;\n  /** Event to dispatch when player ended */\n  @prop('esl:media:ended') public ENDED_EVENT: string;\n  /** Event to dispatch when player detached */\n  @prop('esl:media:detached') public DETACHED_EVENT: string;\n  /** Event to dispatch when player paused by another instance in group */\n  @prop('esl:media:managedpause') public MANAGED_PAUSE_EVENT: string;\n\n  /** Media resource identifier */\n  @attr() public mediaId: string;\n  /** Media resource src/url path */\n  @attr() public mediaSrc: string;\n  /** Media resource type. 'auto' (auto detection from src) by default */\n  @attr() public mediaType: string;\n\n  /** Media elements group name */\n  @attr() public group: string;\n  /** Media resource rendering strategy relative to the element area: 'cover', 'inscribe' or not defined */\n  @attr() public fillMode: ESLMediaFillMode;\n  /** Strict aspect ratio definition */\n  @attr() public aspectRatio: string;\n\n\n  /** Disabled marker to prevent rendering */\n  @boolAttr() public disabled: boolean;\n  /** Autoplay resource marker */\n  @boolAttr() public autoplay: boolean;\n  /** Autofocus on play marker */\n  @boolAttr() public override autofocus: boolean;\n  /** Mute resource marker */\n  @boolAttr() public muted: boolean;\n  /** Loop resource play */\n  @boolAttr() public loop: boolean;\n  /** Marker to show controls for resource player */\n  @boolAttr() public controls: boolean;\n  /** Allow media to play inline (see HTML video/audio spec) */\n  @boolAttr() public playsinline: boolean;\n  /** Allows play resource only in viewport area */\n  @boolAttr() public playInViewport: boolean;\n\n  /** Preload resource */\n  @attr({defaultValue: 'auto'}) public preload: 'none' | 'metadata' | 'auto' | '';\n\n  /** Ready state class/classes */\n  @attr() public readyClass: string;\n  /** Ready state class/classes target */\n  @attr() public readyClassTarget: string;\n\n  /** Class / classes to add when media is accepted */\n  @attr() public loadClsAccepted: string;\n  /** Class / classes to add when media is declined */\n  @attr() public loadClsDeclined: string;\n  /** Condition {@link ESLMediaQuery} to allow load of media resource. Default: `all` */\n  @attr({defaultValue: 'all'}) public loadCondition: string;\n  /** Target element {@link ESLTraversingQuery} select to add accepted/declined classes */\n  @attr({defaultValue: '::parent'}) public loadClsTarget: string;\n\n  /** @readonly Ready state marker */\n  @boolAttr({readonly: true}) public ready: boolean;\n  /** @readonly Active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n  /** @readonly Resource played marker */\n  @boolAttr({readonly: true}) public played: boolean;\n  /** @readonly Error state marker */\n  @boolAttr({readonly: true}) public error: boolean;\n\n  private _provider: BaseProvider | null;\n\n  private deferredResize = rafDecorator(() => this._onResize());\n  private deferredReinitialize = debounce(() => this.reinitInstance());\n\n  /**\n   * Map object with possible Player States, values:\n   * BUFFERING, ENDED, PAUSED, PLAYING, UNSTARTED, VIDEO_CUED, UNINITIALIZED\n   */\n  static get PLAYER_STATES(): typeof PlayerStates {\n    return PlayerStates;\n  }\n\n  static supports(name: string): boolean {\n    return ESLMediaProviderRegistry.instance.has(name);\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'application');\n    }\n    this.innerHTML += '<!-- Inner Content, do not modify it manually -->';\n    this.bindEvents();\n    this.attachViewportConstraint();\n    this.deferredReinitialize();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.unbindEvents();\n    this.detachViewportConstraint();\n    this._provider && this._provider.unbind();\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    switch (attrName) {\n      case 'disabled':\n      case 'media-id':\n      case 'media-src':\n      case 'media-type':\n        this.deferredReinitialize();\n        break;\n      case 'loop':\n      case 'muted':\n      case 'controls':\n        this._provider && this._provider.onSafeConfigChange(attrName, newVal !== null);\n        break;\n      case 'fill-mode':\n      case 'aspect-ratio':\n        this.deferredResize();\n        break;\n      case 'play-in-viewport':\n        this.playInViewport ?\n          this.attachViewportConstraint() :\n          this.detachViewportConstraint();\n        break;\n      case 'load-condition':\n        ESLMediaQuery.for(oldVal).removeEventListener(this.deferredReinitialize);\n        ESLMediaQuery.for(newVal).addEventListener(this.deferredReinitialize);\n        this.deferredReinitialize();\n        break;\n    }\n  }\n\n  protected bindEvents(): void {\n    ESLMediaProviderRegistry.instance.addListener(this._onRegistryStateChange);\n    this.conditionQuery.addEventListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.addEventListener('resize', this.deferredResize);\n    }\n    window.addEventListener(this.REFRESH_EVENT, this._onRefresh);\n    this.addEventListener('keydown', this._onKeydown);\n  }\n  protected unbindEvents(): void {\n    ESLMediaProviderRegistry.instance.removeListener(this._onRegistryStateChange);\n    this.conditionQuery.removeEventListener(this.deferredReinitialize);\n    if (this.fillModeEnabled) {\n      window.removeEventListener('resize', this.deferredResize);\n    }\n    window.removeEventListener(this.REFRESH_EVENT, this._onRefresh);\n    this.removeEventListener('keydown', this._onKeydown);\n  }\n\n  public canActivate(): boolean {\n    if (this.disabled) return false;\n    return this.conditionQuery.matches;\n  }\n\n  private reinitInstance(): void {\n    console.debug('[ESL] Media reinitialize ', this);\n    this._provider && this._provider.unbind();\n    this._provider = null;\n\n    if (this.canActivate()) {\n      this._provider = ESLMediaProviderRegistry.instance.createFor(this);\n      if (this._provider) {\n        this._provider.bind();\n        console.debug('[ESL] Media provider bound', this._provider);\n      } else {\n        this._onError();\n      }\n    }\n\n    this.updateContainerMarkers();\n  }\n\n  public updateContainerMarkers(): void {\n    const targetEl = ESLTraversingQuery.first(this.loadClsTarget, this) as HTMLElement;\n    if (!targetEl) return;\n\n    const active = this.canActivate();\n    CSSClassUtils.toggle(targetEl, this.loadClsAccepted, active);\n    CSSClassUtils.toggle(targetEl, this.loadClsDeclined, !active);\n  }\n\n  /** Seek to given position of media */\n  public seekTo(pos: number): Promise<void> | null {\n    return this._provider && this._provider.safeSeekTo(pos);\n  }\n\n  /**\n   * Start playing media\n   * @param allowActivate - allows to remove disabled marker\n   */\n  public play(allowActivate: boolean = false): Promise<void> | null {\n    if (this.disabled && allowActivate) {\n      this.disabled = false;\n      this.deferredReinitialize.cancel();\n      this.reinitInstance();\n    }\n    if (!this.canActivate()) return null;\n    return this._provider && this._provider.safePlay();\n  }\n\n  /** Pause playing media */\n  public pause(): Promise<void> | null {\n    return this._provider && this._provider.safePause();\n  }\n\n  /** Stop playing media */\n  public stop(): Promise<void> | null {\n    return this._provider && this._provider.safeStop();\n  }\n\n  /** Toggle play/pause state of the media */\n  public toggle(): Promise<void> | null {\n    return this._provider && this._provider.safeToggle();\n  }\n\n  /** Focus inner player **/\n  public focusPlayer(): void {\n    this._provider && this._provider.focus();\n  }\n\n  // media live-cycle handlers\n  public _onReady(): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', false);\n    this.updateReadyClass();\n    this.deferredResize();\n    this.$$fire(this.READY_EVENT);\n  }\n\n  public _onError(detail?: any, setReadyState = true): void {\n    this.toggleAttribute('ready', true);\n    this.toggleAttribute('error', true);\n    this.$$fire(this.ERROR_EVENT, {detail});\n    setReadyState && this.$$fire(this.READY_EVENT);\n  }\n\n  public _onDetach(): void {\n    this.removeAttribute('active');\n    this.removeAttribute('ready');\n    this.removeAttribute('played');\n    this.updateReadyClass();\n    this.$$fire(this.DETACHED_EVENT);\n  }\n\n  public _onPlay(): void {\n    if (this.autofocus) this.focus();\n    this.deferredResize();\n    this.setAttribute('active', '');\n    this.setAttribute('played', '');\n    this.$$fire(this.PLAY_EVENT);\n    MediaGroupRestrictionManager.registerPlay(this);\n  }\n\n  public _onPaused(): void {\n    this.removeAttribute('active');\n    this.$$fire(this.PAUSED_EVENT);\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onEnded(): void {\n    this.removeAttribute('active');\n    this.$$fire(this.ENDED_EVENT);\n    MediaGroupRestrictionManager.unregister(this);\n  }\n\n  public _onResize(): void {\n    if (!this._provider) return;\n    if (this.fillModeEnabled && this.actualAspectRatio > 0) {\n      let stretchVertically = this.offsetWidth / this.offsetHeight < this.actualAspectRatio;\n      if (this.fillMode === 'inscribe') stretchVertically = !stretchVertically; // Inscribe behaves inversely\n      stretchVertically ?\n        this._provider.setSize(this.actualAspectRatio * this.offsetHeight, this.offsetHeight) : // h\n        this._provider.setSize(this.offsetWidth, this.offsetWidth / this.actualAspectRatio);   // w\n    } else {\n      this._provider.setSize('auto', 'auto');\n    }\n  }\n\n  @bind\n  protected _onRefresh(e: Event): void {\n    const {target} = e;\n    if (target instanceof HTMLElement && target.contains(this)) {\n      this._onResize();\n    }\n  }\n\n  @bind\n  protected _onRegistryStateChange(name: string): void {\n    const type = this.mediaType.toLowerCase() || 'auto';\n    if (name === type || (!this.providerType && type === 'auto')) {\n      this.reinitInstance();\n    }\n  }\n\n  @bind\n  protected _onKeydown(e: KeyboardEvent): void {\n    if (e.target !== this) return;\n    if ([SPACE, PAUSE].includes(e.key)) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.toggle();\n    }\n  }\n\n  /** Update ready class state */\n  protected updateReadyClass(): void {\n    const target = ESLTraversingQuery.first(this.readyClassTarget, this) as HTMLElement;\n    target && CSSClassUtils.toggle(target, this.readyClass, this.ready);\n  }\n\n  /** Applied provider */\n  public get providerType(): string {\n    return this._provider ? this._provider.name : '';\n  }\n\n  /** Current player state, see {@link ESLMedia.PLAYER_STATES} values */\n  public get state(): PlayerStates {\n    return this._provider ? this._provider.state : PlayerStates.UNINITIALIZED;\n  }\n\n  /** Duration of the media resource */\n  public get duration(): number {\n    return this._provider ? this._provider.duration : 0;\n  }\n\n  /** Current time of media resource */\n  public get currentTime(): number {\n    return this._provider ? this._provider.currentTime : 0;\n  }\n\n  /** Set current time of media resource */\n  public set currentTime(time: number) {\n    (this._provider) && this._provider.safeSeekTo(time);\n  }\n\n  /** ESLMediaQuery to limit ESLMedia loading */\n  public get conditionQuery(): ESLMediaQuery {\n    return ESLMediaQuery.for(this.loadCondition);\n  }\n\n  /** Fill mode should be handled for element */\n  public get fillModeEnabled(): boolean {\n    return this.fillMode === 'cover' || this.fillMode === 'inscribe';\n  }\n\n  /** Used resource aspect ratio forced by attribute or returned by provider */\n  public get actualAspectRatio(): number {\n    if (this.aspectRatio && this.aspectRatio !== 'auto') return parseAspectRatio(this.aspectRatio);\n    return this._provider ? this._provider.defaultAspectRatio : 0;\n  }\n\n  protected attachViewportConstraint(): void {\n    if (this.playInViewport) {\n      getIObserver().observe(this);\n    }\n  }\n  protected detachViewportConstraint(): void {\n    const observer = getIObserver(true);\n    observer && observer.unobserve(this);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Media: typeof ESLMedia;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-media': ESLMedia;\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {ESLMedia} from '../core/esl-media';\nimport type {ProviderObservedParams} from '../core/esl-media-provider';\nimport type {VideoJsPlayer} from 'video.js';\n\nconst API_SCRIPT_ID = 'BC_API_SOURCE';\n\nexport interface BCPlayerAccount {\n  playerId: string | null;\n  accountId: string | null;\n}\n\n/**\n * Brightcove API provider for {@link ESLMedia}\n * @author Julia Murashko\n */\n@BaseProvider.register\nexport class BrightcoveProvider extends BaseProvider {\n  static override readonly providerName: string = 'brightcove';\n\n  protected videojsClasses = 'video-js vjs-default-skin video-js-brightcove';\n\n  protected _api: VideoJsPlayer;\n  protected _account: BCPlayerAccount;\n  protected _autoplay: boolean;\n\n  /**\n   * @returns settings, get from element by default\n   */\n  protected static getAccount(el: ESLMedia): BCPlayerAccount {\n    return {\n      playerId: el.getAttribute('player-id'),\n      accountId: el.getAttribute('player-account')\n    };\n  }\n\n  /** Loads player API according defined settings */\n  protected static loadAPI(account: BCPlayerAccount): Promise<Event> {\n    const apiSrc =\n      `//players.brightcove.net/${account.accountId}/${account.playerId}_default/index.min.js`;\n    const apiScript = document.getElementById(API_SCRIPT_ID);\n    if (apiScript && apiScript.parentNode && apiScript.getAttribute('src') !== apiSrc) {\n      apiScript.parentNode.removeChild(apiScript);\n    }\n    return loadScript(API_SCRIPT_ID, apiSrc);\n  }\n\n  /** Build video brightcove element */\n  protected buildVideo(): HTMLElement {\n    const el = document.createElement('video-js');\n    el.id = 'esl-media-brightcove-' + randUID();\n    el.className = 'esl-media-inner esl-media-brightcove ' + this.videojsClasses;\n    el.title = this.config.title;\n    el.toggleAttribute('loop', this.config.loop);\n    el.toggleAttribute('muted', this.config.muted);\n    el.toggleAttribute('controls', this.config.controls);\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('data-embed', 'default');\n    el.setAttribute('data-video-id', this.config.mediaId || '');\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    this._account.playerId && el.setAttribute('data-player', this._account.playerId);\n    this._account.accountId && el.setAttribute('data-account', this._account.accountId);\n    return el;\n  }\n\n  /** Utility method to convert api event to promise */\n  protected $$fromEvent(eventName: string): Promise<void> {\n    if (!this._api) return Promise.reject();\n    return new Promise((resolve, reject) => this._api ? this._api.one(eventName, resolve) : reject());\n  }\n\n  /**\n   * Executes as soon as api script detected or loaded.\n   * @returns promise with provided API\n   */\n  protected onAPILoaded(): Promise<void> | void {\n    if (typeof window.bc !== 'function' || typeof window.videojs !== 'function') {\n      throw new Error('Brightcove API is not in the global scope');\n    }\n    this._api = window.bc(this._el);\n    return new Promise((resolve, reject) => this._api ? this._api.ready(resolve) : reject());\n  }\n\n  /**\n   * Executes after API ready state resolved\n   * Basic onAPIReady should be called to subscribe to API state\n   */\n  protected onAPIReady(): Promise<void> | void {\n    // Set autoplay though js because BC is unresponsive while processing it natively\n    this._api.autoplay(this._autoplay || this.config.autoplay);\n\n    // Listeners to control player state\n    this._api.on('play', () => this.component._onPlay());\n    this._api.on('pause', () => this.component._onPaused());\n    this._api.on('ended', () => this.component._onEnded());\n    this.component._onReady();\n\n    // Can handle query only when loadedmetadata have happened\n    return this.$$fromEvent('loadedmetadata');\n  }\n\n  public bind(): void {\n    const Provider = (this.constructor as typeof BrightcoveProvider);\n    this._account = Provider.getAccount(this.component);\n    this._el = this.buildVideo();\n    this.component.appendChild(this._el);\n\n    this._ready = Provider.loadAPI(this._account)\n      .then(() => this.onAPILoaded())\n      .then(() => this.onAPIReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  public override unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.dispose();\n    super.unbind();\n  }\n\n  protected override onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (typeof this._api[param] === 'function') {\n      this._api[param](value);\n    }\n  }\n\n  public override focus(): void {\n    this._api && this._api.focus();\n  }\n\n  public get state(): PlayerStates {\n    if (this._api) {\n      if (this._api.ended()) return PlayerStates.ENDED;\n      if (this._api.paused()) return PlayerStates.PAUSED;\n      if (!this._api.played()) return PlayerStates.UNSTARTED;\n      return PlayerStates.PLAYING;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get defaultAspectRatio(): number {\n    if (!this._api) return 0;\n    return this._api.videoWidth() / this._api.videoHeight();\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.currentTime() : 0;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.duration() : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.currentTime(pos);\n  }\n\n  public play(): void {\n    this._api.play();\n  }\n\n  public pause(): void {\n    this._api.pause();\n  }\n\n  public stop(): void {\n    this._api.currentTime(0);\n    this._api.pause();\n  }\n\n  // Overrides to set tech autoplay marker\n  public override safePlay(): Promise<any> {\n    this._autoplay = true;\n    return super.safePlay();\n  }\n  public override safeStop(): Promise<any> {\n    this._autoplay = true;\n    return super.safeStop();\n  }\n}\n\n// root typing\ndeclare global {\n  interface Window {\n    bc?: (el: HTMLElement, ...args: any[]) => VideoJsPlayer;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Audio API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class AudioProvider extends HTMLMediaProvider {\n  static override readonly providerName: string = 'audio';\n  static override readonly urlPattern = /\\.(mp3|wav|aac)(\\?|$)/;\n\n  protected override _el: HTMLAudioElement;\n\n  protected createElement(): HTMLAudioElement {\n    const el = document.createElement('audio');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public get defaultAspectRatio(): number {\n    return 0;\n  }\n}\n","import {BaseProvider, PlayerStates} from '../../core/esl-media-provider';\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../../core/esl-media-provider';\n\n/**\n * Simple Native Media API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya, Alexey Stsefanovich (ala'n)\n */\nexport abstract class HTMLMediaProvider extends BaseProvider {\n  static readonly urlPattern: RegExp;\n\n  static override parseUrl(mediaSrc: string): Partial<MediaProviderConfig> | null {\n    if (this.urlPattern.test(mediaSrc)) {\n      return {mediaSrc};\n    }\n    return null;\n  }\n\n  protected override _el: HTMLMediaElement;\n\n  protected static applyElementSettings(el: HTMLMediaElement, cfg: MediaProviderConfig): HTMLMediaElement {\n    el.classList.add('esl-media-inner');\n    el.autoplay = cfg.autoplay;\n    el.preload = cfg.preload || 'auto' ;\n    el.loop = cfg.loop;\n    el.muted = cfg.muted;\n    el.controls = cfg.controls;\n    el.tabIndex = 0;\n    el.toggleAttribute('playsinline', cfg.playsinline);\n    return el;\n  }\n\n  protected abstract createElement(): HTMLMediaElement;\n\n  public override onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n  }\n\n  public bind(): void {\n    this._el = this.createElement();\n    HTMLMediaProvider.applyElementSettings(this._el, this.config);\n    this.component.appendChild(this._el);\n    this.bindListeners();\n  }\n\n  protected bindListeners(): void {\n    this._el.addEventListener('loadedmetadata', () => this.component._onReady());\n    this._el.addEventListener('play', () => this.component._onPlay());\n    this._el.addEventListener('pause', () => this.component._onPaused());\n    this._el.addEventListener('ended', () => this.component._onEnded());\n    this._el.addEventListener('error', (e) => this.component._onError(e));\n  }\n\n  public override unbind(): void {\n    this.component._onDetach();\n    super.unbind();\n  }\n\n  override get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public get state(): PlayerStates {\n    if (!this._el) return PlayerStates.UNINITIALIZED;\n    if (this._el.ended) return PlayerStates.ENDED;\n    if (!this._el.played || !this._el.played.length) return PlayerStates.UNSTARTED;\n    if (this._el.paused) return PlayerStates.PAUSED;\n    return PlayerStates.PLAYING;\n  }\n\n  public get duration(): number {\n    return this._el ? this._el.duration : 0;\n  }\n\n  public get currentTime(): number {\n    return this._el ? this._el.currentTime : 0;\n  }\n\n  public seekTo(pos: number): void {\n    this._el.currentTime = pos;\n  }\n\n  public play(): Promise<any> {\n    return this._el.play();\n  }\n\n  public pause(): void {\n    this._el.pause();\n  }\n\n  public stop(): void {\n    this._el.pause();\n    this._el.currentTime = 0;\n  }\n}\n","import {BaseProvider} from '../../core/esl-media-provider';\nimport {HTMLMediaProvider} from './media-provider';\n\n/**\n * Simple Video API provider for {@link ESLMedia}\n * @author Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class VideoProvider extends HTMLMediaProvider {\n  static override readonly providerName: string = 'video';\n  static override readonly urlPattern = /\\.(mp4|webm|ogv|mov)(\\?|$)/;\n\n  protected override _el: HTMLVideoElement;\n\n  protected createElement(): HTMLVideoElement {\n    const el = document.createElement('video');\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  get defaultAspectRatio(): number {\n    return this._el.videoWidth / this._el.videoHeight;\n  }\n}\n","import {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\n\nimport type {MediaProviderConfig} from '../core/esl-media-provider';\n\n/**\n * Simple Basic Iframe provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n)\n */\n@BaseProvider.register\nexport class IframeBasicProvider extends BaseProvider {\n  static override readonly providerName: string = 'iframe';\n\n  private _state: PlayerStates = PlayerStates.UNINITIALIZED;\n  protected override _el: HTMLIFrameElement;\n\n  static override parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    try {\n      if (!url) return null;\n      const {protocol} = new URL(url);\n      if (protocol !== 'http:' && protocol !== 'https:') return null;\n      return {mediaSrc: url};\n    } catch {\n      return null;\n    }\n  }\n\n  protected buildIframe(): HTMLIFrameElement {\n    const el = document.createElement('iframe');\n    el.id = 'esl-media-iframe-' + randUID();\n    el.className = 'esl-media-inner esl-media-iframe';\n    el.title = this.config.title;\n    el.setAttribute('aria-label', this.config.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('scrolling', 'no');\n    el.setAttribute('allowfullscreen', 'yes');\n    el.toggleAttribute('playsinline', this.config.playsinline);\n    el.src = this.config.mediaSrc || '';\n    return el;\n  }\n\n  public bind(): void {\n    if (this._state !== PlayerStates.UNINITIALIZED) return;\n    this._ready = new Promise((resolve, reject) => {\n      this._el = this.buildIframe();\n      this._el.onload = (): void => resolve(this);\n      this._el.onerror = (e): void => reject(e);\n      this._state = PlayerStates.UNSTARTED;\n      this.component.appendChild(this._el);\n    });\n    this._ready.then(() => {\n      this._state = PlayerStates.PLAYING;\n      this.component._onReady();\n      this.component._onPlay();\n    });\n    this._ready.catch((e) => this.component._onError(e));\n  }\n\n  public override unbind(): void {\n    this.component._onDetach();\n    this._state = PlayerStates.UNINITIALIZED;\n    super.unbind();\n  }\n\n  override get ready(): Promise<any> {\n    return Promise.resolve();\n  }\n\n  public override focus(): void {\n    if (this._el && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    return this._state;\n  }\n\n  public get duration(): number {\n    return 0;\n  }\n\n  public get currentTime(): number {\n    return 0;\n  }\n\n  get defaultAspectRatio(): number {\n    return 0;\n  }\n\n  public seekTo(pos: number): void {\n    console.error('[ESLMedia] Unsupported action: can not execute seekTo on abstract iframe provider');\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.UNINITIALIZED) {\n      this.bind();\n    }\n  }\n\n  public pause(): void {\n    this.unbind();\n  }\n\n  public stop(): void {\n    this.unbind();\n  }\n}\n","import {loadScript} from '../../esl-utils/dom/script';\nimport {BaseProvider, PlayerStates} from '../core/esl-media-provider';\nimport {randUID} from '../../esl-utils/misc/uid';\nimport PlayerVars = YT.PlayerVars;\n\nimport type {MediaProviderConfig, ProviderObservedParams} from '../core/esl-media-provider';\n\nconst DEFAULT_ASPECT_RATIO = 16 / 9;\n\n/**\n * Youtube API provider for {@link ESLMedia}\n * @author Alexey Stsefanovich (ala'n), Yuliya Adamskaya\n */\n@BaseProvider.register\nexport class YouTubeProvider extends BaseProvider {\n  static override readonly providerName: string = 'youtube';\n  static readonly idRegexp = /(?:v\\/|v=|vi=|vi\\/|e\\/|embed\\/|user\\/.*\\/u\\/\\d+\\/)([_0-9a-zA-Z-]+)/i;\n  static readonly providerRegexp = /^\\s*(?:https?:\\/\\/)?(?:www\\.)?(?:youtu\\.be|youtube(-nocookie)?\\.com)/i;\n\n  protected override _el: HTMLDivElement | HTMLIFrameElement;\n  protected _api: YT.Player;\n\n  static override parseUrl(url: string): Partial<MediaProviderConfig> | null {\n    if (this.providerRegexp.test(url)) {\n      const [, id] = url.match(this.idRegexp) || [];\n      return id ? {mediaId: id} : null;\n    }\n    return null;\n  }\n\n  private static _coreApiPromise: Promise<void>;\n  protected static getCoreApi(): Promise<void> {\n    if (!YouTubeProvider._coreApiPromise) {\n      YouTubeProvider._coreApiPromise = new Promise((resolve) => {\n        if (window.YT && window.YT.Player) return resolve(window.YT);\n        loadScript('YT_API_SOURCE', '//www.youtube.com/iframe_api');\n        const cbOrigin = window.onYouTubeIframeAPIReady;\n        window.onYouTubeIframeAPIReady = (): void => {\n          try {\n            (typeof cbOrigin === 'function') && cbOrigin.apply(window);\n          } catch (err) { // eslint-disable-line\n            // Do Nothing\n          }\n          return resolve(window.YT);\n        };\n      });\n    }\n    return YouTubeProvider._coreApiPromise;\n  }\n\n  protected static mapOptions(cfg: MediaProviderConfig): PlayerVars {\n    return {\n      enablejsapi: 1,\n      origin: location.origin,\n      rel: 0,\n      showinfo: 0,\n      iv_load_policy: 3, // eslint-disable-line\n      autoplay: Number(cfg.autoplay),\n      controls: Number(cfg.controls),\n      playsinline: Number(cfg.playsinline),\n      disablekb: Number(!cfg.controls), // TODO: criteria\n      autohide: Number(!cfg.controls) // TODO: criteria\n    };\n  }\n\n  protected static buildIframe(sm: MediaProviderConfig): HTMLDivElement | HTMLIFrameElement {\n    const el = document.createElement('div');\n    el.id = 'esl-media-yt-' + randUID();\n    el.className = 'esl-media-inner esl-media-youtube';\n    el.title = sm.title;\n    el.setAttribute('aria-label', el.title);\n    el.setAttribute('frameborder', '0');\n    el.setAttribute('tabindex', '0');\n    el.setAttribute('allowfullscreen', 'yes');\n    return el;\n  }\n\n  public bind(): void {\n    this._el = YouTubeProvider.buildIframe(this.config);\n    this.component.appendChild(this._el);\n    this._ready = YouTubeProvider.getCoreApi()\n      .then(() => this.onCoreApiReady())\n      .then(() => this.onPlayerReady())\n      .catch((e) => this.component._onError(e));\n  }\n\n  /** Init YT.Player on target element */\n  protected onCoreApiReady(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      console.debug('[ESL]: Media Youtube Player initialization for ', this);\n      this._api = new YT.Player(this._el.id, {\n        videoId: this.config.mediaId,\n        events: {\n          onError: (e): void => reject(e),\n          onReady: (): void => resolve(this),\n          onStateChange: (e): void => this._onStateChange(e)\n        },\n        playerVars: YouTubeProvider.mapOptions(this.config)\n      });\n    });\n  }\n  /** Post YT.Player init actions */\n  protected onPlayerReady(): void {\n    console.debug('[ESL]: Media Youtube Player ready ', this);\n    this._el = this._api.getIframe();\n    if (this.config.muted) {\n      this._api.mute();\n    }\n    this.component._onReady();\n  }\n\n  public override unbind(): void {\n    this.component._onDetach();\n    this._api && this._api.destroy();\n    super.unbind();\n  }\n\n  private _onStateChange(event: YT.OnStateChangeEvent): void {\n    switch (+event.data) {\n      case PlayerStates.PLAYING:\n        this.component._onPlay();\n        break;\n      case PlayerStates.PAUSED:\n        this.component._onPaused();\n        break;\n      case PlayerStates.ENDED:\n        if (this.config.loop) {\n          this._api.playVideo();\n        } else {\n          this.component._onEnded();\n        }\n        break;\n    }\n  }\n\n  protected override onConfigChange(param: ProviderObservedParams, value: boolean): void {\n    super.onConfigChange(param, value);\n    if (param === 'muted') {\n      value ? this._api.mute() : this._api.unMute();\n    }\n  }\n\n  public override focus(): void {\n    if (this._el instanceof HTMLIFrameElement && this._el.contentWindow) {\n      this._el.contentWindow.focus();\n    }\n  }\n\n  public get state(): PlayerStates {\n    if (this._api && typeof this._api.getPlayerState === 'function') {\n      return this._api.getPlayerState() as number as PlayerStates;\n    }\n    return PlayerStates.UNINITIALIZED;\n  }\n\n  public get duration(): number {\n    return this._api ? this._api.getDuration() : 0;\n  }\n\n  public get currentTime(): number {\n    return this._api ? this._api.getCurrentTime() : 0;\n  }\n\n  public get defaultAspectRatio(): number {\n    return DEFAULT_ASPECT_RATIO;\n  }\n\n  public seekTo(pos: number): void {\n    this._api.seekTo(pos, false);\n  }\n\n  public play(): void {\n    if (this.state === PlayerStates.ENDED) {\n      this._api.seekTo(0, false);\n    }\n    this._api.playVideo();\n  }\n\n  public pause(): void {\n    this._api.pauseVideo();\n  }\n\n  public stop(): void {\n    this._api.stopVideo();\n  }\n}\n\n// typings\ndeclare global {\n  interface YT extends Promise<void> {\n    Player: YT.Player;\n  }\n\n  interface Window {\n    YT?: YT;\n    onYouTubeIframeAPIReady?: () => void;\n  }\n}\n","import {ESLMixinRegistry} from './esl-mixin-registry';\nimport type {ESLMixinElement, ESLMixinElementInternal} from './esl-mixin-element';\n\n// Singleton cache for ESLMixinAttributesObserver instances\nconst instances = new Map<string, ESLMixinAttributesObserver>();\n\n/**\n * Internal {@link ESLMixinElement}s observedAttributes mutation listener.\n * Creates a single instance per mixin type\n * Ignores mixin primary attribute changes (they are observed by {@link ESLMixinRegistry} ootb)\n */\nexport class ESLMixinAttributesObserver {\n  protected observer = new MutationObserver(\n    (records: MutationRecord[]) => records.forEach(this.handleRecord, this)\n  );\n\n  private constructor(protected readonly type: string) {\n    if (instances.has(type)) return instances.get(type)!;\n    instances.set(type, this);\n  }\n\n  /** Processes single mutation record */\n  protected handleRecord(record: MutationRecord): void {\n    const name = record.attributeName;\n    const target = record.target as HTMLElement;\n    if (!name || !target) return;\n    const mixin = ESLMixinRegistry.get(target, this.type) as ESLMixinElementInternal;\n    mixin && mixin.attributeChangedCallback(name, record.oldValue, target.getAttribute(name));\n  }\n\n  /** Subscribes to the {@link ESLMixinElement} host instance mutations */\n  public observe(mixin: ESLMixinElement): void {\n    const {is, observedAttributes} = mixin.constructor as typeof ESLMixinElement;\n    const attributeFilter = observedAttributes.filter((name: string) => name !== is);\n    if (!attributeFilter.length) return;\n    this.observer.observe(mixin.$host, {\n      attributes: true,\n      attributeFilter,\n      attributeOldValue: true\n    });\n  }\n\n  /** Unsubscribes from the {@link ESLMixinElement} host instance mutations */\n  public unobserve(mixin: ESLMixinElement): void {\n    this.observer.observe(mixin.$host, {\n      attributes: true,\n      attributeFilter: []\n    });\n  }\n\n  private static instanceFor(mixin: ESLMixinElement): ESLMixinAttributesObserver | null {\n    const {is, observedAttributes} = mixin.constructor as typeof ESLMixinElement;\n    const attributes = (observedAttributes || []).filter((name: string) => name !== is);\n    if (!is || !attributes.length) return null;\n    return new ESLMixinAttributesObserver(is);\n  }\n\n  /** Subscribes to the {@link ESLMixinElement} host instance mutations */\n  public static observe(mixin: ESLMixinElement): void {\n    const observer = this.instanceFor(mixin);\n    observer && observer.observe(mixin);\n  }\n\n  /** Unsubscribes from the {@link ESLMixinElement} host instance mutations */\n  public static unobserve(mixin: ESLMixinElement): void {\n    const observer = this.instanceFor(mixin);\n    observer && observer.unobserve(mixin);\n  }\n}\n","import {prop} from '../../esl-utils/decorators';\nimport {setAttr} from '../../esl-utils/dom/attr';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport {ESLMixinRegistry} from './esl-mixin-registry';\nimport {ESLMixinAttributesObserver} from './esl-mixin-attr';\n\nimport type {\n  ESLEventListener,\n  ESLListenerCriteria,\n  ESLListenerDescriptor,\n  ESLListenerHandler\n} from '../../esl-utils/dom/events';\nimport type {ESLBaseComponent} from '../../esl-utils/abstract/component';\nimport type {ESLDomElementRelated} from '../../esl-utils/abstract/dom-target';\n\n/**\n * Base class for mixin elements.\n * Mixin elements attaches to the DOM element via attribute.\n * Allows multiple mixin elements per one DOM element\n */\n@ExportNs('Mixin')\nexport class ESLMixinElement implements ESLBaseComponent, ESLDomElementRelated {\n  /** Root attribute to identify mixin targets. Should contain dash in the name. */\n  static is: string;\n  /** Additional observed attributes */\n  static observedAttributes: string[] = [];\n\n  /** Event to indicate component significant state change that may affect other components state */\n  @prop('esl:refresh') public REFRESH_EVENT: string;\n\n  public constructor(\n    public readonly $host: HTMLElement\n  ) {}\n\n  /** Callback of mixin instance initialization */\n  protected connectedCallback(): void {\n    ESLMixinAttributesObserver.observe(this);\n    ESLEventUtils.subscribe(this);\n  }\n\n  /** Callback to execute on mixin instance destroy */\n  protected disconnectedCallback(): void {\n    ESLMixinAttributesObserver.unobserve(this);\n    ESLEventUtils.unsubscribe(this);\n  }\n\n  /**\n   * Callback to handle changing of additional attributes.\n   * Happens when attribute accessed for writing independently of the actual value change\n   */\n  protected attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {}\n\n  /** Subscribes `handler` method marked with `@listen` decorator */\n  public $$on(handler: ESLListenerHandler): ESLEventListener[];\n  /** Subscribes `handler` function by the passed DOM event descriptor {@link ESLListenerDescriptor} or event name */\n  public $$on<EType extends keyof ESLListenerEventMap>(\n    event: EType | ESLListenerDescriptor<EType>,\n    handler: ESLListenerHandler<ESLListenerEventMap[EType]>\n  ): ESLEventListener[];\n  public $$on(event: any, handler?: any): ESLEventListener[] {\n    return ESLEventUtils.subscribe(this, event, handler);\n  }\n\n  /** Unsubscribes event listener */\n  public $$off(...condition: ESLListenerCriteria[]): ESLEventListener[] {\n    return ESLEventUtils.unsubscribe(this, ...condition);\n  }\n\n  /**\n   * Gets or sets CSS classes for the `$host`\n   * @param cls - CSS classes query {@link CSSClassUtils}\n   * @param value - boolean to set CSS class(es) state or undefined to skip mutation\n   * @returns current classes state or passed state\n   */\n  public $$cls(cls: string, value?: boolean): boolean {\n    if (value === undefined) return CSSClassUtils.has(this.$host, cls);\n    CSSClassUtils.toggle(this.$host, cls, value);\n    return value;\n  }\n\n  /**\n   * Gets or sets attribute for the `$host`.\n   * If the `value` param is undefined then skips mutation.\n   * @param name - attribute name\n   * @param value - string attribute value, boolean attribute state or `null` to delete attribute\n   * @returns current attribute value or previous value for mutation\n   */\n  public $$attr(name: string, value?: null | boolean | string): string | null {\n    const prevValue = this.$host.getAttribute(name);\n    if (value !== undefined) setAttr(this, name, value);\n    return prevValue;\n  }\n\n  /**\n   * Dispatches component custom event on the `$host`.\n   * Uses 'esl:' prefix for event name, overridable to customize event namespaces.\n   * @param eventName - event name\n   * @param eventInit - custom event init. See {@link CustomEventInit}\n   */\n  public $$fire(eventName: string, eventInit?: CustomEventInit): boolean {\n    return ESLEventUtils.dispatch(this.$host, eventName, eventInit);\n  }\n\n  /** Register current mixin definition */\n  public static register(): void {\n    (new ESLMixinRegistry()).register(this);\n  }\n\n  // Public Registry API\n  public static readonly get = ESLMixinRegistry.get;\n  public static readonly getAll = ESLMixinRegistry.getAll;\n}\n\nexport type ESLMixinElementInternal = ESLMixinElement & {\n  connectedCallback(): void;\n  disconnectedCallback(): void;\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\n};\n\nexport type ESLMixinElementConstructable = typeof ESLMixinElement & (new($root: HTMLElement) => ESLMixinElement);\n","import type {\n  ESLMixinElement,\n  ESLMixinElementInternal,\n  ESLMixinElementConstructable\n} from './esl-mixin-element';\n\n// Private key to store mixin instances\nconst STORE = (window.Symbol || String)('__esl_mixins');\n\n// Singleton for registry\nlet global: ESLMixinRegistry;\n\n/** Registry to store and initialize {@link ESLMixinElement} instances */\nexport class ESLMixinRegistry {\n  /** Map that stores available mixins under their identifier (attribute) */\n  protected store = new Map<string, ESLMixinElementConstructable>();\n  /** MutationObserver instance to track DOM changes and init mixins on-fly */\n  protected mutation$$ = new MutationObserver(this._onMutation.bind(this));\n\n  public constructor() {\n    if (global) return global;\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    global = this;\n  }\n\n  /** Array of registered mixin tags */\n  public get observedAttributes(): string[] {\n    const attrs: string[] = [];\n    this.store.forEach((mixin, name) => attrs.push(name));\n    return attrs;\n  }\n\n  /** Registers mixin definition using {@link ESLMixinElement} constructor */\n  public register(mixin: ESLMixinElementConstructable): void {\n    if (!mixin.is || mixin.is.indexOf('-') === -1) {\n      throw new DOMException(`[ESL]: Illegal mixin attribute name \"${mixin.is}\"`, 'NotSupportedError');\n    }\n    const registered = this.store.get(mixin.is);\n    if (registered && registered !== mixin) {\n      throw new DOMException(`[ESL]: Attribute ${mixin.is} is already occupied by another mixin`, 'InUseAttributeError');\n    }\n    if (!registered) {\n      this.store.set(mixin.is, mixin);\n      this.invalidateRecursive(document.documentElement, mixin.is);\n      this.resubscribe();\n    }\n  }\n\n  /** Resubscribes DOM observer */\n  public resubscribe(root: Element = document.documentElement): void {\n    // Don't let flushed changes from being unhandled\n    this._onMutation(this.mutation$$.takeRecords());\n    // Resubscribe for all observed attributes\n    this.mutation$$.disconnect();\n    this.mutation$$.observe(root, {\n      subtree: true,\n      childList: true,\n      attributes: true,\n      attributeFilter: this.observedAttributes,\n      attributeOldValue: true\n    });\n  }\n\n  /**\n   * Invalidates all mixins on the element and subtree\n   * @param root - root HTMLElement to start traversing\n   * @param name - optional filter for mixin name\n   */\n  public invalidateRecursive(root: HTMLElement = document.body, name?: string): void {\n    if (!root) return;\n    name ? this.invalidate(root, name) : this.invalidateAll(root);\n    if (!root.children || !root.children.length) return;\n    Array.prototype.forEach.call(root.children, (child: Element) => this.invalidateRecursive(child as HTMLElement, name));\n  }\n\n  /**\n   * Invalidates all mixins on the element\n   * @param el - host element to invalidate mixins\n   */\n  public invalidateAll(el: HTMLElement): void {\n    const hasStore = Object.hasOwnProperty.call(el, STORE);\n    this.store.forEach((mixin: ESLMixinElementConstructable, name: string) => {\n      if (el.hasAttribute(name)) {\n        ESLMixinRegistry.init(el, mixin);\n      } else if (hasStore) {\n        ESLMixinRegistry.destroy(el, name);\n      }\n    });\n  }\n\n  /**\n   * Invalidates passed mixin name on the element\n   * @param el - host element to invalidate mixin\n   * @param name - mixin name to invalidate\n   * @param oldValue - optional previous value of mixins attribute\n   */\n  public invalidate(el: HTMLElement, name: string, oldValue: string | null = null): void {\n    const newValue = el.getAttribute(name);\n    if (newValue === null) return ESLMixinRegistry.destroy(el, name);\n    const instance = ESLMixinRegistry.get(el, name) as ESLMixinElementInternal;\n    if (instance) {\n      instance.attributeChangedCallback(name, oldValue, newValue);\n    } else {\n      const type = this.store.get(name);\n      type && ESLMixinRegistry.init(el, type);\n    }\n  }\n\n  /** Handles DOM {@link MutationRecord} list */\n  protected _onMutation(mutations: MutationRecord[]): void {\n    mutations.forEach((record: MutationRecord) => {\n      if (record.type === 'attributes' && record.attributeName) {\n        this.invalidate(record.target as HTMLElement, record.attributeName, record.oldValue);\n      }\n      if (record.type === 'childList') {\n        record.addedNodes.forEach((node) => {\n          if (node.nodeType === Node.ELEMENT_NODE) this.invalidateRecursive(node as HTMLElement);\n        });\n        record.removedNodes.forEach((node) => {\n          if (node.nodeType === Node.ELEMENT_NODE) ESLMixinRegistry.destroyAll(node as HTMLElement);\n        });\n      }\n    });\n  }\n\n  /** Returns mixin instance by element */\n  public static get<T extends ESLMixinElementConstructable>(this: T, $el: HTMLElement): InstanceType<T> | null;\n  /** Returns mixin instance by element and mixin name */\n  public static get($el: HTMLElement, name: string): ESLMixinElement | null;\n  /** @returns mixin instance by name */\n  public static get(this: any, el: HTMLElement, mixin: string = this.is): ESLMixinElement | null {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement> | undefined;\n    return (store && store[mixin]) || null;\n  }\n\n  /** @returns all mixins initialized on passed host element */\n  public static getAll(el: HTMLElement): ESLMixinElement[] {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement> | undefined;\n    return store ? Object.keys(store).map((key: string) => store[key]) : [];\n  }\n\n  /** @returns if the passed mixin exists on the element */\n  public static has(el: HTMLElement, mixin: string): boolean {\n    return !!this.get(el, mixin);\n  }\n\n  /** Sets mixin instance to the element store */\n  private static set(el: HTMLElement, mixin: ESLMixinElement): void {\n    if (!Object.hasOwnProperty.call(el, STORE)) Object.defineProperty(el, STORE, {value: {}, configurable: true});\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement>;\n    store[(mixin.constructor as ESLMixinElementConstructable).is] = mixin;\n  }\n\n  /** Inits mixin instance on the element */\n  private static init(el: HTMLElement, Mixin: ESLMixinElementConstructable): ESLMixinElement | null {\n    if (this.has(el, Mixin.is)) return null;\n    const instance = new Mixin(el);\n    ESLMixinRegistry.set(el, instance);\n    (instance as ESLMixinElementInternal).connectedCallback();\n    return instance;\n  }\n\n  /** Destroys passed mixin on the element */\n  private static destroy(el: HTMLElement, mixin: string): void {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement>;\n    if (!store) return;\n    const instance = store[mixin];\n    if (!instance) return;\n    (instance as ESLMixinElementInternal).disconnectedCallback();\n    delete store[mixin];\n  }\n\n  /** Destroys all mixins on the element */\n  private static destroyAll(el: HTMLElement): void {\n    const store = (el as any)[STORE] as Record<string, ESLMixinElement> | undefined;\n    store && Object.keys(store).forEach((name) => ESLMixinRegistry.destroy(el, name));\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {defined} from '../../esl-utils/misc/object/utils';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {afterNextRender} from '../../esl-utils/async/raf';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {decorate, memoize, attr, jsonAttr, prop, listen} from '../../esl-utils/decorators';\nimport {format} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ESLMediaQuery, ESLMediaRuleList} from '../../esl-media-query/core';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {ESLPanel} from '../../esl-panel/core';\n\nimport type {PanelActionParams} from '../../esl-panel/core';\n\n/** Converts special 'all' value to positive infinity */\nconst parseCount = (value: string): number => value === 'all' ? Number.POSITIVE_INFINITY : parseInt(value, 10);\n\n/**\n * ESLPanelGroup component\n * @author Julia Murashko, Anastasia Lesun, Alexey Stsefanovich (ala'n)\n *\n * ESLPanelGroup is a custom element that is used as a container for a group of {@link ESLPanel}s\n */\n@ExportNs('PanelGroup')\nexport class ESLPanelGroup extends ESLBaseElement {\n  public static override is = 'esl-panel-group';\n\n  public static observedAttributes = ['mode', 'refresh-strategy', 'min-open-items', 'max-open-items'];\n  /** List of supported modes */\n  public static supportedModes = ['accordion', 'tabs'];\n\n  /** Event that dispatched on instance mode change */\n  @prop('esl:change:mode') public MODE_CHANGE_EVENT: string;\n  /** Inner event that dispatched after group-handled animation end */\n  @prop('esl:after:animate') public AFTER_ANIMATE_EVENT: string;\n\n  /** Child panels selector (Default `esl-panel`) */\n  @attr({defaultValue: ESLPanel.is}) public panelSel: string;\n\n  /** Rendering mode of the component (takes values from the list of supported modes; 'accordion' by default) */\n  @attr({defaultValue: 'accordion'}) public mode: string;\n  /** Rendering mode class pattern. Uses {@link format} syntax for `mode` placeholder */\n  @attr({defaultValue: 'esl-{mode}-view'}) public modeCls: string;\n  /** Element {@link ESLTraversingQuery} selector to add class that identifies the rendering mode (ESLPanelGroup itself by default) */\n  @attr({defaultValue: ''}) public modeClsTarget: string;\n\n  /**\n   * ESLMediaQuery string to define a list of media conditions\n   * to disable collapse/expand animation (for both Group and Panel animations)\n   */\n  @attr({defaultValue: 'not all'}) public noAnimate: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animationClass: string;\n\n  /** Define minimum number of panels that could be opened */\n  @attr({defaultValue: '1'}) public minOpenItems: string;\n  /** Define maximum number of panels that could be opened */\n  @attr({defaultValue: '1'}) public maxOpenItems: string;\n\n  /**\n   * Define active panel(s) behaviour in case of configuration change (mode, min-open-items, max-open-items)\n   * `last` (default) - try to preserve currently active panel(s)\n   * `initial` - activates initially opened panel(s)\n   * `open` - open max of available panels\n   * `close` - close all the panels (to the min of open items)\n   */\n  @attr({defaultValue: 'last'}) public refreshStrategy: string;\n\n  /** Action params to pass into panels when executing reset action (happens when mode is changed) */\n  @jsonAttr({defaultValue: {noAnimate: true}}) public transformParams: PanelActionParams;\n\n\n  /** Height of previous active panel */\n  protected _previousHeight: number = 0;\n\n  protected override connectedCallback(): void {\n    ESLPanel.registered.then(() => {\n      super.connectedCallback();\n      this.refresh();\n    });\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'mode' || attrName === 'min-open-items' || attrName === 'max-open-items') {\n      this.$$off(this._onConfigChange);\n      memoize.clear(this, 'modeRules');\n      memoize.clear(this, 'minValueRules');\n      memoize.clear(this, 'maxValueRules');\n      this.$$on(this._onConfigChange);\n      this.refresh();\n    }\n    if (attrName === 'refresh-strategy') {\n      memoize.clear(this, 'refreshRules');\n    }\n  }\n\n  /** Updates element state according to current mode */\n  protected refresh(): void {\n    const prevMode = this.getAttribute('current-mode');\n    const currentMode = this.currentMode;\n    this.setAttribute('current-mode', currentMode);\n\n    this.updateModeCls();\n    this.reset();\n\n    if (prevMode !== currentMode) this.$$fire(this.MODE_CHANGE_EVENT, {detail: {prevMode, currentMode}});\n  }\n\n  /** Updates mode class marker */\n  protected updateModeCls(): void {\n    const {modeCls, currentMode} = this;\n    if (!modeCls) return;\n    const $target = ESLTraversingQuery.first(this.modeClsTarget, this);\n    if (!$target) return;\n    ESLPanelGroup.supportedModes.forEach((mode) => {\n      const className = format(modeCls, {mode});\n      $target.classList.toggle(className, currentMode === mode);\n    });\n  }\n\n  /** @returns ESLMediaRuleList instance of the mode mapping */\n  @memoize()\n  public get modeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.mode);\n  }\n\n  /** @returns ESLMediaRuleList instance of the min-open-items mapping */\n  @memoize()\n  public get minValueRules(): ESLMediaRuleList<number> {\n    return ESLMediaRuleList.parse(this.minOpenItems, parseCount);\n  }\n\n  /** @returns ESLMediaRuleList instance of the max-open-items mapping */\n  @memoize()\n  public get maxValueRules(): ESLMediaRuleList<number> {\n    return ESLMediaRuleList.parse(this.maxOpenItems, parseCount);\n  }\n\n  /** @returns ESLMediaRuleList instance of the refresh-strategy mapping */\n  @memoize()\n  public get refreshRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.refreshStrategy);\n  }\n\n  /** @returns current mode */\n  public get currentMode(): string {\n    return this.modeRules.activeValue || '';\n  }\n\n  /** @returns current value of min-open-items */\n  public get currentMinItems(): number {\n    const min = 0;\n    const val = defined(this.minValueRules.activeValue, 1);\n    const max = this.currentMode === 'tabs' ? 1 : this.$panels.length;\n    return Math.min(max, Math.max(min, val)); // minmax\n  }\n\n  /** @returns current value of max-open-items */\n  public get currentMaxItems(): number {\n    const min = this.currentMinItems;\n    const val = defined(this.maxValueRules.activeValue, 1);\n    const max = this.currentMode === 'tabs' ? 1 : this.$panels.length;\n    return Math.min(max, Math.max(min, val)); // minmax\n  }\n\n  /** @returns panels that are processed by the current panel group */\n  public get $panels(): ESLPanel[] {\n    const els = Array.from(this.querySelectorAll(this.panelSel));\n    return els.filter((el) => this.includesPanel(el)) as ESLPanel[];\n  }\n\n  /** @returns panels that are active */\n  public get $activePanels(): ESLPanel[] {\n    return this.$panels.filter((el: ESLPanel) => el.open);\n  }\n\n  /** @returns panels that was initially opened */\n  public get $initialPanels(): ESLPanel[] {\n    return this.$panels.filter((el: ESLPanel) => el.initiallyOpened);\n  }\n\n  /** @returns panels that requested to be opened on refresh */\n  public get $resetStatePanels(): ESLPanel[] {\n    switch (this.refreshRules.activeValue) {\n      case 'close': return [];\n      case 'open': return this.$panels;\n      case 'initial': return this.$initialPanels;\n      default: return this.$activePanels;\n    }\n  }\n\n  /** @returns whether the collapse/expand animation should be handheld by the breakpoints */\n  public get shouldAnimate(): boolean {\n    return !ESLMediaQuery.for(this.noAnimate).matches;\n  }\n\n  /** @returns action params config that's used (inherited) by controlled {@link ESLPanel}s */\n  public get panelConfig(): PanelActionParams {\n    return {\n      capturedBy: this.currentMode === 'tabs' ? this : undefined,\n      noAnimate: !this.shouldAnimate || (this.currentMode === 'tabs')\n    };\n  }\n\n  /** @returns merged panel action params for show/hide requests from the group */\n  protected mergeActionParams(...params: PanelActionParams[]): PanelActionParams {\n    return Object.assign({initiator: 'group', activator: this}, ...params);\n  }\n\n  /** Condition-guard to check if the passed target is a Panel that should be controlled by the Group */\n  public includesPanel(target: any): target is ESLPanel {\n    if (!(target instanceof ESLPanel)) return false;\n    return target.$group === this;\n  }\n\n  /** Shows all panels besides excluded ones */\n  public showAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$panels.forEach((el) => !excluded.includes(el) && el.show(this.mergeActionParams(params)));\n  }\n  /** Hides all active panels besides excluded ones */\n  public hideAll(excluded: ESLPanel[] = [], params: PanelActionParams = {}): void {\n    this.$activePanels.forEach((el) => !excluded.includes(el) && el.hide(this.mergeActionParams(params)));\n  }\n\n  /** Resets to default state applicable to the current panel group configuration */\n  public reset(): void {\n    // $activePanels - collection of items to open (ideally; without normalization)\n    const $activePanels = this.$resetStatePanels;\n    // $orderedPanels = $activePanels U ($panels / $activePanels) - the list of ordered panels\n    const $orderedPanels = $activePanels.concat(this.$panels.filter((item) => !$activePanels.includes(item)));\n    // we use current open active panels count but normalized in range of minmax\n    const activeCount = Math.min(this.currentMaxItems, Math.max($activePanels.length, this.currentMinItems));\n\n    const params = this.mergeActionParams(this.transformParams);\n    $orderedPanels.forEach((panel, index) => panel.toggle(index < activeCount, params));\n  }\n\n  /** Animates the height of the component */\n  protected onAnimate(from: number, to: number): void {\n    const hasCurrent = this.style.height && this.style.height !== 'auto';\n    if (hasCurrent) {\n      this.style.height = `${to}px`;\n      this.fallbackAnimate();\n    } else {\n      // set initial height\n      this.style.height = `${from}px`;\n      // make sure that browser applies initial height to animate\n      afterNextRender(() => {\n        this.style.height = `${to}px`;\n        this.fallbackAnimate();\n      });\n    }\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented */\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.height) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    CSSClassUtils.add(this, this.animationClass);\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(silent?: boolean): void {\n    this.style.removeProperty('height');\n    CSSClassUtils.remove(this, this.animationClass);\n\n    if (silent) return;\n    this.$$fire(this.AFTER_ANIMATE_EVENT, {bubbles: false});\n  }\n\n  /** Process {@link ESLPanel} pre-show event */\n  @listen('esl:before:show')\n  protected _onBeforeShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n\n    const max = this.currentMaxItems;\n    const params = this.mergeActionParams({event: e});\n    const balanceMarker = e.detail?.params?.event?.type !== 'esl:before:hide';\n\n    // All currently active except panel that requested to be open\n    const $activePanels = this.$activePanels.filter((el) => el !== panel);\n\n    // overflow = pretended to be active (current active + balanceMarker (1 if nothing hides)) - limit\n    const overflow = Math.max(0, $activePanels.length + Number(balanceMarker) - max);\n    // close all extra active panels (not includes requested one)\n    $activePanels.slice(0, overflow).forEach((el) => el.hide(params));\n\n    if (max <= 0) return e.preventDefault();\n  }\n\n  /** Process {@link ESLPanel} show event */\n  @listen('esl:show')\n  protected _onShow(e: CustomEvent): void {\n    const panel = e.target;\n    if (!this.includesPanel(panel)) return;\n    if (this.currentMode !== 'tabs') return;\n\n    this.beforeAnimate();\n    if (this.shouldAnimate) {\n      this.onAnimate(this._previousHeight, panel.initialHeight);\n    } else {\n      afterNextRender(() => this.afterAnimate(true));\n    }\n  }\n\n  /** Process {@link ESLPanel} pre-hide event */\n  @listen('esl:before:hide')\n  protected _onBeforeHide(e: CustomEvent): void {\n    const {target: panel, detail} = e;\n    if (!this.includesPanel(panel)) return;\n\n    const min = this.currentMinItems;\n    // Check if the hide event was produced by the show event\n    const balanceMarker = detail?.params?.event?.type === 'esl:before:show';\n    // activePanels = currentActivePanels - 1 (hide) + 1 if the event produced by 'before:show'\n    const activeNumber = this.$activePanels.length - 1 + Number(balanceMarker);\n\n    if (activeNumber < min) {\n      const $firstInactive = this.$panels.find(($panel: ESLPanel) => !$panel.open);\n      if (min === 1 || !$firstInactive) return e.preventDefault();\n      const params = this.mergeActionParams({event: e});\n      $firstInactive.show(params);\n    }\n\n    this._previousHeight = this.clientHeight;\n  }\n\n  /** Catches CSS transition end event to start post-animate processing */\n  @listen('transitionend')\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Handles configuration change */\n  @listen({\n    event: 'change',\n    target: (group: ESLPanelGroup) => [group.modeRules, group.minValueRules, group.maxValueRules]\n  })\n  @decorate(debounce, 0)\n  protected _onConfigChange(): void {\n    this.refresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PanelGroup: typeof ESLPanelGroup;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-panel-group': ESLPanelGroup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {attr, boolAttr, jsonAttr, listen} from '../../esl-utils/decorators';\nimport {afterNextRender, skipOneRender} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\n\nimport type {ESLPanelGroup} from '../../esl-panel-group/core';\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core';\n\n/** {@link ESLPanel} action params interface */\nexport interface PanelActionParams extends ESLToggleableActionParams {\n  /** Panel group */\n  capturedBy?: ESLPanelGroup;\n  /** Prevents collapsing/expanding animation */\n  noAnimate?: boolean;\n}\n\n/**\n * ESLPanel component\n * @author Julia Murashko\n *\n * ESLPanel is a custom element that is used as a wrapper for content that can be shown or hidden.\n * Can use collapsing/expanding animation (smooth height change).\n * Can be used in conjunction with {@link ESLPanelGroup} to control a group of ESLPopups\n */\n@ExportNs('Panel')\nexport class ESLPanel extends ESLToggleable {\n  public static override is = 'esl-panel';\n\n  /** Class(es) to be added for active state ('open' by default) */\n  @attr({defaultValue: 'open'}) public override activeClass: string;\n  /** Class(es) to be added during animation ('animate' by default) */\n  @attr({defaultValue: 'animate'}) public animateClass: string;\n  /** Class(es) to be added during animation after next render ('post-animate' by default) */\n  @attr({defaultValue: 'post-animate'}) public postAnimateClass: string;\n\n  /** CSS selector of the parent group (default: 'esl-panel-group') */\n  @attr({defaultValue: 'esl-panel-group'}) public panelGroupSel: string;\n\n  /** Initial params for current ESLPanel instance */\n  @jsonAttr<PanelActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public override initialParams: PanelActionParams;\n\n  /** Active while animation in progress */\n  @boolAttr({readonly: true}) public animating: boolean;\n\n  /** Inner height state that updates after show/hide actions but before show/hide events triggered */\n  protected _initialHeight: number = 0;\n\n  /** @returns Previous active panel height at the start of the animation */\n  public get initialHeight(): number {\n    return this._initialHeight;\n  }\n\n  /** @returns Closest panel group or null if not presented */\n  public get $group(): ESLPanelGroup | null {\n    if (this.groupName === 'none' || this.groupName) return null;\n    return this.closest(this.panelGroupSel);\n  }\n\n  /** Process show action */\n  protected override onShow(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onShow(params);\n\n    this.beforeAnimate();\n    if (params.noAnimate) return this.postAnimate(params.capturedBy);\n    this.onAnimate(0, this._initialHeight);\n  }\n\n  /** Process hide action */\n  protected override onHide(params: PanelActionParams): void {\n    this._initialHeight = this.scrollHeight;\n    super.onHide(params);\n\n    this.beforeAnimate();\n    if (params.noAnimate) return this.postAnimate(null);\n    this.onAnimate(this._initialHeight, 0);\n  }\n\n  /** Pre-processing animation action */\n  protected beforeAnimate(): void {\n    this.toggleAttribute('animating', true);\n    CSSClassUtils.add(this, this.animateClass);\n    this.postAnimateClass && afterNextRender(() => CSSClassUtils.add(this, this.postAnimateClass));\n  }\n\n  /** Handles post animation process to initiate after animate step */\n  protected postAnimate(capturedBy?: ESLPanelGroup | null): void {\n    if (capturedBy) {\n      capturedBy.$$on({\n        event: capturedBy.AFTER_ANIMATE_EVENT,\n        once: true\n      }, () => this.afterAnimate());\n    } else {\n      skipOneRender(() => this.afterAnimate());\n    }\n  }\n\n  /** Process animation */\n  protected onAnimate(from: number, to: number): void {\n    // set initial height\n    this.style.setProperty('max-height', `${from}px`);\n    // make sure that browser applies initial height for animation\n    afterNextRender(() => {\n      this.style.setProperty('max-height', `${to}px`);\n      this.fallbackAnimate();\n    });\n  }\n\n  /** Checks if transition happens and runs afterAnimate step if transition is not presented*/\n  protected fallbackAnimate(): void {\n    afterNextRender(() => {\n      const distance = parseFloat(this.style.maxHeight) - this.clientHeight;\n      if (Math.abs(distance) <= 1) this.afterAnimate();\n    });\n  }\n\n  /** Post-processing animation action */\n  protected afterAnimate(): void {\n    const {animating} = this;\n    this.clearAnimation();\n    // Prevent fallback calls from being tracked\n    if (!animating) return;\n    this.$$fire(this.open ? this.AFTER_SHOW_EVENT : this.AFTER_HIDE_EVENT);\n  }\n\n  /** Clear animation properties */\n  protected clearAnimation(): void {\n    this.toggleAttribute('animating', false);\n    this.style.removeProperty('max-height');\n    CSSClassUtils.remove(this, this.animateClass);\n    CSSClassUtils.remove(this, this.postAnimateClass);\n  }\n\n  /** Catching CSS transition end event to start post-animate processing */\n  @listen('transitionend')\n  protected _onTransitionEnd(e?: TransitionEvent): void {\n    if (!e || (e.propertyName === 'max-height' && e.target === this)) {\n      this.afterAnimate();\n    }\n  }\n\n  /** Merge params that are used by panel group for actions */\n  protected override mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    const stackConfig = this.$group?.panelConfig || {};\n    return Object.assign({}, stackConfig, this.defaultParams, params || {});\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Panel: typeof ESLPanel;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-panel': ESLPanel;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLPopup} from './esl-popup';\n\n@ExportNs('PopupPlaceholder')\nexport class ESLPopupPlaceholder extends ESLToggleablePlaceholder {\n  public static override is = 'esl-popup-placeholder';\n\n  public override $origin: ESLPopup | null;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    PopupPlaceholder: typeof ESLPopupPlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup-placeholder': ESLPopupPlaceholder;\n  }\n}\n","import {Rect} from '../../esl-utils/dom/rect';\n\nexport type PositionType = 'top' | 'bottom' | 'left' | 'right';\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport interface PopupPositionValue {\n  placedAt: PositionType;\n  popup: Rect;\n  arrow: Point;\n}\n\nexport interface IntersectionRatioRect {\n  top?: number;\n  left?: number;\n  right?: number;\n  bottom?: number;\n}\n\nexport interface PopupPositionConfig {\n  position: PositionType;\n  behavior: string;\n  marginArrow: number;\n  offsetArrowRatio: number;\n  intersectionRatio: IntersectionRatioRect;\n  arrow: DOMRect | Rect;\n  element: DOMRect;\n  inner: Rect;\n  outer: Rect;\n  trigger: Rect;\n}\n\n/**\n * Checks that the position along the horizontal axis\n * @param position - name of position\n */\nexport function isMajorAxisHorizontal(position: PositionType): boolean {\n  return ['left', 'right'].includes(position);\n}\n\n/**\n * Calculates the position of the popup on the minor axis\n * @param cfg - popup position config\n * @param centerPosition - position of the center of the trigger on the minor axis\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcPopupPositionByMinorAxis(cfg: PopupPositionConfig, centerPosition: number, dimensionName: 'height' | 'width'): number {\n  return centerPosition - cfg.arrow[dimensionName] / 2 - cfg.marginArrow - calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * TODO: optimize switch\n * Calculates Rect for given popup position config.\n * @param cfg - popup position config\n * */\nfunction calcPopupBasicRect(cfg: PopupPositionConfig): Rect {\n  let x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n  let y = cfg.inner.y - cfg.element.height;\n  switch (cfg.position) {\n    case 'left':\n      x = cfg.inner.x - cfg.element.width;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'right':\n      x = cfg.inner.right;\n      y = calcPopupPositionByMinorAxis(cfg, cfg.inner.cy, 'height');\n      break;\n    case 'bottom':\n      x = calcPopupPositionByMinorAxis(cfg, cfg.inner.cx, 'width');\n      y = cfg.inner.bottom;\n      break;\n  }\n\n  return new Rect(x, y, cfg.element.width, cfg.element.height);\n}\n\n/**\n * Gets opposite position.\n * @param position - name of position\n * */\nfunction getOppositePosition(position: PositionType): PositionType {\n  return ({\n    top: 'bottom',\n    left: 'right',\n    right: 'left',\n    bottom: 'top'\n  }[position] || position) as PositionType;\n}\n\n/**\n * TODO: move the actionsToFit definition outside the function and optimize\n * Updates popup and arrow positions to fit on major axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMajorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): PositionType {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-major') return cfg.position;\n\n  let isMirrored = false;\n  const actionsToFit: Record<PositionType, () => void> = {\n    'bottom': () => {\n      if (cfg.intersectionRatio.bottom || cfg.outer.bottom < rect.bottom) {\n        rect.y = cfg.inner.y - cfg.element.height;\n        isMirrored = true;\n      }\n    },\n    'left': () => {\n      if (cfg.intersectionRatio.left || rect.x < cfg.outer.x) {\n        rect.x = cfg.inner.right;\n        isMirrored = true;\n      }\n    },\n    'right': () => {\n      if (cfg.intersectionRatio.right || cfg.outer.right < rect.right) {\n        rect.x = cfg.inner.x - cfg.element.width;\n        isMirrored = true;\n      }\n    },\n    'top': () => {\n      if (cfg.intersectionRatio.top || rect.y < cfg.outer.y) {\n        rect.y = cfg.inner.bottom;\n        isMirrored = true;\n      }\n    }\n  };\n  actionsToFit[cfg.position]();\n\n  return isMirrored ? getOppositePosition(cfg.position) : cfg.position;\n}\n\n/**\n * Calculates adjust for popup position to fit container bounds\n * @param elCoord - coordinate of the popup\n * @param outerCoord - coordinate of the outer border element\n * @param arrowCoord - coordinate of the arrow\n * @param arrowLimit - the limit value of the arrow coordinate\n * @param startingSide - is it starting side?\n * @returns adjustment value for the coordinates of the arrow and the popup\n */\nfunction adjustAlignmentBySide(elCoord: number, outerCoord: number, arrowCoord: number, arrowLimit: number, isStartingSide: boolean): number {\n  let arrowAdjust = 0;\n\n  if (isStartingSide ? elCoord < outerCoord : elCoord > outerCoord) {\n    arrowAdjust = elCoord - outerCoord;\n    const newCoord = arrowCoord + arrowAdjust;\n    if (isStartingSide ? newCoord < arrowLimit : newCoord > arrowLimit) {\n      arrowAdjust = 0;\n    }\n    /** It was decided that if the relative positions of the trigger and container\n     *  do not allow the popup to be displayed correctly together with the arrow,\n     *  the popup should be displayed as-is without adjusting the position of the minor axis\n     *\n     *  The following code adheres to a different strategy - maximum position adaptation,\n     *  with the popup having minimal overhang outside the container.\n     *  Perhaps in the future, we should allow the user to choose the strategy.\n     *\n     * const func = isStartingSide ? Math.max : Math.min;\n     * arrowAdjust = func(elCoord - outerCoord, arrowLimit - arrowCoord);\n     */\n  }\n\n  return arrowAdjust;\n}\n\n/**\n * Updates popup and arrow positions to fit on minor axis.\n * @param cfg - popup position config\n * @param rect - popup position rect\n * @param arrow - arrow position value\n * */\nfunction fitOnMinorAxis(cfg: PopupPositionConfig, rect: Rect, arrow: Point): void {\n  if (cfg.behavior !== 'fit' && cfg.behavior !== 'fit-on-minor') return;\n\n  const isHorizontal = isMajorAxisHorizontal(cfg.position);\n  const start = isHorizontal ? 'y' : 'x';\n  const end = isHorizontal ? 'bottom' : 'right';\n  const dimension = isHorizontal ? 'height' : 'width';\n\n  if (cfg.outer[dimension] < cfg.element[dimension] ||  // cancel fit mode if the popup size is greater than the outer limiter size\n      cfg.trigger[start] < cfg.outer[start] ||          // or the trigger is outside the outer limiting element\n      cfg.trigger[end] > cfg.outer[end]\n  ) return;\n\n  let coordAdjust = 0;\n  // check the starting side of the axis\n  let arrowLimit = cfg.marginArrow;\n  coordAdjust = adjustAlignmentBySide(rect[start], cfg.outer[start], arrow[start], arrowLimit, true);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n  // check the final side of the axis\n  arrowLimit += calcUsableSizeForArrow(cfg, dimension);\n  coordAdjust = adjustAlignmentBySide(rect[end], cfg.outer[end], arrow[start], arrowLimit, false);\n  if (coordAdjust) {\n    rect[start] -= coordAdjust;\n    arrow[start] += coordAdjust;\n  }\n}\n\n/**\n * Calculates the usable size available for the arrow\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcUsableSizeForArrow(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.element[dimensionName] - cfg.arrow[dimensionName] - 2 * cfg.marginArrow;\n}\n\n/**\n * Calculates the position of the arrow on the minor axis\n * @param cfg - popup position config\n * @param dimensionName - the name of dimension (height or width)\n */\nfunction calcArrowPosition(cfg: PopupPositionConfig, dimensionName: 'height' | 'width'): number {\n  return cfg.marginArrow + calcUsableSizeForArrow(cfg, dimensionName) * cfg.offsetArrowRatio;\n}\n\n/**\n * Calculates popup and arrow popup positions.\n * @param cfg - popup position config\n * */\nexport function calcPopupPosition(cfg: PopupPositionConfig): PopupPositionValue {\n  const popup = calcPopupBasicRect(cfg);\n  const arrow = {\n    x: calcArrowPosition(cfg, 'width'),\n    y: calcArrowPosition(cfg, 'height'),\n    position: cfg.position\n  };\n\n  const placedAt = fitOnMajorAxis(cfg, popup, arrow);\n  fitOnMinorAxis(cfg, popup, arrow);\n\n  return {\n    popup,\n    placedAt,\n    arrow\n  };\n}\n","import {range} from '../../esl-utils/misc/array';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {bind, memoize, ready, prop, attr, boolAttr, jsonAttr} from '../../esl-utils/decorators';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {afterNextRender, rafDecorator} from '../../esl-utils/async/raf';\nimport {ESLToggleable} from '../../esl-toggleable/core';\nimport {Rect} from '../../esl-utils/dom/rect';\nimport {isRTL} from '../../esl-utils/dom/rtl';\nimport {getListScrollParents} from '../../esl-utils/dom/scroll';\nimport {getWindowRect} from '../../esl-utils/dom/window';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {calcPopupPosition, isMajorAxisHorizontal} from './esl-popup-position';\nimport {ESLPopupPlaceholder} from './esl-popup-placeholder';\n\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core';\nimport type {PositionType, IntersectionRatioRect} from './esl-popup-position';\n\nconst INTERSECTION_LIMIT_FOR_ADJACENT_AXIS = 0.7;\nconst DEFAULT_OFFSET_ARROW = 50;\nconst scrollOptions = {passive: true} as EventListenerOptions;\n\nconst parsePercent = (value: string | number, nanValue: number = 0): number => {\n  const rawValue = parseNumber(value, nanValue);\n  return Math.max(0, Math.min(rawValue !== undefined ? rawValue : nanValue, 100));\n};\n\nexport interface PopupActionParams extends ESLToggleableActionParams {\n  /** popup position relative to trigger */\n  position?: PositionType;\n  /** popup behavior if it does not fit in the window */\n  behavior?: string;\n  /** Disable hiding the popup depending on the visibility of the activator */\n  disableActivatorObservation?: boolean;\n  /** Margins on the edges of the arrow. */\n  marginArrow?: string;\n  /** offset of the arrow as a percentage of the popup edge (0% - at the left edge, 100% - at the right edge, for RTL it is vice versa) */\n  offsetArrow?: string;\n  /** offset in pixels from trigger element */\n  offsetTrigger?: number;\n  /**\n   * offset in pixels from the edges of the container (or window if the container is not defined)\n   *  value as a number for equals x and y offsets\n   *  value as an array for different x and y offsets\n   */\n  offsetContainer?: number | [number, number];\n  /** margin around the element that is used as the viewport for checking the visibility of the popup activator */\n  intersectionMargin?: string;\n  /** Target to container element to define bounds of popups visibility */\n  container?: string;\n  /** Container element that defines bounds of popups visibility (is not taken into account if the container attr is set on popup) */\n  containerEl?: HTMLElement;\n}\n\nexport interface ActivatorObserver {\n  unsubscribers?: (() => void)[];\n  observer?: IntersectionObserver;\n}\n\n@ExportNs('Popup')\nexport class ESLPopup extends ESLToggleable {\n  public static override is = 'esl-popup';\n\n  public $placeholder: ESLPopupPlaceholder | null;\n\n  protected _containerEl?: HTMLElement;\n  protected _offsetTrigger: number;\n  protected _offsetContainer: number | [number, number];\n  protected _deferredUpdatePosition = rafDecorator(() => this._updatePosition());\n  protected _activatorObserver: ActivatorObserver;\n  protected _intersectionMargin: string;\n  protected _intersectionRatio: IntersectionRatioRect = {};\n  protected _updateLoopID: number;\n\n  /** Classname of popups arrow element */\n  @attr({defaultValue: 'esl-popup-arrow'}) public arrowClass: string;\n\n  /**\n   * Popup position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public position: PositionType;\n\n  /** Popup behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public behavior: string;\n\n  /** Disable hiding the popup depending on the visibility of the activator */\n  @boolAttr() public disableActivatorObservation: boolean;\n  /**\n   * Margins on the edges of the arrow.\n   * This is the value in pixels that will be between the edge of the popup and\n   * the arrow at extreme positions of the arrow (when offsetArrow is set to 0 or 100)\n   */\n  @attr({defaultValue: '5'}) public marginArrow: string;\n\n  /**\n   * Offset of the arrow as a percentage of the popup edge\n   * (0% - at the left edge,\n   *  100% - at the right edge,\n   *  for RTL it is vice versa) */\n  @attr({defaultValue: `${DEFAULT_OFFSET_ARROW}`}) public offsetArrow: string;\n\n  /** Target to container element {@link ESLTraversingQuery} to define bounds of popups visibility (window by default) */\n  @attr() public container: string;\n\n  /** Default params to merge into passed action params */\n  @jsonAttr<PopupActionParams>({defaultValue: {\n    offsetTrigger: 3,\n    offsetContainer: 15,\n    intersectionMargin: '0px'\n  }})\n  public override defaultParams: PopupActionParams;\n\n  @prop() public override closeOnEsc = true;\n  @prop() public override closeOnOutsideAction = true;\n\n  /** Arrow element */\n  @memoize()\n  public get $arrow(): HTMLElement | null {\n    return this.querySelector(`.${this.arrowClass}`) || this.appendArrow();\n  }\n\n  /** Container element that define bounds of popups visibility */\n  @memoize()\n  protected get $container(): HTMLElement | undefined {\n    return this.container ? ESLTraversingQuery.first(this.container, this) as HTMLElement : this._containerEl;\n  }\n\n  /** Get the size and position of the container */\n  protected get containerRect(): Rect {\n    const {$container} = this;\n    if (!$container) return getWindowRect();\n    const containerRect = $container.getBoundingClientRect();\n    return new Rect(containerRect.left, containerRect.top + window.pageYOffset, containerRect.width, containerRect.height);\n  }\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.moveToBody();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    memoize.clear(this, '$arrow');\n  }\n\n  /** Checks that the position along the horizontal axis */\n  @memoize()\n  protected get _isMajorAxisHorizontal(): boolean {\n    return isMajorAxisHorizontal(this.position);\n  }\n\n  /** Checks that the position along the vertical axis */\n  @memoize()\n  protected get _isMajorAxisVertical(): boolean {\n    return !isMajorAxisHorizontal(this.position);\n  }\n\n  /** Get offsets arrow ratio */\n  @memoize()\n  protected get _offsetArrowRatio(): number {\n    const ratio = parsePercent(this.offsetArrow, DEFAULT_OFFSET_ARROW) / 100;\n    return isRTL(this) ? 1 - ratio : ratio;\n  }\n\n  /** Moves popup into document.body */\n  protected moveToBody(): void {\n    const {parentNode, $placeholder} = this;\n    if (!parentNode || parentNode === document.body) return;\n\n    // to be safe and prevent leaks\n    $placeholder && $placeholder.parentNode?.removeChild($placeholder);\n\n    // replace this with placeholder element\n    this.$placeholder = ESLPopupPlaceholder.from(this);\n    parentNode.replaceChild(this.$placeholder, this);\n    document.body.appendChild(this);\n  }\n\n  /** Appends arrow to Popup */\n  public appendArrow(): HTMLElement {\n    const $arrow = document.createElement('span');\n    $arrow.className = this.arrowClass;\n    this.appendChild($arrow);\n    memoize.clear(this, '$arrow');\n    return $arrow;\n  }\n\n  /**\n   * Actions to execute on show popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire esl:refresh event by default.\n   */\n  protected override onShow(params: PopupActionParams): void {\n    super.onShow(params);\n\n    if (params.position) {\n      this.position = params.position;\n    }\n    if (params.behavior) {\n      this.behavior = params.behavior;\n    }\n    if (params.disableActivatorObservation) {\n      this.disableActivatorObservation = params.disableActivatorObservation;\n    }\n    if (params.marginArrow) {\n      this.marginArrow = params.marginArrow;\n    }\n    if (params.offsetArrow) {\n      this.offsetArrow = params.offsetArrow;\n    }\n    if (params.container) {\n      this.container = params.container;\n    }\n    this._containerEl = params.containerEl;\n    this._offsetTrigger = params.offsetTrigger || 0;\n    this._offsetContainer = params.offsetContainer || 0;\n    this._intersectionMargin = params.intersectionMargin || '0px';\n\n    this.style.visibility = 'hidden'; // eliminates the blinking of the popup at the previous position\n\n    afterNextRender(() => this.afterOnShow()); // running as a separate task solves the problem with incorrect positioning on the first showing\n  }\n\n  /**\n   * Actions to execute on hide popup.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and updates a11y by default.\n   */\n  protected override onHide(params: PopupActionParams): void {\n    this.beforeOnHide();\n    super.onHide(params);\n\n    this._stopUpdateLoop();\n    this.activator && this._removeActivatorObserver(this.activator);\n\n    // clear all memoize data\n    memoize.clear(this, '_isMajorAxisHorizontal');\n    memoize.clear(this, '_isMajorAxisVertical');\n    memoize.clear(this, '_offsetArrowRatio');\n    memoize.clear(this, '$container');\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected afterOnShow(): void {\n    this._updatePosition();\n    this.style.visibility = 'visible';\n    this.activator && this._addActivatorObserver(this.activator);\n    this._startUpdateLoop();\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected beforeOnHide(): void {}\n\n  /**\n   * Checks activator intersection for adjacent axis.\n   * Hides the popup if the intersection ratio exceeds the limit.\n   */\n  protected _checkIntersectionForAdjacentAxis(isAdjacentAxis: boolean, intersectionRatio: number): void {\n    if (isAdjacentAxis && intersectionRatio < INTERSECTION_LIMIT_FOR_ADJACENT_AXIS) {\n      this.hide();\n    }\n  }\n\n  /** Actions to execute on activator intersection event. */\n  @bind\n  protected onActivatorIntersection(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void {\n    const entry = entries[0];\n    this._intersectionRatio = {};\n    if (!entry.isIntersecting) {\n      this.hide();\n      return;\n    }\n\n    if (entry.intersectionRect.y !== entry.boundingClientRect.y) {\n      this._intersectionRatio.top = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.top);\n    }\n    if (entry.intersectionRect.bottom !== entry.boundingClientRect.bottom) {\n      this._intersectionRatio.bottom = entry.intersectionRect.height / entry.boundingClientRect.height;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisHorizontal, this._intersectionRatio.bottom);\n    }\n    if (entry.intersectionRect.x !== entry.boundingClientRect.x) {\n      this._intersectionRatio.left = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.left);\n    }\n    if (entry.intersectionRect.right !== entry.boundingClientRect.right) {\n      this._intersectionRatio.right = entry.intersectionRect.width / entry.boundingClientRect.width;\n      this._checkIntersectionForAdjacentAxis(this._isMajorAxisVertical, this._intersectionRatio.right);\n    }\n  }\n\n  /** Actions to execute on activator scroll event. */\n  @bind\n  protected onActivatorScroll(e: Event): void {\n    if (this._updateLoopID) return;\n    this._updatePosition();\n  }\n\n  /** Creates listeners and observers to observe activator after showing popup */\n  protected _addActivatorObserver(target: HTMLElement): void {\n    const scrollParents = getListScrollParents(target);\n\n    this._activatorObserver = {\n      unsubscribers: scrollParents.map(($root) => {\n        $root.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        return (): void => {\n          $root && $root.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n        };\n      })\n    };\n\n    if (!this.disableActivatorObservation) {\n      const options = {\n        rootMargin: this._intersectionMargin,\n        threshold: range(9, (x) => x / 8)\n      } as IntersectionObserverInit;\n\n      const observer = new IntersectionObserver(this.onActivatorIntersection, options);\n      observer.observe(target);\n\n      this._activatorObserver.observer = observer;\n    }\n\n    window.addEventListener('resize', this._deferredUpdatePosition);\n    window.addEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    document.body.addEventListener('transitionstart', this._startUpdateLoop);\n  }\n\n  /** Removes activator listeners and observers after hiding popup */\n  protected _removeActivatorObserver(target: HTMLElement): void {\n    window.removeEventListener('resize', this._deferredUpdatePosition);\n    window.removeEventListener('scroll', this.onActivatorScroll, scrollOptions);\n    document.body.removeEventListener('transitionstart', this._startUpdateLoop);\n\n    if (!this._activatorObserver) return;\n    this._activatorObserver.observer?.disconnect();\n    this._activatorObserver.observer = undefined;\n    this._activatorObserver.unsubscribers?.forEach((cb) => cb());\n    this._activatorObserver.unsubscribers = [];\n  }\n\n  /**\n   * Starts loop for update position of popup.\n   * The loop ends when the position and size of the activator have not changed\n   * for the last 2 frames of the animation.\n   */\n  @bind\n  protected _startUpdateLoop(): void {\n    if (this._updateLoopID) return;\n\n    let same = 0;\n    let lastRect = new Rect();\n    const updateLoop = (): void => {\n      if (!this.activator) {\n        this._stopUpdateLoop();\n        return;\n      }\n\n      const newRect = Rect.from(this.activator.getBoundingClientRect());\n      if (!Rect.isEqual(lastRect, newRect)) {\n        same = 0;\n        lastRect = newRect;\n      }\n\n      if (same++ > 2) {\n        this._stopUpdateLoop();\n        return;\n      }\n      this._updatePosition();\n      this._updateLoopID = requestAnimationFrame(updateLoop);\n    };\n\n    this._updateLoopID = requestAnimationFrame(updateLoop);\n  }\n\n  /**\n   * Stops loop for update position of popup.\n   * Also cancels the animation frame request.\n   */\n  @bind\n  protected _stopUpdateLoop(): void {\n    if (!this._updateLoopID) return;\n    cancelAnimationFrame(this._updateLoopID);\n    this._updateLoopID = 0;\n  }\n\n  /** Updates position of popup and its arrow */\n  protected _updatePosition(): void {\n    if (!this.activator) return;\n\n    const triggerRect = this.activator.getBoundingClientRect();\n    const popupRect = this.getBoundingClientRect();\n    const arrowRect = this.$arrow ? this.$arrow.getBoundingClientRect() : new Rect();\n    const trigger = new Rect(triggerRect.left, triggerRect.top + window.pageYOffset, triggerRect.width, triggerRect.height);\n    const innerMargin = this._offsetTrigger + arrowRect.width / 2;\n    const {containerRect} = this;\n\n    const config = {\n      position: this.position,\n      behavior: this.behavior,\n      marginArrow: +this.marginArrow,\n      offsetArrowRatio: this._offsetArrowRatio,\n      intersectionRatio: this._intersectionRatio,\n      arrow: arrowRect,\n      element: popupRect,\n      trigger,\n      inner: Rect.from(trigger).grow(innerMargin),\n      outer: (typeof this._offsetContainer === 'number') ?\n        containerRect.shrink(this._offsetContainer) :\n        containerRect.shrink(...this._offsetContainer)\n    };\n\n    const {placedAt, popup, arrow} = calcPopupPosition(config);\n\n    this.setAttribute('placed-at', placedAt);\n    // set popup position\n    this.style.left = `${popup.x}px`;\n    this.style.top = `${popup.y}px`;\n    // set arrow position\n    if (this.$arrow) {\n      this.$arrow.style.left = this._isMajorAxisVertical ? `${arrow.x}px` : '';\n      this.$arrow.style.top = this._isMajorAxisHorizontal ? `${arrow.y}px` : '';\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Popup: typeof ESLPopup;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-popup': ESLPopup;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLMixinElement} from '../../esl-mixin-element/core';\nimport {ESLToggleable} from '../../esl-toggleable/core/esl-toggleable';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {listen, attr} from '../../esl-utils/decorators';\nimport {copyDefinedKeys} from '../../esl-utils/misc/object/copy';\n\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\nexport type ESLRelatedTargetActionType = 'all' | 'show' | 'hide';\n\n/**\n * ESLRelatedTarget mixin element\n * @author Anastasia Lesun, Alexey Stsefanovich (ala'n)\n *\n * ESLRelatedTarget is a custom mixin element that can be used with {@link ESLToggleable}s to sync their states\n */\n@ExportNs('RelatedTarget')\nexport class ESLRelatedTarget extends ESLMixinElement {\n  static override is = 'esl-related-target';\n\n  /** Selector/query ({@link ESLTraversingQuery}) to find related ESLToggleable element */\n  @attr({name: ESLRelatedTarget.is}) public selector: string;\n  /** Action to synchronize between toggleables */\n  @attr({name: ESLRelatedTarget.is + '-action', defaultValue: 'all'}) public action: ESLRelatedTargetActionType;\n\n  /** @returns related toggleable instances */\n  public get $targets(): ESLToggleable[] {\n    const {selector} = this;\n    if (!selector) return [];\n    const targets = ESLTraversingQuery.all(selector, this.$host);\n    return targets.filter(\n      (target: HTMLElement): target is ESLToggleable => target instanceof ESLToggleable && target !== this.$host\n    );\n  }\n\n  /** Merges params that are used to initiate actions */\n  protected mergeParams(params: ESLToggleableActionParams): ESLToggleableActionParams {\n    return Object.assign(copyDefinedKeys(params), {\n      initiator: 'relatedToggleable',\n      activator: this.$host\n    });\n  }\n\n  /** Processes {@link ESLToggleable} show event */\n  @listen('esl:show')\n  protected onShow(e: CustomEvent): void {\n    if (this.action === 'hide') return;\n    const {params} = e.detail;\n    this.$targets.forEach((target) => target.show({params: this.mergeParams(params)}));\n  }\n\n  /** Processes {@link ESLToggleable} hide event */\n  @listen('esl:hide')\n  protected onHide(e: CustomEvent): void {\n    if (this.action === 'show') return;\n    const {params} = e.detail;\n    this.$targets.forEach((target) => target.hide({params: this.mergeParams(params)}));\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {bind, ready, attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {isMouseEvent, isTouchEvent, getTouchPoint, getOffsetPoint} from '../../esl-utils/dom/events';\nimport {isRelativeNode} from '../../esl-utils/dom/traversing';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {isRTL, RTLScroll, normalizeScrollLeft} from '../../esl-utils/dom/rtl';\n\n/**\n * ESLScrollbar is a reusable web component that replaces the browser's default scrollbar with\n * a custom scrollbar implementation.\n *\n * @author Yuliya Adamskaya\n */\n@ExportNs('Scrollbar')\nexport class ESLScrollbar extends ESLBaseElement {\n  public static override is = 'esl-scrollbar';\n  public static observedAttributes = ['target', 'horizontal'];\n\n  /** Horizontal scroll orientation marker */\n  @boolAttr() public horizontal: boolean;\n  /** Disable continuous scroll when the mouse pressed on scrollbar */\n  @boolAttr() public noContinuousScroll: boolean;\n\n  /** Target element {@link ESLTraversingQuery} selector. Parent element by default */\n  @attr({defaultValue: '::parent'}) public target: string;\n  /** Custom class for thumb element. 'scrollbar-thumb' by default */\n  @attr({defaultValue: 'scrollbar-thumb'}) public thumbClass: string;\n  /** Custom class for track element area. 'scrollbar-track' by default */\n  @attr({defaultValue: 'scrollbar-track'}) public trackClass: string;\n\n  /** @readonly Dragging state marker */\n  @boolAttr({readonly: true}) public dragging: boolean;\n  /** @readonly Inactive state marker */\n  @boolAttr({readonly: true}) public inactive: boolean;\n\n  /** @readonly Indicates that the scroll is at the beginning */\n  @boolAttr({readonly: true}) public atStart: boolean;\n  /** @readonly Indicates that the scroll is at the end */\n  @boolAttr({readonly: true}) public atEnd: boolean;\n\n  protected $scrollbarThumb: HTMLElement;\n  protected $scrollbarTrack: HTMLElement;\n\n  protected _$target: HTMLElement | null;\n  protected _pointerPosition: number;\n  protected _initialPosition: number;\n  protected _initialMousePosition: number;\n\n  protected _deferredDrag = rafDecorator((e) => this._onPointerDrag(e));\n  protected _deferredRefresh = rafDecorator(() => this.refresh());\n  protected _scrollTimer: number = 0;\n  protected _resizeObserver = new ResizeObserver(this._deferredRefresh);\n  protected _mutationObserver = new MutationObserver((rec) => this.updateContentObserve(rec));\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.render();\n    this.findTarget();\n  }\n\n  @ready\n  protected override disconnectedCallback(): void {\n    this.unbindTargetEvents();\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'target') this.findTarget();\n    if (attrName === 'horizontal') this.refresh();\n  }\n\n  protected findTarget(): void {\n    this.$target = this.target ?\n      ESLTraversingQuery.first(this.target, this) as HTMLElement :\n      null;\n  }\n\n  /** Target element to observe and scroll */\n  public get $target(): HTMLElement | null {\n    return this._$target || null;\n  }\n\n  public set $target(content: HTMLElement | null) {\n    this.unbindTargetEvents();\n    this._$target = content;\n    this.bindTargetEvents();\n    this._deferredRefresh();\n  }\n\n  protected render(): void {\n    this.innerHTML = '';\n    this.$scrollbarTrack = document.createElement('div');\n    this.$scrollbarTrack.className = this.trackClass;\n    this.$scrollbarThumb = document.createElement('div');\n    this.$scrollbarThumb.className = this.thumbClass;\n\n    this.$scrollbarTrack.appendChild(this.$scrollbarThumb);\n    this.appendChild(this.$scrollbarTrack);\n  }\n\n  protected bindTargetEvents(): void {\n    if (!this.$target) return;\n    // Container resize/scroll observers/listeners\n    if (document.documentElement === this.$target) {\n      this.$$on({event: 'scroll resize', target: window}, this._onScrollOrResize);\n    } else {\n      this.$$on({event: 'scroll', target: this.$target}, this._onScrollOrResize);\n      this._resizeObserver.observe(this.$target);\n    }\n    // Subscribes to the child elements resizes\n    this._mutationObserver.observe(this.$target, {childList: true});\n    Array.from(this.$target.children).forEach((el) => this._resizeObserver.observe(el));\n  }\n\n  /** Resubscribes resize observer on child elements when container content changes */\n  protected updateContentObserve(recs: MutationRecord[] = []): void {\n    if (!this.$target) return;\n    const contentChanges = recs.filter((rec) => rec.type === 'childList');\n    contentChanges.forEach((rec) => {\n      Array.from(rec.addedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.observe(el));\n      Array.from(rec.removedNodes)\n        .filter((el) => el instanceof Element)\n        .forEach((el: Element) => this._resizeObserver.unobserve(el));\n    });\n    if (contentChanges.length) this._deferredRefresh();\n  }\n\n  protected unbindTargetEvents(): void {\n    if (!this.$target) return;\n    this.$$off(this._onScrollOrResize);\n    if (document.documentElement !== this.$target) {\n      this._resizeObserver.disconnect();\n      this._mutationObserver.disconnect();\n    }\n  }\n\n  /** @readonly Scrollable distance size value (px) */\n  public get scrollableSize(): number {\n    if (!this.$target) return 0;\n    return this.horizontal ?\n      this.$target.scrollWidth - this.$target.clientWidth :\n      this.$target.scrollHeight - this.$target.clientHeight;\n  }\n\n  /** @readonly Track size value (px) */\n  public get trackOffset(): number {\n    return this.horizontal ? this.$scrollbarTrack.offsetWidth : this.$scrollbarTrack.offsetHeight;\n  }\n\n  /** @readonly Thumb size value (px) */\n  public get thumbOffset(): number {\n    return this.horizontal ? this.$scrollbarThumb.offsetWidth : this.$scrollbarThumb.offsetHeight;\n  }\n\n  /** @readonly Relative thumb size value (between 0.0 and 1.0) */\n  public get thumbSize(): number {\n    // behave as native scroll\n    if (!this.$target || !this.$target.scrollWidth || !this.$target.scrollHeight) return 1;\n    const areaSize = this.horizontal ? this.$target.clientWidth : this.$target.clientHeight;\n    const scrollSize = this.horizontal ? this.$target.scrollWidth : this.$target.scrollHeight;\n    return Math.min((areaSize + 1) / scrollSize, 1);\n  }\n\n  /** Relative position value (between 0.0 and 1.0) */\n  public get position(): number {\n    if (!this.$target) return 0;\n    const scrollOffset = this.horizontal ? normalizeScrollLeft(this.$target) : this.$target.scrollTop;\n    return this.scrollableSize ? (scrollOffset / this.scrollableSize) : 0;\n  }\n\n  public set position(position: number) {\n    this.scrollTargetTo(this.scrollableSize * this.normalizePosition(position));\n    this.update();\n  }\n\n  /** Normalizes position value (between 0.0 and 1.0) */\n  protected normalizePosition(position: number): number {\n    const relativePosition = Math.min(1, Math.max(0, position));\n    if (!isRTL(this.$target) || !this.horizontal) return relativePosition;\n    return RTLScroll.type === 'negative' ? (relativePosition - 1) : (1 - relativePosition);\n  }\n\n  /** Scrolls target element to passed position */\n  protected scrollTargetTo(pos: number): void {\n    if (!this.$target) return;\n    this.$target.scrollTo({\n      [this.horizontal ? 'left' : 'top']: pos,\n      behavior: this.dragging ? 'auto' : 'smooth'\n    });\n  }\n\n  /** Updates thumb size and position */\n  public update(): void {\n    this.$$fire('esl:change:scroll', {bubbles: false});\n    if (!this.$scrollbarThumb || !this.$scrollbarTrack) return;\n    const thumbSize = this.trackOffset * this.thumbSize;\n    const thumbPosition = (this.trackOffset - thumbSize) * this.position;\n    const style = {\n      [this.horizontal ? 'left' : 'top']: `${thumbPosition}px`,\n      [this.horizontal ? 'width' : 'height']: `${thumbSize}px`\n    };\n    Object.assign(this.$scrollbarThumb.style, style);\n  }\n\n  /** Updates auxiliary markers */\n  public updateMarkers(): void {\n    const {position, thumbSize} =  this;\n    this.toggleAttribute('at-start', thumbSize < 1 && position <= 0);\n    this.toggleAttribute('at-end', thumbSize < 1 && position >= 1);\n    this.toggleAttribute('inactive', thumbSize >= 1);\n  }\n\n  /** Refreshes scroll state and position */\n  public refresh(): void {\n    this.update();\n    this.updateMarkers();\n  }\n\n  /** Returns position from MouseEvent coordinates (not normalized) */\n  public toPosition(event: MouseEvent | TouchEvent): number {\n    const {horizontal, thumbOffset, trackOffset} = this;\n    const point = getTouchPoint(event);\n    const offset = getOffsetPoint(this.$scrollbarTrack);\n    const pointPosition = horizontal ? point.x - offset.x : point.y - offset.y;\n    const freeTrackArea = trackOffset - thumbOffset; // size of free track px\n    const clickPositionNoOffset = pointPosition - thumbOffset / 2;\n    return clickPositionNoOffset / freeTrackArea;\n  }\n\n  // Event listeners\n  /** Handles `mousedown` / `touchstart` event to manage thumb drag start and scroll clicks */\n  @listen('mousedown touchstart')\n  protected _onPointerDown(event: MouseEvent | TouchEvent): void {\n    this._initialPosition = this.position;\n    this._pointerPosition = this.toPosition(event);\n    const point = getTouchPoint(event);\n    this._initialMousePosition = this.horizontal ? point.x : point.y;\n\n    if (event.target === this.$scrollbarThumb) {\n      this._onThumbPointerDown(event); // Drag start handler\n    } else {\n      this._onPointerDownTick(true); // Continuous scroll and click handler\n    }\n\n    // Subscribes inverse handlers\n    isMouseEvent(event) && this.$$on({event: 'mouseup', target: window}, this._onPointerUp);\n    isTouchEvent(event) && this.$$on({event: 'touchend', target: window}, this._onPointerUp);\n\n    // Prevents default text selection, etc.\n    if (!isTouchEvent(event)) event.preventDefault();\n  }\n\n  /** Handles a scroll click / continuous scroll*/\n  @bind\n  protected _onPointerDownTick(first: boolean): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n\n    const position = this.position;\n    const allowedOffset = (first ? 1 : 1.5) * this.thumbSize;\n    this.position = Math.min(position + allowedOffset, Math.max(position - allowedOffset, this._pointerPosition));\n\n    if (this.position === this._pointerPosition || this.noContinuousScroll) return;\n    this._scrollTimer = window.setTimeout(this._onPointerDownTick, 400);\n  }\n\n  /** Handles thumb drag start */\n  @bind\n  protected _onThumbPointerDown(event: MouseEvent | TouchEvent): void {\n    this.toggleAttribute('dragging', true);\n    this.$target?.style.setProperty('scroll-behavior', 'auto');\n    // Attaches drag listeners\n    this.$$on(this._onBodyClick);\n    isMouseEvent(event) && this.$$on({event: 'mousemove', target: window}, this._onPointerMove);\n    isTouchEvent(event) && this.$$on({event: 'touchmove', target: window}, this._onPointerMove);\n  }\n\n  /** Sets position on drag */\n  protected _onPointerDrag(event: MouseEvent | TouchEvent): void {\n    const point = getTouchPoint(event);\n    const mousePosition = this.horizontal ? point.x : point.y;\n    const positionChange = mousePosition - this._initialMousePosition;\n    const scrollableAreaHeight = this.trackOffset - this.thumbOffset;\n    const absChange = scrollableAreaHeight ? (positionChange / scrollableAreaHeight) : 0;\n    this.position = this._initialPosition + absChange;\n\n    this.updateMarkers();\n  }\n\n  /** `mousemove` document handler for thumb drag event. Active only if drag action is active */\n  protected _onPointerMove(event: MouseEvent | TouchEvent): void {\n    if (!this.dragging) return;\n    // Request position update\n    this._deferredDrag(event);\n    // Prevents default text selection, etc.\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /** `mouseup` short-time document handler for drag end action */\n  protected _onPointerUp(event: MouseEvent | TouchEvent): void {\n    this._scrollTimer && window.clearTimeout(this._scrollTimer);\n    this.toggleAttribute('dragging', false);\n    this.$target?.style.removeProperty('scroll-behavior');\n\n    // Unbinds drag listeners\n    this.$$off(this._onPointerMove);\n    this.$$off(this._onPointerUp);\n  }\n\n  /** Body `click` short-time handler to prevent clicks event on thumb drag. Handles capture phase */\n  @listen({auto: false, event: 'click', target: window, once: true, capture: true})\n  protected _onBodyClick(event: MouseEvent): void {\n    event.stopImmediatePropagation();\n  }\n\n  /**\n   * Handler for refresh event\n   * @param event - instance of 'esl:refresh' event.\n   */\n  @listen({\n    event: (el: ESLScrollbar) => el.REFRESH_EVENT,\n    target: window\n  })\n  protected _onRefresh(event: Event): void {\n    if (!(event.target instanceof Element)) return;\n    if (!isRelativeNode(event.target.parentNode, this.$target)) return;\n    this._deferredRefresh();\n  }\n\n  /**\n   * Handler for scroll and resize events\n   * @param event - instance of 'resize' or 'scroll' event\n   */\n  protected _onScrollOrResize(event: Event): void {\n    if (event.type === 'scroll' && this.dragging) return;\n    this._deferredRefresh();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Scrollbar: typeof ESLScrollbar;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-scrollbar': ESLScrollbar;\n  }\n}\n","import {ESLShareBaseAction} from '../core/esl-share-action';\nimport {ESLEventUtils} from '../../esl-utils/dom/events';\n\nimport type {ESLShareButton} from '../core/esl-share-button';\n\n/** Copy to clipboard action class for share buttons {@link ESLShareButton} */\n@ESLShareBaseAction.register\nexport class ESLShareCopyAction extends ESLShareBaseAction {\n  public static override readonly is: string = 'copy';\n\n  /** Checks if this action is available on the user's device */\n  public override get isAvailable(): boolean {\n    return navigator.clipboard !== undefined;\n  }\n\n  /** Does an action to share */\n  public share($button: ESLShareButton): void {\n    const shareData = this.getShareData($button);\n    const {url} = shareData;\n    if (!this.isAvailable || !url) return;\n\n    navigator.clipboard.writeText(url);\n    this.showCopyAlert($button.additional?.alertText);\n  }\n\n  /** Shows alert about the successful action completion */\n  protected showCopyAlert(alertText: string): void {\n    if (!alertText) return;\n    const detail = {\n      cls: 'esl-share-alert',\n      html: `<span>${alertText}</span>`\n    };\n    ESLEventUtils.dispatch(document.body, 'esl:alert:show', {detail});\n  }\n}\n","import {ESLShareUrlGenericAction} from './url-generic-action';\n\nimport type {ESLShareButton} from '../core/esl-share-button';\n\n/** Action class for share buttons {@link ESLShareButton} via an external link */\n@ESLShareUrlGenericAction.register\nexport class ESLShareExternalAction extends ESLShareUrlGenericAction {\n  public static override readonly is: string = 'external';\n\n  /** Does an action to share */\n  public share($button: ESLShareButton): void {\n    const {link} = $button;\n    if (!link) return;\n\n    const shareData = this.getShareData($button);\n    const a = document.createElement('a');\n    a.href = this.buildURL(link, shareData);\n    a.click();\n  }\n}\n","import {ESLShareUrlGenericAction} from './url-generic-action';\n\nimport type {ESLShareButton} from '../core/esl-share-button';\n\n/** Action class for share buttons {@link ESLShareButton} via a link to share on a social media */\n@ESLShareUrlGenericAction.register\nexport class ESLShareMediaAction extends ESLShareUrlGenericAction {\n  public static override readonly is: string = 'media';\n\n  /**\n   * Window features that apply to `window.open()`.\n   * These features include options such as the window's default size and position,\n   * whether or not to open a minimal popup window, and so forth.\n   * */\n  public static FEATURES: Record<string, number> = {\n    scrollbars: 0,\n    resizable: 1,\n    menubar: 0,\n    left: 100,\n    top: 100,\n    width: 750,\n    height: 500,\n    toolbar: 0,\n    status: 0\n  };\n\n  protected get windowFeatures(): string {\n    const features = (this.constructor as typeof ESLShareMediaAction).FEATURES;\n    return Object.entries(features).map(([key, value]) => `${key}=${value}`).join(',');\n  }\n\n  /** Does an action to share */\n  public share($button: ESLShareButton): void {\n    const {link} = $button;\n    if (!link) return;\n\n    const shareData = this.getShareData($button);\n    window.open(this.buildURL(link, shareData), '_blank', this.windowFeatures);\n  }\n}\n","import {ESLShareBaseAction} from '../core/esl-share-action';\n\nimport type {ESLShareButton} from '../core/esl-share-button';\n\n/** Native action class for share buttons {@link ESLShareButton} that invokes the native sharing mechanism of Web Share API */\n@ESLShareBaseAction.register\nexport class ESLShareNativeAction extends ESLShareBaseAction {\n  public static override readonly is: string = 'native';\n\n  /** Checks if this action is available on the user's device */\n  public override get isAvailable(): boolean {\n    return navigator.share !== undefined;\n  }\n\n  /** Does an action to share */\n  public share($button: ESLShareButton): void {\n    if (!this.isAvailable) return;\n\n    const shareData = this.getShareData($button);\n    navigator.share(shareData);\n  }\n}\n","import {ESLShareBaseAction} from '../core/esl-share-action';\n\nimport type {ESLShareButton} from '../core/esl-share-button';\n\n/** Print action class for share buttons {@link ESLShareButton} */\n@ESLShareBaseAction.register\nexport class ESLSharePrintAction extends ESLShareBaseAction {\n  public static override readonly is: string = 'print';\n\n  /** Does an action to share */\n  public share($button: ESLShareButton): void {\n    window.print();\n  }\n}\n","import {ESLShareBaseAction} from '../core/esl-share-action';\nimport {format} from '../../esl-utils/misc/format';\n\n/** Base action class for URL-based actions of share buttons {@link ESLShareButton} */\nexport abstract class ESLShareUrlGenericAction extends ESLShareBaseAction {\n\n  protected getFormatSource(shareData: ShareData): Record<string, string> {\n    const title = encodeURIComponent(shareData.title || '');\n    const url = encodeURIComponent(shareData.url || '');\n    return {\n      u: url,\n      t: title,\n      url,\n      title\n    };\n  }\n\n  /** Builds URL to share on a social network */\n  protected buildURL(link: string, shareData: ShareData): string {\n    return format(link, this.getFormatSource(shareData));\n  }\n}\n","import {memoize} from '../../esl-utils/decorators';\n\nimport type {ESLShareActionType, ESLShareBaseAction} from './esl-share-action';\nimport type {ESLShareButton} from './esl-share-button';\n\n/**\n * ESLShareActionRegistry class to store share actions\n * @author Dmytro Shovchko\n */\nexport class ESLShareActionRegistry {\n  private actionsMap: Map<string, ESLShareBaseAction> = new Map();\n\n  /** Returns action registry instance */\n  @memoize()\n  public static get instance(): ESLShareActionRegistry {\n    return new ESLShareActionRegistry();\n  }\n\n  /** Registers action */\n  public register(action: ESLShareActionType): void {\n    if (!action.is) throw new Error('Action should have a name');\n    this.actionsMap.set(action.is, new action());\n  }\n\n  /** Checks if action is registered for passed name */\n  public has(name: string): boolean {\n    return this.actionsMap.has(name);\n  }\n\n  /** Gets the action by name */\n  public get(name: string): ESLShareBaseAction | null {\n    if (!name) return null;\n    return this.actionsMap.get(name.toLowerCase()) || null;\n  }\n\n  /** Does the share action on passed Share button {@link ESLShareButton} */\n  public share(button: ESLShareButton): void {\n    const action = this.get(button.action);\n    action && action.share(button);\n  }\n}\n","import {ESLShareActionRegistry} from './esl-share-action-registry';\n\nimport type {ESLShareButton} from './esl-share-button';\n\n/** Action type definition */\nexport type ESLShareActionType = (new() => ESLShareBaseAction) & typeof ESLShareBaseAction;\n\n/** Base action class for actions of share buttons {@link ESLShareButton} */\nexport abstract class ESLShareBaseAction {\n  public static readonly is: string;\n\n  /** Decorator to register action */\n  public static register(this: ESLShareActionType): void;\n  /** Registers this action */\n  public static register(this: unknown, action?: ESLShareActionType): void;\n  public static register(this: any, action?: ESLShareActionType): void {\n    action = action || this;\n    if (action === ESLShareBaseAction) throw new Error('`ESLShareBaseAction` can\\'t be registered.');\n    if (!(action?.prototype instanceof ESLShareBaseAction)) throw new Error('Action should be instanceof `ESLShareBaseAction`');\n    ESLShareActionRegistry.instance.register(action);\n  }\n\n  /** Checks if this action is available on the user's device */\n  public get isAvailable(): boolean {\n    return true;\n  }\n\n  /** @returns {@link ShareData} object for button  */\n  protected getShareData($button: ESLShareButton): ShareData {\n    return {\n      url: $button.urlToShare,\n      title: $button.titleToShare\n    };\n  }\n\n  /** Does an action to share */\n  public abstract share($button: ESLShareButton): void;\n}\n","import {ESLBaseElement} from '../../esl-base-element/core';\nimport {attr, boolAttr, jsonAttr, listen} from '../../esl-utils/decorators';\nimport {ENTER, SPACE} from '../../esl-utils/dom/keys';\nimport {toAbsoluteUrl} from '../../esl-utils/misc/url';\nimport {ESLShareActionRegistry} from './esl-share-action-registry';\n\nimport type {ESLShareBaseAction} from './esl-share-action';\n\n/**\n * ESLShareButton\n * @author Dmytro Shovchko\n *\n * ESLShareButton is a custom element to create a \"Share on social media\" button.\n */\nexport class ESLShareButton extends ESLBaseElement {\n  public static override is = 'esl-share-button';\n  public static observedAttributes = ['action'];\n\n  /** Name of share action that occurs after button click */\n  @attr() public action: string;\n  /** Link to share on a social network */\n  @attr() public link: string;\n  /** String social network identifier (no spaces) */\n  @attr() public name: string;\n\n  /** URL to share (current page URL by default) */\n  @attr() public shareUrl: string;\n  /** Title to share (current document title by default) */\n  @attr() public shareTitle: string;\n\n  /** Additional params to pass into a button (can be used by share actions) */\n  @jsonAttr() public additional: Record<string, any>;\n\n  /** Marker of availability of share button */\n  @boolAttr() public unavailable: boolean;\n\n  protected get actionInstance(): ESLShareBaseAction | null {\n    return ESLShareActionRegistry.instance.get(this.action);\n  }\n\n  /** @returns title to share */\n  public get titleToShare(): string {\n    return this.getShareAttr('share-title', document.title);\n  }\n\n  /** @returns URL to share */\n  public get urlToShare(): string {\n    return toAbsoluteUrl(this.getShareAttr('share-url', window.location.href));\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'action') this.updateAction();\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.initA11y();\n    this.updateAction();\n  }\n\n  /** Sets initial a11y attributes */\n  protected initA11y(): void {\n    if (!this.hasAttribute('role')) this.setAttribute('role', 'button');\n    if (this.getAttribute('role') === 'button' && !this.hasAttribute('tabindex')) {\n      this.tabIndex = 0;\n    }\n  }\n\n  /** Does an action to share */\n  public share(): void {\n    this.actionInstance?.share(this);\n  }\n\n  protected updateAction(): void {\n    this.$$attr('unavailable', !this.actionInstance?.isAvailable);\n  }\n\n  /** Gets attribute from the element or closest parent,\n   *  returns fallback value in the case when an element with attribute not found */\n  protected getShareAttr(name: string, fallback: string): string {\n    const el = this.closest(`[${name}]`);\n    return (el && el.getAttribute(name)) || fallback;\n  }\n\n  @listen('click')\n  protected _onClick(e: MouseEvent): void {\n    this.share();\n  }\n\n  @listen('keydown')\n  protected _onKeydown(e: KeyboardEvent): void {\n    if ([ENTER, SPACE].includes(e.key)) {\n      this.click();\n      e.preventDefault();\n    }\n  }\n}\n","/** {@link ESLShareConfig} provider type definition */\nexport type ESLShareConfigProviderType = () => Promise<ESLShareConfig>;\n\n/** The definition of the sharing button */\nexport interface ESLShareButtonConfig {\n  /** Name of the share action, which is performed after the button is pressed */\n  action: string;\n  /** HTML content of the share icon */\n  icon: string;\n  /** Color of the icon background (the value - CSS data type represents a color) */\n  iconBackground: string;\n  /**\n   * URL link (with placeholders) to share. Can contain the following placeholders:\n   * - `{u}` or `{url}` - URL to share (`shareUrl` property on the {@link ESLShareButton} instance)\n   * - `{t}` or `{title}` - title to share (`shareTitle` property on the {@link ESLShareButton} instance)\n   */\n  link: string;\n  /** String identifier of the button (no spaces) */\n  name: string;\n  /** Button title */\n  title: string;\n  /** Additional params to pass into a button */\n  additional?: Record<string, any>;\n}\n\n/** The definition of share buttons groups (named sets of share buttons) */\nexport interface ESLShareGroupConfig {\n  /** Name of the group. The group can be accessed with the `group:` prefix in the component configuration */\n  name: string;\n  /** A list of button names separated by space */\n  list: string;\n}\n\n/** The definition of `ESLShare` component configuration */\nexport interface ESLShareConfig {\n  /** List of sharing buttons configuration */\n  buttons: ESLShareButtonConfig[];\n  /** List of share button groups configurations */\n  groups: ESLShareGroupConfig[];\n}\n\nfunction getConfigSectionItem<T extends ESLShareButtonConfig | ESLShareGroupConfig>(section: T[], name: string): T | undefined {\n  return section.find((item) => item.name === name);\n}\n\n/**\n * Selects the buttons for the given list and returns their configuration.\n * @returns config of buttons\n */\nexport function selectButtonsForList(config: ESLShareConfig, list: string): ESLShareButtonConfig[] {\n  return list.split(' ').reduce((res, item) => {\n    const [btnName, groupName] = item.split('group:');\n    if (groupName) {\n      const groupConfig = getConfigSectionItem(config.groups, groupName);\n      if (groupConfig) return res.concat(selectButtonsForList(config, groupConfig.list));\n    } else {\n      const btnConfig = getConfigSectionItem(config.buttons, btnName);\n      if (btnConfig) res.push(btnConfig);\n    }\n    return res;\n  }, [] as ESLShareButtonConfig[]);\n}\n","import {ESLTrigger} from '../../esl-trigger/core';\n\nimport type {ESLToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n/**\n * ESLShareTrigger component\n * @author Dmytro Shovchko\n *\n * ESLShareTrigger is an extension of {@link ESLTrigger} that\n * - controls an internal popup of {@link ESLShare} module in `popup` rendering mode.\n * - forwards the sharing attributes from the parent share {@link ESLShare} component to its associated instance of {@link ESLPopup}\n */\nexport class ESLShareTrigger extends ESLTrigger {\n  public static override is = 'esl-share-trigger';\n\n  /** List of attributes to forward from the host to the target share {@link ESLPopup} */\n  public static forwardedAttrs = ['share-title', 'share-url'];\n\n  /** Shows the target {@link ESLPopup} with a passed params */\n  public override showTarget(params: ESLToggleableActionParams = {}): void {\n    super.showTarget(params);\n\n    this.forwardAttributes();\n  }\n\n  /**\n   * Forwards share attributes from the host (or its parents) to the target share {@link ESLPopup} instance.\n   * Skips empty attributes\n   */\n  protected forwardAttributes(): void {\n    ESLShareTrigger.forwardedAttrs.forEach((name) => {\n      const el = this.closest(`[${name}]`);\n      const value = el && el.getAttribute(name);\n      if (value) this.$target?.$$attr(name, value);\n    });\n  }\n}\n","import {ESLBaseElement} from '../../esl-base-element/core';\nimport {ESLPopup} from '../../esl-popup/core';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {attr, bind, boolAttr, prop} from '../../esl-utils/decorators';\nimport {selectButtonsForList} from './esl-share-config';\nimport {ESLShareButton} from './esl-share-button';\nimport {ESLShareTrigger} from './esl-share-trigger';\n\nimport type {PopupActionParams} from '../../esl-popup/core';\nimport type {ESLShareConfig, ESLShareButtonConfig} from './esl-share-config';\n\n/** {@link ShareConfig} provider type definition */\nexport type ESLShareConfigProviderType = () => Promise<ESLShareConfig>;\n\n/**\n * ESLShare\n * @author Dmytro Shovchko\n *\n * ESLShare is a custom element to dynamically draw {@link ESLShareButton}s using simplified shared config\n */\nexport class ESLShare extends ESLBaseElement {\n  public static override is = 'esl-share';\n  protected static _config: Promise<ESLShareConfig>;\n  protected static _popupStore: Map<string, ESLPopup> = new Map<string, ESLPopup>();\n\n  /** Register {@link ESLShare} component and dependent {@link ESLShareButton} */\n  public static override register(): void {\n    ESLShareButton.register();\n    ESLShareTrigger.register();\n    super.register();\n  }\n\n  /**\n   * Gets or updates config with a promise of a new config object or using a config provider function.\n   * @returns Promise of the current config\n   */\n  public static config(provider?: ESLShareConfigProviderType | ESLShareConfig): Promise<ESLShareConfig> {\n    if (typeof provider === 'function') ESLShare._config = provider();\n    if (typeof provider === 'object') ESLShare._config = Promise.resolve(provider);\n    return ESLShare._config ?? Promise.reject('Configuration is not set');\n  }\n\n  /** Event to dispatch on ready state of {@link ESLShare} */\n  @prop('esl:share:ready') public SHARE_READY_EVENT: string;\n\n  /** Default initial params to pass into the newly created popup */\n  @prop({\n    position: 'top',\n    defaultParams: {\n      hideDelay: 200\n    }\n  }) protected popupInitialParams: PopupActionParams;\n\n  /**\n   * List of social networks or groups of them to display (all by default).\n   * The value - a string containing the names of the buttons or groups (specified with\n   * the prefix group:) separated by spaces.\n   * @example \"facebook reddit group:default\"\n   * */\n  @attr({defaultValue: 'all'}) public list: string;\n  /** URL to share (current page URL by default) */\n  @attr() public shareUrl: string;\n  /** Title to share (current document title by default) */\n  @attr() public shareTitle: string;\n  /** Rendering mode of the share buttons ('list' by default) */\n  @attr() public mode: 'list' | 'popup';\n\n  /** @readonly Ready state marker */\n  @boolAttr({readonly: true}) public ready: boolean;\n\n  protected _content: string;\n\n  /** @returns config of buttons specified by the list attribute */\n  public get buttonsConfig(): Promise<ESLShareButtonConfig[]> {\n    return (this.constructor as typeof ESLShare).config().then((config) => {\n      return (this.list !== 'all') ? selectButtonsForList(config, this.list) : config.buttons;\n    });\n  }\n\n  public override connectedCallback(): void {\n    super.connectedCallback();\n    this.init();\n  }\n\n  protected init(): void {\n    if (this.ready) return;\n    if (!this.mode) this.mode = 'list';\n    if (!this._content) this._content = this.innerHTML;\n    this.buttonsConfig\n      .then(this.buildContent)\n      .then(() => this.$$fire(this.SHARE_READY_EVENT, {bubbles: false}))\n      .catch((e) => console.error(`[${this.baseTagName}]: ${e}`));\n  }\n\n  /** Builds component's content from received `ESLShareButtonConfig` list */\n  @bind\n  protected buildContent(btnConfig: ESLShareButtonConfig[]): void {\n    this.innerHTML = '';\n\n    if (this.mode === 'list') {\n      this.appendButtonsTo(this, btnConfig);\n      return;\n    }\n\n    const $popup = this.getStoredPopup() || this.createPopup(btnConfig);\n    this.appendTrigger(`#${$popup.id}`);\n  }\n\n  /** Appends buttons to the passed element. */\n  protected appendButtonsTo($el: Element, btnConfig: ESLShareButtonConfig[]): void {\n    btnConfig.forEach((cfg) => {\n      const btn = this.createButton(cfg);\n      btn && $el.appendChild(btn);\n    });\n  }\n\n  /** Appends trigger to the share component. */\n  protected appendTrigger(target: string): void {\n    const $trigger = ESLShareTrigger.create();\n    Object.assign($trigger, {\n      target,\n      trackClick: true,\n      trackHover: true\n    });\n    $trigger.innerHTML = this._content;\n    this.appendChild($trigger);\n  }\n\n  /** Creates share button. */\n  protected createButton(cfg: ESLShareButtonConfig): ESLShareButton | null {\n    const $button = ESLShareButton.create();\n    Object.assign($button, cfg);\n    const $icon = document.createElement('span');\n    $icon.title = cfg.title;\n    $icon.classList.add('esl-share-icon');\n    $icon.innerHTML = cfg.icon;\n    $icon.setAttribute('style', `background-color:${cfg.iconBackground};`);\n    $button.appendChild($icon);\n    return $button;\n  }\n\n  /** Creates popup element with share buttons. */\n  protected createPopup(btnConfig: ESLShareButtonConfig[]): ESLPopup {\n    const $popup = ESLPopup.create();\n    const id = sequentialUID(this.baseTagName + '-');\n    Object.assign($popup, {id, ...this.popupInitialParams});\n    $popup.appendArrow();\n    document.body.appendChild($popup);\n    this.storePopup($popup);\n\n    this.appendButtonsTo($popup, btnConfig);\n    return $popup;\n  }\n\n  /** Gets popup element from the popup's store. */\n  protected getStoredPopup(): ESLPopup | undefined {\n    return (this.constructor as typeof ESLShare)._popupStore.get(this.list);\n  }\n\n  /** Adds popup element to the popup's store. */\n  protected storePopup(value: ESLPopup): void {\n    (this.constructor as typeof ESLShare)._popupStore.set(this.list, value);\n  }\n}\n","import {attr} from '../../esl-utils/decorators';\nimport {setAttr} from '../../esl-utils/dom/attr';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLTrigger} from '../../esl-trigger/core';\n\n/**\n * ESlTab component\n * @author Julia Murashko\n *\n * Tab trigger item, usually used in conjunction with a {@link ESLTabs}.\n * Can control any {@link ESLToggleable} instance but is usually used in conjunction with {@link ESLPanel}\n */\n@ExportNs('Tab')\nexport class ESLTab extends ESLTrigger {\n  public static override is = 'esl-tab';\n\n  @attr({defaultValue: 'show'}) public override mode: string;\n  @attr({defaultValue: 'active'}) public override activeClass: string;\n\n  public override initA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n    if (target.hasAttribute('role')) return;\n    setAttr(target, 'role', 'tab');\n  }\n\n  public override updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    if (this.a11yLabelActive !== null || this.a11yLabelInactive !== null) {\n      setAttr(target, 'aria-label', this.a11yLabel);\n    }\n    setAttr(target, 'aria-selected', String(this.active));\n    setAttr(target, 'tabindex', this.active ? '0' : '-1');\n\n    if (this.$target && this.$target.id) {\n      setAttr(target, 'aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tab: typeof ESLTab;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tab': ESLTab;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {rafDecorator} from '../../esl-utils/async/raf';\nimport {memoize, attr, listen, decorate} from '../../esl-utils/decorators';\nimport {isRTL, RTLScroll} from '../../esl-utils/dom/rtl';\nimport {debounce} from '../../esl-utils/async/debounce';\nimport {ESLMediaRuleList} from '../../esl-media-query/core/esl-media-rule-list';\nimport {ESLTab} from './esl-tab';\n\n/**\n * ESlTabs component\n * @author Julia Murashko\n *\n * Tabs container component for Tabs trigger group.\n * Uses {@link ESLTab} as an item.\n * Each individual {@link ESLTab} can control {@link ESLToggleable} or, usually, {@link ESLPanel}\n */\n@ExportNs('Tabs')\nexport class ESLTabs extends ESLBaseElement {\n  public static override is = 'esl-tabs';\n  public static observedAttributes = ['scrollable'];\n\n  /** List of supported scrollable types */\n  public static supportedScrollableTypes = ['disabled', 'side', 'center'];\n\n  /**\n   * Scrollable mode (supports {@link ESLMediaRuleList}).\n   * Supported types for different breakpoints ('disabled' by default):\n   * - 'disabled' or not defined -  scroll behavior is disabled;\n   * - 'center' - scroll behavior is enabled, tab is center-aligned;\n   * - 'side' - scroll behavior is enabled, tab is side-aligned;\n   * - empty or unsupported value is equal to 'side' behavior;\n   */\n  @attr({defaultValue: 'disabled'}) public scrollable: string;\n\n  /** Inner element to contain {@link ESLTab} collection. Will be scrolled in a scrollable mode */\n  @attr({defaultValue: '.esl-tab-container'}) public scrollableTarget: string;\n\n  protected _deferredUpdateArrows = debounce(this.updateArrows, 100, this);\n  protected _deferredFitToViewport = debounce(this.fitToViewport, 100, this);\n\n  /** ESLMediaRuleList instance of the scrollable type mapping */\n  @memoize()\n  public get scrollableTypeRules(): ESLMediaRuleList<string> {\n    return ESLMediaRuleList.parse(this.scrollable);\n  }\n\n  /** @returns current scrollable type */\n  public get currentScrollableType(): string {\n    return this.scrollableTypeRules.activeValue || 'side';\n  }\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.updateScrollableType();\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || oldVal === newVal) return;\n    if (attrName === 'scrollable') {\n      memoize.clear(this, 'scrollableTypeRules');\n      this.$$on(this._onScrollableTypeChange);\n      this.updateScrollableType();\n    }\n  }\n\n  protected bindScrollableEvents(): void {\n    this.$$on(this._onScroll);\n    this.$$on(this._onResize);\n  }\n  protected unbindScrollableEvents(): void {\n    this.$$off(this._onScroll);\n    this.$$off(this._onResize);\n  }\n\n  /** Collection of inner {@link ESLTab} items */\n  public get $tabs(): ESLTab[] {\n    const els = this.querySelectorAll(ESLTab.is);\n    return els ? Array.from(els) as ESLTab[] : [];\n  }\n\n  /** Active {@link ESLTab} item */\n  public get $current(): ESLTab | null {\n    return this.$tabs.find((el) => el.active) || null;\n  }\n\n  /** Container element to scroll */\n  public get $scrollableTarget(): HTMLElement | null {\n    return this.querySelector(this.scrollableTarget);\n  }\n\n  /** Is the scrollable mode enabled ? */\n  public get isScrollable(): boolean {\n    return this.currentScrollableType !== 'disabled';\n  }\n\n  /** Move scroll to the next/previous item */\n  public moveTo(direction: string, behavior: ScrollBehavior = 'smooth'): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n    let left = $scrollableTarget.offsetWidth;\n    left = isRTL(this) && RTLScroll.type !== 'reverse' ? -left : left;\n    left = direction === 'left' ? -left : left;\n\n    $scrollableTarget.scrollBy({left, behavior});\n  }\n\n  /** Scroll tab to the view */\n  protected fitToViewport($trigger: ESLTab | null, behavior: ScrollBehavior = 'smooth'): void {\n    this.updateMarkers();\n\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget || !$trigger) return;\n\n    const areaRect = $scrollableTarget.getBoundingClientRect();\n    const itemRect = $trigger.getBoundingClientRect();\n\n    $scrollableTarget.scrollBy({\n      left: this.calcScrollOffset(itemRect, areaRect),\n      behavior\n    });\n\n    this.updateArrows();\n  }\n\n  /** Get scroll offset position from the selected item rectangle */\n  protected calcScrollOffset(itemRect: DOMRect, areaRect: DOMRect): number | undefined {\n    const isReversedRTL = isRTL(this) && RTLScroll.type === 'reverse';\n\n    if (this.currentScrollableType === 'center') {\n      const shift = itemRect.left + itemRect.width / 2 - (areaRect.left + areaRect.width / 2);\n      return isReversedRTL ? -shift : shift;\n    }\n\n    // item is out of area from the right side\n    // else item out is of area from the left side\n    if (itemRect.right > areaRect.right) {\n      return isReversedRTL ? Math.floor(areaRect.right - itemRect.right) : Math.ceil(itemRect.right - areaRect.right);\n    } else if (itemRect.left < areaRect.left) {\n      return isReversedRTL ? Math.ceil(areaRect.left - itemRect.left) : Math.floor(itemRect.left - areaRect.left);\n    }\n  }\n\n  protected updateArrows(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const swapSides = isRTL(this) && RTLScroll.type === 'default';\n    const scrollStart = Math.abs($scrollableTarget.scrollLeft) > 1;\n    const scrollEnd = Math.abs($scrollableTarget.scrollLeft) + $scrollableTarget.clientWidth + 1 < $scrollableTarget.scrollWidth;\n\n    const $rightArrow = this.querySelector('[data-tab-direction=\"right\"]');\n    const $leftArrow = this.querySelector('[data-tab-direction=\"left\"]');\n\n    $leftArrow && $leftArrow.toggleAttribute('disabled', !(swapSides ? scrollEnd : scrollStart));\n    $rightArrow && $rightArrow.toggleAttribute('disabled', !(swapSides ? scrollStart : scrollEnd));\n  }\n\n  protected updateMarkers(): void {\n    const $scrollableTarget = this.$scrollableTarget;\n    if (!$scrollableTarget) return;\n\n    const hasScroll = this.isScrollable && ($scrollableTarget.scrollWidth > this.clientWidth);\n    this.toggleAttribute('has-scroll', hasScroll);\n  }\n\n  /** Update element state according to scrollable type */\n  protected updateScrollableType(): void {\n    ESLTabs.supportedScrollableTypes.forEach((type) => {\n      this.$$cls(`scrollable-${type}`, this.currentScrollableType === type);\n    });\n    this._deferredFitToViewport(this.$current);\n\n    if (this.currentScrollableType === 'disabled') {\n      this.unbindScrollableEvents();\n    } else {\n      this.bindScrollableEvents();\n    }\n  }\n\n  @listen('esl:change:active')\n  protected _onTriggerStateChange({detail}: CustomEvent): void {\n    if (!detail.active) return;\n    this._deferredFitToViewport(this.$current);\n  }\n\n  @listen('click')\n  protected _onClick(event: Event): void {\n    const eventTarget: HTMLElement = event.target as HTMLElement;\n    const target: HTMLElement | null = eventTarget.closest('[data-tab-direction]');\n    const direction = target && target.dataset.tabDirection;\n\n    if (!direction) return;\n    this.moveTo(direction);\n  }\n\n  @listen('focusin')\n  protected _onFocus(e: FocusEvent): void {\n    const target = e.target;\n    if (target instanceof ESLTab) this._deferredFitToViewport(target);\n  }\n\n  @listen({\n    auto: false,\n    event: 'scroll',\n    target: (el: ESLTabs) => el.$scrollableTarget\n  })\n  protected _onScroll(): void {\n    this._deferredUpdateArrows();\n  }\n\n  @listen({\n    auto: false,\n    event: 'resize',\n    target: window,\n    passive: true\n  })\n  @decorate(rafDecorator)\n  protected _onResize(): void {\n    this._deferredFitToViewport(this.$current, 'auto');\n  }\n\n  /** Handles scrollable type change */\n  @listen({\n    event: 'change',\n    target: (el: ESLTabs) => el.scrollableTypeRules\n  })\n  protected _onScrollableTypeChange(): void {\n    this.updateScrollableType();\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tabs: typeof ESLTabs;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-tabs': ESLTabs;\n  }\n}\n","import {ESLBaseElement, listen} from '../../esl-base-element/core';\nimport {getCompositeTarget} from '../../esl-utils/dom/events';\nimport {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLToggleable} from './esl-toggleable';\n\n/**\n * ESLToggleableDispatcher\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleableDispatcher - plugin component, that prevents activation of multiple ESLToggleable instances in bounds of managed container.\n */\n@ExportNs('ToggleableDispatcher')\nexport class ESLToggleableDispatcher extends ESLBaseElement {\n  public static override readonly is = 'esl-toggleable-dispatcher';\n\n  /**\n   * Initialize ToggleableGroupDispatcher\n   * Uses esl-toggleable-dispatcher tag and document body root by default\n   */\n  public static init(root: HTMLElement = document.body, tagName: string = this.is): void {\n    if (!root) throw new Error('Root element should be specified');\n    const instances = root.getElementsByTagName(tagName);\n    if (instances.length) return;\n    this.register(tagName);\n    root.insertAdjacentElement('afterbegin', document.createElement(tagName));\n  }\n\n  protected _popups: Map<string, ESLToggleable> = new Map<string, ESLToggleable>();\n\n  /** Observed element */\n  public get root(): HTMLElement | null {\n    return this.parentElement;\n  }\n\n  /** Guard-condition for targets */\n  protected isAcceptable(target: any): target is ESLToggleable {\n    if (!(target instanceof ESLToggleable)) return false;\n    return !!target.groupName && target.groupName !== 'none';\n  }\n\n  /** Hides active element in group */\n  public hideActive(groupName: string, activator?: HTMLElement): void {\n    const active = this.getActive(groupName);\n    if (!active || active === activator) return;\n    active.hide({\n      initiator: 'dispatcher',\n      dispatcher: this,\n      activator\n    });\n  }\n\n  /** Sets active element in group */\n  public setActive(groupName: string, popup: ESLToggleable): void {\n    if (!groupName) return;\n    this.hideActive(groupName, popup);\n    this._popups.set(groupName, popup);\n  }\n\n  /** Gets active element in group or undefined if group doesn't exist */\n  public getActive(groupName: string): ESLToggleable | undefined {\n    return this._popups.get(groupName);\n  }\n\n  /** Deletes element from the group if passed element is currently active */\n  public deleteActive(groupName: string, popup: ESLToggleable): void {\n    if (this.getActive(groupName) !== popup) return;\n    this._popups.delete(groupName);\n  }\n\n  /** Hides active element before e.target will be shown */\n  @listen({\n    event: ESLToggleable.prototype.BEFORE_SHOW_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onBeforeShow(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.hideActive(target.groupName, target);\n  }\n\n  /** Updates active element after a new element is shown */\n  @listen({\n    event: ESLToggleable.prototype.SHOW_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onShow(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.setActive(target.groupName, target);\n  }\n\n  /** Updates group state after active element is hidden */\n  @listen({\n    event: ESLToggleable.prototype.HIDE_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onHide(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    this.deleteActive(target.groupName, target);\n  }\n\n  /** Updates active elements */\n  @listen({\n    event: ESLToggleable.prototype.GROUP_CHANGED_EVENT,\n    target: (host: ESLToggleableDispatcher) => host.root\n  })\n  protected _onChangeGroup(e: CustomEvent): void {\n    const target = getCompositeTarget(e);\n    if (!this.isAcceptable(target)) return;\n\n    const {oldGroupName, newGroupName} = e.detail;\n    this.deleteActive(oldGroupName, target);\n    this.setActive(newGroupName, target);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleableDispatcher: typeof ESLToggleableDispatcher;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-dispatcher': ESLToggleableDispatcher;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\n\nimport type {ESLToggleable} from '../../esl-toggleable/core';\n\n@ExportNs('ToggleablePlaceholder')\nexport class ESLToggleablePlaceholder extends ESLBaseElement {\n  public static override is = 'esl-toggleable-placeholder';\n\n  /** List of attributes allowed to copy from origin to this element */\n  public static readonly allowedAttrs: string[] = ['id', 'class'];\n\n  public $origin: ESLToggleable | null;\n\n  /** reates a placeholder for a given element of the toggleable's descendant */\n  public static from<T extends typeof ESLToggleablePlaceholder>(this: T, $el: ESLToggleable): InstanceType<T> {\n    const $placeholder = document.createElement(this.is) as InstanceType<T>;\n    $placeholder.$origin = $el;\n    return $placeholder;\n  }\n\n  public override connectedCallback(): void {\n    this.copyAttributesFromOrigin();\n    super.connectedCallback();\n  }\n\n  /** Builds attribute name for copy */\n  protected buildAttrName(name: string): string {\n    return name === 'id' ? 'original-id' : name;\n  }\n\n  /** Copies allowed attributes from origin to this element */\n  protected copyAttributesFromOrigin(): void {\n    const {$origin} = this;\n    if (!$origin) return;\n\n    (this.constructor as typeof ESLToggleablePlaceholder).allowedAttrs.forEach((name) => {\n      const value = $origin.getAttribute(name);\n      if (value) {\n        this.setAttribute(this.buildAttrName(name), value);\n      }\n    });\n\n    // sanitize class list of placeholder from the tag name of origin's element\n    this.classList.remove(($origin.constructor as typeof ESLBaseElement).is);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    ToggleablePlaceholder: typeof ESLToggleablePlaceholder;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable-placeholder': ESLToggleablePlaceholder;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESC, SYSTEM_KEYS} from '../../esl-utils/dom/keys';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {prop, attr, jsonAttr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {defined, copyDefinedKeys} from '../../esl-utils/misc/object';\nimport {sequentialUID} from '../../esl-utils/misc/uid';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {DelayedTask} from '../../esl-utils/async/delayed-task';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {findParent, isMatches} from '../../esl-utils/dom/traversing';\n\n/** Default Toggleable action params type definition */\nexport interface ESLToggleableActionParams {\n  /** Initiator string identifier */\n  initiator?: string;\n  /** Delay timeout for both show and hide actions */\n  delay?: number;\n  /** Show delay timeout */\n  showDelay?: number;\n  /** Hide delay timeout */\n  hideDelay?: number;\n  /** Force action independently of current state of the Toggleable */\n  force?: boolean;\n  /** Do not throw events on action */\n  silent?: boolean;\n  /** Activate hover tracking to hide Toggleable */\n  trackHover?: boolean;\n  /** Element activator of the action */\n  activator?: HTMLElement | null;\n  /** Event that initiates the action */\n  event?: Event;\n\n  /** Custom user data */\n  [key: string]: any;\n}\n\nexport interface ESLToggleableRequestDetails extends ESLToggleableActionParams {\n  // Selector to match or exact predicate to check if the target should process request\n  match?: string | ((target: Element) => boolean);\n}\n\n/** @deprecated alias for ESLToggleableActionParams, will be removed in 5.0.0*/\nexport type ToggleableActionParams = ESLToggleableActionParams;\n\nconst activators: WeakMap<ESLToggleable, HTMLElement | undefined> = new WeakMap();\n\n/**\n * ESLToggleable component\n * @author Julia Murashko, Alexey Stsefanovich (ala'n)\n *\n * ESLToggleable - a custom element, that is used as a base for \"Popup-like\" components creation\n */\n@ExportNs('Toggleable')\nexport class ESLToggleable extends ESLBaseElement {\n  public static override is = 'esl-toggleable';\n  public static observedAttributes = ['open', 'group'];\n\n  /** Event to dispatch when toggleable is going to be activated */\n  @prop('esl:before:show') public BEFORE_SHOW_EVENT: string;\n  /** Event to dispatch when toggleable is going to be deactivated */\n  @prop('esl:before:hide') public BEFORE_HIDE_EVENT: string;\n\n  /** Event to dispatch when toggleable is activated */\n  @prop('esl:show') public SHOW_EVENT: string;\n  /** Event to dispatch when toggleable is deactivated */\n  @prop('esl:hide') public HIDE_EVENT: string;\n\n  /** Event to dispatch when toggleable has end activation process */\n  @prop('esl:after:show') public AFTER_SHOW_EVENT: string;\n  /** Event to dispatch when toggleable has end deactivation process */\n  @prop('esl:after:hide') public AFTER_HIDE_EVENT: string;\n\n  /** Event to activate toggleables on event way */\n  @prop('esl:show:request') public SHOW_REQUEST_EVENT: string;\n  /** Event to deactivate toggleables on event way */\n  @prop('esl:hide:request') public HIDE_REQUEST_EVENT: string;\n\n  /** Event to dispatch when toggleable group has changed */\n  @prop('esl:change:group') public GROUP_CHANGED_EVENT: string;\n\n  /**\n   * CSS class (supports {@link CSSClassUtils}) to add on the body element\n   * */\n  @attr() public bodyClass: string;\n  /** CSS class (supports {@link CSSClassUtils}) to add when the Toggleable is active */\n  @attr({defaultValue: 'open'}) public activeClass: string;\n\n  /**\n   * CSS class (supports {@link CSSClassUtils}) to add/remove on the container\n   * defined by {@link containerActiveClassTarget}\n   */\n  @attr() public containerActiveClass: string;\n  /**\n   * Selector for the closest parent element to add/remove {@link containerActiveClass}\n   * (default: `*` direct parent)\n   */\n  @attr({defaultValue: '*'}) public containerActiveClassTarget: string;\n\n  /** Toggleable group meta information to organize groups */\n  @attr({name: 'group'}) public groupName: string;\n  /** Selector to mark inner close triggers */\n  @attr({name: 'close-on'}) public closeTrigger: string;\n\n  /** Disallow automatic id creation when it's empty */\n  @boolAttr() public noAutoId: boolean;\n  /** Close the Toggleable on ESC keyboard event */\n  @boolAttr() public closeOnEsc: boolean;\n  /** Close the Toggleable on a click/tap outside */\n  @boolAttr() public closeOnOutsideAction: boolean;\n\n  /** Initial params to pass to show/hide action on the start */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {force: true, initiator: 'init'}})\n  public initialParams: ESLToggleableActionParams;\n  /** Default params to merge into passed action params */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {}})\n  public defaultParams: ESLToggleableActionParams;\n  /** Hover params to pass from track hover listener */\n  @jsonAttr<ESLToggleableActionParams>({defaultValue: {}})\n  public trackHoverParams: ESLToggleableActionParams;\n\n  /** Marker of initially opened toggleable instance */\n  public initiallyOpened: boolean;\n\n  /** Inner state */\n  private _open: boolean = false;\n\n  /** Inner show/hide task manager instance */\n  protected _task: DelayedTask = new DelayedTask();\n  /** Marker for current hover listener state */\n  protected _trackHover: boolean = false;\n  /** Delay for track hover listeners actions */\n  protected _trackHoverDelay: number | undefined;\n\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    if (!this.id && !this.noAutoId) {\n      this.id = sequentialUID(this.baseTagName, this.baseTagName + '-');\n    }\n    this.initiallyOpened = this.hasAttribute('open');\n    this.setInitialState();\n  }\n\n  protected override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    activators.delete(this);\n  }\n\n  protected override attributeChangedCallback(attrName: string, oldVal: string, newVal: string): void {\n    if (!this.connected || newVal === oldVal) return;\n    switch (attrName) {\n      case 'open':\n        if (this.open === this.hasAttribute('open')) return;\n        this.toggle(this.open, {initiator: 'attribute', showDelay: 0, hideDelay: 0});\n        break;\n      case 'group':\n        this.$$fire(this.GROUP_CHANGED_EVENT, {\n          detail: {oldGroupName: oldVal, newGroupName: newVal}\n        });\n        break;\n    }\n  }\n\n  /** Set initial state of the Toggleable */\n  protected setInitialState(): void {\n    if (this.initialParams) {\n      this.toggle(this.initiallyOpened, this.initialParams);\n    }\n  }\n\n  /** Bind outside action event listeners */\n  protected bindOutsideEventTracking(track: boolean): void {\n    track ? this.$$on(this._onOutsideAction) : this.$$off(this._onOutsideAction);\n  }\n  /** Bind hover events listeners for the Toggleable itself */\n  protected bindHoverStateTracking(track: boolean, hideDelay?: number | string): void {\n    if (!DeviceDetector.hasHover) return;\n    this._trackHoverDelay = track && hideDelay !== undefined ? +hideDelay : undefined;\n    if (this._trackHover === track) return;\n    this._trackHover = track;\n\n    track ? this.$$on(this._onMouseEnter) : this.$$off(this._onMouseEnter);\n    track ? this.$$on(this._onMouseLeave) : this.$$off(this._onMouseLeave);\n  }\n\n  /** Function to merge the result action params */\n  protected mergeDefaultParams(params?: ESLToggleableActionParams): ESLToggleableActionParams {\n    return Object.assign({}, this.defaultParams, copyDefinedKeys(params));\n  }\n\n  /** Toggle the element state */\n  public toggle(state: boolean = !this.open, params?: ESLToggleableActionParams): ESLToggleable {\n    return state ? this.show(params) : this.hide(params);\n  }\n\n  /** Change the element state to active */\n  public show(params?: ESLToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.showTask.bind(this, params), defined(params.showDelay, params.delay));\n    this.bindOutsideEventTracking(this.closeOnOutsideAction);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n  /** Change the element state to inactive */\n  public hide(params?: ESLToggleableActionParams): ESLToggleable {\n    params = this.mergeDefaultParams(params);\n    this._task.put(this.hideTask.bind(this, params), defined(params.hideDelay, params.delay));\n    this.bindOutsideEventTracking(false);\n    this.bindHoverStateTracking(!!params.trackHover, defined(params.hideDelay, params.delay));\n    return this;\n  }\n\n  /** Actual show task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected showTask(params: ESLToggleableActionParams): void {\n    if (!params.force && this.open) return;\n    if (!params.silent && !this.$$fire(this.BEFORE_SHOW_EVENT, {detail: {params}})) return;\n    this.activator = params.activator;\n    this.open = true;\n    this.onShow(params);\n    if (!params.silent) this.$$fire(this.SHOW_EVENT, {detail: {params}, cancelable: false});\n  }\n  /** Actual hide task to execute by toggleable task manger ({@link DelayedTask} out of the box) */\n  protected hideTask(params: ESLToggleableActionParams): void {\n    if (!params.force && !this.open) return;\n    if (!params.silent && !this.$$fire(this.BEFORE_HIDE_EVENT, {detail: {params}})) return;\n    this.open = false;\n    this.onHide(params);\n    this.bindOutsideEventTracking(false);\n    if (!params.silent) this.$$fire(this.HIDE_EVENT, {detail: {params}, cancelable: false});\n  }\n\n  /**\n   * Actions to execute on show toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Adds CSS classes, update a11y and fire {@link ESLToggleable.REFRESH_EVENT} event by default.\n   */\n  protected onShow(params: ESLToggleableActionParams): void {\n    CSSClassUtils.add(this, this.activeClass);\n    CSSClassUtils.add(document.body, this.bodyClass, this);\n    if (this.containerActiveClass) {\n      const $container = findParent(this, this.containerActiveClassTarget);\n      $container && CSSClassUtils.add($container, this.containerActiveClass, this);\n    }\n\n    this.updateA11y();\n    this.$$fire(this.REFRESH_EVENT); // To notify other components about content change\n  }\n\n  /**\n   * Actions to execute on hide toggleable.\n   * Inner state and 'open' attribute are not affected and updated before `onShow` execution.\n   * Removes CSS classes and update a11y by default.\n   */\n  protected onHide(params: ESLToggleableActionParams): void {\n    CSSClassUtils.remove(this, this.activeClass);\n    CSSClassUtils.remove(document.body, this.bodyClass, this);\n    if (this.containerActiveClass) {\n      const $container = findParent(this, this.containerActiveClassTarget);\n      $container && CSSClassUtils.remove($container, this.containerActiveClass, this);\n    }\n    this.updateA11y();\n  }\n\n  /** Active state marker */\n  public get open(): boolean {\n    return this._open;\n  }\n  public set open(value: boolean) {\n    this.toggleAttribute('open', this._open = value);\n  }\n\n  /** Last component that has activated the element. Uses {@link ESLToggleableActionParams.activator}*/\n  public get activator(): HTMLElement | null | undefined {\n    return activators.get(this);\n  }\n  public set activator(el: HTMLElement | null | undefined) {\n    el ? activators.set(this, el) : activators.delete(this);\n  }\n\n  /** Returns the element to apply a11y attributes */\n  protected get $a11yTarget(): HTMLElement | null {\n    const target = this.getAttribute('a11y-target');\n    if (target === 'none') return null;\n    return target ? this.querySelector(target) : this;\n  }\n\n  /** Called on show and on hide actions to update a11y state accordingly */\n  protected updateA11y(): void {\n    const targetEl = this.$a11yTarget;\n    if (!targetEl) return;\n    targetEl.setAttribute('aria-hidden', String(!this._open));\n  }\n\n  /** @returns if the passed event should trigger hide action */\n  public isOutsideAction(e: Event): boolean {\n    const target = e.target as HTMLElement;\n    // target is inside current toggleable\n    if (this.contains(target)) return false;\n    // target is inside last activator\n    if (this.activator && this.activator.contains(target)) return false;\n    // Event is not a system command key\n    return !(e instanceof KeyboardEvent && SYSTEM_KEYS.includes(e.key));\n  }\n\n  @listen({\n    event: 'click',\n    selector: (el: ESLToggleable) => el.closeTrigger || ''\n  })\n  protected _onCloseClick(e: MouseEvent): void {\n    this.hide({initiator: 'close', activator: e.target as HTMLElement, event: e});\n  }\n\n  @listen({\n    auto: false,\n    event: 'keydown mouseup touchend',\n    target: document.body,\n    capture: true\n  })\n  protected _onOutsideAction(e: Event): void {\n    if (!this.isOutsideAction(e)) return;\n    // Used 0 delay to decrease priority of the request\n    this.hide({initiator: 'outsideaction', hideDelay: 0, event: e});\n  }\n\n  @listen('keydown')\n  protected _onKeyboardEvent(e: KeyboardEvent): void {\n    if (this.closeOnEsc && e.key === ESC) {\n      this.hide({initiator: 'keyboard', event: e});\n    }\n  }\n\n  @listen({auto: false, event: 'mouseenter'})\n  protected _onMouseEnter(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ESLToggleableActionParams = {\n      initiator: 'mouseenter',\n      trackHover: true,\n      activator: this.activator,\n      event: e,\n      hideDelay\n    };\n    this.show(Object.assign(baseParams, this.trackHoverParams));\n  }\n  @listen({auto: false, event: 'mouseleave'})\n  protected _onMouseLeave(e: MouseEvent): void {\n    const hideDelay = this._trackHoverDelay;\n    const baseParams: ESLToggleableActionParams = {\n      initiator: 'mouseleave',\n      trackHover: true,\n      activator: this.activator,\n      event: e,\n      hideDelay\n    };\n    this.hide(Object.assign(baseParams, this.trackHoverParams));\n  }\n\n  /** Prepares toggle request events param */\n  protected buildRequestParams(e: CustomEvent<ESLToggleableRequestDetails>): ESLToggleableActionParams | null {\n    const detail = e.detail || {};\n    if (!isMatches(this, detail.match)) return null;\n    return Object.assign({}, detail, {event: e});\n  }\n\n  /** Actions to execute on show request */\n  @listen((el: ESLToggleable) => el.SHOW_REQUEST_EVENT)\n  protected _onShowRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    const params = this.buildRequestParams(e);\n    params && this.show(params);\n  }\n  /** Actions to execute on hide request */\n  @listen((el: ESLToggleable) => el.HIDE_REQUEST_EVENT)\n  protected _onHideRequest(e: CustomEvent<ESLToggleableRequestDetails>): void {\n    const params = this.buildRequestParams(e);\n    params && this.hide(params);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Toggleable: typeof ESLToggleable;\n  }\n\n  export interface HTMLElementTagNameMap {\n    'esl-toggleable': ESLToggleable;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLPopup} from '../../esl-popup/core';\nimport {memoize, attr, boolAttr, listen} from '../../esl-utils/decorators';\nimport {TAB} from '../../esl-utils/dom/keys';\nimport {getKeyboardFocusableElements} from '../../esl-utils/dom/focus';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\n\nimport type {PopupActionParams} from '../../esl-popup/core';\nimport type {PositionType} from '../../esl-popup/core/esl-popup-position';\n\nexport interface TooltipActionParams extends PopupActionParams {\n  /** text to be shown */\n  text?: string;\n  /** html content to be shown */\n  html?: string;\n  /** text directionality of tooltips content */\n  dir?: string;\n  /** language of tooltips text content */\n  lang?: string;\n  /** tooltip without arrow */\n  disableArrow?: boolean;\n}\n\n@ExportNs('Tooltip')\nexport class ESLTooltip extends ESLPopup {\n  static override is = 'esl-tooltip';\n\n  /**\n   * Tooltip position relative to the trigger.\n   * Currently supported: 'top', 'bottom', 'left', 'right' position types ('top' by default)\n   */\n  @attr({defaultValue: 'top'}) public override position: PositionType;\n\n  /** Tooltip behavior if it does not fit in the window ('fit' by default) */\n  @attr({defaultValue: 'fit'}) public override behavior: string;\n\n  /** Disable arrow at Tooltip */\n  @boolAttr() public disableArrow: boolean;\n\n  /** Shared instanse of Tooltip */\n  @memoize()\n  public static get sharedInstance(): ESLTooltip {\n    return document.createElement('esl-tooltip');\n  }\n\n  /** List of all focusable elements inside Tooltip */\n  public get focusableElements(): Element[] {\n    return getKeyboardFocusableElements(this);\n  }\n\n  /** First focusable element inside Tooltip */\n  public get firstFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[0] : null;\n  }\n\n  /** Last focusable element inside Tooltip */\n  public get lastFocusableElement(): Element | null {\n    const els = this.focusableElements;\n    return els.length ? els[els.length - 1] : null;\n  }\n\n  /** Active state marker */\n  public static get open(): boolean {\n    return this.sharedInstance.open;\n  }\n\n  /** Changes the element state to active */\n  public static show(params: TooltipActionParams = {}): void {\n    this.sharedInstance.show(params);\n  }\n\n  /** Changes the element state to inactive */\n  public static hide(params: TooltipActionParams = {}): void {\n    this.sharedInstance.hide(params);\n  }\n\n  public override connectedCallback(): void {\n    super.connectedCallback();\n    this.classList.add(ESLPopup.is);\n    this.classList.toggle('disable-arrow', this.disableArrow);\n    this.tabIndex = 0;\n  }\n\n  /** Sets initial state of the Tooltip */\n  protected override setInitialState(): void {}\n\n  /** Actions to execute on show Tooltip. */\n  public override onShow(params: TooltipActionParams): void {\n    if (params.disableArrow) {\n      this.disableArrow = params.disableArrow;\n    }\n    if (params.text) {\n      this.innerText = params.text;\n    }\n    if (params.html) {\n      this.innerHTML = params.html;\n    }\n    this.dir = params.dir || '';\n    this.lang = params.lang || '';\n    if (params.extraClass) {\n      CSSClassUtils.add(this, params.extraClass);\n    }\n    document.body.appendChild(this);\n    super.onShow(params);\n    this._updateActivatorState(true);\n  }\n\n  /** Actions to execute on Tooltip hiding. */\n  public override onHide(params: TooltipActionParams): void {\n    this._updateActivatorState(false);\n    super.onHide(params);\n    document.body.removeChild(this);\n    if (params.extraClass) {\n      CSSClassUtils.remove(this, params.extraClass);\n    }\n  }\n\n  /**\n   * Actions to execute after showing of popup.\n   */\n  protected override afterOnShow(): void {\n    super.afterOnShow();\n    this.focus({preventScroll: true});\n  }\n\n  /**\n   * Actions to execute before hiding of popup.\n   */\n  protected override beforeOnHide(): void {\n    this.activator?.focus({preventScroll: true});\n  }\n\n  @listen({inherit: true})\n  protected override _onKeyboardEvent(e: KeyboardEvent): void {\n    super._onKeyboardEvent(e);\n    if (e.key === TAB) this._onTabKey(e);\n  }\n\n  protected _onTabKey(e: KeyboardEvent): void {\n    if (!this.activator) return;\n    const {firstFocusableElement, lastFocusableElement} = this;\n    if (\n      !lastFocusableElement ||\n      e.target === lastFocusableElement && !e.shiftKey ||\n      e.target === firstFocusableElement && e.shiftKey\n    ) {\n      this.activator.focus();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  protected _updateActivatorState(newState: boolean): void {\n    this.activator?.toggleAttribute('tooltip-shown', newState);\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Tooltip: typeof ESLTooltip;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-tooltip': ESLTooltip;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {tuple, wrap, uniq} from '../../esl-utils/misc/array';\nimport {unwrapParenthesis} from '../../esl-utils/misc/format';\nimport {findAll, findChildren, findNext, findParent, findClosest, findPrev} from '../../esl-utils/dom/traversing';\nimport {isVisible} from '../../esl-utils/dom/visible';\n\ntype ProcessorDescriptor = [string?, string?];\ntype ElementProcessor = (base: Element, sel: string) => Element | Element[] | null;\ntype CollectionProcessor = (els: Element[], sel: string) => Element[];\n\n/**\n * Traversing Query utility to find element via extended selector query\n * Extended query supports\n * - plain CSS selectors\n * - relative selectors (selectors that don't start from a plain selector will use passed base Element as a root)\n * - ::next and ::prev sibling pseudo-selectors\n * - ::parent, ::closest and ::child pseudo-selectors\n * - ::find pseudo-selector\n * - ::first, ::last and :nth(#) limitation pseudo-selectors\n * - ::filter, ::not filtration pseudo-selectors\n *\n * @example\n * - `#id .class [attr]` - find by CSS selector in a current document\n * - ` ` - get current base element\n * - `::next` - get next sibling element\n * - `::prev` - get previous sibling element\n * - `::parent` - get base element parent\n * - `::parent(#id .class [attr])` - find the closest parent matching passed selector\n * - `::closest(#id .class [attr])` - find the closest ancestor including base element that matches passed selector\n * - `::child(#id .class [attr])` - find direct child element(s) that match passed selector\n * - `::find(#id .class [attr])` - find child element(s) that match passed selector\n * - `::find(buttons, a)::not([hidden])` - find all buttons and anchors that are not have hidden attribute\n * - `::find(buttons, a)::filter(:first-child)` - find all buttons and anchors that are first child in container\n * - `::parent::child(some-tag)` - find direct child element(s) that match tag 'some-tag' in the parent\n * - `#id .class [attr]::parent` - find parent of element matching selector '#id .class [attr]' in document\n * - `::find(.row)::last::parent` - find parent of the last element matching selector '.row' from the base element subtree\n */\n@ExportNs('TraversingQuery')\nexport class ESLTraversingQuery {\n  private static ELEMENT_PROCESSORS: Record<string, ElementProcessor> = {\n    '::find': findAll,\n    '::next': findNext,\n    '::prev': findPrev,\n    '::child': findChildren,\n    '::parent': findParent,\n    '::closest': findClosest\n  };\n  private static COLLECTION_PROCESSORS: Record<string, CollectionProcessor> = {\n    '::first': (list: Element[]) => list.slice(0, 1),\n    '::last': (list: Element[]) => list.slice(-1),\n    '::nth': (list: Element[], sel?: string) => {\n      const index = sel ? +sel : NaN;\n      return wrap(list[index - 1]);\n    },\n    '::not': (list: Element[], sel?: string) => list.filter((el) => !el.matches(sel || '')),\n    '::visible': (list: Element[]) => list.filter((el) => (el instanceof HTMLElement) && isVisible(el)),\n    '::filter': (list: Element[], sel?: string) => list.filter((el) => el.matches(sel || ''))\n  };\n\n  /**\n   * @returns RegExp that selects all known processors in query string\n   * e.g. /(::parent|::closest|::child|::next|::prev)/\n   */\n  private static get PROCESSORS_REGEX(): RegExp {\n    const keys = Object.keys(this.ELEMENT_PROCESSORS).concat(Object.keys(this.COLLECTION_PROCESSORS));\n    return new RegExp(`(${keys.join('|')})`, 'g');\n  }\n\n  private static isCollectionProcessor([name]: ProcessorDescriptor): boolean {\n    return !!name && (name in this.COLLECTION_PROCESSORS);\n  }\n  private static processElement(el: Element, [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.ELEMENT_PROCESSORS)) return [];\n    return wrap(this.ELEMENT_PROCESSORS[name](el, sel));\n  }\n  private static processCollection(els: Element[], [name, selString]: ProcessorDescriptor): Element[] {\n    const sel = unwrapParenthesis(selString || '');\n    if (!name || !(name in this.COLLECTION_PROCESSORS)) return [];\n    return wrap(this.COLLECTION_PROCESSORS[name](els, sel));\n  }\n\n  private static traverseChain(collection: Element[], processors: ProcessorDescriptor[], findFirst: boolean): Element[] {\n    if (!processors.length || !collection.length) return collection;\n    const [processor, ...rest] = processors;\n    if (this.isCollectionProcessor(processor)) {\n      const processedItem = this.processCollection(collection, processor);\n      return this.traverseChain(processedItem, rest, findFirst);\n    }\n    const result: Element[] = [];\n    for (const target of collection) {\n      const processedItem = this.processElement(target, processor);\n      const resultCollection: Element[] = this.traverseChain(processedItem, rest, findFirst);\n      if (!resultCollection.length) continue;\n      if (findFirst) return resultCollection.slice(0, 1);\n      result.push(...resultCollection);\n    }\n    return uniq(result);\n  }\n\n  /** Split multiple queries separated by comma (respects query brackets) */\n  // This can be solved by RegEx /(?<!\\([^\\)]*),(?![^\\(]*\\))/g)/, when the WebKit browser implements this feature\n  public static splitQueries(str: string): string[] {\n    let last = 0;\n    let stack = 0;\n    const result = [];\n    for (let i = 0; i < str.length; i++) {\n      if (str[i] === '(') stack++;\n      if (str[i] === ')') stack = Math.max(0, stack - 1);\n      if (str[i] === ',' && !stack) {\n        result.push(str.substring(last, i).trim());\n        last = i + 1;\n      }\n    }\n    result.push(str.substring(last).trim());\n    return result;\n  }\n\n  protected static traverse(query: string, findFirst: boolean, base?: Element | null, scope: Element | Document = document): Element[] {\n    const found: Element[] = [];\n    for (const part of ESLTraversingQuery.splitQueries(query)) {\n      const els = this.traverseQuery(part, findFirst, base, scope);\n      if (findFirst && els.length) return [els[0]];\n      found.push(...els);\n    }\n    return uniq(found);\n  }\n\n  protected static traverseQuery(query: string, findFirst: boolean, base?: Element | null, scope: Element | Document = document): Element[] {\n    const parts = query.split(this.PROCESSORS_REGEX).map((term) => term.trim());\n    const rootSel = parts.shift();\n    const baseCollection = base ? [base] : [];\n    const initial: Element[] = rootSel ? Array.from(scope.querySelectorAll(rootSel)) : baseCollection;\n    return this.traverseChain(initial, tuple(parts), findFirst);\n  }\n\n  /** @returns first matching element reached via {@link ESLTraversingQuery} rules */\n  static first(query: string, base?: Element | null, scope?: Element | Document): Element | null {\n    return ESLTraversingQuery.traverse(query, true, base, scope)[0] || null;\n  }\n  /** @returns Array of all matching elements reached via {@link ESLTraversingQuery} rules */\n  static all(query: string, base?: Element | null, scope?: Element | Document): Element[] {\n    return ESLTraversingQuery.traverse(query, false, base, scope);\n  }\n}\n\n/** @deprecated alias for {@link ESLTraversingQuery} */\nexport const TraversingQuery = ESLTraversingQuery;\n\ndeclare global {\n  export interface ESLLibrary {\n    TraversingQuery: typeof ESLTraversingQuery;\n  }\n}\n","import {ExportNs} from '../../esl-utils/environment/export-ns';\nimport {ESLBaseElement} from '../../esl-base-element/core';\nimport {setAttr} from '../../esl-utils/dom/attr';\nimport {attr, boolAttr, prop, listen, ready} from '../../esl-utils/decorators';\nimport {parseNumber} from '../../esl-utils/misc/format';\nimport {CSSClassUtils} from '../../esl-utils/dom/class';\nimport {ENTER, SPACE, ESC} from '../../esl-utils/dom/keys';\nimport {ESLTraversingQuery} from '../../esl-traversing-query/core';\nimport {DeviceDetector} from '../../esl-utils/environment/device-detector';\nimport {ESLMediaQuery} from '../../esl-media-query/core';\nimport {ESLToggleablePlaceholder} from '../../esl-toggleable/core';\n\nimport type {ESLToggleable, ESLToggleableActionParams} from '../../esl-toggleable/core/esl-toggleable';\n\n@ExportNs('Trigger')\nexport class ESLTrigger extends ESLBaseElement {\n  public static override is = 'esl-trigger';\n  public static observedAttributes = ['target'];\n\n  /** Event that represents {@link ESLTrigger} state change */\n  @prop('esl:change:active') public CHANGE_EVENT: string;\n  /** Events to observe target {@link ESLToggleable} instance state */\n  @prop('esl:show esl:hide') public OBSERVED_EVENTS: string;\n\n  /** @readonly Observed Toggleable active state marker */\n  @boolAttr({readonly: true}) public active: boolean;\n\n  /** CSS classes to set on active state */\n  @attr({defaultValue: ''}) public activeClass: string;\n  /** Target element {@link ESLTraversingQuery} selector to set `activeClass` */\n  @attr({defaultValue: ''}) public activeClassTarget: string;\n\n  /** Selector for ignored inner elements */\n  @attr({defaultValue: 'a[href]'}) public ignore: string;\n\n  /** Target Toggleable {@link ESLTraversingQuery} selector. `::next` by default */\n  @attr({defaultValue: '::next'}) public target: string;\n  /** Action to pass to the Toggleable. Supports `show`, `hide` and `toggle` values. `toggle` by default */\n  @attr({defaultValue: 'toggle'}) public mode: string;\n\n  /** Click event tracking media query. Default: `all` */\n  @attr({defaultValue: 'all'}) public trackClick: string;\n  /** Hover event tracking media query. Default: `none` */\n  @attr({defaultValue: 'not all'}) public trackHover: string;\n\n  /** Selector of inner target element to place aria attributes. Uses trigger itself if blank */\n  @attr({defaultValue: ''}) public a11yTarget: string;\n\n  /** Value of aria-label for active state */\n  @attr({defaultValue: null}) public a11yLabelActive: string | null;\n  /** Value of aria-label for inactive state */\n  @attr({defaultValue: null}) public a11yLabelInactive: string | null;\n\n  /** Show delay value */\n  @attr({defaultValue: 'none'}) public showDelay: string;\n  /** Hide delay value */\n  @attr({defaultValue: 'none'}) public hideDelay: string;\n\n  /**\n   * Show delay value override for hover.\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverShowDelay: string;\n  /**\n   * Hide delay value override for hover\n   * Note: the value should be numeric in order to delay hover action triggers for correct handling on mobile browsers.\n   */\n  @attr({defaultValue: '0'}) public hoverHideDelay: string;\n\n  /** Prevent ESC keyboard event handling for target element hiding */\n  @boolAttr() public ignoreEsc: boolean;\n\n  protected _$target: ESLToggleable | null;\n\n  protected override attributeChangedCallback(attrName: string): void {\n    if (!this.connected) return;\n    if (attrName === 'target') return this.updateTargetFromSelector();\n  }\n\n  /** Target observable Toggleable */\n  public get $target(): ESLToggleable | null {\n    return this._$target;\n  }\n  public set $target(newPopupInstance: ESLToggleable | null) {\n    this.$$off(this._onTargetStateChange);\n    this._$target = newPopupInstance;\n    this.$$on(this._onTargetStateChange);\n    this._onTargetStateChange();\n  }\n\n  /** Element target to setup aria attributes */\n  public get $a11yTarget(): HTMLElement | null {\n    return this.a11yTarget ? this.querySelector(this.a11yTarget) : this;\n  }\n\n  /** Value to setup aria-label */\n  public get a11yLabel(): string | null {\n    if (!this.$target) return null;\n    return (this.$target.open ? this.a11yLabelActive : this.a11yLabelInactive) || null;\n  }\n\n  /** Marker to allow track hover */\n  public get allowHover(): boolean {\n    return DeviceDetector.hasHover && ESLMediaQuery.for(this.trackHover).matches;\n  }\n  /** Marker to allow track clicks */\n  public get allowClick(): boolean {\n    return ESLMediaQuery.for(this.trackClick).matches;\n  }\n\n  @ready\n  protected override connectedCallback(): void {\n    super.connectedCallback();\n    this.updateTargetFromSelector();\n    this.initA11y();\n  }\n\n  /** Update `$target` Toggleable  from `target` selector */\n  public updateTargetFromSelector(): void {\n    if (!this.target) return;\n    this.$target = ESLTraversingQuery.first(this.target, this) as ESLToggleable;\n\n    if (this.$target instanceof ESLToggleablePlaceholder && this.$target.$origin) {\n      // change target if it is an instance of the placeholder element\n      this.$target = this.$target.$origin;\n    }\n  }\n\n  /** Check if the event target should be ignored */\n  protected isTargetIgnored(target: EventTarget | null): boolean {\n    if (!target || !(target instanceof HTMLElement) || !this.ignore) return false;\n    const $ignore = target.closest(this.ignore);\n    // Ignore only inner elements (but do not ignore the trigger itself)\n    return !!$ignore && $ignore !== this && this.contains($ignore);\n  }\n\n  /** Merge params to pass to the toggleable */\n  protected mergeToggleableParams(this: ESLTrigger, ...params: ESLToggleableActionParams[]): ESLToggleableActionParams {\n    return Object.assign({\n      initiator: 'trigger',\n      activator: this\n    }, ...params);\n  }\n\n  /** Show target toggleable with passed params */\n  public showTarget(params: ESLToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.showDelay)\n    }, params);\n    if (this.$target && typeof this.$target.show === 'function') {\n      this.$target.show(actionParams);\n    }\n  }\n  /** Hide target toggleable with passed params */\n  public hideTarget(params: ESLToggleableActionParams = {}): void {\n    const actionParams = this.mergeToggleableParams({\n      delay: parseNumber(this.hideDelay)\n    }, params);\n    if (this.$target && typeof this.$target.hide === 'function') {\n      this.$target.hide(actionParams);\n    }\n  }\n  /** Toggles target toggleable with passed params */\n  public toggleTarget(params: ESLToggleableActionParams = {}, state: boolean = !this.active): void {\n    state ? this.showTarget(params) : this.hideTarget(params);\n  }\n\n  /**\n   * Updates trigger state according to toggleable state\n   * Does not produce `esl:change:active` event\n   */\n  public updateState(): boolean {\n    const isActive = !!this.$target?.open;\n    const wasActive = this.active;\n\n    this.toggleAttribute('active', isActive);\n    const clsTarget = ESLTraversingQuery.first(this.activeClassTarget, this) as HTMLElement;\n    clsTarget && CSSClassUtils.toggle(clsTarget, this.activeClass, isActive);\n\n    this.updateA11y();\n\n    return isActive !== wasActive;\n  }\n\n  /** Handles ESLToggleable state change */\n  @listen({\n    event: (that: ESLTrigger) => that.OBSERVED_EVENTS,\n    target: (that: ESLTrigger) => that.$target\n  })\n  protected _onTargetStateChange(originalEvent?: Event): void {\n    if (!this.updateState()) return;\n    const detail = {active: this.active, originalEvent};\n    this.$$fire(this.CHANGE_EVENT, {detail});\n  }\n\n  /** Handles `click` event */\n  @listen('click')\n  protected _onClick(event: MouseEvent): void {\n    if (!this.allowClick || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    this._onPrimaryEvent(event);\n  }\n\n  /** Handles `keydown` event */\n  @listen('keydown')\n  protected _onKeydown(event: KeyboardEvent): void {\n    if (![ENTER, SPACE, ESC].includes(event.key) || this.isTargetIgnored(event.target)) return;\n    event.preventDefault();\n    if (event.key === ESC) {\n      if (this.ignoreEsc) return;\n      this.hideTarget({event});\n    } else {\n      this._onPrimaryEvent(event);\n    }\n  }\n\n  /** Handles target primary (observed) event */\n  protected _onPrimaryEvent(event: Event): void {\n    switch (this.mode) {\n      case 'show':\n        return this.showTarget({event});\n      case 'hide':\n        return this.hideTarget({event});\n      default:\n        return this.toggleTarget({event});\n    }\n  }\n\n  /** Handles hover `mouseenter` event */\n  @listen('mouseenter')\n  protected _onMouseEnter(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    const delay = parseNumber(this.hoverShowDelay);\n    this.toggleTarget({event, delay}, this.mode !== 'hide');\n    event.preventDefault();\n  }\n\n  /** Handles hover `mouseleave` event */\n  @listen('mouseleave')\n  protected _onMouseLeave(event: MouseEvent): void {\n    if (!this.allowHover) return;\n    if (this.mode === 'show' || this.mode === 'hide') return;\n    const delay = parseNumber(this.hoverHideDelay);\n    this.hideTarget({event, delay, trackHover: true});\n    event.preventDefault();\n  }\n\n  /** Set initial a11y attributes. Do nothing if trigger contains actionable element */\n  public initA11y(): void {\n    if (this.$a11yTarget !== this) return;\n    if (!this.hasAttribute('role')) this.setAttribute('role', 'button');\n    if (this.getAttribute('role') === 'button' && !this.hasAttribute('tabindex')) {\n      this.setAttribute('tabindex', '0');\n    }\n  }\n\n  /** Update aria attributes */\n  public updateA11y(): void {\n    const target = this.$a11yTarget;\n    if (!target) return;\n\n    if (this.a11yLabelActive !== null || this.a11yLabelInactive !== null) {\n      setAttr(target, 'aria-label', this.a11yLabel);\n    }\n    setAttr(target, 'aria-expanded', String(this.active));\n    if (this.$target && this.$target.id) {\n      setAttr(target, 'aria-controls', this.$target.id);\n    }\n  }\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    Trigger: typeof ESLTrigger;\n  }\n  export interface HTMLElementTagNameMap {\n    'esl-trigger': ESLTrigger;\n  }\n}\n","import {isObject} from '../misc/object/types';\n\n/** An object that relates to some DOM element e.g. controller or {@link ESLMixinElement} */\nexport type ESLDomElementRelated = {\n  /** Related DOM element */\n  $host: Element;\n};\n\n/** An {@link Element} or {@link ESLDomElementRelated} */\nexport type ESLDomElementTarget = Element | ESLDomElementRelated;\n\n/** Unwraps {@link ESLDomElementTarget} to {@link Element} */\nexport function resolveDomTarget(obj: ESLDomElementTarget): Element;\n/**\n * Resolves unknown object to {@link Element} if it is {@link ESLDomElementTarget}-like,\n * other-vice returns `null`\n */\nexport function resolveDomTarget(obj: unknown): Element | null;\nexport function resolveDomTarget(obj: unknown): Element | null {\n  if (obj instanceof Element) return obj;\n  if (isObject(obj) && obj.$host instanceof Element) return obj.$host;\n  return null;\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Abstract Observable implementation\n * @author Yuliya Adamskaya\n */\nexport abstract class Observable <Callback extends AnyToVoidFnSignature = AnyToVoidFnSignature> {\n  protected _listeners = new Set<Callback>();\n\n  public addListener(listener: Callback): void {\n    this._listeners.add(listener);\n  }\n  public removeListener(listener: Callback): void {\n    this._listeners.delete(listener);\n  }\n\n  protected fire(...args: Parameters<Callback>): void {\n    this._listeners.forEach((listener) => {\n      try {\n        listener.apply(this, args);\n      } catch (e) {\n        console.error(e);\n      }\n    });\n  }\n}\n","import {createDeferred} from './promise/defered';\n\nimport type {AnyToAnyFnSignature} from '../misc/functions';\nimport type {Deferred} from './promise/defered';\n\n/** Debounced<F> is a function wrapper type for a function decorated via debounce */\nexport interface Debounced<F extends AnyToAnyFnSignature> {\n  /** Debounced method signature */\n  (...args: Parameters<F>): void;\n  /** Promise of deferred function call */\n  promise: Promise<ReturnType<F> | void>;\n  /** Cancel debounced call */\n  cancel(): void;\n}\n\n/**\n * Creates a debounced function that implements {@link Debounced}.\n * Debounced function delays invoking func until after wait milliseconds have elapsed\n * since the last time the debounced function was invoked.\n * The func is invoked with the last arguments provided to the debounced function.\n * @param fn - function to decorate\n * @param wait - time to debounce\n * @param thisArg - optional context to call original function, use debounced method call context if not defined\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function debounce<F extends AnyToAnyFnSignature>(fn: F, wait = 10, thisArg?: object): Debounced<F> {\n  let timeout: number | null = null;\n  let deferred: Deferred<ReturnType<F>> | null = null;\n\n  function debouncedSubject(...args: any[]): void {\n    deferred = deferred || createDeferred();\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = window.setTimeout(() => {\n      timeout = null;\n      // fn.apply to save call context\n      deferred!.resolve(fn.apply(thisArg || this, args));\n      deferred = null;\n    }, wait);\n  }\n  function cancel(): void {\n    (typeof timeout === 'number') && clearTimeout(timeout);\n    timeout = null;\n    deferred?.reject();\n    deferred = null;\n  }\n\n  Object.defineProperty(debouncedSubject, 'promise', {\n    get: () => deferred ? deferred.promise : Promise.resolve()\n  });\n  Object.defineProperty(debouncedSubject, 'cancel', {\n    writable: false,\n    enumerable: false,\n    value: cancel\n  });\n\n  return debouncedSubject as Debounced<F>;\n}\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Task placeholder with a single place for executing deferred task.\n * Only one task can be planed per DelayedTask instance.\n * @see put DelayedTask.put behaviour description.\n */\nexport class DelayedTask {\n  protected _fn: AnyToVoidFnSignature | null = null;\n  protected _timeout: number | null = null;\n\n  /** Execute deferred task immediately */\n  protected run = (): void => {\n    this._timeout = null;\n    this._fn && this._fn();\n  };\n\n  /** @returns Function of currently deferred (planned) task */\n  public get fn(): AnyToVoidFnSignature | null {\n    return this._fn;\n  }\n\n  /**\n   * Cancel deferred task and planning passed\n   * @param task - task function\n   * @param delay - time to delay task execution\n   *  - pass negative or false to execute task immediately\n   *  - pass 0 to plan task to the macrotask\n   *  - pass positive number x to delay task on x ms.\n   * */\n  public put(task: AnyToVoidFnSignature, delay: number | string | boolean = false): AnyToVoidFnSignature | null {\n    const prev = this.cancel();\n    if (typeof task === 'function') {\n      if (delay && typeof delay === 'string') delay = +delay;\n      if (typeof delay === 'number' && delay >= 0) {\n        this._fn = task;\n        this._timeout = window.setTimeout(this.run, delay);\n      } else {\n        task();\n      }\n    }\n    return prev;\n  }\n\n  /** Cancel deferred (planned) task */\n  public cancel(): AnyToVoidFnSignature | null {\n    const prev = this._fn;\n    (typeof this._timeout === 'number') && clearTimeout(this._timeout);\n    this._fn = this._timeout = null;\n    return prev;\n  }\n}\n","/**\n * A decorator utility to postpone callback execution once after the main task execution\n * (as a microtask produced with Promise)\n */\nexport function microtask<T>(fn: (...arg: [T?]) => void, thisArg?: object): (arg?: T) => void {\n  const args: T[] = [];\n  return function microtaskFn(arg: T): void {\n    args.push(arg);\n    if ((microtaskFn as any).request) return;\n    (microtaskFn as any).request = Promise.resolve().then(() => {\n      delete (microtaskFn as any).request;\n      fn.call(thisArg || this, args);\n    });\n  };\n}\n","import {createDeferred} from './promise/defered';\nimport {promisifyTimeout} from './promise/timeout';\nimport {promisifyTransition} from './promise/animation';\nimport {promisifyEvent, promisifyMarker} from './promise/event';\nimport {promisifiedTry, tryUntil} from './promise/try-until';\nimport {promisifyNextRender} from './promise/raf';\n\nimport type {AnyToAnyFnSignature} from '../misc/functions';\nimport type {Deferred} from './promise/defered';\n\n/** Creates function type with the same signature but with the result type wrapped into promise */\nexport type PromisifyResultFn<F extends AnyToAnyFnSignature> = ((...args: Parameters<F>) => Promise<ReturnType<F> | void>);\nexport type {Deferred};\n\nexport {createDeferred, promisifyTimeout, promisifyEvent, promisifyMarker, promisifyNextRender, promisifiedTry, promisifyTransition};\nexport {tryUntil};\n\n/**\n * Call async callback in a sequence passed number of times\n * Initial call starts as a microtask\n * @param callback - async chain function\n * @param count - count o calls\n * @returns sequence end promise\n */\nexport function repeatSequence<T>(callback: () => Promise<T>, count = 1): Promise<T> {\n  if (count < 1) return Promise.reject();\n  if (count === 1) return Promise.resolve().then(callback);\n  return repeatSequence(callback, count - 1).then(callback);\n}\n\n/**\n * Safe wrap for Promise.resolve to use in Promise chain\n * @example\n * `const resolvedPromise = rejectedPromise.catch(resolvePromise);`\n */\nexport function resolvePromise<T>(arg: T | PromiseLike<T>): Promise<T> {\n  return Promise.resolve(arg);\n}\n\n/**\n * Safe wrap for Promise.reject to use in Promise chain\n * @example\n * `const rejectedPromise = resolvedPromise.then(rejectPromise);`\n */\nexport function rejectPromise<T = never>(arg?: T | PromiseLike<T>): Promise<T> {\n  return Promise.reject(arg);\n}\n\n/**\n * Promise utils helper class\n * Note: use individual methods in case you need correct \"tree shaking\"\n * @deprecated use separate function extend\n */\nexport abstract class PromiseUtils {\n  static fromTimeout = promisifyTimeout;\n  static fromEvent = promisifyEvent;\n  static fromMarker = promisifyMarker;\n\n  static repeat = repeatSequence;\n  static tryUntil = tryUntil;\n\n  static deferred = createDeferred;\n  static resolve = resolvePromise;\n  static reject = rejectPromise;\n}\n","/** Utility to promisify transition observation */\nexport function promisifyTransition(\n  $el: Element,\n  props?: string\n): Promise<void> {\n  return new Promise((resolve) => {\n    function transitionCallback(e: TransitionEvent): void {\n      if (typeof props === 'string' && props !== e.propertyName) return;\n      $el.removeEventListener('transitionend', transitionCallback);\n      resolve();\n    }\n    $el.addEventListener('transitionend', transitionCallback);\n  });\n}\n","/** Deferred object represents promise with it's resolve/reject methods */\nexport type Deferred<T> = {\n  /** Wrapped promise */\n  promise: Promise<T>;\n  /** Function that resolves wrapped promise */\n  resolve: (arg: T) => void;\n  /** Function that rejects wrapped promise */\n  reject: (arg?: any) => void;\n};\n\n/**\n * Creates Deferred Object that wraps promise and its resolve and reject callbacks\n */\nexport function createDeferred<T>(): Deferred<T> {\n  let reject: any;\n  let resolve: any;\n  // Both reject and resolve will be assigned anyway while the Promise constructing.\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {promise, resolve, reject};\n}\n","/** Interface to describe abstract listenable target */\nexport type ListenableTarget = {\n  addEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n  removeEventListener: (\n    event: string,\n    callback: (payload: any) => void,\n    options?: boolean | AddEventListenerOptions | undefined\n  ) => void;\n};\n\n/**\n * @returns Promise that will be resolved by dispatching `event` on `target`\n * Or it will be rejected in `timeout` if it's specified\n * Optional `options` for addEventListener can be also specified\n */\nexport function promisifyEvent(\n  target: ListenableTarget,\n  event: string,\n  timeout?: number | null | undefined,\n  options?: boolean | AddEventListenerOptions\n): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    function eventCallback(e?: Event): void {\n      target.removeEventListener(event, eventCallback, options);\n      e ? resolve(e) : reject(new Error('Rejected by timeout'));\n    }\n\n    target.addEventListener(event, eventCallback, options);\n    if (typeof timeout === 'number' && timeout >= 0) {\n      setTimeout(eventCallback, timeout);\n    }\n  });\n}\n\n/**\n * Short helper to make Promise from element state marker\n * @returns Promise that will be resolved if the target `marker` property is truthful or `event` is dispatched\n * @example\n * `const imgReady = promisifyMarker(eslImage, 'ready');`\n */\nexport function promisifyMarker(target: HTMLElement, marker: string, event: string = marker): Promise<HTMLElement> {\n  if ((target as any)[marker]) return Promise.resolve(target);\n  return promisifyEvent(target, event).then(() => target);\n}\n","/**\n * @returns Promise that will be resolved or rejected in `timeout` with an optional `payload`\n * If `isReject` is `true` the result promise will be rejected, otherwise (by default) the result promise will be resolved\n */\nexport function promisifyTimeout<T>(timeout: number, payload?: T, isReject?: boolean): Promise<T> {\n  return new Promise<T>((resolve, reject) =>\n    setTimeout((isReject ? reject : resolve).bind(null, payload), timeout)\n  );\n}\n","/**\n * Call `callback` limited by `tryCount` amount of times with interval in `timeout` ms\n * @returns Promise that will be resolved as soon as callback returns truthy value, or reject it by limit.\n */\nexport function tryUntil<T>(callback: () => T, tryCount = 2, timeout = 100): Promise<T> {\n  return new Promise((resolve, reject) => {\n    (function check(): void {\n      let result: T | undefined;\n      try {\n        result = callback();\n      } catch {\n        result = undefined;\n      }\n\n      if (result || (tryCount--) < 0) {\n        result ? resolve(result) : reject(new Error('Rejected by limit of tries'));\n      } else {\n        setTimeout(check, timeout);\n      }\n    })();\n  });\n}\n\n/** Alias for {@link tryUntil} */\nexport const promisifiedTry = tryUntil;\n","import type {AnyToVoidFnSignature} from '../misc/functions';\n\n/**\n * Postpone action after next render\n */\nexport const afterNextRender = (callback: () => void): number => requestAnimationFrame(() => requestAnimationFrame(callback));\n\n/**\n * Postpone action after a couple of renders\n */\nexport const skipOneRender = (callback: () => void): number => requestAnimationFrame(() => afterNextRender(callback));\n\n/**\n * Decorate function to schedule execution after next render\n * @returns decorated function\n */\nexport const rafDecorator = <T extends AnyToVoidFnSignature>(fn: T): T => {\n  let lastArgs: any[] | null = null; // null if no calls requested\n  return function (...args: any[]) {\n    if (lastArgs === null) {\n      requestAnimationFrame(() => {\n        lastArgs && fn.call(this, ...lastArgs);\n        lastArgs = null;\n      });\n    }\n    lastArgs = args;\n  } as T;\n};\n","import {identity} from '../misc/functions';\nimport {parseString, toKebabCase} from '../misc/format';\nimport {getAttr, setAttr} from '../dom/attr';\n\nimport type {ESLAttributeDecorator} from '../dom/attr';\nimport type {ESLDomElementTarget} from '../abstract/dom-target';\n\nexport type AttrParser<T> = (attr: string | null) => T;\nexport type AttrSerializer<T> = (val: T) => null | boolean | string;\n\n/** HTML attribute mapping configuration */\ntype AttrDescriptor<T = string> = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n  /** Parser from attribute value */\n  parser?: AttrParser<T>;\n  /** Serializer to transform passed value to attribute value */\n  serializer?: AttrSerializer<T>;\n};\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value.\n * Maps string type property.\n * @param config - mapping configuration. See {@link AttrDescriptor}\n */\nexport const attr = <T = string>(config: AttrDescriptor<T> = {}): ESLAttributeDecorator => {\n  return (target: ESLDomElementTarget, propName: string): any => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n\n    function get(): T | null {\n      const val = getAttr(this, attrName);\n      if (val === null && 'defaultValue' in config) return config.defaultValue as T;\n      return (config.parser || parseString as AttrParser<any>)(val);\n    }\n    function set(value: T): void {\n      setAttr(this, attrName, (config.serializer as AttrSerializer<any> || identity)(value));\n    }\n\n    Object.defineProperty(target, propName, config.readonly ? {get} : {get, set});\n    return {};\n  };\n};\n","import {getPropertyDescriptor} from '../misc/object/utils';\n\n/** Decorator \"bind\" allows to bind prototype method context to class instance */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bind<Fn extends Function>(target: object,\n                                          propertyKey: string,\n                                          descriptor: TypedPropertyDescriptor<Fn>): TypedPropertyDescriptor<Fn> {\n  // Validation check\n  if (!descriptor || (typeof descriptor.value !== 'function')) {\n    throw new TypeError('Only class methods can be decorated via @bind');\n  }\n  // Original function\n  const originalFn = descriptor.value;\n\n  return descriptor = {\n    enumerable: descriptor.enumerable,\n    configurable: true,\n\n    get: function getBound(): Fn {\n      const proto = Object.getPrototypeOf(this);\n      const desc = getPropertyDescriptor(proto, propertyKey);\n      const isProtoCall = !desc || desc.get !== getBound;\n      return isProtoCall ? originalFn : (this[propertyKey] = originalFn.bind(this));\n    },\n    set(value: Fn): void {\n      Object.defineProperty(this, propertyKey, {\n        value,\n        writable: true,\n        configurable: true,\n        enumerable: descriptor.enumerable\n      });\n    }\n  };\n}\n","import {hasAttr, setAttr} from '../dom/attr';\nimport {toKebabCase} from '../misc/format';\n\nimport type {ESLAttributeDecorator} from '../dom/attr';\nimport type {ESLDomElementTarget} from '../abstract/dom-target';\n\n/** HTML boolean (marker) attribute mapping configuration */\ntype BoolAttrDescriptor = {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n};\n\nfunction buildConditionalDescriptor(attrName: string, readOnly: boolean): PropertyDescriptor {\n  function get(): boolean {\n    return hasAttr(this, attrName);\n  }\n  function set(value: unknown): void {\n    setAttr(this, attrName, !!value);\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element boolean (marker) attribute state.\n * Maps boolean type property.\n * @param config - mapping configuration. See {@link BoolAttrDescriptor}\n */\nexport const boolAttr = (config: BoolAttrDescriptor = {}): ESLAttributeDecorator => {\n  return (target: ESLDomElementTarget, propName: string): any => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildConditionalDescriptor(attrName, !!config.readonly));\n    return {};\n  };\n};\n","import {getPropertyDescriptor} from '../misc/object/utils';\nimport type {AnyToAnyFnSignature} from '../misc/functions';\n\n/**\n * Common TS decorator to apply decorator function\n * (like {@link debounce}, {@link throttle}, {@link rafDecorator})\n * to the class method\n * @param decorator - function decorator, should accept decorated method as first argument\n * @param args - additional arguments to pass into `decorator`\n */\nexport function decorate<Args extends any[], Fn extends AnyToAnyFnSignature>(\n  decorator: (fn: Fn, ...params: Args) => Fn,\n  ...args: Args\n) {\n  return function (target: any, propertyKey: string, descriptor: TypedPropertyDescriptor<Fn>): TypedPropertyDescriptor<Fn> {\n    if (!descriptor || typeof descriptor.value !== 'function') {\n      throw new TypeError('Only class methods can be decorated');\n    }\n\n    const originalFn: Fn = descriptor.value;\n\n    return descriptor = {\n      enumerable: descriptor.enumerable,\n      configurable: true,\n\n      get: function getBound(): Fn {\n        // Skip own properties\n        const proto = Object.getPrototypeOf(this);\n        // Find the closest descriptor for property\n        const desc = getPropertyDescriptor(proto, propertyKey);\n        // Return original function in case of prototype or super call\n        if (!desc || desc.get !== getBound) return originalFn;\n        // Create a new decorated instance of function\n        const decoratedFn = decorator(originalFn.bind(this), ...args);\n        // Copy original function own keys\n        Object.assign(decoratedFn, originalFn);\n        // Defines own property with the decorated instance\n        return this[propertyKey] = decoratedFn;\n      },\n      set(value: Fn): void {\n        Object.defineProperty(this, propertyKey, {\n          value,\n          writable: true,\n          configurable: true,\n          enumerable: descriptor.enumerable\n        });\n      }\n    };\n  };\n}\n","import {getAttr, setAttr} from '../dom/attr';\nimport {toKebabCase, evaluate} from '../misc/format';\n\nimport type {ESLAttributeDecorator} from '../dom/attr';\nimport type {ESLDomElementTarget} from '../abstract/dom-target';\n\n/** HTML attribute to object property mapping configuration */\ninterface JsonAttrDescriptor<T> {\n  /** HTML attribute name. Uses kebab-cased variable name by default */\n  name?: string;\n  /** Create getter only */\n  readonly?: boolean;\n  /** Use data-* attribute */\n  dataAttr?: boolean;\n  /** Default property value. Used if no attribute is present on the element. Empty string by default. */\n  defaultValue?: T;\n}\n\nfunction buildJsonAttrDescriptor<T>(attrName: string, readOnly: boolean, defaultValue: T | null): PropertyDescriptor {\n  function get(): T | null {\n    const attrContent = getAttr(this, attrName, '').trim();\n    return evaluate(attrContent, defaultValue);\n  }\n\n  function set(value: any): void {\n    try {\n      if (typeof value !== 'object') throw Error('value should be object');\n      setAttr(this, attrName, value ? JSON.stringify(value) : false);\n    } catch (e) {\n      console.error('[ESL] jsonAttr: Can not set json value ', e);\n    }\n  }\n\n  return readOnly ? {get} : {get, set};\n}\n\nconst buildAttrName =\n  (propName: string, dataAttr: boolean): string => dataAttr ? `data-${toKebabCase(propName)}` : toKebabCase(propName);\n\n/**\n * Decorator to map current property to element attribute value using JSON (de-)serialization rules.\n * Maps object type property.\n * @param config - mapping configuration. See {@link JsonAttrDescriptor}\n */\nexport const jsonAttr = <T>(config: JsonAttrDescriptor<T> = {}): ESLAttributeDecorator => {\n  config = Object.assign({defaultValue: {}}, config);\n  return (target: ESLDomElementTarget, propName: string): any => {\n    const attrName = buildAttrName(config.name || propName, !!config.dataAttr);\n    Object.defineProperty(target, propName, buildJsonAttrDescriptor(attrName, !!config.readonly, config.defaultValue));\n    return {};\n  };\n};\n","import {ESLEventUtils} from '../../esl-event-listener/core';\n\nimport type {PropertyProvider} from '../misc/functions';\nimport type {ESLListenerHandler, ESLListenerDescriptorExt} from '../dom/events';\n\ntype ListenDecorator<EType extends Event> =\n  (target: any, property: string, descriptor: TypedPropertyDescriptor<ESLListenerHandler<EType>>) => void;\n\n/**\n * Decorator to declare listener ({@link ESLEventListener}) meta information\n * Defines auto-subscribable event\n * @param event - event type string or event provider function\n */\nexport function listen<K extends keyof ESLListenerEventMap>(event: K | PropertyProvider<K>): ListenDecorator<ESLListenerEventMap[K]>;\n/**\n * Decorator to declare listener ({@link ESLEventListener}) meta information using {@link ESLListenerDescriptor}\n * Defines auto-subscribable event by default\n * @param desc - event listener configuration {@link ESLListenerDescriptor}\n */\nexport function listen<K extends keyof ESLListenerEventMap>(desc: ESLListenerDescriptorExt<K>): ListenDecorator<ESLListenerEventMap[K]>;\n\nexport function listen(desc: string | PropertyProvider<string> | ESLListenerDescriptorExt): ListenDecorator<Event> {\n  return function listener<Host extends object>(target: Host, propertyKey: keyof Host & string): void {\n    // Map short event or event provider value to descriptor object\n    desc = typeof desc === 'string' || typeof desc === 'function' ? {event: desc} : desc;\n    // Makes auto collectable/subscribable description if not inherited\n    desc = Object.assign(desc.inherit ? {} : {auto: true}, desc);\n\n    ESLEventUtils.initDescriptor(target, propertyKey, desc);\n  };\n}\n","import {defaultArgsHashFn, memoizeFn} from '../misc/memoize';\nimport {isPrototype, getPropertyDescriptor} from '../misc/object';\n\nimport type {MemoHashFn} from '../misc/memoize';\nimport type {MethodTypedDecorator} from '../misc/functions';\n\nexport function memoize(): MethodDecorator;\nexport function memoize<H extends MemoHashFn>(hashFn: H): MethodTypedDecorator<(...args: Parameters<H>) => any>;\n/**\n * Memoization decorator helper.\n * @see memoizeFn Original memoizeFn function decorator.\n */\nexport function memoize(hashFn: MemoHashFn = defaultArgsHashFn) {\n  return function (target: any, prop: string, descriptor: TypedPropertyDescriptor<any>): void {\n    if (!descriptor || typeof (descriptor.value || descriptor.get) !== 'function') {\n      throw new TypeError('Only get accessors or class methods can be decorated via @memoize');\n    }\n\n    if (isPrototype(target)) {\n      // Object members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeGetter(descriptor.get, prop));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeMethod(descriptor.value, prop, hashFn));\n    } else {\n      // Static members\n      (typeof descriptor.get === 'function') && (descriptor.get = memoizeFn(descriptor.get));\n      (typeof descriptor.value === 'function') && (descriptor.value = memoizeFn(descriptor.value, hashFn));\n    }\n  };\n}\n\n// Lock storage to prevent cache logic for some key\nconst locks = new WeakMap();\nconst defineOwnKeySafe = (obj: any, prop: string, value: any): void => {\n  locks.set(obj, prop); // IE try to get key with the prototype instance call, so we lock it\n  Object.defineProperty(obj, prop, {value, writable: true, configurable: true});\n  locks.delete(obj); // Free property key\n};\n\n/** Cache getter result as an object own property */\nfunction memoizeGetter(originalMethod: any, prop: string) {\n  return function (): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const value = originalMethod.call(this);\n    defineOwnKeySafe(this, prop, value);\n    return value;\n  };\n}\n\n/** Cache method memo function in the current context on call */\nfunction memoizeMethod(originalMethod: any, prop: string, hashFn: MemoHashFn) {\n  return function (this: any, ...args: any[]): any {\n    if (locks.get(this) === prop) return originalMethod;\n    const memo = memoizeFn(originalMethod, hashFn);\n    defineOwnKeySafe(this, prop, memo);\n    return memo.apply(this, args);\n  };\n}\n\n/**\n * Clear memoization cache for passed property of the target.\n * Accepts not own properties.\n * Note: be sure that you targeting memoized property or function.\n * Clear utility has no 100% check to prevent modifying incorrect (not memoized) property keys\n *\n * @param target - object instance that holds property\n * @param property - property, key of target, to clear cache\n */\nfunction clearMemo<T extends object>(target: T, property: keyof T | (keyof T)[]): void;\n/**\n * Clear memoization cache for passed property of the target.\n * Accepts not own properties.\n * Note: be sure that you target memoized property or function.\n * Clear utility has no 100% check to prevent modifying incorrect (not memoized) property keys\n *\n * @param target - object instance that holds property\n * @param property - property, key of target, to clear cache\n */\nfunction clearMemo(target: object, property: string | string[]): void;\nfunction clearMemo(target: any, property: string | string[]): void {\n  if (Array.isArray(property)) return property.forEach((prop) => memoize.clear(target, prop));\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).clear === 'function') return (desc.get as any).clear();\n  if (typeof desc.value === 'function' && typeof desc.value.clear === 'function') return desc.value.clear();\n  if (Object.hasOwnProperty.call(target, property)) delete target[property];\n}\nmemoize.clear = clearMemo;\n\n/**\n * Check if property has cache for the passed params\n *\n * @param target - object instance that holds property\n * @param property - property, key of target, to check cache\n * @param params - additional params of original memoized method\n */\nfunction hasMemo<T extends object>(target: T, property: keyof T, ...params: any[]): boolean;\n/**\n * Check if property has cache for the passed params\n *\n * @param target - object instance that holds property\n * @param property - property, key of target, to check cache\n * @param params - additional params of original memoized method\n */\nfunction hasMemo(target: object, property: string, ...params: any[]): boolean;\nfunction hasMemo(target: any, property: string, ...params: any[]): boolean {\n  const desc = getPropertyDescriptor(target, property);\n  if (!desc) return false;\n  if (typeof desc.get === 'function' && typeof (desc.get as any).has === 'function') return (desc.get as any).has(...params);\n  if (typeof desc.value === 'function' && typeof desc.value.has === 'function') return desc.value.has(...params);\n  return Object.hasOwnProperty.call(target, property);\n}\nmemoize.has = hasMemo;\n","/** Property configuration */\nexport type OverrideDecoratorConfig = {\n  /** To define enumerable property */\n  enumerable?: boolean;\n  /** To define readonly property */\n  readonly?: boolean;\n};\n\n/**\n * `@prop` is auxiliary decorator to define a field on the prototype level.\n *` @prop` can be used to override decorated property from the parent level\n *\n * You can also use an @override decorator in combination with ECMA Script class property definition:\n * `@prop() public field: any = initial value;`\n *\n * The class property initial value is a part of object creation, so it goes to the object itself,\n * while the @override value is defined on the prototype level.\n *\n * @param value - value to setup in prototype\n * @param prototypeConfig - prototype property configuration\n */\nexport function prop(value?: any, prototypeConfig: OverrideDecoratorConfig = {}) {\n  return function (obj: any, name: string): any {\n    if (Object.hasOwnProperty.call(obj, name)) {\n      throw new TypeError('Can\\'t override own property');\n    }\n    Object.defineProperty(obj, name, {\n      value,\n      writable: !prototypeConfig.readonly,\n      enumerable:  !prototypeConfig.enumerable,\n      configurable: true\n    });\n    return {};\n  };\n}\n","import {onDocumentReady} from '../dom/ready';\nimport type {AnyToVoidFnSignature} from '../misc/functions';\n\n/** Defer method execution to the next task with dom ready state precondition */\nexport function ready<T extends AnyToVoidFnSignature>(target: any,\n                                                      propertyKey: string,\n                                                      descriptor: TypedPropertyDescriptor<T>): void {\n  if (!descriptor || typeof descriptor.value !== 'function') {\n    throw new TypeError('Only class methods can be decorated via document ready decorator');\n  }\n  const fn = descriptor.value;\n  descriptor.value = function (...arg: any[]) {\n    onDocumentReady(() => fn.call(this, ...arg));\n  } as T;\n}\n","/**\n * Get the Element that is the root element of the document.\n * @param element - element for which to get the document element\n * */\nexport const getDocument = (element: Element | Window = window): Element => {\n  return (element instanceof Window ? element.document : element.ownerDocument).documentElement;\n};\n\n/**\n * Get the name of node.\n * @param element - element for which to get the name\n */\nexport const getNodeName = (element?: Node | Window): string  => {\n  return element && !(element instanceof Window) ? (element.nodeName).toLowerCase() : '';\n};\n\n/**\n * Get the parent of the specified element in the DOM tree.\n * @param element - element for which to get the parent\n */\nexport const getParentNode = (element: Element | ShadowRoot): Node => {\n  if (getNodeName(element) === 'html') return element;\n  return (window.ShadowRoot\n    ? element instanceof ShadowRoot\n      ? element.host\n      : element.assignedSlot || element.parentNode\n    : element.parentNode) || getDocument(element as Element);\n};\n","import {resolveDomTarget} from '../abstract/dom-target';\n\nimport type {ESLDomElementTarget} from '../abstract/dom-target';\n\nexport type ESLAttributeTarget = undefined | null | ESLDomElementTarget | ESLDomElementTarget[];\nexport type ESLAttributeDecorator = (target: ESLDomElementTarget, propName: string) => void;\n\n/** @returns true if attribute presented */\nexport function hasAttr($el: ESLAttributeTarget, name: string): boolean {\n  if (Array.isArray($el)) return $el.every((element: Element) => hasAttr(element, name));\n  if (!($el = resolveDomTarget($el))) return false;\n  return $el.hasAttribute(name);\n}\n\n/** @returns attribute or passed fallback value. Identical to getAttribute by default */\nexport function getAttr($el: ESLAttributeTarget, name: string): string | null;\nexport function getAttr<T>($el: ESLAttributeTarget, name: string, fallback: T): string | T;\nexport function getAttr($el: ESLAttributeTarget, name: string, fallback: string | null = null): string | null {\n  if (Array.isArray($el)) return getAttr($el[0], name);\n  if (!($el = resolveDomTarget($el))) return null;\n  const value = $el.getAttribute(name);\n  return value === null ? fallback : value;\n}\n\n/** Sets attribute */\nexport function setAttr($el: ESLAttributeTarget, name: string, value: undefined | null | boolean | string): void {\n  if (Array.isArray($el)) {\n    $el.forEach((element: Element) => setAttr(element, name, value));\n    return;\n  }\n  if (!($el = resolveDomTarget($el))) return;\n  if (value === undefined || value === null || value === false) {\n    $el.removeAttribute(name);\n  } else {\n    $el.setAttribute(name, value === true ? '' : value);\n  }\n}\n","import {wrap} from '../misc/array';\n\n/** Describe locker elements collection per class name */\ntype Locks = Map<string, Set<Element>>;\n/** Store locks for key element classes*/\nconst lockStore = new WeakMap<Element, Locks>();\n\n/** Mange className lock for the element */\nconst lock = (el: Element, className: string, locker: Element): void => {\n  const elLocks: Locks = lockStore.get(el) || new Map();\n  const classLocks: Set<Element> = elLocks.get(className) || new Set();\n  classLocks.add(locker);\n  elLocks.set(className, classLocks);\n  lockStore.set(el, elLocks);\n};\n/**\n * Manage className unlock for the element\n * @returns true if className have no locks\n */\nconst unlock = (el: Element, className: string, locker: Element): boolean => {\n  const elLocks = lockStore.get(el);\n  if (!elLocks) return true;\n  const classLocks = elLocks.get(className);\n  if (!classLocks) return true;\n  classLocks.delete(locker);\n  return !classLocks.size;\n};\n\n/**\n * Add single class to the element.\n * Supports inversion and locker management.\n */\nconst add = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return remove(el, className.substring(1), locker);\n  if (locker) lock(el, className, locker);\n  el.classList.add(className);\n};\n\n/**\n * Remove single class from the element.\n * Supports inversion and locker management.\n */\nconst remove = (el: Element, className: string, locker?: Element): void => {\n  if (className[0] === '!') return add(el, className.substring(1), locker);\n  if (locker && !unlock(el, className, locker)) return;\n  if (!locker) CSSClassUtils.unlock(el, className);\n  el.classList.remove(className);\n};\n\n/**\n * Check if the element matches passed CSS class.\n * Supports inversion.\n */\nconst has = (el: Element, className: string): boolean => {\n  if (className[0] === '!') return !has(el, className.substring(1));\n  return el.classList.contains(className);\n};\n\n/**\n * CSS class manipulation utilities.\n *\n * Allows manipulating with CSS classes with the following set of sub-features:\n * - JQuery-like enumeration - you can pass multiple tokens separated by space\n * - safe checks - empty or falsy token sting will be ignored without throwing an error\n * - inversion syntax - tokens that start from '!' will be processed with inverted action\n * (e.g. addCls(el, '!class') - will remove 'class' from the element, while removeCls(el, '!class') adds 'class' to the element)\n * - class locks - you can manipulate with classes using `locker` option that takes into account the modification initiator.\n * That means the class added in 'locker' mode will not be removed until all initiators that requested add class have requested its removal.\n * */\nexport abstract class CSSClassUtils {\n  /** Splitting passed token string into CSS class names array. */\n  public static splitTokens(tokenString: string | null | undefined): string[] {\n    return (tokenString || '').split(' ').filter((str) => !!str);\n  }\n\n  /**\n   * Add all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static add(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => add(el, className, locker)));\n  }\n\n  /**\n   * Remove all classes from the class token string to the element.\n   * @see CSSClassUtils\n   * */\n  public static remove(els: Element | Element[], cls: string | null | undefined, locker?: Element): void {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    wrap(els).forEach((el) => tokens.forEach((className) => remove(el, className, locker)));\n  }\n\n  /**\n   * Toggle all classes from the class token string on the element to the passed state.\n   * @see CSSClassUtils\n   * */\n  public static toggle(els: Element | Element[], cls: string | null | undefined, state: boolean, locker?: Element): void {\n    (state ? CSSClassUtils.add : CSSClassUtils.remove)(els, cls, locker);\n  }\n\n  /**\n   * Check if all class from token string matches to the element or elements.\n   * @see CSSClassUtils\n   * */\n  public static has(els: Element | Element[], cls: string): boolean {\n    const tokens = CSSClassUtils.splitTokens(cls);\n    return wrap(els).every((el) => tokens.every((className) => has(el, className)));\n  }\n\n  /** Remove all lockers for the element or passed element className */\n  public static unlock(els: Element | Element[], className?: string): void {\n    if (className) {\n      wrap(els).forEach((el) => lockStore.get(el)?.delete(className));\n    } else {\n      wrap(els).forEach((el) => lockStore.delete(el));\n    }\n  }\n}\n","/** Checks if the passed event is {@link MouseEvent} */\nexport const isMouseEvent = (event: Event): event is MouseEvent => window.MouseEvent && event instanceof MouseEvent;\n\n/** Checks if the passed event is {@link TouchEvent} */\nexport const isTouchEvent = (event: Event): event is TouchEvent => window.TouchEvent && event instanceof TouchEvent;\n\n/** Checks if the passed event is {@link PointerEvent} */\nexport const isPointerEvent = (event: Event): event is PointerEvent => window.PointerEvent && event instanceof PointerEvent;\n\nconst PASSIVE_EVENTS = ['wheel', 'mousewheel', 'touchstart', 'touchmove'];\n/**\n * @returns true if the passed event should be passive by default\n * @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n */\nexport const isPassiveByDefault = (event: string): boolean => PASSIVE_EVENTS.includes(event);\n\n/** Gets the original CustomEvent source in case event bubbles from Shadow DOM */\nexport const getCompositeTarget = (e: CustomEvent): EventTarget | null => {\n  const targets = (e.composedPath && e.composedPath());\n  return targets ? targets[0] : e.target;\n};\n\n/** Object that describes coordinates */\nexport interface Point {\n  x: number;\n  y: number;\n}\n\n/** @returns touch point coordinates of {@link TouchEvent} or {@link PointerEvent} */\nexport const getTouchPoint = (event: TouchEvent | PointerEvent | MouseEvent): Point => {\n  const source = isTouchEvent(event) ? event.changedTouches[0] : event;\n  return {\n    x: source.pageX,\n    y: source.pageY\n  };\n};\n\n/** @returns element offset point coordinates */\nexport const getOffsetPoint = (el: Element): Point => {\n  const props = el.getBoundingClientRect();\n  const y = props.top + window.scrollY;\n  const x = props.left + window.scrollX;\n  return {x, y};\n};\n\n/**\n * Dispatches custom event.\n * Event bubbles and is cancelable by default, use `eventInit` to override that.\n * @param el - EventTarget to dispatch event\n * @param eventName - name of the event to dispatch\n * @param eventInit - object that specifies characteristics of the event. See {@link CustomEventInit}\n */\nexport const dispatchCustomEvent = (el: EventTarget, eventName: string, eventInit?: CustomEventInit): boolean => {\n  const init = Object.assign({\n    bubbles: true,\n    composed: true,\n    cancelable: true\n  }, eventInit || {});\n  return el.dispatchEvent(new CustomEvent(eventName, init));\n};\n\n/**\n * Overrides {@link Event} `target` property\n * @param event - {@link Event} to override\n * @param key - {@link Event} property\n * @param target - {@link EventTarget} to setup\n * @returns original event\n */\nexport const overrideEvent = (\n  event: Event,\n  key: keyof Event,\n  target: null | EventTarget | (() => null | EventTarget)\n): Event => {\n  const provider = typeof target === 'function' ? target : ((): null | EventTarget => target);\n  Object.defineProperty(event, key, {\n    get: provider,\n    enumerable: true,\n    configurable: true\n  });\n  return event;\n};\n","import {flat, uniq} from '../../misc/array';\nimport {overrideEvent} from './misc';\n\n/** Key to store listeners on the {@link SyntheticEventTarget} instance*/\nconst LISTENERS = Symbol('_listeners');\n\n/**\n * Synthetic implementation of EventTarget\n * Replicates behavior of native event\n * Doesn't give explicit access to callback storage\n */\nexport class SyntheticEventTarget implements EventTarget {\n  // Event type to use in the shortcutted calls\n  public static DEFAULT_EVENT = 'change';\n\n  private readonly [LISTENERS]: Record<string, EventListenerOrEventListenerObject[]> = {};\n\n  protected getEventListeners(): EventListenerOrEventListenerObject[];\n  protected getEventListeners(type: string): EventListenerOrEventListenerObject[];\n  protected getEventListeners(type?: string): EventListenerOrEventListenerObject[] {\n    if (typeof type !== 'string') return uniq(flat(Object.values(this[LISTENERS])));\n    return this[LISTENERS][type] || [];\n  }\n\n  public hasEventListener(): boolean;\n  public hasEventListener(type: string): boolean;\n  /** @deprecated alias for `addEventListener` */\n  public hasEventListener(type: string | number): boolean;\n  /** @deprecated alias for `addEventListener` */\n  public hasEventListener(type: string, minCount: number): boolean;\n  public hasEventListener(type: string | number = 'change', minCount: number = 0): boolean {\n    if (typeof type !== 'string') return this.hasEventListener('change', type || 0); // TODO: remove in 5.0.0\n    return this.getEventListeners(type).length > minCount;\n  }\n\n  public addEventListener(callback: EventListenerOrEventListenerObject): void;\n  public addEventListener(type: string, callback: EventListenerOrEventListenerObject): void;\n  public addEventListener(type: string | EventListenerOrEventListenerObject, callback?: EventListenerOrEventListenerObject): void {\n    if (typeof type !== 'string') return this.addEventListener((this.constructor as typeof SyntheticEventTarget).DEFAULT_EVENT, type);\n\n    validateEventListenerType(callback);\n    const listeners = this[LISTENERS][type];\n    if (listeners?.includes(callback!)) return;\n    if (listeners) listeners.push(callback!);\n    else Object.assign(this[LISTENERS], {[type]: [callback]});\n  }\n\n  public removeEventListener(callback: EventListenerOrEventListenerObject): void;\n  public removeEventListener(type: string, callback: EventListenerOrEventListenerObject): void;\n  public removeEventListener(type: string | EventListenerOrEventListenerObject, callback?: EventListenerOrEventListenerObject): void {\n    if (typeof type !== 'string') return this.removeEventListener((this.constructor as typeof SyntheticEventTarget).DEFAULT_EVENT, type);\n\n    validateEventListenerType(callback);\n    const listeners = this[LISTENERS][type];\n    if (!listeners) return;\n    this[LISTENERS][type] = listeners.filter((cb) => cb !== callback);\n  }\n\n  public dispatchEvent(e: Event): boolean;\n  /** @deprecated use `overrideEvent` to declare `target` */\n  public dispatchEvent(e: Event, target?: EventTarget): boolean;\n  public dispatchEvent(e: Event, target?: EventTarget): boolean {\n    overrideEvent(e, 'currentTarget', this);\n    if (target) overrideEvent(e, 'target', target); // TODO: remove in 5.0.0\n    if (!e.target) overrideEvent(e, 'target', this);\n    if (!e.srcElement) overrideEvent(e, 'srcElement', e.target); // TODO: remove in 5.0.0\n    this.getEventListeners(e.type).forEach((listener) => {\n      if (typeof listener === 'function') listener.call(this, e);\n      else listener.handleEvent.call(listener, e);\n    });\n    return e.defaultPrevented;\n  }\n\n  /** @deprecated alias for `addEventListener` */\n  public addListener(cb: EventListener): void {\n    this.addEventListener(cb);\n  }\n  /** @deprecated alias for `removeEventListener` */\n  public removeListener(cb: EventListener): void {\n    this.removeEventListener(cb);\n  }\n}\n\nfunction validateEventListenerType(callback: any): void | never {\n  if (!callback || typeof callback !== 'function' && typeof callback.handleEvent !== 'function') {\n    throw Error('Callback should be a function or EventListenerObject');\n  }\n}\n","import {TAB} from './keys';\n\n/**\n * Chain focus order between passed elements.\n * Passive (should be called inside keyboard event handler)\n */\nexport const handleFocusChain = (e: KeyboardEvent, first: HTMLElement, last: HTMLElement): boolean | undefined => {\n  if (e.key !== TAB) return;\n  if (last && e.target === first && e.shiftKey) {\n    last.focus();\n    e.preventDefault();\n    return true;\n  }\n  if (first && e.target === last && !e.shiftKey) {\n    first.focus();\n    e.preventDefault();\n    return true;\n  }\n};\n\n/**\n * TODO: add visibility check\n * Gets keyboard-focusable elements within a specified root element\n * @param root - root element\n */\nexport const getKeyboardFocusableElements = (root: HTMLElement | Document = document): Element[] => {\n  return Array.from(root.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])'))\n    .filter((el) => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n};\n","export const TAB = 'Tab';\nexport const ENTER = 'Enter';\nexport const ESC = 'Escape';\nexport const SPACE = ' ';\nexport const BACKSPACE = 'Backspace';\n\nexport const ALT = 'Alt';\nexport const SHIFT = 'Shift';\nexport const CONTROL = 'Control';\n\nexport const PAUSE = 'Pause';\nexport const END = 'End';\nexport const HOME = 'Home';\nexport const DELETE = 'Delete';\n\nexport const PAGE_UP = 'PageUp';\nexport const PAGE_DOWN = 'PageDown';\n\nexport const ARROW_LEFT = 'ArrowLeft';\nexport const ARROW_UP = 'ArrowUp';\nexport const ARROW_RIGHT = 'ArrowRight';\nexport const ARROW_DOWN = 'ArrowDown';\n\nexport const SYSTEM_KEYS = [TAB, ALT, SHIFT, CONTROL, PAGE_UP, PAGE_DOWN, ARROW_LEFT, ARROW_UP, ARROW_RIGHT, ARROW_DOWN];\n","/**\n * Execute callback in bounds of the next task with dom ready state precondition\n */\nexport function onDocumentReady(callback: () => void): void {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      setTimeout(() => callback());\n    });\n  } else {\n    setTimeout(() => callback());\n  }\n}\n","/**\n * A Rect describes the size and position of a rectangle.\n */\nexport class Rect {\n  /** The X coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public x = 0;\n  /** The Y coordinate of the Rect's origin (top-left corner of the rectangle). */\n  public y = 0;\n  /** The width of the Rect. */\n  public width = 0;\n  /** The height of the Rect. */\n  public height = 0;\n\n  /**\n   * The static method creates a new Rect instance from a rect-like object.\n   * @param rect - rect-like object\n   */\n  public static from(rect: {x?: number, left?: number, y?: number, top?: number, width?: number, height?: number} = {}): Rect {\n    return new this(rect.x || rect.left, rect.y || rect.top, rect.width, rect.height);\n  }\n\n  /**\n   * The static method checks the equality of the two Rect instances.\n   * @param rect1 - first instance of Rect\n   * @param rect2 - second instance of Rect\n   */\n  public static isEqual(rect1: Rect, rect2: Rect): boolean {\n    return rect1.x === rect2.x && rect1.y === rect2.y && rect1.width === rect2.width && rect1.height === rect2.height;\n  }\n\n  /**\n   * The static method returns intersection Rect of two Rect instances\n   * @param rect1 - first instance of Rect\n   * @param rect2 - second instance of Rect\n   */\n  public static intersect(rect1: Rect, rect2: Rect): Rect {\n    const top = Math.max(rect1.top, rect2.top);\n    const left = Math.max(rect1.left, rect2.left);\n    const bottom = Math.min(rect1.bottom, rect2.bottom);\n    const right = Math.min(rect1.right, rect2.right);\n    const width = Math.max(right - left, 0);\n    const height = Math.max(bottom - top, 0);\n    return Rect.from({top, left, width, height});\n  }\n\n  public constructor(x?: number, y?: number, width?: number, height?: number) {\n    this.x = x || 0;\n    this.y = y || 0;\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n\n  /**\n   * Get the top coordinate value of the Rect (has the same value as y).\n   */\n  public get top(): number {\n    return this.y;\n  }\n\n  /**\n   * Get the left coordinate value of the Rect (has the same value as x).\n   */\n  public get left(): number {\n    return this.x;\n  }\n\n  /**\n   * Get the right coordinate value of the DOMRect.\n   */\n  public get right(): number {\n    return this.x + this.width;\n  }\n\n  /**\n   * Get the bottom coordinate value of the Rect.\n   */\n  public get bottom(): number {\n    return this.y + this.height;\n  }\n\n  /**\n   * Get the center X coordinate value of the Rect.\n   */\n  public get cx(): number {\n    return this.x + this.width / 2;\n  }\n\n  /**\n   * Get the center Y coordinate value of the Rect.\n   */\n  public get cy(): number {\n    return this.y + this.height / 2;\n  }\n\n  /**\n   * Method that accepts one argument and grows the Rect by the specified increment in pixels.\n   * It increases the size of the Rect by moving each point on the edge of the Rect to a certain distance further away from the center of the Rect.\n   * @param increment - distance to grow in pixels for both X and Y-axis\n   */\n  public grow(increment: number): Rect;\n  /**\n   * Method that accepts two arguments where each specified increment grows the rect in different axis in pixels.\n   * @param incrementX -  distance to grow in pixels for X-axis\n   * @param incrementY -  distance to grow in pixels for Y-axis\n   */\n  public grow(incrementX: number, incrementY: number): Rect;\n  public grow(incrementX: number, incrementY: number = incrementX): Rect {\n    this.y -= incrementY;\n    this.x -= incrementX;\n    this.height += 2 * incrementY;\n    this.width += 2 * incrementX;\n    return this;\n  }\n\n  /**\n   * Method that accepts one argument and shrinks the Rect by the specified decrement in pixels.\n   * It reduces the size of the Rect by moving each point on the edge of the Rect to a certain distance closer to the center of the Rect.\n   * @param decrement - distance to shrink in pixels for both X and Y-axis\n   */\n  public shrink(decrement: number): Rect;\n  /**\n   * Method that accepts two arguments where each specified decrement shrinks the rect in different axis in pixels.\n   * @param decrementX -  distance to shrink in pixels for X-axis\n   * @param decrementY -  distance to shrink in pixels for Y-axis\n   */\n  public shrink(decrementX: number, decrementY: number): Rect;\n  public shrink(decrementX: number, decrementY: number = decrementX): Rect {\n    return this.grow(-decrementX, -decrementY);\n  }\n\n  /** @returns the numeric value of rectangle area */\n  public get area(): number {\n    return this.height * this.width;\n  }\n}\n","// TODO: Revisit using https://caniuse.com/mdn-api_element_scrollleft in 5.0.0\n/** RTL scroll browser behaviours */\nexport type ScrollType = 'default' | 'negative' | 'reverse';\n\n/** Checks if the element in a RTL direction context */\nexport const isRTL = (el?: HTMLElement | null): boolean => getComputedStyle(el || document.body).direction === 'rtl';\n\n/** Creates the dummy test element with a horizontal scroll presented */\nconst createDummyScroll = (): HTMLElement => {\n  const el = document.createElement('div');\n  el.appendChild(document.createTextNode('ESL!'));\n  el.dir = 'rtl';\n  Object.assign(el.style, {\n    position: 'absolute',\n    top: '-1000px',\n    width: '4px',\n    height: '1px',\n    fontSize: '14px',\n    overflow: 'scroll'\n  });\n  return el;\n};\n\nexport const testRTLScrollType = (): ScrollType => {\n  let scrollType: ScrollType = 'default';\n  const el = createDummyScroll();\n  document.body.appendChild(el);\n  if (el.scrollLeft <= 0) {\n    el.scrollLeft = 2;\n    scrollType = el.scrollLeft < 2 ? 'negative' : 'reverse';\n  }\n  document.body.removeChild(el);\n  return scrollType;\n};\n\nlet type: ScrollType | null = null;\n\nexport const RTLScroll = {\n  /** @returns RTL scroll type (lazy, memoized) */\n  get type(): ScrollType {\n    if (typeof type === 'string') return type;\n    return type = testRTLScrollType();\n  }\n};\n\nexport const normalizeScrollLeft = (el: HTMLElement, value: number | null = null, isRtl: boolean = isRTL(el)): number => {\n  value = (value === null) ? el.scrollLeft : value;\n  switch (isRtl ? RTLScroll.type : '') {\n    case 'negative':\n      return el.scrollWidth - el.clientWidth + value;\n    case 'reverse':\n      return el.scrollWidth - el.clientWidth - value;\n    default:\n      return value;\n  }\n};\n\n/** @deprecated use separate functions from the module */\nexport abstract class RTLUtils {\n  /** @deprecated use {@link isRTL} instead */\n  static readonly isRtl = isRTL;\n\n  /** @deprecated use {@link normalizeScrollLeft} instead */\n  static readonly normalizeScrollLeft = normalizeScrollLeft;\n\n  /** @deprecated use {@link RTLScroll}.type instead */\n  static get scrollType(): ScrollType {\n    return RTLScroll.type;\n  }\n}\n","/** checks if the attribute is dangerous */\nconst isDangerousAttribute = (name: string, value: string): boolean => {\n  const val = value.replace(/\\s+/g, '').toLowerCase();\n  if (['src', 'data', 'href', 'xlink:href'].includes(name)\n    && (val.includes('javascript:') || val.includes('data:text/html'))) return true;\n  return name.indexOf('on') === 0;\n};\n\n/** loops through each attribute, if it's dangerous, remove it */\nconst removeDangerousAttributes = (el: Element): void => {\n  Array.from(el.attributes).forEach(({name, value}) => {\n    if (isDangerousAttribute(name, value)) {\n      el.removeAttribute(name);\n    }\n  });\n};\n\n/** removes malicious attributes from element and its children */\nconst sanitizeElAttributes = (body: Element): void => {\n  Array.from(body.children).forEach((el) => {\n    removeDangerousAttributes(el);\n    sanitizeElAttributes(el);\n  });\n};\n\n/** removes script elements inside element */\nconst removeScripts = (body: Element): void => {\n  const scripts = body.querySelectorAll('script');\n  Array.from(scripts).forEach((script) => script.remove());\n};\n\nconst filterElements = (body: Element, allowedTopLevelTags: string[]): void => {\n  if (!allowedTopLevelTags.length) return;\n  Array.from(body.childNodes).forEach((el: Element) => {\n    if (!allowedTopLevelTags.includes(el.tagName)) body.removeChild(el);\n  });\n};\n\n/**\n * Sanitizes html string from malicious attributes, values, and scripts\n * Can also filter elements at the top nesting level by tag names.\n * @param html - html string to sanitize\n * @param allowedTopLevelTags - array of allowed tag names\n */\nexport function sanitize(html: string, allowedTopLevelTags: string[] = []): string {\n  // converts the string to an HTML document\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(html, 'text/html');\n  const body = doc.body || document.createElement('body');\n  // sanitizes html\n  removeScripts(body);\n  sanitizeElAttributes(body);\n  // filter allowed tags\n  filterElements(body, allowedTopLevelTags);\n\n  return body.innerHTML;\n}\n","/**\n * Creates new async script tag by id and src\n */\nconst createAsyncScript = (id: string, src: string): HTMLScriptElement => {\n  const script = document.createElement('script');\n  script.id = id;\n  script.async = true;\n  script.src = src;\n  return script;\n};\n\n/**\n * Common function that loads script async\n * @param id - unique script id that is used as a marker to prevent future load\n * @param src - script src (url) to load\n */\nexport function loadScript(id: string, src: string): Promise<Event> {\n  return new Promise((resolve, reject) => {\n    const script: HTMLScriptElement =\n      (document.getElementById(id) || createAsyncScript(id, src)) as HTMLScriptElement;\n    const state = script.getAttribute('state');\n\n    switch (state) {\n      case 'success': resolve(new Event('load')); break;\n      case 'error': reject(new Event('error')); break;\n      default:\n        script.addEventListener('load', (e: Event) => {\n          script.setAttribute('state', 'success');\n          resolve(e);\n        });\n        script.addEventListener('error', (e: Event) => {\n          script.setAttribute('state', 'error');\n          reject(e);\n        });\n    }\n    if (!script.parentNode) {\n      const firstScriptTag =\n        document.querySelector('script') || document.querySelector('head title');\n      if (firstScriptTag && firstScriptTag.parentNode) {\n        firstScriptTag.parentNode.insertBefore(script, firstScriptTag);\n      } else {\n        reject('Page document structure is incorrect');\n      }\n    }\n  });\n}\n","import {getNodeName, getParentNode} from '../api';\n\n/**\n * Get the list of all scroll parents, up the list of ancestors until we get to the top window object.\n * @param element - element for which you want to get the list of all scroll parents\n * @param list - array of elements to concatenate with the list of all scroll parents of element (optional)\n */\nexport function getListScrollParents(element: Element, list: Element[] = []): Element[] {\n  const scrollParent = getScrollParent(element);\n  const isBody = scrollParent === element.ownerDocument?.body;\n  const target = isBody\n    ? isScrollable(scrollParent) ? scrollParent : []\n    : scrollParent;\n\n  const updatedList = list.concat(target);\n  return isBody\n    ? updatedList\n    : updatedList.concat(getListScrollParents(getParentNode(scrollParent) as Element));\n}\n\n/**\n * Get the scroll parent of the specified element in the DOM tree.\n * @param node - element for which to get the scroll parent\n */\nexport function getScrollParent(node: Element): Element {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    return node.ownerDocument?.body as Element;\n  }\n\n  if (node instanceof HTMLElement && isScrollable(node as Element)) {\n    return node as Element;\n  }\n\n  return getScrollParent(getParentNode(node) as Element);\n}\n\n/**\n * Check that element is scroll parent.\n * @param element - element for checking\n * */\nexport function isScrollable(element: Element): boolean {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  const {overflow, overflowX, overflowY} = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\n","import {tryUntil} from '../../async';\n\n/**\n * This is a promise-based version of scrollIntoView().\n * Method scrolls the element's parent container such that the element on which\n * scrollIntoView() is called is visible to the user. The promise is resolved when\n * the element became visible to the user and scrolling stops.\n *\n * Note: Please, use the native element.scrollIntoView() if you don't need a promise\n * to detect the moment when the scroll is finished or you don't use smooth behavior.\n * @param element - element to be made visible to the user\n * @param options - scrollIntoView options\n */\nexport function scrollIntoView(element: Element, options?: boolean | ScrollIntoViewOptions | undefined): Promise<boolean> {\n  let same = 0;\n  let lastLeft: number;\n  let lastTop: number;\n  const check = (): boolean => {\n    const {top, left} = element.getBoundingClientRect();\n\n    if (top !== lastTop || left !== lastLeft) {\n      same = 0;\n      lastTop = top;\n      lastLeft = left;\n    }\n    return same++ > 2;\n  };\n\n  element.scrollIntoView(options);\n  return tryUntil(check, 333, 30); // will check top position every 30ms, but not more than 250 times (10s)\n}\n","import type {Predicate} from '../misc/functions';\n\n/** Checks if element matches passed selector or exact predicate function */\nexport const isMatches = (el: Element, matcher?: string | ((el: Element) => boolean)): boolean => {\n  if (typeof matcher === 'string') return !matcher || el.matches(matcher);\n  if (typeof matcher === 'function') return matcher.call(el, el);\n  return typeof matcher === 'undefined';\n};\n\n/** Checks that `nodeA` and `nodeB` are from the same tree path */\nexport const isRelativeNode = (nodeA: Node | null, nodeB: Node | null): boolean => {\n  return !!(nodeA && nodeB) && (nodeA.contains(nodeB) || nodeB.contains(nodeA));\n};\n\ntype IteratorFn = (el: Element) => Element | null;\n\n/** Creates function that finds next dom element, that matches selector, in the sequence declared by `next` function */\nexport const createSequenceFinder = (next: IteratorFn, includeSelf: boolean = false) => {\n  return function (base: Element, predicate: string | Predicate<Element>): Element | null {\n    if (includeSelf && isMatches(base, predicate)) return base;\n    for (let target: Element | null = next(base); target && target !== base; target = next(target)) {\n      if (isMatches(target, predicate)) return target;\n    }\n    return null;\n  };\n};\n\n/** @returns first matching next sibling or null*/\nexport const findNext = createSequenceFinder((el) => el.nextElementSibling);\n/** @returns first matching previous sibling or null*/\nexport const findPrev = createSequenceFinder((el) => el.previousElementSibling);\n/** @returns first matching parent or null*/\nexport const findParent = createSequenceFinder((el) => el.parentElement);\n/** @returns first matching ancestor starting from passed element or null*/\nexport const findClosest = createSequenceFinder((el) => el.parentElement, true);\n/** @returns first matching host element starting from passed element*/\nexport const findHost = createSequenceFinder((el) => {\n  const root = el.getRootNode();\n  return (root instanceof ShadowRoot) ? root.host : null;\n}, true);\n\n/** @returns Array of all matching elements in subtree or empty array */\nexport const findAll = (base: Element, sel: string): Element[] => {\n  return sel ? Array.from(base.querySelectorAll(sel)) : [base];\n};\n/** @returns Array of all matching children or empty array */\nexport const findChildren = (base: Element, sel: string): Element[] => {\n  return Array.from(base.children).filter((el: Element) => !sel || el.matches(sel));\n};\n\n/**\n * Finds closest parent node of `node` by `predicate`.\n * Optional `skipSelf` to skip initial node\n */\nexport const findClosestBy = (node: Node | null, predicate: (node: Node) => boolean, skipSelf = false): Node | null => {\n  let current = skipSelf && node ? node.parentNode : node;\n  while (current) {\n    if (predicate(current)) return current;\n    current = current.parentNode;\n  }\n  return null;\n};\n\n/**\n * Finds looped next element within parent circle\n */\nexport const findNextLooped =\n  createSequenceFinder((el) => el.nextElementSibling || (el.parentElement && el.parentElement.firstElementChild));\n\n/**\n * Finds looped previous element within parent circle (looped)\n */\nexport const findPrevLooped =\n  createSequenceFinder((el) => el.previousElementSibling || (el.parentElement && el.parentElement.lastElementChild));\n\n/** @deprecated Cumulative traversing utility set */\nexport abstract class TraversingUtils {\n  static isRelative = isRelativeNode;\n  static closestBy = findClosestBy;\n  static createSequenceFinder = createSequenceFinder;\n\n  static findNext = findNext;\n  static findPrev = findPrev;\n  static findParent = findParent;\n  static findClosest = findClosest;\n\n  static findAll = findAll;\n  static findChildren = findChildren;\n}\n","import {Rect} from './rect';\nimport {getListScrollParents} from './scroll';\nimport {findClosestBy, findHost} from './traversing';\nimport {getWindowRect} from './window';\n\nexport interface VisibilityOptions {\n  /** Element will be considered invisible if opacity set to '0' */\n  opacity?: boolean;\n  /** Element will be considered invisible if visibility set to 'hidden' */\n  visibility?: boolean;\n  /** Element will be considered invisible if it's not in viewport */\n  viewport?: boolean;\n}\n\n/**\n * Checks if the specified element is visible\n * @param el - element to be checked\n * @param options - object of additional visibility options to include\n */\nexport function isVisible(el: HTMLElement, options: VisibilityOptions = {visibility: true}): boolean {\n  if (!el.getClientRects().length) return false;\n  if (options.visibility && findHost(el, (host) => getComputedStyle(host).visibility === 'hidden')) return false;\n  if (options.opacity &&\n    findClosestBy(el, (parent) => parent instanceof Element && getComputedStyle(parent).opacity === '0')) return false;\n  return !(options.viewport && !isInViewport(el));\n}\n\n/**\n * Checks if the specified element is inside the viewport\n * @param el - element to be checked\n */\nexport function isInViewport(el: HTMLElement): boolean {\n  const wndIntersection = Rect.intersect(getWindowRect(), Rect.from(el.getBoundingClientRect()));\n  if (wndIntersection.area === 0) return false;\n  return !getListScrollParents(el).some((parent: HTMLElement) =>\n    Rect.intersect(wndIntersection, Rect.from(parent.getBoundingClientRect())).area === 0);\n}\n","import {Rect} from './rect';\n\n/**\n * Get the window object associated with a document of the specified element.\n * @param node - element for which to get window\n * */\nexport function getWindow(node: Node | Window): Window {\n  if (node === null) return window;\n  if (node instanceof Window) return node;\n  const ownerDocument = node.ownerDocument;\n  return ownerDocument ? ownerDocument.defaultView || window : window;\n}\n\n/**\n * Get the size and position of the window.\n * @returns\n */\nexport function getWindowRect(wnd: Window = window): Rect {\n  return Rect.from({\n    x: wnd.scrollX || wnd.pageXOffset,\n    y: wnd.scrollY || wnd.pageYOffset,\n    width: wnd.innerWidth || wnd.document.documentElement.clientWidth,\n    height: wnd.innerHeight || wnd.document.documentElement.clientHeight\n  });\n}\n","import {ExportNs} from './export-ns';\n\nconst {userAgent, vendor, platform} = window.navigator;\n\n// IE Detection\nexport const isTrident = /trident/i.test(userAgent);\nexport const isIE = isTrident;\n\n// Edge Detection\nexport const isEdgeHTML = /edg([ea]|ios)/i.test(userAgent);\nexport const isBlinkEdge = /\\sedg\\//i.test(userAgent);\nexport const isEdge = isEdgeHTML || isBlinkEdge;\n\n// Gecko\nexport const isGecko = /gecko/i.test(userAgent) && !/like gecko/i.test(userAgent);\nexport const isFirefox = /firefox|iceweasel|fxios/i.test(userAgent);\n\n// Opera / Chrome\nexport const isOpera = /(?:^opera.+?version|opr)/.test(userAgent);\nexport const isChrome = !isOpera && /google inc/.test(vendor);\n\n// Webkit\nexport const isWebkit = /(apple)?webkit/i.test(userAgent);\n\n// Safari\nexport const isSafari = isWebkit && /^((?!chrome|android).)*safari/i.test(userAgent);\n\n// Blink\nexport const isBlink = isWebkit && !isSafari;\n\n// Bot detection\nexport const isBot = /Chrome-Lighthouse|Google Page Speed Insights/i.test(userAgent);\n\n// Mobile\nexport const isAndroid = /Android/i.test(userAgent);\nexport const isMobileIOS13 = /* iOS 13+ detection */ (platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\nexport const isMobileIOS = /iPad|iPhone|iPod/.test(platform) || isMobileIOS13;\nexport const isLegacyMobile = /webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\nexport const isMobile = isMobileIOS || isAndroid || isLegacyMobile;\nexport const isMobileSafari = isMobileIOS && isWebkit && /CriOS/i.test(userAgent);\n\n// Touch Detection\nexport const isTouchDevice = ((): boolean => {\n  const navApi: any = window.navigator;\n  if (navApi.maxTouchPoints || navApi.msMaxTouchPoints) return true;\n  return ('ontouchstart' in window) || ('DocumentTouch' in window && document instanceof Touch);\n})();\n\n// Hover check\n// Note: always true for IE\nexport const hasHover = !matchMedia('(hover: none)').matches;\n\ntype TouchEventsDefinition = {\n  START: string;\n  MOVE: string;\n  END: string;\n};\n/** @deprecated TODO: needs to be reworked or moved away from device detector */\nexport const TOUCH_EVENTS = ((): TouchEventsDefinition => {\n  const isTouch = isTouchDevice;\n  return {\n    START: isTouch ? 'touchstart' : 'pointerdown',\n    MOVE: isTouch ? 'touchmove' : 'pointermove',\n    END: isTouch ? 'touchend' : 'pointerup'\n  };\n})();\n\n/**\n * Device detection utility\n * @readonly\n */\n@ExportNs('DeviceDetector')\nexport abstract class DeviceDetector {\n  // IE Detection\n  public static readonly isTrident = isTrident;\n  public static readonly isIE = isIE;\n\n  // Edge Detection\n  public static readonly isEdgeHTML = isEdgeHTML;\n  public static readonly isBlinkEdge = isBlinkEdge;\n  public static readonly isEdge = isEdge;\n\n  // Gecko\n  public static readonly isGecko = isGecko;\n  public static readonly isFirefox = isFirefox;\n\n  // Opera / Chrome\n  public static readonly isOpera = isOpera;\n  public static readonly isChrome = isChrome;\n\n  // Webkit\n  public static readonly isWebkit = isWebkit;\n\n  // Safari\n  public static readonly isSafari = isSafari;\n\n  // Blink\n  public static readonly isBlink = isBlink;\n\n  // Bot detection\n  public static readonly isBot = isBot;\n\n  // Mobile\n  public static readonly isAndroid = isAndroid;\n  public static readonly isMobileIOS13 = isMobileIOS13;\n  public static readonly isMobileIOS = isMobileIOS;\n  public static readonly isLegacyMobile = isLegacyMobile;\n\n  public static readonly isMobile = isMobile;\n  public static readonly isMobileSafari = isMobileSafari;\n\n  // Touch Detection\n  public static isTouchDevice = isTouchDevice;\n\n  // Hover check\n  // Note: always true for IE\n  public static hasHover = hasHover;\n\n  /** @deprecated TODO: needs to be reworked or moved away from device detector */\n  static TOUCH_EVENTS = TOUCH_EVENTS;\n}\n\ndeclare global {\n  export interface ESLLibrary {\n    DeviceDetector: typeof DeviceDetector;\n  }\n}\n","const NS_NAME = 'ESL';\n\n/**\n * Nested declaration helper\n */\nfunction define(root: any, name: string, value: any): void {\n  name.split('.').reduce((obj: any, key, index, parts) => {\n    if (parts.length === index + 1) {\n      return (obj[key] = obj[key] || value);\n    }\n    const type = typeof obj[key];\n    if (type !== 'undefined' && type !== 'object' && type !== 'function') {\n      throw new Error(`Can not define ${value} on ${name}`);\n    }\n    return (obj[key] = obj[key] || {});\n  }, root);\n}\n\n/**\n * Method to manually declare key in library namespace\n * See {@link ExportNs} decorator for details\n */\nexport const exportNs = (name: string, module: any): void => {\n  if (!(NS_NAME in window)) return;\n  define((window as any)[NS_NAME], name, module);\n};\n\n/**\n * Decorator to declare function or class in a global ns\n * @param name - key path to declare in ESL global ns\n * NOTE: path parts should be separated by dots\n * @example\n * ```ts\n * @Export('Package.Component')\n * ```\n * NOTE: in case declaration contains components-packages, their origins will be mixed with declaration in a Runtime\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function ExportNs<T extends Function>(name?: string) {\n  return (module: T): void => exportNs(name || module.name, module);\n}\n\n/** Declare ESL global */\nExportNs.declare = (): void => {\n  if ('ESL' in window) return;\n  Object.defineProperty(window, 'ESL', {value: {}});\n};\n","/** Fix IE browser to allow to display alert under iframe */\nexport function createZIndexIframe(): HTMLElement {\n  const iframe = document.createElement('iframe');\n  iframe.className = 'ie-zindex-fix';\n  iframe.src = 'about:blank';\n  return iframe;\n}\n","import {rafDecorator} from '../async/raf';\nimport {DeviceDetector} from '../environment/device-detector';\n\n/**\n * Small utility to provide 100vw and 100vh alternative CSS Variables\n * - vwProp (default: `--100vw`) - scroll independent viewport width value\n * - vhProp (default: `--100vh`) - device independent viewport height value (also known as 100vh iOS fix)\n */\nexport class ESLVSizeCSSProxy {\n  public static vwProp = '--100vw';\n  public static vhProp = '--100vh';\n\n  /** Inits custom CSS variables for viewport sizes and it's observation */\n  public static observe(): void {\n    // IE doesnt support CSS Variables (hopefully same as 100vh issue :D)\n    if (DeviceDetector.isIE) return;\n\n    this.update();\n    window.addEventListener('resize', this.updateDebounced);\n  }\n  /** Destroys observer */\n  public static destroy(): void {\n    window.removeEventListener('resize', this.updateDebounced);\n  }\n\n  /** Update custom CSS variables with actual viewport sizes */\n  protected static update(): void {\n    const $html = document.documentElement;\n    $html.style.setProperty(this.vwProp, `${this.viewportWidth}px`);\n    $html.style.setProperty(this.vhProp, `${this.viewportHeight}px`);\n  }\n  protected static readonly updateDebounced = rafDecorator(this.update.bind(this));\n\n  /** @returns current viewport width */\n  public static get viewportWidth(): number {\n    return document.documentElement.clientWidth;\n  }\n  /** @returns current viewport height */\n  public static get viewportHeight(): number {\n    return window.innerHeight;\n  }\n}\n","import {identity} from './functions';\nimport {isArrayLike} from './object';\n\ntype Tuple<T> = [T?, T?];\n\n/** Split array into tuples */\nexport const tuple = <T>(arr: T[]): Tuple<T>[] => arr.reduce((acc: Tuple<T>[], el) => {\n  if (acc.length === 0 || acc[acc.length - 1].length >= 2) acc.push([]);\n  acc[acc.length - 1].push(el);\n  return acc;\n}, []);\n\n/** Flat array - unwraps one level of nested arrays */\nexport const flat = <T>(arr: (null | T | T[])[]): T[] =>\n  arr.reduce((acc: T[], el) => el ? acc.concat(el) : acc, []) as T[];\n\n/** Wraps passed object or primitive to array */\nexport const wrap = <T>(arr: undefined | null | T | T[]): T[] => {\n  if (arr === undefined || arr === null) return [];\n  if (Array.isArray(arr)) return arr;\n  return [arr];\n};\n\n/** Unwraps empty collection to `undefined` */\nexport function unwrap(value: []): undefined;\n/** Unwraps and returns the first element of array-like object */\nexport function unwrap<T>(value: (ArrayLike<T> & {0: T})): T;\n/** Unwraps and returns the first element if array-like object */\nexport function unwrap<T>(value: ArrayLike<T>): T | undefined;\n/** Unwraps and returns the first element Node of passed NodeList object */\nexport function unwrap<T extends Node>(value: NodeListOf<T>): T | undefined;\n/** Unwraps and returns the first element if passed object is array-like, returns an original object otherwise */\nexport function unwrap<T>(value: T): T;\nexport function unwrap(value: any): any {\n  return isArrayLike(value) ? value[0] : value;\n}\n\n/** Makes array values unique */\nexport const uniq = <T> (arr: T[]): T[] => {\n  if (arr.length < 2) return arr.slice(0);\n  const result: T[] = [];\n  const set = new Set<T>();\n  arr.forEach((item) => set.add(item));\n  set.forEach((item) => result.push(item));\n  return result;\n};\n\n/** Create an array filled with the range [0,..,N-1] */\nexport function range(n: number): number[];\n/** Create an array filled with values returned by the filler callback */\nexport function range<T>(n: number, filler: (i: number) => T): T[];\nexport function range(n: number, filler: (i: number) => any = identity): any[] {\n  const arr = Array(n);\n  let i = 0;\n  while (i < n) arr[i] = filler(i++);\n  return arr;\n}\n\n/**\n * @returns object with a criteria value as a key and an array of original items that belongs to the current criteria value\n */\nexport const groupBy = <T, V extends string | number>(array: T[], group: (item: T) => V): Record<V, T[]> => {\n  return array.reduce((obj: Record<V, T[]>, el: T) => {\n    const key = group(el);\n    obj[key] ? obj[key].push(el) : obj[key] = [el];\n    return obj;\n  }, {} as Record<V, T[]>);\n};\n","import {get} from './object';\n\n/** Converts string to kebab-case notation */\nexport const toKebabCase = (str: string): string => {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\\s_]+/g, '-').toLowerCase();\n};\n\n/** Converts string to camelCase notation */\nexport const toCamelCase = (str: string): string => {\n  return str.trim().replace(/[\\s-,_]+([a-zA-Z0-9]?)/g, (match: string, word: string) => word.toUpperCase());\n};\n\n/** Makes the first non-indent (space, tab, newline) letter in the string capitalized */\nexport const capitalize = (str: string): string => {\n  let i = 0;\n  while (i < str.length && (str[i] === ' ' || str[i] === '\\t' || str[i] === '\\n')) i++;\n  return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);\n};\n\n/** Unwraps string from parenthesis */\nexport const unwrapParenthesis = (str: string): string => {\n  return str.trim().replace(/^\\((.*)\\)$/, '$1').trim();\n};\n\n/** Parses `null` and `undefined` as an empty string */\nexport const parseString = (val: string | null): string => String(val ?? '');\n\n/** Parses string representation of the boolean value */\nexport const parseBoolean = (val: string | null): boolean => val !== null && val !== 'false';\n\n/**\n * Parses number with the ability to pass an alternative fallback for NaN.\n * Note: falsy values except 0 are treated as NaN\n */\nexport const parseNumber = (str: string | number, nanValue?: number | undefined): number | undefined => {\n  if (str === 0) return 0;\n  const value = +(str || NaN);\n  return isNaN(value) ? nanValue : value;\n};\n\n/**\n * Common function that returns coefficient aspect ratio\n * Supported formats: w:h, w/h, coefficient\n * @example\n * `16:9`, `16/9`, `1.77`\n * @param str - string to parse\n * @returns aspect ratio coefficient\n */\nexport function parseAspectRatio(str: string): number {\n  const [w, h] = str.split(/[:/]/);\n  if (typeof h !== 'undefined') return +w / +h;\n  return +w || 0;\n}\n\n/** Evaluates passed string or returns `defaultValue` */\nexport function evaluate(str: string, defaultValue?: any): any {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    return str ? (new Function(`return ${str}`))() : defaultValue;\n  } catch (e) {\n    console.warn('[ESL]: Cannot parse value ', str, e);\n    return defaultValue;\n  }\n}\n\n/** Default RegExp to match replacements in the string for the {@link format} function */\nexport const DEF_FORMAT_MATCHER = /{[{%]?([\\w.]+)[%}]?}/g;\n\n/** Replaces `{key}` patterns in the string from the source object */\nexport function format(str: string, source: Record<string, any>, matcher: RegExp = DEF_FORMAT_MATCHER): string {\n  return str.replace(matcher, (match, key) => {\n    const val = get(source, key);\n    return val === undefined ? match : val;\n  });\n}\n","/** Function that does nothing */\nexport const noop: AnyToVoidFnSignature = () => undefined;\n\n/** Function that returns the first argument */\nexport const identity = <T>(arg: T): T => arg;\n\nexport type NoopFnSignature = () => void;\n\nexport type AnyToVoidFnSignature = (...args: any[]) => void;\n\nexport type AnyToAnyFnSignature = (...args: any[]) => any;\n\nexport type MethodTypedDecorator<T> = (target: any, property: string, descriptor: TypedPropertyDescriptor<T>) => TypedPropertyDescriptor<T> | void;\n\nexport type Predicate<T> = (el: T) => boolean;\n\n/**\n * Property provider function\n * @param that - (equal to `this` context) host or context\n */\nexport type PropertyProvider<T> = (this: unknown, that: unknown) => T;\n\n/** Resolves {@link PropertyProvider} function to the value */\nexport const resolveProperty = <T>(val: T | PropertyProvider<T>, origin: unknown): T => typeof val === 'function' ? val.call(origin, origin) : val;\n","import type {AnyToAnyFnSignature} from './functions';\n\n/** Memoized function type */\nexport type MemoizedFn<T extends AnyToAnyFnSignature> = T & {\n  /** Cache instance */\n  cache: Map<null | string, ReturnType<T>>;\n  /** Clear memoization cache */\n  clear: () => void;\n  /** Check existence of cache for passed params */\n  has: (...params: Parameters<T>) => boolean;\n};\n\n/**\n * Memoization decorator function. Caches the original function result according to hash generated from arguments.\n * In case the hash function returns `undefined` value will not be memoized.\n * @see MemoHashFn Hash function signature.\n */\nexport function memoizeFn<F extends AnyToAnyFnSignature>(fn: F, hashFn: MemoHashFn<F> = defaultArgsHashFn): MemoizedFn<F> {\n  function memo(...args: Parameters<F>): any {\n    const key = hashFn(...args);\n    if (key !== null && typeof key !== 'string') {\n      console.warn(`[ESL]: Can't cache value for ${fn.name} call.`);\n      return fn.apply(this, args);\n    }\n    if (!memo.cache.has(key)) {\n      memo.cache.set(key, fn.apply(this, args));\n    }\n    return memo.cache.get(key);\n  }\n\n  memo.cache = new Map<null | string, ReturnType<F>>();\n  memo.clear = (): void => memo.cache.clear();\n  memo.has = (...args: Parameters<F>): boolean => {\n    const key = hashFn(...args);\n    return key === undefined ? false : memo.cache.has(key);\n  };\n  return memo as MemoizedFn<F>;\n}\n\n/**\n * Describe abstract memoization hash function. Memoization should have the same or compatible signature as the decorated function.\n * Hash function can return string or null as a hash result. Note: null is correct hash for arguments!\n * If the result is `undefined` - it means that the hash can not be generated.\n */\nexport type MemoHashFn<F extends AnyToAnyFnSignature = AnyToAnyFnSignature> = (...args: Parameters<F>) => undefined | null | string;\n\n/**\n * Default arguments hash function.\n * Supports only 0-1 arguments with a primitive type.\n */\nexport function defaultArgsHashFn(...args: any[]): string | null | undefined {\n  if (args.length === 0) return null;\n  if (args.length > 1) return;\n  if (typeof args[0] !== 'string' && typeof args[0] !== 'number' && typeof args[0] !== 'boolean') return;\n  return String(args[0]);\n}\n","import {isObject} from './types';\n\n/** Deeply compares passed objects */\nexport function isEqual(obj1: any, obj2: any): boolean {\n  if (Object.is(obj1, obj2)) return true;\n  if (typeof obj1 !== typeof obj2) return false;\n  if (isObject(obj1) && isObject(obj2)) {\n    const keys1 = Object.keys(obj1);\n    const keys2 = Object.keys(obj2);\n    if (keys1.length !== keys2.length) return false;\n    return !keys1.some((key) => !isEqual(obj1[key], obj2[key]));\n  }\n  return false;\n}\n\n/** @deprecated alias for `isEqual` method */\nexport const deepCompare = isEqual;\n\n/** Check if arr and arr mask has intersection */\nfunction isIntersect(arrObj: any[], arrMask: any[], comparer: (a: any, b: any) => boolean): boolean {\n  return arrMask.every((key) => arrObj.some((itm) => comparer(itm, key)));\n}\n\n/**\n * Checks if all keys presented in the `mask` are equal to the `obj` keys\n * Note: array order is not taken into account and uses intersection strategy\n */\nexport function isSimilar(obj: any, mask: any, deep: boolean = true): boolean {\n  if (Array.isArray(obj) && Array.isArray(mask)) return isIntersect(obj, mask, deep ? isSimilar : Object.is);\n  if (!isObject(obj) || !isObject(mask)) return Object.is(obj, mask);\n  return Object.keys(mask).every((key: string) => (deep ? isSimilar : Object.is)(obj[key], mask[key]));\n}\n","export type CopyPredicate = (key: string, value: any) => boolean;\n\n/** Makes a plain copy of obj with properties satisfying the predicate\n * If no predicate provided copies all own properties */\nexport function copy<T>(obj: T, predicate: CopyPredicate = (): boolean => true): Partial<T> {\n  const result: any = Object.assign({}, obj || {});\n  Object.keys(result).forEach((key) => {\n    (!predicate(key, result[key])) && delete result[key];\n  });\n  return result;\n}\n\n/** Makes a flat copy without undefined keys */\nexport function copyDefinedKeys<T>(obj?: T): Partial<T> {\n  return copy(obj || {}, (key, value) => value !== void 0);\n}\n\n/** Omits copying provided properties from object */\nexport function omit<T>(obj: T, keys: string[]): Partial<T> {\n  return copy(obj, (key) => !keys.includes(key));\n}\n","import {isObject} from './types';\n\n/**\n * Performs a deep copy of object.\n * @returns deep copy of the object\n */\nexport function deepMerge<T>(obj: T): T;\n/**\n * Performs a deep merge of two objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U>(obj1: T, obj2: U): T & U;\n/**\n * Performs a deep merge of three objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V>(obj1: T, obj2: U, obj3: V): T & U & V;\n/**\n * Performs a deep merge of four objects. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge<T, U, V, W>(obj1: T, obj2: U, obj3: V, obj4: W): T & U & V & W;\n/**\n * Performs a deep merge of objects and returns new object. Does not modify objects (immutable)\n * @returns new object with merged key/values\n */\nexport function deepMerge(...objects: any[]): any;\nexport function deepMerge(...objects: any[]): any {\n  return objects.reduce((res: any, obj: any) => {\n    if (typeof obj === 'undefined') return res;\n    if (typeof res === 'undefined') res = Array.isArray(obj) ? [] : {};\n    if (!isObject(obj) || !isObject(res)) return obj;\n\n    Object.keys(obj).forEach((key) => {\n      res[key] = isObject(obj[key]) ? deepMerge(res[key], obj[key]) : obj[key];\n    });\n\n    return res;\n  }, undefined);\n}\n","import {isObjectLike} from './types';\n\n/** Full key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKeyDef = {\n  /** Key name */\n  key: string | number;\n  /** Key represents collection index */\n  isIndex?: boolean;\n  /** Key should produce array if not exists */\n  isIndexed?: boolean;\n};\n/** Key definition for {@link getByPath} or {@link setByPath} */\nexport type PathKey = PathKeyDef | string | number;\n\n/** @returns PathKeyDef from the PathDef */\nconst toKeyDef = (key: PathKey): PathKeyDef => typeof key === 'object' ? key : {key};\n\n/** Parses path to full {@link PathKeyDef} array */\nexport const parseKeys = (path: string | PathKey[]): PathKeyDef[] => {\n  if (Array.isArray(path)) return path.map(toKeyDef);\n  return parseKeysPath(path || '.');\n};\n\n/** Parses string path to full {@link PathKeyDef} array */\nconst parseKeysPath = (path: string): PathKeyDef[] => {\n  let start = 0;\n  const parts: PathKeyDef[] = [];\n\n  while (start < path.length) {\n    let end = start = start + +(path[start] === '.'); // skip initial '.'\n    if (path[start] === '[') { // handle index syntax\n      end = ++start; // start bracket ignored\n      while (end < path.length && path[end] !== ']') ++end;\n      const key = path.substring(start, end);\n      const isIndex = !key || Math.floor(+key) === +key;\n      parts.push({key, isIndex});\n      start = ++end; // skip end bracket\n    } else { // handle simple key\n      while (end < path.length && path[end] !== '[' && path[end] !== '.') ++end;\n      const key = path.substring(start, end);\n      parts.push({key});\n      start = end;\n    }\n  }\n  return parts;\n};\n\n/**\n * Gets object property using \"path\" key\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param data - object\n * @param path - key path. string or {@link PathKey} array\n * @param defaultValue - default\n * @returns specified object property\n */\nexport const getByPath = (data: any, path: string | PathKey[], defaultValue?: any): any => {\n  const keys = parseKeys(path);\n  const result = keys.reduce((curr: any, {key}: PathKeyDef) => {\n    if (isObjectLike(curr)) return curr[key];\n    return undefined;\n  }, data);\n  return typeof result === 'undefined' ? defaultValue : result;\n};\n\n/**\n * Gets object property using \"path\" with a keys separated by `.`\n * @see getByPath\n */\nexport const get = (data: any, path: string, defaultValue?: any): any => getByPath(data, (path || '').split('.'), defaultValue);\n\n/**\n * Sets object property using \"path\" key\n * Creates empty object if sub-key value is not presented.\n *\n * Supports three types of key definition\n * - full array of {@link PathKeyDef}\n * - array of keys (string or number), can be mixed with a full definitions {@link PathKeyDef}\n * - string path mode (supports index syntax and collection creation):\n *   - `a.b` - simple key access (`{a : {b: val}}`)\n *   - `a[0]` - index access, creates collection if it's not exists  (`{a : [val]}`)\n *   - `a[]` - pushes to the end of collection (`{a : [..., val]}`)\n *   - `a[a.b.c]` - escaping: non-numeric indexes uses as a simple keys, delimiters inside square brackets are ignored (`{a : {'a.b.c': val}}`)\n *\n * @param target - object\n * @param path - key path. string or {@link PathKey} array\n * @param value - value of property\n * @returns original object\n */\nexport const setByPath = (target: any, path: string | PathKey[], value: any): any => {\n  const keys = parseKeys(path);\n  const depth = keys.length - 1;\n  keys.reduce((cur: any, {key, isIndex, isIndexed}: PathKeyDef, pos: number) => {\n    if (isIndex && !key) key = cur.length || 0; // a[] only\n    if (pos !== depth && isObjectLike(cur[key])) return cur[key]; // key already presented\n    if (isIndexed === undefined && pos !== depth) isIndexed = keys[pos + 1].isIndex;\n    return cur[key] = (pos === depth) ? value : (isIndexed ? [] : {});\n  }, target);\n  return target;\n};\n\n/**\n * Sets object property using \"path\" with a keys separated by `.`\n * @see setByPath\n */\nexport const set = (target: any, path: string, value: any): any => setByPath(target, (path || '').split('.'), value);\n","/** Checks that passed value is object, but not a callable-object (function) */\nexport const isObject = (obj: any): obj is Record<string | symbol, any> => !!obj && typeof obj === 'object';\n/** Checks that passed value is an object or function */\nexport const isObjectLike = (obj: any): boolean => isObject(obj) || typeof obj === 'function';\n/** Checks if the passed value is primitive */\nexport const isPrimitive = (obj: any): obj is string | number | boolean | symbol | undefined | null =>\n  obj === null ||\n  typeof obj === 'undefined' ||\n  typeof obj === 'string' ||\n  typeof obj === 'number' ||\n  typeof obj === 'boolean' ||\n  typeof obj === 'symbol';\n/** Checks that passed object is prototype of some class */\nexport const isPrototype = (obj: any): boolean => Object.hasOwnProperty.call(obj, 'constructor');\n\n/** Array-like type definition */\nexport type ArrayLike<T = any> = {\n  [key: number]: T;\n  length: number;\n};\n/** Checks that passed object is array-like */\nexport const isArrayLike = (value: any): value is ArrayLike => {\n  if (!value || typeof value !== 'object') return false;\n  if (Array.isArray(value)) return true;\n  if (typeof value.length !== 'number' || value.length < 0) return false;\n  return !value.length || Object.hasOwnProperty.call(value, value.length - 1);\n};\n","export function defined(): undefined;\nexport function defined<T>(a: T): T;\nexport function defined(a: undefined, b: undefined): undefined;\nexport function defined<T>(a: T | undefined, b: T): T;\nexport function defined(a: undefined, b: undefined, c: undefined): undefined;\nexport function defined<T>(a: T | undefined, b: T | undefined, c: T): T;\nexport function defined<T>(...params: T[]): T | undefined;\n/** @returns first defined param */\nexport function defined<T>(...params: T[]): T | undefined {\n  for (const param of params) {\n    if (param !== undefined) return param;\n  }\n}\n\n/** Finds the closest property descriptor */\nexport function getPropertyDescriptor(o: any, prop: PropertyKey): PropertyDescriptor | undefined {\n  let proto = o;\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc) return desc;\n    proto = Object.getPrototypeOf(proto);\n  }\n}\n\n\nexport function extractValues(obj: any, filter: (value: any, key: string | symbol) => boolean): any[];\nexport function extractValues<T>(obj: any, filter: (value: any, key: string | symbol) => value is T): T[];\nexport function extractValues(obj: any, filter: (value: any, key: string | symbol) => boolean): any[] {\n  if (!obj) return [];\n  const desc: any[] = [];\n  for (const key in obj) {\n    if (filter(obj[key], key)) desc.push(obj[key]);\n  }\n  return desc;\n}\n","const ns = window || global;\nconst sequences = ns.__esl_sequences__ || new Map<string, number>();\nns.__esl_sequences__ = sequences;\n\ndeclare global {\n  interface Window {\n    __esl_sequences__: Map<string, number>;\n  }\n}\n\n/** Create and return sequential id */\nexport const sequentialUID = (name: string, prefix: string = name): string => {\n  const uid = (sequences.get(name) || 0) + 1;\n  sequences.set(name, uid);\n  return prefix + uid;\n};\n\n/** Return random unique identifier */\nexport const randUID = (prefix: string = ''): string => {\n  const time = Date.now().toString(32);\n  const rand = Math.round(Math.random() * 1024 * 1024).toString(32);\n  return prefix + time + '-' + rand;\n};\n\n/**\n * Generate unique id\n * @deprecated Alias for {@link randUID}\n */\nexport const generateUId = randUID;\n","/**\n * Converts relative URL to absolute URL based on the base URL.\n * @param relative - relative URL\n * @param base - base URL (document.baseURI by default)\n **/\nexport function toAbsoluteUrl(relative: string, base: string = document.baseURI): string {\n  return new URL(relative, base).href;\n}\n","import {ExportNs} from './esl-utils/environment/export-ns';\n\ndeclare global {\n  interface ESLLibrary {}\n  const ESL: ESLLibrary;\n  export interface Window {\n    ESl: ESLLibrary;\n  }\n}\n\nExportNs.declare();\n","/** Shim for ES5 style inheritance support of classes in modern browsers */\nexport function shimES5Constructor(Class: new (...args: any[]) => any): void {\n  if (window.Reflect === undefined || typeof Class !== 'function') return;\n  if (String(Class).indexOf('[native code]') === -1) return;\n  const constructor = function (...args: any[]): any {\n    return Reflect.construct(Class, args, this.constructor);\n  };\n  Object.defineProperty(constructor, 'name', {value: Class.name});\n  Object.defineProperty(window, Class.name, {value: constructor});\n  const Element = (window as any)[Class.name];\n  Element.prototype = Class.prototype;\n  Element.prototype.constructor = Element;\n  Object.setPrototypeOf(Element, Class);\n}\n\nshimES5Constructor(Event);\nshimES5Constructor(HTMLElement);\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`, `Safari < 13`\n * Element.toggleAttribute polyfill\n */\nif (!Element.prototype.toggleAttribute) {\n  Element.prototype.toggleAttribute = function (name: string, force: boolean | undefined): boolean {\n    const has = this.hasAttribute(name);\n    const state = force === void 0 ? !has : !!force;\n\n    if (has !== state) {\n      (state) ? this.setAttribute(name, '') : this.removeAttribute(name);\n    }\n    return state;\n  };\n}\n","/**\n * Group: DOM API shims\n * Target Browsers: `IE11`, `Edge < 18`\n * KeyboardEvent.prototype.key shim to normalize key values to W3C spec\n * Based on published shim https://www.npmjs.com/package/shim-keyboard-event-key\n */\n(function (KeyboardEventProto): void {\n  const desc = Object.getOwnPropertyDescriptor(KeyboardEventProto, 'key');\n  if (!desc) return;\n\n  const keyMap: Record<string, string> = {\n    Win: 'Meta',\n    Scroll: 'ScrollLock',\n    Spacebar: ' ',\n\n    Down: 'ArrowDown',\n    Left: 'ArrowLeft',\n    Right: 'ArrowRight',\n    Up: 'ArrowUp',\n\n    Del: 'Delete',\n    Apps: 'ContextMenu',\n    Esc: 'Escape',\n\n    Multiply: '*',\n    Add: '+',\n    Subtract: '-',\n    Decimal: '.',\n    Divide: '/',\n  };\n\n  Object.defineProperty(KeyboardEventProto, 'key', {\n    get() {\n      const key = desc.get!.call(this);\n      return Object.prototype.hasOwnProperty.call(keyMap, key) ? keyMap[key] : key;\n    },\n  });\n})(KeyboardEvent.prototype);\n","/**\n * Group: DOM polyfills\n * Target browsers: `IE11`, `Edge <= 18`\n * Node.isConnected polyfill\n */\nif (!('isConnected' in Node.prototype)) {\n  Object.defineProperty(Node.prototype, 'isConnected', {\n    get() {\n      return !this.ownerDocument ||\n        // eslint-disable-next-line no-bitwise\n        !(this.ownerDocument.compareDocumentPosition(this) & this.DOCUMENT_POSITION_DISCONNECTED);\n    }\n  });\n}\n","if (!('customElements' in window)) {\n  throw new Error('Browser is not support customElements, load polyfills before');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// Support for ES5 bundle target\nimport '../../src/polyfills/es5-target-shim';\n// Builtin polyfills\nimport '../../src/polyfills/polyfills.es6';\n// Validate environment\nimport '../../src/polyfills/polyfills.validate';\n\n// With Namespace\nimport '../../src/modules/lib';\n// Config\nimport './common/breakpoints';\n\nimport {\n  ESLVSizeCSSProxy,\n  ESLImage,\n  ESLMedia,\n  ESLToggleable,\n  ESLPopup,\n  ESLPopupPlaceholder,\n  ESLPanel,\n  ESLPanelGroup,\n  ESLTrigger,\n  ESLA11yGroup,\n  ESLTabs,\n  ESLTab,\n  ESLScrollbar,\n  ESLAlert,\n  ESLToggleableDispatcher,\n  ESLSelect,\n  ESLSelectList,\n  ESLNote,\n  ESLNoteIgnore,\n  ESLFootnotes,\n  ESLTooltip,\n  ESLAnimate,\n  ESLAnimateMixin,\n  ESLShare,\n  ESLRelatedTarget,\n\n  ESLCarousel,\n  ESLCarouselNavDots,\n  ESLCarouselNavMixin,\n  ESLCarouselTouchMixin,\n  ESLCarouselKeyboardMixin,\n  ESLCarouselRelateToMixin,\n  ESLCarouselAutoplayMixin\n} from '../../src/modules/all';\n\nimport '../../src/modules/esl-media/providers/iframe-provider';\nimport '../../src/modules/esl-media/providers/html5/audio-provider';\nimport '../../src/modules/esl-media/providers/html5/video-provider';\nimport '../../src/modules/esl-media/providers/youtube-provider';\nimport '../../src/modules/esl-media/providers/brightcove-provider';\n\nimport '../../src/modules/esl-share/actions/copy-action';\nimport '../../src/modules/esl-share/actions/external-action';\nimport '../../src/modules/esl-share/actions/media-action';\nimport '../../src/modules/esl-share/actions/native-action';\nimport '../../src/modules/esl-share/actions/print-action';\n\nimport './esl-media-demo/test-media';\nimport './esl-media-demo/test-media-source';\n\nimport {ESLDemoBackLink} from './back-link/back-link';\nimport {ESLDemoMarquee} from './landing/landing';\nimport {ESLDemoSearchBox} from './navigation/header/header-search';\nimport {ESLDemoSearchPageWrapper} from './search/search';\nimport {ESLDemoSidebar} from './navigation/navigation';\nimport {ESLDemoAnchorLink} from './anchor/anchor-link';\nimport {ESLDemoBanner} from './banner/banner';\n\nESLVSizeCSSProxy.observe();\n\n// Register Demo components\nESLDemoSidebar.register();\nESLDemoMarquee.register();\nESLDemoSearchBox.register();\nESLDemoSearchPageWrapper.register();\nESLDemoAnchorLink.register();\nESLDemoBackLink.register();\nESLDemoBanner.register();\n\n// Register ESL Components\nESLImage.register();\nESLMedia.register();\n\nESLToggleableDispatcher.init();\nESLToggleable.register();\nESLPopup.register();\nESLPopupPlaceholder.register();\n\nESLPanelGroup.register();\nESLPanel.register();\n\nESLTrigger.register();\nESLTab.register();\n\nESLA11yGroup.register();\nESLTabs.register();\n\nESLScrollbar.register();\n\nESLAlert.register();\nESLAlert.init({\n  closeOnOutsideAction: true\n});\n\nESLSelectList.register();\nESLSelect.register();\n\nESLFootnotes.register();\nESLNote.register();\nESLNoteIgnore.register();\nESLTooltip.register();\n\nESLAnimate.register();\nESLAnimateMixin.register();\n\nESLCarousel.register();\nESLCarouselNavDots.register();\nESLCarouselNavMixin.register();\nESLCarouselTouchMixin.register();\nESLCarouselKeyboardMixin.register();\nESLCarouselRelateToMixin.register();\nESLCarouselAutoplayMixin.register();\n\nESLShare.config(() => fetch('/assets/share/config.json').then((response) => response.json()));\nESLShare.register();\n\n// Register ESL Mixins\nESLRelatedTarget.register();\n"],"names":["ESLDemoAnchorLink","anchorHref","this","$host","HTMLAnchorElement","url","URL","href","hash","substring","anchorTarget","document","getElementById","moveToTarget","$target","console","warn","dispatch","scrollIntoView","behavior","onClick","e","preventDefault","history","pushState","is","ESLDemoBackLink","connectedCallback","super","referrer","host","window","location","$$attr","ESLDemoBanner","_$focusBefore","hasCookie","cookieName","cookie","indexOf","$focusable","querySelector","registerCookie","expireDays","cookieTime","expires","Date","now","toUTCString","setInitialState","toggle","initialParams","onShow","params","activeElement","focus","initiator","onHide","parser","str","encodeURIComponent","trim","defaultValue","parseInt","showDelay","add","ESLDemoMediaSource","$targets","all","target","render","onChange","form","createElement","innerHTML","action","appendChild","inputs","querySelectorAll","Array","from","forEach","input","HTMLInputElement","type","toggleAttribute","name","checked","setAttribute","value","register","ESLDemoMediaControls","actionList","actions","split","actionName","ACTIONS","dataset","actionDesc","actionFn","$el","call","renderButton","btn","className","textContent","title","play","pause","stop","ACTIONS_ALL","Object","keys","join","ESLDemoMarquee","_$active","_animateTimer","startAnimation","disconnectedCallback","stopAnimation","$stars","constructor","STARS_SEL","$randomStar","index","Math","floor","random","length","clear","setTimeout","_onIteration","iterationTime","clearTimeout","$candidates","targetsNumber","star","classList","remove","ESLDemoSearchBox","closeOnOutsideAction","postCls","then","showSearchElements","autofocus","$focusEl","first","firstFocusable","postClsDelay","loadingAnimationEL","activator","preventScroll","onFocusOut","relatedTarget","currentTarget","contains","hide","hideDelay","event","ESLDemoSidebar","closeOnEsc","submenus","activeMenuAttr","$submenus","storeState","open","localStorage","removeItem","setItem","isDesktop","for","matches","isStoredOpen","getItem","force","immediate","collapseAll","menu","expandActive","noAnimate","filter","hasAttribute","show","updateA11y","targetEl","$a11yTarget","String","_animation","onBreakpointChange","_onOutsideAction","inherit","onGSSReady","Promise","resolve","__gcse","parsetags","initializationCallback","requestGss","ESLDemoSearchPageWrapper","afterSearchScriptLoad","ESLA11yGroup","$root","parentElement","targets","_onKeydown","includes","groupTarget","KEY_MAP","key","goTo","current","activateSelected","click","next","trigger","triggers","prev","$active","ESLAlert","static","options","alert","assign","create","body","mergeDefaultParams","defaultConfig","defaultParams","attributeChangedCallback","attrName","oldVal","newVal","connected","getAttribute","$content","isIE","_$target","$$on","_onShowRequest","_onHideRequest","_clearTimeout","html","text","hideTime","cls","activeCls","buildRequestParams","detail","match","SHOW_REQUEST_EVENT","HIDE_REQUEST_EVENT","stopPropagation","observedAttributes","el","ESLAnimateMixin","reanimate","unobserve","observe","ESLAnimateService","_io","IntersectionObserver","onIntersect","OPTIONS_OBSERVER","_entries","Set","_configMap","WeakMap","deferredOnAnimate","onAnimate","config","item","instance","isObserved","cfg","DEFAULT_CONFIG","set","delete","get","entries","intersectionRatio","isIntersecting","ratio","repeat","_timeout","time","group","groupDelay","onAnimateItem","_unsubscribe","threshold","ESLAnimate","finalize","tagName","defineProperty","Error","writable","configurable","ESLBaseElement","HTMLElement","_connected","baseTagName","subscribe","unsubscribe","oldValue","newValue","handler","$$off","condition","$$cls","undefined","has","prevValue","$$fire","eventName","eventInit","DOMException","customElements","define","registered","whenDefined","ESLCarouselSlideEvent","Event","init","bubbles","cancelable","BEFORE","composed","AFTER","ESLCarouselChangeEvent","TYPE","added","removed","ESLCarouselRenderer","carousel","size","count","loop","$area","$slidesArea","bind","onBind","unbind","onUnbind","redraw","navigate","direction","activeIndex","activeIndexes","dispatchEvent","related","onBeforeAnimate","onAfterAnimate","error","setActive","min","$slides","active","i","slideAt","registry","ESLCarouselRendererRegistry","view","store","Map","Renderer","values","CustomEvent","ESLCarouselSlide","$carousel","carouselTag","replace","closest","addSlide","removeSlide","parentNode","prototype","children","NaN","$next","$prev","$nextCyclic","$prevCyclic","content","$slide","ESLCarousel","typeRule","parse","mediaCfg","typeCfg","loopRule","loopCfg","countRule","countCfg","state","renderer","update","oldType","oldConfig","$oldSlides","updateContainer","slide","$container","removeChild","_onRuleUpdate","_onRegistryUpdate","_onResize","$provided","$activeSlide","actives","prevIndex","$activeSlides","arr","push","reduce","dir","canNavigate","readonly","boundIndex","max","normalizeIndex","calcDirection","to","abs","indexToGroup","groupCount","ceil","firstGroupIndex","secondGroupIndex","commonCount","firstGroupCount","indexToDirection","parseIndex","isRelative","toIndex","splitTarget","indexStr","groupToIndex","resolveGroupIndex","resolveSlideIndex","ESLCarouselAutoplayMixin","start","_onInterval","timeout","command","_onInteract","ESLCarouselPlugin","removeAttribute","ESLCarouselKeyboardMixin","ESLCarouselNavDots","toLowerCase","rerender","activeDot","buildDot","isActive","_onSlideChange","_onClick","$eventTarget","ESLCarouselNavMixin","$nav","ESLCarouselRelateToMixin","ESLCarouselTouchMixin","startPoint","x","y","isTouchStarted","isIgnoredEvent","media","touches","button","_onPointerDown","animating","_onPointerMove","_onPointerUp","offset","tolerance","onMove","commit","ESLMultiCarouselRenderer","gapWidth","slideWidth","currentIndex","resize","reindex","style","removeProperty","transform","reject","nextIndex","onBeforeStepAnimate","onAfterStepAnimate","orderIndex","offsetIndex","offsetLeft","shiftXBefore","shiftXAfter","sign","_checkNonLoop","stageOffset","shiftCount","catch","slidesAreaStyles","getComputedStyle","width","parseFloat","columnGap","minWidth","order","ESLEventUtils","criteria","eventDesc","arguments","acc","desc","concat","listeners","mergedDesc","listener","descriptors","getAutoDescriptors","initDescriptor","isEventDescriptor","DESCRIPTORS","Symbol","getOwnDescriptorsKeys","hasOwnProperty","obj","proto","getPrototypeOf","getDescriptorsKeysFor","map","auto","fn","TypeError","superDesc","ReferenceError","addDescriptorKey","LISTENERS","ESLEventListener","defaults","capture","passive","Element","delegate","selector","handleEvent","handlerBound","handlerFull","once","handleDelegation","$delegate","addEventListener","removeEventListener","every","descriptor","createOrResolve","eventString","events","terms","term","deduplicate","splitEvents","subscribed","ESLElementResizeEvent","UIEvent","entry","contentRect","borderBoxSize","contentBoxSize","devicePixelContentBoxSize","ESLResizeObserverTarget","adapter","mapping","fromEntry","callback","getEventListeners","observer$$","hasEventListener","ResizeObserver","changes","handleChange","convertNotesToFootnotesList","notes","renderedIndex","compileFootnotesNongroupedList","note","allowFootnotes","compileFootnotesGroupedList","groupedList","sortFootnotes","sort","note1","note2","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","ESLFootnotes","_notes","deferredOnUpdate","_onUpdate","scopeEl","scopeTarget","footnotesList","grouping","id","_notifyNotes","unlink","linkNote","link","_sortNotes","unlinkNote","buildItems","footnote","buildItem","buildItemIndex","buildItemText","buildItemBack","buildWrappedItemIndex","backToNoteLabel","_onNoteSubscribe","stopImmediatePropagation","_onItemClick","orderAttr","_onBackToNote","highlight","activate","turnOffHighlight","FOOTNOTE_REQUEST_EVENT","FOOTNOTE_RESPONSE_EVENT","ESLNoteIgnore","noteSelector","$note","updateIgnoredQuery","ESLNote","allowHover","hasHover","trackHover","allowClick","trackClick","queryToIgnore","_index","renderedHTML","standaloneLabel","_$footnotes","ignore","getClosestRelatedAttr","currentDir","currentLang","lang","_sendResponseToFootnote","restore","_onIgnoreConditionChange","relatedAttrName","$closest","hideTooltip","activateTimeout","block","showTooltip","enable","footnotes","linked","tabIndex","standalone","mergeToggleableParams","container","containerEl","intersectionMargin","actionParams","toggleTooltip","tooltipShown","_onMouseEnter","_onMouseLeave","_onFootnotesReady","ESLSelectItem","selected","disabled","option","original","ESLSelectList","$list","$scroll","$selectAll","_updateDisabled","bindSelect","HTMLSelectElement","$select","_renderItems","$items","build","pinSelected","_renderGroup","multiple","items","last","slice","_updateSelectAll","isAllSelected","selectAllLabel","_onTargetChange","newTarget","oldTarget","_onChange","_onListChange","setAllSelected","setSelected","increment","ESLSelectWrapper","_mutationObserver","MutationObserver","_onTargetMutation","_$select","select","disconnect","observationConfig","some","change","addedNodes","removedNodes","_onReset","selectedOptions","getOption","find","isSelected","opt","hasSelected","required","validity","validationMessage","willValidate","checkValidity","reportValidity","setCustomValidity","subtree","attributes","attributeFilter","childList","characterData","ownerDocument","ESLSelectDropdown","_disposeTimeout","$owner","dropdownClass","_updatePosition","_onKeyboardEvent","_onTabKey","$els","$first","$last","shiftKey","getBoundingClientRect","ESLSelectRenderer","$text","$rest","$remove","owner","hasValue","applyItems","apply","limit","rest","moreLabelFormat","scrollWidth","clientWidth","_onClear","ESLSelect","$renderer","$dropdown","_prepare","_updateMarkers","_dispose","valueChanged","emptyText","placeholder","hasValueClass","focusEl","hasFocus","hasFocusClass","_onFocusOut","_onPopupStateChange","iObserver","getIObserver","handleViewport","rootMargin","isMobile","image","triggerLoad","EMPTY_IMAGE","isEmptyImage","src","STRATEGIES","img","shadowImg","isEmpty","backgroundImage","paddingTop","height","innerImg","attachInnerImage","removeInnerImage","devicePixelRatio","request","XMLHttpRequest","onreadystatechange","readyState","status","responseText","send","ESLImage","alt","srcRules","lazyObservable","_detachLazyTrigger","refresh","clearImage","_srcRules","_onMediaMatchChange","changeMode","lazyTriggered","rules","currentSrc","_currentSrc","empty","canUpdate","lazy","originalWidth","_shadowImageElement","originalHeight","mode","loaded","syncImage","getPath","activeValue","ready","_shadowImg","refreshOnUpdate","complete","_shadowImgError","_onError","_onLoad","role","innerImage","srcBase","updateContainerClasses","strategy","_strategy","_innerImg","innerImageClass","cloneNode","Image","onload","onerror","naturalHeight","_onReadyState","successful","LOAD_EVENT","ERROR_EVENT","READY_EVENT","containerClass","DEFAULT_CONTAINER_CLS","isLoadState","containerClassState","containerClassTarget","dataAttr","shortcuts","ESLEnvShortcuts","shortcut","_shortcuts","isTouchDevice","isBot","isAndroid","isMobileIOS","isEdgeHTML","isGecko","isWebkit","isBlink","isSafari","isMobileSafari","ESLScreenBreakpoints","maxWidth","BP_NAME_REGEXP","test","ESLScreenBreakpoint","names","bp","BP_REGEXP","mediaQueryGE","mediaQueryLE","mediaQuery","toString","ESLScreenDPR","dpr","toFixed","VALUE_REGEXP","isNaN","ignoreBotsDpr","toDPI","ESLMediaChangeEvent","MediaQueryCondition","query","inverted","_inverted","_mq","matchMedia","addListener","removeListener","optimize","eq","MediaQueryConstCondition","_matches","val","ALL","NOT_ALL","MediaQueryContainer","MediaQueryConjunction","optimizedItems","MediaQueryDisjunction","pretty","ESLMediaQuery","preprocessor","_preprocessors","unshift","conjunctions","conditions","parseSimpleQuery","SHORTCUT_PATTERN","replacer","result","process","queryInverted","processedQuery","preprocess","sanitizedQuery","invert","use","ESLMediaRuleListEvent","previous","ESLMediaRuleList","common","pop","parseTuple","parseQuery","lex","rule","mask","queries","valueList","validRules","_rules","_onMatchChanged","_value","computedValue","payload","activeValues","curValue","STRING_PARSER","OBJECT_PARSER","ESLMediaRule","JSON","stringify","payloadValue","parts","RATIO_TO_ACTIVATE","RATIO_TO_DEACTIVATE","video","autoplay","managerMap","MediaGroupRestrictionManager","MANAGED_PAUSE_EVENT","PlayerStates","BaseProvider","component","muted","controls","preload","playsinline","mediaId","mediaSrc","_ready","res","log","providerName","_el","onConfigChange","param","setSize","setProperty","PAUSED","UNSTARTED","VIDEO_CUED","onSafeConfigChange","safeSeekTo","pos","seekTo","safePlay","safePause","safeStop","safeToggle","provider","evRegistryInstance","ESLMediaProviderRegistry","providersMap","providers","list","fire","findByName","createFor","createByType","createBySrc","mediaType","_create","reverse","parseUrl","parseConfig","ESLMedia","deferredResize","deferredReinitialize","reinitInstance","PLAYER_STATES","bindEvents","attachViewportConstraint","unbindEvents","detachViewportConstraint","_provider","playInViewport","_onRegistryStateChange","conditionQuery","fillModeEnabled","REFRESH_EVENT","_onRefresh","canActivate","debug","updateContainerMarkers","loadClsTarget","loadClsAccepted","loadClsDeclined","allowActivate","cancel","focusPlayer","_onReady","updateReadyClass","setReadyState","_onDetach","DETACHED_EVENT","_onPlay","PLAY_EVENT","registerPlay","_onPaused","PAUSED_EVENT","unregister","_onEnded","ENDED_EVENT","actualAspectRatio","stretchVertically","offsetWidth","offsetHeight","fillMode","providerType","readyClassTarget","readyClass","UNINITIALIZED","duration","currentTime","loadCondition","aspectRatio","defaultAspectRatio","observer","API_SCRIPT_ID","BrightcoveProvider","videojsClasses","playerId","accountId","account","apiSrc","apiScript","buildVideo","_account","$$fromEvent","_api","one","onAPILoaded","bc","videojs","onAPIReady","_autoplay","on","Provider","getAccount","loadAPI","dispose","ended","ENDED","paused","played","PLAYING","videoWidth","videoHeight","AudioProvider","urlPattern","HTMLMediaProvider","applyElementSettings","bindListeners","VideoProvider","IframeBasicProvider","_state","protocol","buildIframe","contentWindow","YouTubeProvider","providerRegexp","idRegexp","_coreApiPromise","YT","Player","cbOrigin","onYouTubeIframeAPIReady","err","enablejsapi","origin","rel","showinfo","iv_load_policy","Number","disablekb","autohide","sm","getCoreApi","onCoreApiReady","onPlayerReady","videoId","onError","onReady","onStateChange","_onStateChange","playerVars","mapOptions","getIframe","mute","destroy","data","playVideo","unMute","HTMLIFrameElement","getPlayerState","getDuration","getCurrentTime","pauseVideo","stopVideo","instances","ESLMixinAttributesObserver","records","handleRecord","record","attributeName","mixin","attributeOldValue","instanceFor","ESLMixinElement","getAll","STORE","global","ESLMixinRegistry","mutation$$","_onMutation","attrs","invalidateRecursive","documentElement","resubscribe","root","takeRecords","invalidate","invalidateAll","child","hasStore","mutations","node","nodeType","ELEMENT_NODE","destroyAll","Mixin","parseCount","POSITIVE_INFINITY","ESLPanelGroup","_previousHeight","_onConfigChange","prevMode","currentMode","updateModeCls","reset","MODE_CHANGE_EVENT","modeCls","modeClsTarget","supportedModes","modeRules","minValueRules","minOpenItems","maxValueRules","maxOpenItems","refreshRules","refreshStrategy","currentMinItems","$panels","currentMaxItems","panelSel","includesPanel","$activePanels","$initialPanels","initiallyOpened","$resetStatePanels","shouldAnimate","panelConfig","capturedBy","mergeActionParams","$group","showAll","excluded","hideAll","$orderedPanels","activeCount","transformParams","panel","fallbackAnimate","distance","clientHeight","afterAnimate","beforeAnimate","animationClass","silent","AFTER_ANIMATE_EVENT","_onBeforeShow","balanceMarker","overflow","_onShow","initialHeight","_onBeforeHide","$firstInactive","$panel","_onTransitionEnd","propertyName","ESLPanel","_initialHeight","groupName","panelGroupSel","scrollHeight","postAnimate","animateClass","postAnimateClass","maxHeight","clearAnimation","AFTER_SHOW_EVENT","AFTER_HIDE_EVENT","stackConfig","ESLPopupPlaceholder","isMajorAxisHorizontal","position","calcPopupPositionByMinorAxis","centerPosition","dimensionName","arrow","marginArrow","calcUsableSizeForArrow","offsetArrowRatio","adjustAlignmentBySide","elCoord","outerCoord","arrowCoord","arrowLimit","isStartingSide","arrowAdjust","newCoord","element","calcArrowPosition","calcPopupPosition","popup","inner","cx","cy","right","bottom","calcPopupBasicRect","placedAt","rect","isMirrored","outer","left","top","fitOnMajorAxis","isHorizontal","end","dimension","coordAdjust","fitOnMinorAxis","scrollOptions","ESLPopup","_deferredUpdatePosition","_intersectionRatio","$arrow","arrowClass","appendArrow","_containerEl","containerRect","pageYOffset","moveToBody","_isMajorAxisHorizontal","_isMajorAxisVertical","_offsetArrowRatio","nanValue","rawValue","parsePercent","offsetArrow","$placeholder","replaceChild","disableActivatorObservation","_offsetTrigger","offsetTrigger","_offsetContainer","offsetContainer","_intersectionMargin","visibility","afterOnShow","beforeOnHide","_stopUpdateLoop","_removeActivatorObserver","_addActivatorObserver","_startUpdateLoop","_checkIntersectionForAdjacentAxis","isAdjacentAxis","onActivatorIntersection","intersectionRect","boundingClientRect","onActivatorScroll","_updateLoopID","scrollParents","_activatorObserver","unsubscribers","cb","same","lastRect","updateLoop","newRect","isEqual","requestAnimationFrame","cancelAnimationFrame","triggerRect","popupRect","arrowRect","innerMargin","grow","shrink","ESLRelatedTarget","mergeParams","ESLScrollbar","_deferredDrag","_onPointerDrag","_deferredRefresh","_scrollTimer","_resizeObserver","rec","updateContentObserve","findTarget","unbindTargetEvents","bindTargetEvents","$scrollbarTrack","trackClass","$scrollbarThumb","thumbClass","_onScrollOrResize","recs","contentChanges","scrollableSize","horizontal","trackOffset","thumbOffset","thumbSize","areaSize","scrollSize","scrollOffset","scrollTop","scrollTargetTo","normalizePosition","relativePosition","scrollTo","dragging","thumbPosition","updateMarkers","toPosition","point","_initialPosition","_pointerPosition","_initialMousePosition","_onThumbPointerDown","_onPointerDownTick","allowedOffset","noContinuousScroll","_onBodyClick","positionChange","scrollableAreaHeight","absChange","ESLShareCopyAction","isAvailable","navigator","clipboard","share","$button","shareData","getShareData","writeText","showCopyAlert","additional","alertText","ESLShareExternalAction","a","buildURL","ESLShareMediaAction","windowFeatures","features","FEATURES","scrollbars","resizable","menubar","toolbar","ESLShareNativeAction","ESLSharePrintAction","print","ESLShareUrlGenericAction","getFormatSource","u","t","ESLShareActionRegistry","actionsMap","ESLShareBaseAction","urlToShare","titleToShare","ESLShareButton","actionInstance","getShareAttr","updateAction","initA11y","fallback","getConfigSectionItem","section","selectButtonsForList","btnName","groupConfig","groups","btnConfig","buttons","ESLShareTrigger","showTarget","forwardAttributes","forwardedAttrs","ESLShare","_config","buttonsConfig","_content","buildContent","SHARE_READY_EVENT","appendButtonsTo","$popup","getStoredPopup","createPopup","appendTrigger","createButton","$trigger","$icon","icon","iconBackground","popupInitialParams","storePopup","_popupStore","ESLTab","a11yLabelActive","a11yLabelInactive","a11yLabel","ESLTabs","_deferredUpdateArrows","updateArrows","_deferredFitToViewport","fitToViewport","scrollableTypeRules","scrollable","currentScrollableType","updateScrollableType","_onScrollableTypeChange","bindScrollableEvents","_onScroll","unbindScrollableEvents","$tabs","els","$current","$scrollableTarget","scrollableTarget","isScrollable","moveTo","scrollBy","areaRect","itemRect","calcScrollOffset","isReversedRTL","shift","swapSides","scrollStart","scrollLeft","scrollEnd","$rightArrow","$leftArrow","hasScroll","supportedScrollableTypes","_onTriggerStateChange","tabDirection","_onFocus","ESLToggleableDispatcher","_popups","getElementsByTagName","insertAdjacentElement","isAcceptable","hideActive","getActive","dispatcher","deleteActive","_onHide","_onChangeGroup","oldGroupName","newGroupName","BEFORE_SHOW_EVENT","SHOW_EVENT","HIDE_EVENT","GROUP_CHANGED_EVENT","ESLToggleablePlaceholder","$origin","copyAttributesFromOrigin","buildAttrName","allowedAttrs","activators","ESLToggleable","_open","_task","_trackHover","noAutoId","bindOutsideEventTracking","track","bindHoverStateTracking","_trackHoverDelay","put","showTask","delay","hideTask","BEFORE_HIDE_EVENT","activeClass","bodyClass","containerActiveClass","containerActiveClassTarget","isOutsideAction","KeyboardEvent","_onCloseClick","baseParams","trackHoverParams","closeTrigger","ESLTooltip","sharedInstance","focusableElements","firstFocusableElement","lastFocusableElement","disableArrow","innerText","extraClass","_updateActivatorState","newState","ESLTraversingQuery","PROCESSORS_REGEX","ELEMENT_PROCESSORS","COLLECTION_PROCESSORS","RegExp","selString","sel","collection","processors","findFirst","processor","isCollectionProcessor","processedItem","processCollection","traverseChain","processElement","resultCollection","stack","base","scope","found","part","splitQueries","traverseQuery","rootSel","baseCollection","initial","traverse","ESLTrigger","updateTargetFromSelector","newPopupInstance","_onTargetStateChange","a11yTarget","isTargetIgnored","$ignore","hideTarget","toggleTarget","updateState","wasActive","clsTarget","activeClassTarget","originalEvent","CHANGE_EVENT","_onPrimaryEvent","ignoreEsc","hoverShowDelay","hoverHideDelay","that","OBSERVED_EVENTS","resolveDomTarget","Observable","_listeners","args","debounce","wait","thisArg","deferred","debouncedSubject","promise","enumerable","DelayedTask","_fn","run","task","microtask","microtaskFn","arg","repeatSequence","resolvePromise","PromiseUtils","fromTimeout","fromEvent","fromMarker","tryUntil","promisifyTransition","props","transitionCallback","createDeferred","rej","promisifyEvent","eventCallback","promisifyMarker","marker","promisifyTimeout","isReject","tryCount","check","afterNextRender","skipOneRender","rafDecorator","lastArgs","attr","propName","serializer","propertyKey","originalFn","getBound","boolAttr","readOnly","buildConditionalDescriptor","decorate","decorator","decoratedFn","jsonAttr","attrContent","buildJsonAttrDescriptor","listen","memoize","hashFn","prop","originalMethod","locks","defineOwnKeySafe","memoizeGetter","memo","memoizeMethod","property","isArray","prototypeConfig","getNodeName","Window","getParentNode","ShadowRoot","assignedSlot","getDocument","hasAttr","getAttr","setAttr","lockStore","locker","elLocks","classLocks","lock","unlock","CSSClassUtils","tokenString","tokens","splitTokens","isMouseEvent","MouseEvent","isTouchEvent","TouchEvent","PASSIVE_EVENTS","isPassiveByDefault","getCompositeTarget","composedPath","getTouchPoint","source","changedTouches","pageX","pageY","getOffsetPoint","scrollY","scrollX","dispatchCustomEvent","overrideEvent","SyntheticEventTarget","minCount","DEFAULT_EVENT","validateEventListenerType","srcElement","defaultPrevented","getKeyboardFocusableElements","TAB","ENTER","ESC","SPACE","PAUSE","ARROW_LEFT","ARROW_UP","ARROW_RIGHT","ARROW_DOWN","SYSTEM_KEYS","onDocumentReady","Rect","rect1","rect2","incrementX","incrementY","decrementX","decrementY","area","isRTL","RTLScroll","scrollType","createTextNode","fontSize","createDummyScroll","testRTLScrollType","normalizeScrollLeft","isRtl","RTLUtils","sanitizeElAttributes","isDangerousAttribute","removeDangerousAttributes","removeScripts","scripts","script","filterElements","allowedTopLevelTags","childNodes","sanitize","DOMParser","parseFromString","createAsyncScript","async","loadScript","firstScriptTag","insertBefore","getListScrollParents","scrollParent","getScrollParent","isBody","updatedList","overflowX","overflowY","lastLeft","lastTop","isMatches","matcher","isRelativeNode","nodeA","nodeB","createSequenceFinder","includeSelf","predicate","findNext","nextElementSibling","findPrev","previousElementSibling","findParent","findClosest","findHost","getRootNode","findAll","findChildren","findClosestBy","skipSelf","findNextLooped","firstElementChild","findPrevLooped","lastElementChild","TraversingUtils","closestBy","isVisible","getClientRects","opacity","parent","viewport","wndIntersection","intersect","isInViewport","getWindowRect","wnd","pageXOffset","innerWidth","innerHeight","userAgent","vendor","platform","isTrident","isBlinkEdge","isEdge","isFirefox","isOpera","isChrome","isMobileIOS13","maxTouchPoints","isLegacyMobile","navApi","msMaxTouchPoints","Touch","TOUCH_EVENTS","START","MOVE","END","DeviceDetector","exportNs","module","ExportNs","declare","createZIndexIframe","iframe","ESLVSizeCSSProxy","updateDebounced","$html","vwProp","viewportWidth","vhProp","viewportHeight","tuple","flat","wrap","uniq","range","n","filler","toKebabCase","unwrapParenthesis","parseString","parseBoolean","parseNumber","parseAspectRatio","w","h","evaluate","Function","DEF_FORMAT_MATCHER","format","identity","resolveProperty","memoizeFn","defaultArgsHashFn","cache","obj1","obj2","keys1","keys2","isSimilar","deep","arrObj","arrMask","comparer","itm","copyDefinedKeys","copy","deepMerge","objects","toKeyDef","parseKeysPath","path","isIndex","parseKeys","curr","getByPath","isObject","isObjectLike","isPrototype","defined","getPropertyDescriptor","o","getOwnPropertyDescriptor","ns","g","sequences","__esl_sequences__","sequentialUID","prefix","uid","randUID","round","toAbsoluteUrl","relative","baseURI","shimES5Constructor","Class","Reflect","construct","setPrototypeOf","KeyboardEventProto","keyMap","Win","Scroll","Spacebar","Down","Left","Right","Up","Del","Apps","Esc","Multiply","Add","Subtract","Decimal","Divide","DOCUMENT_POSITION_DISCONNECTED","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","getter","__esModule","d","definition","globalThis","E","fetch","response","json"],"sourceRoot":""}