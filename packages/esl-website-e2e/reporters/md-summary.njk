{% macro row(list) -%}
  {%- if list and list.length -%}
    <tr>
      {%- for item in list -%}
        <td>{{ item | safe }}</td>
      {%- endfor -%}
    </tr>
  {%- endif -%}
{%- endmacro %}

{% macro errorRow(errorHtml, colspan) -%}
  {%- if errorHtml -%}
    <tr>
      <td colspan="{{ colspan }}">
        <pre>{{ errorHtml | safe }}</pre>
      </td>
    </tr>
  {%- endif -%}
{%- endmacro %}

<h2>Website E2E (Playwright) â€” Summary</h2>

<table>
  <tbody>
    {{ row(['âœ… Passed', 'âŒ Failed', 'ğŸš§ Flaky', 'âšª Skipped', 'â± Duration']) }}
    {{ row([stats.passed, stats.failed, stats.flaky, stats.skipped, stats.totalTimeStr]) }}
  </tbody>
</table>

{%- if tests and tests.length -%}
  <hr/>
  <h3>Tests</h3>
  <table>
    <tbody>
      {{ row(['Test', 'Status', 'Time']) }}
      {%- for t in tests -%}
        {%- set status = 'âœ…' if t.status == 'passed' else ('ğŸš§' if t.status == 'flaky' else ('âšª' if t.status == 'skipped' else 'âŒ')) -%}
        {%- set timing = '-' if not t.time else (t.time + 'ms' if t.time < 1000 else (t.time / 1000) | round(2) + 's') -%}
        {{ row([t.title, status, timing]) }}
        {{ errorRow(t.error, 3) }}
      {%- endfor -%}
    </tbody>
  </table>
{%- endif -%}
