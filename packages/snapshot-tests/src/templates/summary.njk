{% from './row.njk' import row with context %}
{% from './error-row.njk' import errorRow with context %}

<h1>Test Results</h1>
<h2>Summary</h2>
<table>
  <tbody>
    {{ row(['🕙 Start time', '⌛ Duration']) }}
    {{ row([stats.startTimeStr, stats.totalTimeStr]) }}
  </tbody>
</table>
<table>
  <tbody>
    {{ row(['', '✅ Passed', '❌ Failed', '🚧 Todo', '⚪ Total']) }}
    {{ row(['Test Suites', stats.numPassedTestSuites, stats.numFailedTestSuites, '-', stats.numTotalTestSuites]) }}
    {{ row(['Tests', stats.numPassedTests, stats.numFailedTests, stats.numTodoTests, stats.numTotalTests]) }}
  </tbody>
</table>

{%- if files -%}
<hr/>
<h2>Tests Details</h2>
{%- endif -%}
{%- for file in files -%}
<h3>{{ file.filepath }}</h3>
<table>
  <tbody>
    {{ row(['Test', 'Status', 'Time']) }}
    {%- for test in file.tests -%}
      {%- set title = test.name + ': ' + test.title -%}
      {%- set status = '✅' if test.status == 'passed' else '❌' -%}
      {%- set timing = test.time + 'ms' if test.time < 1000 else (test.time / 1000) + 's' -%}
      {{ row([title, status, timing]) }}
      {%- if test.status != 'passed' -%}
        {{ errorRow(test, basePath) }}
      {%- endif -%}
    {%- endfor -%}
  </tbody>
</table>
{%- endfor -%}
