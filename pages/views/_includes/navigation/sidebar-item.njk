{% macro navitem(title, collection, icon) %}
  {% set isPrimaryActive = functions.isActivePath(page.url, collection) %}

  <div class="sidebar-nav-item-heading {{ 'active' if isPrimaryActive }}">
    <a class="sidebar-nav-item-link" href="{{ ('/' + collection) | url }}">
      {% include icon %}
    </a>
    <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow"
                 target="::parent::next"
                 {% if isPrimaryActive %}active{% endif %}>
      {{ title }}
    </esl-trigger>
  </div>

  <esl-panel id="sidebar-{{ collection }}-menu"
             class="sidebar-nav-secondary {{ 'open' if isPrimaryActive }}"
             group="esl-nav"
             fallback-duration="400">
    <ul class="sidebar-nav-secondary-list">
      {% for item in collections[collection] | released | sortByNameAndOrder %}
        {% set isActive = page.url === item.url %}
        <li class="sidebar-nav-secondary-item {{ 'active' if isActive }}"
            {% if isActive %}aria-selected="true"{% endif %}>
          <a class="sidebar-nav-secondary-link"
             {% if isActive %}aria-current="page"{% endif %}
             href="{{ item.url | url }}">
            {{ item.data.name }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </esl-panel>
{% endmacro %}
